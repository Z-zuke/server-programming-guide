{"config":{"lang":["en"],"separator":"[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+","pipeline":["stemmer"]},"docs":[{"location":"","title":"\u670d\u52a1\u5668\u7f16\u7a0b\u65b0\u624b\u5165\u95e8","text":"<p>By:  howardlau1999\u3001 darkyzhou</p> <p>\u8fd9\u4e2a\u6559\u7a0b\u5199\u7ed9\u5177\u6709\u4e00\u5b9a\u7684 C++ \u7a0b\u5e8f\u8bbe\u8ba1\u57fa\u7840\uff0c\u4f46\u5bf9\u670d\u52a1\u5668\u7f16\u7a0b\u8fd8\u4e0d\u592a\u4e86\u89e3\u7684\u8bfb\u8005\u3002</p> <p>\u672c\u6559\u7a0b\u4f1a\u5c3d\u91cf\u6db5\u76d6\u670d\u52a1\u5668\u7f16\u7a0b\u4e2d\u7684\u5e38\u7528\u77e5\u8bc6\uff0c\u4f46\u5e76\u4e0d\u4f1a\u6df1\u5165\u8bb2\u89e3\uff0c\u800c\u662f\u901a\u8fc7\u7b80\u5355\u7684\u4f8b\u5b50\u8ba9\u4f60\u53ef\u4ee5\u5feb\u901f\u8fd0\u884c\u8d77\u6765\u3002\u5982\u679c\u5e0c\u671b\u66f4\u6df1\u5165\u5730\u4e86\u89e3\u76f8\u5173\u77e5\u8bc6\uff0c\u672c\u6559\u7a0b\u4f1a\u63d0\u4f9b\u76f8\u5173\u53c2\u8003\u8d44\u6599\u4ee5\u4f9b\u5b66\u4e60\u3002\u901a\u8fc7\u8fd9\u4e2a\u6559\u7a0b\uff0c\u4f60\u5c06\u4f1a\u5b66\u4e60\u5230\uff1a</p> <ul> <li>\u7a0b\u5e8f\u7684\u7f16\u8bd1\u3001\u94fe\u63a5\u4e0e\u88c5\u8f7d\u57fa\u7840\u77e5\u8bc6</li> <li>\u5982\u4f55\u4f7f\u7528\u73b0\u4ee3\u7684\u6784\u5efa\u7cfb\u7edf\uff08Build System\uff09\u6765\u7ec4\u7ec7\u6784\u5efa\u4e00\u4e2a\u4e2d\u5c0f\u578b C++ \u9879\u76ee</li> <li>\u5982\u4f55\u5728 C++ \u9879\u76ee\u4e2d\u4f7f\u7528\u7b2c\u4e09\u65b9\u5e93</li> <li>\u5982\u4f55\u4f7f\u7528\u5e38\u89c1\u7684\u591a\u7ebf\u7a0b\u3001\u591a\u8fdb\u7a0b\u7f16\u7a0b\u8303\u5f0f</li> <li>\u5982\u4f55\u901a\u8fc7 RPC \u5e93\u5c06\u7a0b\u5e8f\u5305\u88c5\u4e3a\u670d\u52a1\u5668\u7a0b\u5e8f</li> <li>\u5982\u4f55\u4f7f\u7528\u6d4b\u8bd5\u5e93\u5bf9\u7a0b\u5e8f\u8fdb\u884c\u6d4b\u8bd5</li> <li>\u5982\u4f55\u4f7f\u7528\u65e5\u5fd7\u5e93\u8bb0\u5f55\u7a0b\u5e8f\u8fd0\u884c\u4e2d\u7684\u5173\u952e\u4fe1\u606f</li> <li>\u5982\u4f55\u4f7f\u7528\u6307\u6807\u7cfb\u7edf\u66b4\u9732\u7a0b\u5e8f\u8fd0\u884c\u7684\u5173\u952e\u6307\u6807</li> <li>\u5982\u4f55\u4f7f\u7528\u8c03\u8bd5\u5668\u8c03\u8bd5\uff08\u8fd0\u884c\u4e2d\u7684\uff09\u7a0b\u5e8f</li> <li>\u5982\u4f55\u5904\u7406\u7a0b\u5e8f\u5d29\u6e83\u4ee5\u53ca\u4f7f\u7528\u8c03\u8bd5\u5668\u6062\u590d\u73b0\u573a</li> <li>\u5982\u4f55\u90e8\u7f72\u4e00\u4e2a\u670d\u52a1\u5668\u7a0b\u5e8f</li> <li>\u5982\u4f55\u5feb\u901f\u5730\u4e0a\u624b\u4e00\u4e2a\u4ed6\u4eba\u7f16\u5199\u7684\u670d\u52a1\u5668\u7a0b\u5e8f</li> <li>\u5982\u4f55\u4e0e\u4ed6\u4eba\u8fdb\u884c\u5408\u4f5c</li> </ul> <p>\u5c3d\u7ba1\u672c\u6559\u7a0b\u4ee5 C++ \u4e3a\u4f8b\uff0c\u4f46\u4f1a\u5c3d\u91cf\u62bd\u8c61\u51fa\u670d\u52a1\u5668\u7f16\u7a0b\u7684\u5e38\u89c1\u8303\u5f0f\u4ee5\u53ca\u6982\u5ff5\uff0c\u5e2e\u52a9\u4f60\u5728\u4ee5\u540e\u8fdb\u884c\u5feb\u901f\u7684\u77e5\u8bc6\u8fc1\u79fb\u3002</p>"},{"location":"appendix/build-env/","title":"\u7f16\u8bd1\u73af\u5883\u51c6\u5907","text":"<p>\u5728\u4e0d\u540c\u7684\u64cd\u4f5c\u7cfb\u7edf\u4e0a\uff0c\u6700\u597d\u8fd8\u662f\u4f7f\u7528\u64cd\u4f5c\u7cfb\u7edf\u5382\u5546\u5f00\u53d1\u7684\u7f16\u8bd1\u5de5\u5177\u94fe\u3002\u4f8b\u5982\uff0c\u5c3d\u7ba1\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 <code>mingw</code> \u7b49\u5de5\u5177\u5728 Windows \u4e0a\u4f7f\u7528 <code>g++</code> \u547d\u4ee4\uff0c\u4f46\u4e3a\u4e86\u6700\u597d\u7684\u517c\u5bb9\u6027\uff0c\u8fd8\u662f\u9009\u62e9 <code>MSVC</code> \u7cfb\u5217\u6bd4\u8f83\u597d\u3002</p> <p>\u9274\u4e8e\u6bcf\u4e2a\u4eba\u559c\u6b22\u7684\u64cd\u4f5c\u7cfb\u7edf\u4e0d\u540c\uff0c\u4f7f\u7528 Windows \u7f16\u7a0b\u4e5f\u5e76\u6ca1\u6709\u4ec0\u4e48\u95ee\u9898\u3002\u5728\u7f16\u5199\u4e00\u4e9b\u64cd\u4f5c\u7cfb\u7edf\u65e0\u5173\u7684\u7a0b\u5e8f\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u5728\u81ea\u5df1\u66f4\u719f\u6089\u7684\u73af\u5883\u4e0b\u7f16\u7a0b\u3002</p>"},{"location":"appendix/build-env/#windows","title":"Windows","text":"<p>\u5728 Windows \u4e0a\uff0c\u6211\u4eec\u4e00\u822c\u4f1a\u5b89\u88c5\uff08\u5df2\u7ecf\u8fc7\u65f6\u7684\uff09DevC++\uff0c\u6216\u8005\u5927\u540d\u9f0e\u9f0e\u7684 Visual Studio \u8fd9\u4e9b IDE\u3002\u5b83\u4eec\u4e0d\u4ec5\u80fd\u63d0\u4f9b\u5f3a\u5927\u7684\u7f16\u7a0b\u73af\u5883\uff0c\u540c\u65f6\u4e5f\u4f1a\u5e2e\u6211\u4eec\u5b89\u88c5\u597d\u7f16\u8bd1\u5668\u3002\u4e0d\u8fc7\uff0c\u5176\u5b9e\u6211\u4eec\u4e5f\u53ef\u4ee5\u5728 Windows \u4e0a\u5355\u72ec\u5b89\u88c5\u7f16\u8bd1\u5668\uff0c\u7136\u540e\u4f7f\u7528 Visual Studio Code \u7b49\u7f16\u8f91\u5668\u6765\u7f16\u7a0b\u3002</p>"},{"location":"appendix/build-env/#\u5b89\u88c5-microsoft-build-tools","title":"\u5b89\u88c5 Microsoft Build Tools","text":"<p>\u5728 Windows \u4e0a\uff0c\u5e76\u4e0d\u4e00\u5b9a\u9700\u8981\u5b89\u88c5 Visual Studio \u624d\u80fd\u7f16\u8bd1\u7a0b\u5e8f\uff0c\u53ef\u4ee5\u5b89\u88c5 Microsoft Build Tools\uff0c\u91cc\u9762\u5c31\u5305\u542b\u4e86 MSVC \u7f16\u8bd1\u5668\u3002</p> <p>\u70b9\u51fb\u4e0a\u9762\u7684\u94fe\u63a5\u4e0b\u8f7d\u5b89\u88c5\u5668\u4e4b\u540e\uff0c\u6253\u5f00\u5b89\u88c5\u5668\uff0c\u5c31\u53ef\u4ee5\u770b\u5230\u5b89\u88c5\u754c\u9762\uff1a</p> <p></p> <p>\u6309\u7167\u9ed8\u8ba4\u7684\u9009\u9879\u5b89\u88c5\u684c\u9762 C++ \u5f00\u53d1\u5de5\u5177\u5373\u53ef\u3002</p>"},{"location":"appendix/build-env/#\u914d\u7f6e-vscode","title":"\u914d\u7f6e VSCode","text":"<p>\u5b89\u88c5\u5b8c Build Tools \u4e4b\u540e\uff0c\u5c31\u53ef\u4ee5\u6309\u7167\u5b98\u65b9\u6559\u7a0b\u6765\u914d\u7f6e VSCode \u4f7f\u7528 MSVC \u7f16\u8bd1\u5668\u4e86\u3002</p>"},{"location":"appendix/build-env/#linux","title":"Linux","text":""},{"location":"appendix/build-env/#wsl","title":"WSL","text":"<p>WSL (Windows Subsystem for Linux) \u662f\u4e00\u4e2a\u5728 Windows \u4e0a\u80fd\u591f\u8fd0\u884c\u539f\u751f Linux \u4e8c\u8fdb\u5236\u53ef\u6267\u884c\u6587\u4ef6\uff08ELF \u683c\u5f0f\uff09\u7684\u517c\u5bb9\u5c42\u3002\u5b83\u662f\u7531\u5fae\u8f6f\u4e0e Canonical \u516c\u53f8\u5408\u4f5c\u5f00\u53d1\uff0c\u5176\u76ee\u6807\u662f\u4f7f\u7eaf\u6b63\u7684 Ubuntu\u3001Debian \u7b49\u6620\u50cf\u80fd\u4e0b\u8f7d\u548c\u89e3\u538b\u5230\u7528\u6237\u7684\u672c\u5730\u8ba1\u7b97\u673a\uff0c\u5e76\u4e14\u6620\u50cf\u5185\u7684\u5de5\u5177\u548c\u5b9e\u7528\u5de5\u5177\u80fd\u5728\u6b64\u5b50\u7cfb\u7edf\u4e0a\u539f\u751f\u8fd0\u884c\u3002</p> <p>\u53ef\u4ee5\u5728 powershell \u4e2d\u4f9d\u6b21\u8fd0\u884c\u4e0b\u8ff0\u6307\u4ee4\uff0c\u5b89\u88c5 WSL1 \u7248\u672c\u7684 Debian\u3002</p> <pre><code>wsl --set-default-version 1\nwsl --install --distribution Debian\n</code></pre> <p>\u5173\u4e8e WSL \u7684\u4f7f\u7528\uff0c\u6700\u4f73\u7684\u6559\u6750\u5373\u4e3a\u5b98\u65b9\u6587\u6863\uff0c\u53e6\u5916\u5f88\u63a8\u8350\u914d\u5408 VSCode \u7684 Remote-WSL \u63d2\u4ef6\u3002\u5047\u8bbe\u4f60\u5df2\u7ecf\u770b\u8fc7\u5b98\u65b9\u6587\u6863\uff0c\u4ee5\u4e0b\u5185\u5bb9\u7ed9\u51fa\u4e00\u4e9b\u65e5\u5e38\u4f7f\u7528\u7ecf\u9a8c\u3002</p> <p>WSL \u7684\u5927\u90e8\u5206\u529f\u80fd\u90fd\u53ef\u4ee5\u88ab\u5b8c\u6574 Linux \u6216\u88c5\u5728\u865a\u62df\u673a\u4e2d\u7684 Linux \u4ee3\u66ff\uff0c\u53cd\u4e4b\u4e5f\u4e00\u6837\u3002\u56e0\u6b64\u4e0a\u8ff0 Linux \u7684\u4f7f\u7528\u6280\u5de7\u5747\u53ef\u4f7f\u7528\u5728 WSL \u4e2d\u3002</p> <p>WSL \u8fd8\u5b58\u5728\u4e00\u4e9b\u5c40\u9650\u6027\uff0c\u4f8b\u5982 WSL1 \u4e0d\u652f\u6301 GPU \u548c\u5f88\u591a\u7cfb\u7edf\u8c03\u7528\uff0cWSL2 \u8bbf\u95ee Windows \u6587\u4ef6\u6027\u80fd\u5dee\uff0c\u4e24\u8005\uff08\u76ee\u524d\u4e3a\u6b62\uff09\u5747\u4e0d\u80fd\u8bbf\u95ee USB \u8bbe\u5907\u7b49\u3002\u90a3\u9664\u4e86\u65e5\u5e38\u4f7f\u7528\u66f4\u65b9\u4fbf\u4e4b\u5916\uff0cWSL \u8fd8\u6709\u5176\u5b83\u7684\u5fc5\u8981\u6027\u5417\uff1f\u7b54\u6848\u81ea\u7136\u662f\u6709\u3002\u5f53\u4f60\u7684\u9879\u76ee\u540c\u65f6\u6d89\u53ca\u5230 Windows \u548c Linux \u73af\u5883\u4e0b\u7684\u6df7\u5408\u7f16\u8bd1\u65f6\uff0cWSL \u4e00\u5b9a\u662f\u4f60\u7684\u6700\u4f73\u9009\u62e9\uff08\u8003\u8651\u5230 WSL2 \u8bbf\u95ee Windows \u6587\u4ef6\u6027\u80fd\u6781\u5dee\uff0c\u56e0\u6b64\u867d\u7136\u73b0\u5728\u5fae\u8f6f\u4e3b\u63a8 WSL2\uff0c\u4f46\u6211\u4ecd\u7136\u5efa\u8bae\u4f7f\u7528 WSL1\uff09\uff1b\u53c8\u4f8b\u5982\uff0c\u4f60\u53ef\u80fd\u4f1a\u7ecf\u5e38\u641e\u574f Linux \u73af\u5883\uff0c\u6bcf\u6b21\u91cd\u88c5\u7cfb\u7edf\uff08\u65e0\u8bba\u7269\u7406\u673a\u8fd8\u662f\u865a\u62df\u673a\uff09\u90fd\u4f1a\u6781\u5927\u7684\u6d88\u8017\u4f60\u7684\u7cbe\u529b\uff0c\u800c WSL \u4e0d\u8fc7\u662f\u70b9\u4e00\u4e0b\u5378\u8f7d\u518d\u91cd\u65b0\u70b9\u4e00\u4e0b\u5b89\u88c5\u7684\u4e8b\uff0c\u524d\u540e\u51e0\u4e4e\u53ea\u6709\u51e0\u5206\u949f\uff0c\u5e76\u4e14\u8fd8\u63d0\u4f9b\u4e86\u6253\u5305\u5907\u4efd\u7684\u529f\u80fd\uff08<code>wsl --export</code>\u548c <code>wsl --import</code>\uff09\u3002</p>"},{"location":"appendix/build-env/#wsl-\u8bbf\u95ee-windows","title":"WSL \u8bbf\u95ee Windows","text":"<p>WSL \u5185\u53ef\u4ee5\u901a\u8fc7 <code>powershell.exe</code> \u8c03\u7528 Windows \u4e0b\u7684\u7ec8\u7aef\u3002</p> <pre><code>$ powershell.exe ls -File\n\n\n    \u76ee\u5f55: D:\\server-programming-guide\n\n\nMode                 LastWriteTime         Length Name\n----                 -------------         ------ ----\n-a----        2021/12/21      5:41          20138 LICENSE\n-a----        2021/12/21      5:41           6505 mkdocs.yml\n-a----        2021/12/21      5:41           1410 README.md\n-a----        2021/12/21      5:41            156 requirements.txt\n</code></pre> <p>\u7531\u4e8e\u5f53\u524d WSL1 \u548c WSL2 \u90fd\u4e0d\u652f\u6301\u5f88\u591a\u64cd\u4f5c\uff08\u4f8b\u5982\u8bbf\u95ee USB \u8bbe\u5907\uff09\u3002\u90a3\u4e48\u4e5f\u53ef\u4ee5\u501f\u52a9 <code>powershell.exe</code> \u53bb\u95f4\u63a5\u8bbf\u95ee\u6302\u8f7d\u5728 Windows \u73af\u5883\u4e2d\u7684\u8f6f\u4ef6\u73af\u5883\u548c\u786c\u4ef6\u5916\u8bbe\u3002</p>"},{"location":"appendix/build-env/#windows-\u8bbf\u95ee-wsl","title":"Windows \u8bbf\u95ee WSL","text":"<p>\u540c\u7406\uff0cWindows \u4e0b\u4e5f\u53ef\u4ee5\u901a\u8fc7 wsl \u8c03\u7528 Linux \u4e0b\u7684\u5de5\u5177\u94fe\u3002</p> <pre><code>PS D:\\server-programming-guide&gt; wsl ls -l\ntotal 32\ndrwxrwxrwx 1 wuk wuk  4096 Dec 21 05:41 docs\n-rwxrwxrwx 1 wuk wuk 20138 Dec 21 05:41 LICENSE\n-rwxrwxrwx 1 wuk wuk  6505 Dec 21 05:41 mkdocs.yml\n-rwxrwxrwx 1 wuk wuk  1410 Dec 21 05:41 README.md\n-rwxrwxrwx 1 wuk wuk   156 Dec 21 05:41 requirements.txt\n</code></pre> <p>\u4f8b\u5982\uff0c\u4f60\u7684 Windows \u6ca1\u6709\u914d\u7f6e <code>git</code>\uff0c\u53c8\u9700\u8981\u4e34\u65f6\u4e0b\u8f7d\u4e00\u4e2a\u9879\u76ee\uff0c\u4f60\u53ef\u4ee5\u50cf\u8fd9\u6837\u4f7f\u7528 WSL \u4e2d\u7684 git \u4e0b\u8f7d\u6587\u4ef6\uff0c\u65e0\u9700\u5355\u72ec\u5f00\u4e00\u4e2a WSL \u7ec8\u7aef\u3002</p> <pre><code>wsl git clone https://github.com/howardlau1999/server-programming-guide.git\n</code></pre> <p>\u4ece\u8fd9\u79cd\u610f\u4e49\u4e0a\u6765\u8bf4\uff0c\u4f60\u53ef\u4ee5\u628a wsl \u5f53\u505a windows \u4e0b\u7684\u4e00\u4e2a\u8d85\u7ea7\u5305\u7ba1\u7406\u5668\uff0c\u53ef\u4ee5\u901a\u8fc7 wsl \u5b89\u88c5\u4f7f\u7528 linux \u4e0b\u7684\u5de5\u5177\u94fe\u3002\u5f53\u7136\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5982\u679c\u9879\u76ee\u4e2d\u6ca1\u6709\u7279\u522b\u7ea6\u675f\uff0c\u90a3\u4e48\u8fd9\u6837\u505a\u7684\u4e00\u5207\u8bbe\u7f6e\uff08\u4f8b\u5982\u884c\u672b\u56de\u8f66\u662f<code>CRLF</code>\u8fd8\u662f<code>LF</code>\uff09\u90fd\u662f\u6309\u7167 Linux \u4e2d\u7684\u8bbe\u7f6e\u6765\u7684\uff0c\u56e0\u6b64\u5982\u679c\u5728 Windows \u4e2d\u76f4\u63a5\u6253\u5f00\u7684\u8bdd\u53ef\u80fd\u4f1a\u51fa\u73b0\u4e71\u7801\u7684\u60c5\u51b5\uff0c\u6b64\u65f6\u6362\u4e00\u4e2a\u53ef\u4ee5\u6b63\u786e\u5904\u7406\u7684\u7f16\u8f91\u5668\uff08\u5982 vscode\uff09\u53ef\u89e3\u51b3\u3002</p>"},{"location":"appendix/build-env/#macos","title":"macOS","text":""},{"location":"basics/","title":"\u6982\u89c8","text":"<p>\u672c\u7ae0\u8282\u5c06\u5e26\u4f60\u5feb\u901f\u4e86\u89e3\u7a0b\u5e8f\u5982\u4f55\u7f16\u8bd1\u3001\u94fe\u63a5\u5e76\u6700\u7ec8\u88c5\u8f7d\u5230\u5185\u5b58\u4e2d\u8fd0\u884c\u7684\u3002\u8fd9\u662f\u8fdb\u5165\u591a\u6587\u4ef6 C++ \u9879\u76ee\u9886\u57df\u7684\u57fa\u7840\u5165\u95e8\u77e5\u8bc6\u3002</p>"},{"location":"basics/cross-compilation/","title":"\u4ea4\u53c9\u7f16\u8bd1","text":"<p>\u6709\u65f6\u5019\uff0c\u6211\u4eec\u5728\u5f00\u53d1\u4e2d\u4f1a\u9047\u5230\u8fd9\u4e9b\u60c5\u51b5\uff1a</p> <ul> <li>\u624b\u5934\u6682\u65f6\u53ea\u6709 Windows \u673a\u5668\u53ef\u4ee5\u7528\uff0c\u4f46\u662f\u5e0c\u671b\u7f16\u8bd1\u51fa\u6765\u7684\u7a0b\u5e8f\u80fd\u5728 Linux \u4e0a\u8fd0\u884c</li> <li>\u624b\u5934\u6682\u65f6\u53ea\u6709 AMD64 \u6307\u4ee4\u96c6\u7684\u673a\u5668\uff0c\u4f46\u662f\u5e0c\u671b\u7f16\u8bd1\u51fa\u6765\u7684\u7a0b\u5e8f\u80fd\u5728 ARM \u6307\u4ee4\u96c6\u673a\u5668\u4e0a\u8fd0\u884c</li> <li>\u6216\u8005\u4e0a\u9762\u4e24\u79cd\u60c5\u51b5\u540c\u65f6\u53d1\u751f\u4e86</li> <li>\u6216\u8005\u6211\u4eec\u6709\u5bf9\u5e94\u7684\u673a\u5668\uff0c\u4f46\u662f\u7531\u4e8e\u79cd\u79cd\u539f\u56e0\u65e0\u6cd5\u5728\u4e0a\u9762\u7f16\u8bd1\uff0c\u6bd4\u5982\u6211\u4eec\u6709\u4e00\u5757\u5355\u7247\u673a</li> </ul> <p>\u8fd9\u65f6\u5019\u6211\u4eec\u5c31\u9700\u8981\u8fdb\u884c\u4ea4\u53c9\u7f16\u8bd1\uff08Cross Compilation\uff09\u4e86\u3002\u4ea4\u53c9\u7f16\u8bd1\u7684\u539f\u7406\u5f88\u7b80\u5355\uff0c\u6307\u4ee4\u96c6\u4e0d\u4e00\u6837\uff1f\u90a3\u5c31\u8ba9\u7f16\u8bd1\u5668\u8f93\u51fa\u5bf9\u5e94\u6307\u4ee4\u96c6\u7684\u6c47\u7f16\uff0c\u7136\u540e\u7528\u5bf9\u5e94\u6307\u4ee4\u96c6\u7684\u6c47\u7f16\u5668\u6c47\u7f16\u5c31\u597d\u4e86\u3002\u64cd\u4f5c\u7cfb\u7edf\u4e0d\u4e00\u6837\uff1f\u90a3\u5c31\u8ba9\u6c47\u7f16\u5668\u4ee5\u53ca\u94fe\u63a5\u5668\u8f93\u51fa\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u7b26\u5408\u64cd\u4f5c\u7cfb\u7edf\u7684\u8981\u6c42\u5c31\u597d\u4e86\u3002</p>"},{"location":"basics/hooks/","title":"\u51fd\u6570\u94a9\u5b50","text":"<p>\u5982\u679c\u6211\u4eec\u7684\u7a0b\u5e8f\u4f7f\u7528\u4e86\u52a8\u6001\u5e93\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u51fd\u6570\u94a9\u5b50\u7684\u65b9\u5f0f\u5b9e\u73b0\u5728\u8fd0\u884c\u65f6\u66ff\u6362\u6389\u5b9e\u9645\u6267\u884c\u51fd\u6570\u7684\u529f\u80fd\u3002</p>"},{"location":"basics/hooks/#ld_preload","title":"<code>LD_PRELOAD</code>","text":"<p>\u901a\u8fc7\u6307\u5b9a <code>LD_PRELOAD</code> \u53d8\u91cf\uff0c\u53ef\u4ee5\u9884\u5148\u5c06\u6211\u4eec\u81ea\u5df1\u7684\u52a8\u6001\u5e93\u7b26\u53f7\u52a0\u8f7d\u5230\u52a0\u8f7d\u5668\u4e2d\uff0c\u8fd9\u6837\uff0c\u5728\u7a0b\u5e8f\u8fd0\u884c\u9700\u8981\u8c03\u7528\u52a8\u6001\u5e93\u4e2d\u7684\u540c\u540d\u51fd\u6570\u65f6\uff0c\u5c31\u4f1a\u4f18\u5148\u641c\u7d22\u6211\u4eec\u63d0\u4f9b\u7684\u52a8\u6001\u5e93\uff0c\u4ece\u800c\u8c03\u7528\u7684\u662f\u6211\u4eec\u81ea\u5df1\u7684\u7f16\u5199\u7684\u51fd\u6570\u3002</p> <p>\u4f8b\u5982\uff0c\u5047\u5982\u6211\u4eec\u81ea\u5df1\u5b9e\u73b0\u4e86\u4e00\u4e2a <code>malloc</code>\uff0c\u5e76\u7f16\u8bd1\u5230\u4e86 <code>libmymalloc.so</code> \u4e2d\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u901a\u8fc7\u6307\u5b9a <code>LD_PRELOAD=./libmymalloc.so</code>\uff0c\u5728\u4e0d\u91cd\u65b0\u7f16\u8bd1\u539f\u6765\u7684\u5e94\u7528\u7a0b\u5e8f\u7684\u60c5\u51b5\u4e0b\uff0c\u8ba9\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528\u6211\u4eec\u81ea\u5df1\u7f16\u5199\u7684 <code>malloc</code>\u3002</p>"},{"location":"basics/loading/","title":"\u7a0b\u5e8f\u7684\u52a0\u8f7d","text":"<p>\u7ecf\u8fc7\u524d\u9762\u7ae0\u8282\u7684\u4ecb\u7ecd\uff0c\u76f8\u4fe1\u4f60\u5df2\u7ecf\u5bf9\u7a0b\u5e8f\u7684\u751f\u6210\u6709\u4e86\u66f4\u6df1\u5165\u7684\u4e86\u89e3\u3002\u672c\u8282\u5c06\u4ecb\u7ecd\u7a0b\u5e8f\u662f\u5982\u4f55\u88ab\u64cd\u4f5c\u7cfb\u7edf\u52a0\u8f7d\u8fd0\u884c\uff0c\u64cd\u4f5c\u7cfb\u7edf\u53c8\u662f\u600e\u4e48\u5728\u8fd0\u884c\u65f6\u89e3\u51b3\u52a8\u6001\u5e93\u51fd\u6570\u7684\u8c03\u7528\u95ee\u9898\u7684\u3002</p>"},{"location":"basics/loading/#\u7a0b\u5e8f\u7684\u52a0\u8f7d\u8fc7\u7a0b","title":"\u7a0b\u5e8f\u7684\u52a0\u8f7d\u8fc7\u7a0b","text":"<p>\u5728\u4e0d\u540c\u7684\u64cd\u4f5c\u7cfb\u7edf\u4e0a\uff0c\u7a0b\u5e8f\u7684\u52a0\u8f7d\u8fc7\u7a0b\u90fd\u662f\u7c7b\u4f3c\u7684\uff0c\u64cd\u4f5c\u7cfb\u7edf\u8bfe\u4e5f\u4f1a\u6559\uff1a</p> <ol> <li>\u8c03\u7528\u521b\u5efa\u8fdb\u7a0b\u7684\u7cfb\u7edf\u51fd\u6570</li> <li>\u7cfb\u7edf\u9a8c\u8bc1\u53c2\u6570\uff0c\u6253\u5f00\u6307\u5b9a\u7684\u7a0b\u5e8f\u6587\u4ef6</li> <li>\u89e3\u6790\u7a0b\u5e8f\u4e8c\u8fdb\u5236\u683c\u5f0f</li> <li>\u6839\u636e\u7a0b\u5e8f\u63d0\u4f9b\u7684\u4fe1\u606f\uff0c\u8fdb\u884c\u5fc5\u8981\u7684\u521d\u59cb\u5316</li> <li>\u5728\u5185\u6838\u4e2d\u521b\u5efa\u4e00\u4e2a\u4fdd\u5b58\u4e86\u8fdb\u7a0b\u4fe1\u606f\u7684\u7ed3\u6784\u4f53</li> <li>\u521b\u5efa\u7a0b\u5e8f\u8fd0\u884c\u9700\u8981\u7684\u865a\u62df\u5185\u5b58\u6620\u5c04\u3001\u8fd0\u884c\u6808\u7b49</li> <li>\u8df3\u8f6c\u5230\u7a0b\u5e8f\u6587\u4ef6\u6307\u5b9a\u7684\u5165\u53e3\uff0c\u5f00\u59cb\u8fd0\u884c\u7a0b\u5e8f</li> </ol> <p>\u5176\u4e2d\u7b2c\u56db\u6b65\u6bd4\u8f83\u590d\u6742\uff0c\u4e0d\u540c\u64cd\u4f5c\u7cfb\u7edf\u4e5f\u4f1a\u5bf9\u4e0d\u540c\u7684\u7a0b\u5e8f\u505a\u4e0d\u540c\u64cd\u4f5c\u3002\u4f8b\u5982\uff0c\u5047\u5982\u4e00\u4e2a\u7a0b\u5e8f\u662f\u52a8\u6001\u94fe\u63a5\u7684\uff0c\u90a3\u4e48\u64cd\u4f5c\u7cfb\u7edf\u5c31\u9700\u8981\u8d1f\u8d23\u89e3\u51b3\u52a8\u6001\u94fe\u63a5\u7684\u95ee\u9898\u3002\u53c8\u4f8b\u5982\uff0c\u5047\u5982\u6211\u4eec\u662f\u5728 Windows \u4e0a\u8fd0\u884c\u7a0b\u5e8f\uff0c\u6839\u636e CUI \u548c GUI \u7684\u4e0d\u540c\uff0cWindows \u4e5f\u4f1a\u505a\u4e0d\u540c\u7684\u5904\u7406\u3002</p>"},{"location":"basics/loading/#linux-\u4e0a\u7684\u52a0\u8f7d\u8fc7\u7a0b","title":"Linux \u4e0a\u7684\u52a0\u8f7d\u8fc7\u7a0b","text":"<p>\u7b80\u5355\u6765\u8bf4\uff0c\u5728 Linux \u4e0a\uff0c\u5c06\u4e00\u4e2a\u7a0b\u5e8f\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u8fd0\u884c\u8d77\u6765\u7684\u7cfb\u7edf\u8c03\u7528\u4fbf\u662f <code>execve</code>\u3002\u8fd9\u4e2a\u7cfb\u7edf\u8c03\u7528\u4f1a\u8bfb\u53d6\u6211\u4eec\u7684\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u5c06\u4ee3\u7801\u548c\u6570\u636e\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\uff0c\u7136\u540e\u4ece\u6587\u4ef6\u91cc\u6307\u5b9a\u7684\u5165\u53e3\u5730\u5740\u5f00\u59cb\u8fd0\u884c\u6211\u4eec\u7684\u7a0b\u5e8f\u3002\u5982\u679c\u662f\u6211\u4eec\u7684\u7a0b\u5e8f\u5168\u90fd\u662f\u9759\u6001\u94fe\u63a5\u7684\uff0c\u90a3\u4e48\u6574\u4e2a\u8fc7\u7a0b\u5c31\u662f\u8fd9\u4e48\u7b80\u5355\u3002\u4e0d\u8fc7\uff0c\u5982\u679c\u6211\u4eec\u7684\u7a0b\u5e8f\u9700\u8981\u7528\u5230\u52a8\u6001\u5e93\uff0c\u4e8b\u60c5\u5c31\u6ca1\u6709\u8fd9\u4e48\u7b80\u5355\u4e86\u3002\u5f53 Linux \u68c0\u6d4b\u5230\u6211\u4eec\u7684\u7a0b\u5e8f\u9700\u8981\u7528\u5230\u52a8\u6001\u5e93\u7684\u65f6\u5019\uff0c\u4f1a\u8c03\u7528 <code>ld.so</code> \u8fd9\u4e2a\u52a0\u8f7d\u5668\u6765\u52a0\u8f7d\u6211\u4eec\u7684\u7a0b\u5e8f\u3002</p> <p>\u5728 x86-64 \u4e0a\uff0c<code>ld.so</code> \u4f4d\u4e8e <code>/lib64/ld-linux-x86-64.so.2</code>\u3002\u5c3d\u7ba1 <code>ld.so</code> \u4ee5 <code>.so</code> \u4f5c\u4e3a\u540e\u7f00\u540d\uff0c\u5b83\u672c\u8eab\u662f\u4e00\u4e2a\u7eaf\u9759\u6001\u94fe\u63a5\u7684\u53ef\u6267\u884c\u4e8c\u8fdb\u5236\u6587\u4ef6\uff08\u4e0d\u7136\u7684\u8bdd\uff0c\u8c01\u6765\u5904\u7406\u5b83\u7684\u52a8\u6001\u5e93\u5462\uff09\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u662f\u53ef\u4ee5\u76f4\u63a5\u6267\u884c\u8fd9\u4e2a\u6587\u4ef6\u7684\u3002</p> <pre><code>$ ldd /lib64/ld-linux-x86-64.so.2\n        statically linked\n$ /lib64/ld-linux-x86-64.so.2\nUsage: ld.so [OPTION]... EXECUTABLE-FILE [ARGS-FOR-PROGRAM...]\nYou have invoked `ld.so', the helper program for shared library executables.\nThis program usually lives in the file `/lib/ld.so', and special directives\nin executable files using ELF shared libraries tell the system's program\nloader to load the helper program from this file.  This helper program loads\nthe shared libraries needed by the program executable, prepares the program\nto run, and runs it.  You may invoke this helper program directly from the\ncommand line to load and run an ELF executable file; this is like executing\nthat file itself, but always uses this helper program from the file you\nspecified, instead of the helper program file specified in the executable\nfile you run.  This is mostly of use for maintainers to test new versions\nof this helper program; chances are you did not intend to run this program.\n\n  --list                list all dependencies and how they are resolved\n  --verify              verify that given object really is a dynamically linked\n                        object we can handle\n  --inhibit-cache       Do not use /etc/ld.so.cache\n  --library-path PATH   use given PATH instead of content of the environment\n                        variable LD_LIBRARY_PATH\n  --inhibit-rpath LIST  ignore RUNPATH and RPATH information in object names\n                        in LIST\n  --audit LIST          use objects named in LIST as auditors\n  --preload LIST        preload objects named in LIST\n</code></pre> <p>\u5f53\u6211\u4eec\u8c03\u7528\u4f7f\u7528\u4e86\u52a8\u6001\u5e93\u7684\u7a0b\u5e8f\uff0c\u64cd\u4f5c\u7cfb\u7edf\u9996\u5148\u4f1a\u52a0\u8f7d <code>ld.so</code> \u5230\u5185\u5b58\u4e2d\uff0c\u7136\u540e\uff0c\u8ba9 <code>ld.so</code> \u6765\u5904\u7406\u52a0\u8f7d\u52a8\u6001\u5e93\u4ee5\u53ca\u5c06\u52a8\u6001\u5e93\u6620\u5c04\u5230\u8fdb\u7a0b\u5185\u5b58\u7a7a\u95f4\u7684\u7ec6\u8282\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5f53\u6211\u4eec\u6267\u884c <code>a.out</code> \u7684\u65f6\u5019\uff0c\u5176\u5b9e\u76f8\u5f53\u4e8e\u6267\u884c\u4e86\u4e0b\u9762\u7684\u4e00\u6761\u547d\u4ee4\uff1a</p> <pre><code>$ /lib64/ld-linux-x86-64.so.2 ./a.out\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 <code>LD_DEBUG</code> \u8fd9\u4e2a\u73af\u5883\u53d8\u91cf\u6765\u8ba9 <code>ld.so</code> \u8f93\u51fa\u80cc\u540e\u53d1\u751f\u7684\u64cd\u4f5c\u3002</p> <pre><code>$ LD_DEBUG=libs LD_LIBRARY_PATH=$(pwd) ./a.out\n   1237739:     find library=libmylib.so [0]; searching\n   1237739:      search path=/home/howard/a/tls/haswell/x86_64:/home/howard/a/tls/haswell:/home/howard/a/tls/x86_64:/home/howard/a/tls:/home/howard/a/haswell/x86_64:/home/howard/a/haswell:/home/howard/a/x86_64:/home/howard/a             (LD_LIBRARY_PATH)\n   1237739:       trying file=/home/howard/a/tls/haswell/x86_64/libmylib.so\n   1237739:       trying file=/home/howard/a/tls/haswell/libmylib.so\n   1237739:       trying file=/home/howard/a/tls/x86_64/libmylib.so\n   1237739:       trying file=/home/howard/a/tls/libmylib.so\n   1237739:       trying file=/home/howard/a/haswell/x86_64/libmylib.so\n   1237739:       trying file=/home/howard/a/haswell/libmylib.so\n   1237739:       trying file=/home/howard/a/x86_64/libmylib.so\n   1237739:       trying file=/home/howard/a/libmylib.so\n   1237739:\n   1237739:     find library=libstdc++.so.6 [0]; searching\n   1237739:      search path=/home/howard/a             (LD_LIBRARY_PATH)\n   1237739:       trying file=/home/howard/a/libstdc++.so.6\n   1237739:      search cache=/etc/ld.so.cache\n   1237739:       trying file=/lib/x86_64-linux-gnu/libstdc++.so.6\n   1237739:\n   1237739:     find library=libc.so.6 [0]; searching\n   1237739:      search path=/home/howard/a             (LD_LIBRARY_PATH)\n   1237739:       trying file=/home/howard/a/libc.so.6\n   1237739:      search cache=/etc/ld.so.cache\n   1237739:       trying file=/lib/x86_64-linux-gnu/libc.so.6\n   1237739:\n   1237739:     find library=libm.so.6 [0]; searching\n   1237739:      search path=/home/howard/a             (LD_LIBRARY_PATH)\n   1237739:       trying file=/home/howard/a/libm.so.6\n   1237739:      search cache=/etc/ld.so.cache\n   1237739:       trying file=/lib/x86_64-linux-gnu/libm.so.6\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230 <code>ld.so</code> \u5982\u4f55\u67e5\u627e\u9700\u8981\u7684\u5e93\u7684\u3002</p> <pre><code>$ LD_DEBUG=all LD_LIBRARY_PATH=$(pwd) ./a.out\n# ... \u7701\u7565\u4e00\u5806\u8f93\u51fa\n   1237888: binding file /lib/x86_64-linux-gnu/libstdc++.so.6 [0] to /lib/x86_64-linux-gnu/libc.so.6 [0]: normal symbol `fwrite' [GLIBC_2.2.5]\n   1237888: symbol=_ZNSo9_M_insertIlEERSoT_;  lookup in file=./a.out [0]\n   1237888: symbol=_ZNSo9_M_insertIlEERSoT_;  lookup in file=/home/howard/a/libmylib.so [0]\n   1237888: symbol=_ZNSo9_M_insertIlEERSoT_;  lookup in file=/lib/x86_64-linux-gnu/libstdc++.so.6 [0]\n   1237888: binding file /lib/x86_64-linux-gnu/libstdc++.so.6 [0] to /lib/x86_64-linux-gnu/libstdc++.so.6 [0]: normal symbol `_ZNSo9_M_insertIlEERSoT_' [GLIBCXX_3.4.9]\n   1237888: symbol=_ZNKSt5ctypeIcE13_M_widen_initEv;  lookup in file=./a.out [0]\n   1237888: symbol=_ZNKSt5ctypeIcE13_M_widen_initEv;  lookup in file=/home/howard/a/libmylib.so [0]\n   1237888: symbol=_ZNKSt5ctypeIcE13_M_widen_initEv;  lookup in file=/lib/x86_64-linux-gnu/libstdc++.so.6 [0]\n   1237888: binding file /lib/x86_64-linux-gnu/libstdc++.so.6 [0] to /lib/x86_64-linux-gnu/libstdc++.so.6 [0]: normal symbol `_ZNKSt5ctypeIcE13_M_widen_initEv' [GLIBCXX_3.4.11]\n   1237888: symbol=memcmp;  lookup in file=./a.out [0]\n   1237888: symbol=memcmp;  lookup in file=/home/howard/a/libmylib.so [0]\n   1237888: symbol=memcmp;  lookup in file=/lib/x86_64-linux-gnu/libstdc++.so.6 [0]\n   1237888: symbol=memcmp;  lookup in file=/lib/x86_64-linux-gnu/libc.so.6 [0]\n   1237888: binding file /lib/x86_64-linux-gnu/libstdc++.so.6 [0] to /lib/x86_64-linux-gnu/libc.so.6 [0]: normal symbol `memcmp' [GLIBC_2.2.5]\n# ... \u7701\u7565\u4e00\u5806\u8f93\u51fa\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230 <code>ld.so</code> \u5982\u4f55\u5728\u5e93\u4e2d\u67e5\u627e\u9700\u8981\u7684\u51fd\u6570\u3002</p>"},{"location":"basics/loading/#windows-\u4e0a\u7684\u52a0\u8f7d\u8fc7\u7a0b","title":"Windows \u4e0a\u7684\u52a0\u8f7d\u8fc7\u7a0b","text":"<p>\u5728 Windows \u4e0a\uff0c\u4e00\u6837\u662f\u6709\u7c7b\u4f3c\u7684\u7a0b\u5e8f\u52a0\u8f7d\u5668\u4ee5\u53ca\u67e5\u627e\u52a8\u6001\u5e93\u7684\u8fc7\u7a0b\uff0cWindows \u4e0a\u53eb\u505a Image Loader\u3002\u4e0d\u8fc7\uff0c\u5b83\u5e76\u4e0d\u662f\u4e00\u4e2a\u5355\u72ec\u7684\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u800c\u662f\u5185\u7f6e\u5728\u4e86 <code>ntdll.dll</code> \u4e2d\uff0c\u4e3b\u8981\u7684\u5165\u53e3\u51fd\u6570\u662f <code>LdrpInitializeProcess</code>\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 Windows SDK \u4e2d\u7684 Global Flags \u548c WinDbg \u5de5\u5177\u6765\u89c2\u5bdf\u7a0b\u5e8f\u5728 Windows \u4e0a\u662f\u5982\u4f55\u8fd0\u884c\u8d77\u6765\u7684\u3002</p> <p>\u9996\u5148\u5b89\u88c5 Debugging Tools for Windows\uff0c\u5efa\u8bae\u901a\u8fc7 Windows SDK \u5b89\u88c5\u5668\u65b9\u5f0f\u5b89\u88c5\u3002\u7136\u540e\u5728\u5f00\u59cb\u83dc\u5355\u641c\u7d22 Global Flags (X64) \u8fd0\u884c\uff0c\u5207\u6362\u5230 Image Flags \u9009\u9879\u5361\uff0c\u5728 Image \u8f93\u5165 <code>notepad.exe</code>\uff0c\u7136\u540e\u6309\u4e0b Tab \u952e\uff0c\u52fe\u9009 <code>Show loader snaps</code> \u9009\u9879\uff0c\u70b9\u51fb\u5e94\u7528\uff0c\u5373\u53ef\u5f00\u542f\u9488\u5bf9\u7279\u5b9a\u7a0b\u5e8f\u7684\u52a0\u8f7d\u5668\u8ffd\u8e2a\u529f\u80fd\u3002</p> <p></p> <p>\u63a5\u4e0b\u6765\u5728\u5f00\u59cb\u83dc\u5355\u641c\u7d22 WinDbg (X64) \u8fd0\u884c\uff0c\u6309\u4e0b Ctrl+E\uff0c\u6253\u5f00 <code>C:\\Windows\\System32\\notepad.exe</code>\uff0c\u6b64\u65f6\u5e94\u8be5\u53ef\u4ee5\u770b\u5230\u8c03\u8bd5\u5668\u5728\u8f93\u51fa\u4e00\u4e9b\u4fe1\u606f\u4e4b\u540e\u505c\u6b62\u8fd0\u884c\u3002</p> <p></p> <p>\u622a\u56fe\u4e2d\u53ef\u4ee5\u770b\u5230\u52a0\u8f7d\u5668\u6839\u636e\u53ef\u6267\u884c\u6587\u4ef6\u4e2d\u7684\u4fe1\u606f\u5bfb\u627e DLL \u52a8\u6001\u5e93\u7684\u8fc7\u7a0b\u3002\u7ee7\u7eed\u5f80\u4e0b\u770b\uff0c\u53ef\u4ee5\u770b\u5230\u52a0\u8f7d\u5668\u52a0\u8f7d\u9700\u8981\u7684\u7b26\u53f7\u7684\u8fc7\u7a0b\uff1a</p> <p></p> <p>\u6b64\u65f6\u8bb0\u4e8b\u672c\u754c\u9762\u8fd8\u6ca1\u6709\u663e\u793a\u51fa\u6765\uff0c\u56e0\u4e3a\u8c03\u8bd5\u5668\u52a0\u4e86\u65ad\u70b9\uff0c\u5728\u4e0b\u65b9\u7684\u547d\u4ee4\u884c\u8f93\u5165 <code>g</code> \u5e76\u56de\u8f66\u7ee7\u7eed\u8fd0\u884c\u3002\u53ef\u4ee5\u770b\u5230\u52a0\u8f7d\u5668\u53c8\u52a0\u8f7d\u4e86\u8bb8\u591a DLL \u548c\u7b26\u53f7\u3002\u5f53\u7136\uff0c\u8fd9\u4e9b\u7b26\u53f7\u53ea\u662f\u4e3a\u4e86\u80fd\u628a\u8bb0\u4e8b\u672c\u663e\u793a\u51fa\u6765\uff0c\u8fd8\u6709\u4e00\u4e9b\u529f\u80fd\u662f\u6309\u9700\u52a0\u8f7d\u7684\u3002\u53ef\u4ee5\u5728\u8bb0\u4e8b\u672c\u4e2d\u9009\u62e9\u6587\u4ef6\u83dc\u5355\uff0c\u7136\u540e\u5355\u51fb\u6253\u5f00\uff0c\u53ef\u4ee5\u770b\u5230\u8c03\u8bd5\u5668\u4e2d\u5e94\u8be5\u4f1a\u8f93\u51fa\u65b0\u7684\u52a0\u8f7d\u4fe1\u606f\uff0c\u8bf4\u660e\u52a8\u6001\u5e93\u4e2d\u7684\u51fd\u6570\u5176\u5b9e\u662f\u53ef\u4ee5\u6309\u9700\u52a0\u8f7d\u7684\u3002</p> <p>\u5728 Windows \u4e0a\uff0c\u5982\u679c\u60f3\u67e5\u770b\u4e00\u4e2a\u7a0b\u5e8f\u4f9d\u8d56\u4e86\u54ea\u4e9b DLL\uff0c\u53ef\u4ee5\u4f7f\u7528 Denpendency Walker\uff0c\u4e0d\u8fc7\u8fd9\u4e2a\u7a0b\u5e8f\u6bd4\u8f83\u8001\uff0c\u5728 Windows 10 \u4e0a\u53ef\u80fd\u65e0\u6cd5\u6b63\u5e38\u8fd0\u884c\uff0c\u53ef\u4ee5\u4f7f\u7528 Dependencies \u8fd9\u4e2a\u66f4\u65b0\u7684\u5de5\u5177\u3002</p>"},{"location":"basics/procedure/","title":"\u4ece\u6e90\u4ee3\u7801\u5230\u4e8c\u8fdb\u5236","text":"<p>\u9996\u5148\u6765\u770b\u4e00\u4e2a\u7b80\u5355\u7684\u7a0b\u5e8f</p> hello.cpp <pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nint main() {\n    cout &lt;&lt; \"Hello World!\" &lt;&lt; endl;\n    return 0;\n}\n</code></pre> <p>\u6211\u4eec\u90fd\u77e5\u9053\uff0c\u6211\u4eec\u53ea\u9700\u8981\u8fd0\u884c <code>g++ hello.cpp</code> \u5c31\u53ef\u4ee5\u5c06\u8fd9\u4e2a C++ \u6e90\u4ee3\u7801\u6587\u4ef6\u7f16\u8bd1\u4e3a\u53ef\u6267\u884c\u6587\u4ef6 <code>a.out</code> \u4e86\u3002\u5176\u5b9e\uff0c<code>g++</code> \u53ea\u662f\u4e00\u4e2a\u9a71\u52a8\u7a0b\u5e8f\uff08Driver\uff09\uff0c\u5b83\u80cc\u540e\u53d1\u751f\u4e86\u4e00\u7cfb\u5217\u590d\u6742\u7684\u64cd\u4f5c\uff0c\u8c03\u7528\u4e86\u8bb8\u591a\u4e0d\u540c\u7684\u7a0b\u5e8f\u3002</p>"},{"location":"basics/procedure/#\u9884\u5904\u7406","title":"\u9884\u5904\u7406","text":"<p>\u5728\u7f16\u8bd1\u5f00\u59cb\u4e4b\u524d\uff0c\u9884\u5904\u7406\u5668\u4f1a\u5904\u7406\u6e90\u6587\u4ef6\u4e2d\u7684\u5b8f\u5b9a\u4e49\uff08\u4f8b\u5982 <code>#define</code>\u3001<code>#include</code>\u3001<code>#ifdef</code> \u7b49\uff09\uff0c\u5bf9\u6e90\u4ee3\u7801\u8fdb\u884c\u5c55\u5f00\u6216\u8005\u66ff\u6362\u3002\u4f8b\u5982\uff0c\u5bf9\u4e8e <code>#include &lt;iostream&gt;</code>\uff0c\u9884\u5904\u7406\u5668\u4f1a\u76f4\u63a5\u5c06 <code>iostream</code> \u8fd9\u4e2a\u6587\u4ef6\u539f\u5c01\u4e0d\u52a8\u5730\u62f7\u8d1d\u5230\u6e90\u6587\u4ef6\u4e2d\u3002\u7136\u800c\uff0c\u6211\u4eec\u7684\u6e90\u4ee3\u7801\u76ee\u5f55\u4e2d\u5e76\u6ca1\u6709 <code>iostream</code> \u8fd9\u4e2a\u6587\u4ef6\uff0c\u9884\u5904\u7406\u5668\u662f\u600e\u4e48\u77e5\u9053\u53bb\u54ea\u91cc\u67e5\u627e\u8fd9\u4e2a\u6587\u4ef6\u5462\uff1f</p> <p>\u5b9e\u9645\u4e0a\uff0c\u9884\u5904\u7406\u5668\u5e76\u4e0d\u77e5\u9053\u6211\u4eec\u7684\u5934\u6587\u4ef6\u90fd\u5728\u54ea\u91cc\uff0c\u9700\u8981\u6211\u4eec\u624b\u52a8\u63d0\u4f9b\u5305\u542b\u8def\u5f84\uff08Include Path\uff09\u3002\u5bf9\u4e8e <code>g++</code> \u800c\u8a00\uff0c\u5c31\u662f <code>-I</code> \u9009\u9879\u3002\u9884\u5904\u7406\u5668\u4f1a\u5728\u6211\u4eec\u63d0\u4f9b\u7684\u8def\u5f84\u4e2d\u4f9d\u6b21\u641c\u7d22\uff0c\u76f4\u5230\u627e\u5230\u5934\u6587\u4ef6\u4e3a\u6b62\u3002\u5f53\u7136\uff0c\u50cf <code>iostream</code> \u8fd9\u79cd\u5e38\u7528\u7684\u7cfb\u7edf\u5934\u6587\u4ef6\uff0c\u5982\u679c\u6bcf\u6b21\u90fd\u9700\u8981\u6211\u4eec\u624b\u52a8\u6307\u5b9a\u67e5\u627e\u76ee\u5f55\uff0c\u5c06\u4f1a\u975e\u5e38\u7e41\u7410\uff0c\u6240\u4ee5 <code>g++</code> \u5df2\u7ecf\u5185\u7f6e\u4e86\u8bb8\u591a\u5e38\u7528\u7684\u5305\u542b\u8def\u5f84\uff0c\u540c\u65f6\uff0c\u5305\u542b\u8def\u5f84\u9ed8\u8ba4\u8fd8\u4f1a\u5305\u62ec\u6e90\u6587\u4ef6\u6240\u5728\u7684\u76ee\u5f55\u3002</p> <p>\u8fd9\u4e00\u6b65\u7684\u8f93\u51fa\u662f\u7ecf\u8fc7\u5b8f\u5c55\u5f00\u4e4b\u540e\u7684\u6e90\u4ee3\u7801\u6587\u4ef6\uff0c\u5e76\u4e0d\u662f\u6240\u6709\u8bed\u8a00\u90fd\u50cf C/C++ \u4e00\u6837\u6709\u7c7b\u4f3c\u6587\u672c\u66ff\u6362\u7684\u9884\u5904\u7406\u6b65\u9aa4\u3002</p> Note <p>\u5728 C/C++ \u4e2d\uff0c\u9884\u5904\u7406\u7a0b\u5e8f\u662f <code>cpp</code>\uff0c\u5168\u79f0\u662f C PreProcessor\u3002\u53ef\u4ee5\u8fd0\u884c <code>cpp hello.cpp</code> \u67e5\u770b\u9884\u5904\u7406\u5668\u7684\u8f93\u51fa\u3002\u8f93\u51fa\u53ef\u80fd\u6bd4\u8f83\u957f\uff0c\u53ef\u4ee5\u5c06\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u4e00\u4e2a\u6587\u4ef6\u65b9\u4fbf\u67e5\u770b\u3002</p> Info <p>\u4f7f\u7528 <code>-E</code> \u9009\u9879\uff0c\u53ef\u4ee5\u4f7f <code>g++</code> \u53ea\u8f93\u51fa\u9884\u5904\u7406\u7ed3\u679c\u800c\u4e0d\u8fdb\u884c\u8fdb\u4e00\u6b65\u7684\u7f16\u8bd1\u3002\u53ef\u4ee5\u8fd0\u884c <code>g++ -E hello.cpp</code> \u67e5\u770b\u8f93\u51fa\uff0c\u548c\u76f4\u63a5\u8fd0\u884c <code>cpp</code> \u7684\u7ed3\u679c\u6bd4\u8f83\u3002</p>"},{"location":"basics/procedure/#\u8bd5\u8bd5\u770b","title":"\u8bd5\u8bd5\u770b","text":"<p>\u4e0b\u9762\u6211\u4eec\u6765\u8bd5\u8bd5\u770b\u5982\u679c\u5305\u542b\u8def\u5f84\u4e0d\u5728\u9ed8\u8ba4\u63d0\u4f9b\u7684\u8303\u56f4\u91cc\uff0c\u6211\u4eec\u5e94\u5f53\u5982\u4f55\u8ba9\u9884\u5904\u7406\u5668\u627e\u5230\u6587\u4ef6\u3002\u9996\u5148\uff0c\u521b\u5efa\u4e24\u4e2a\u6587\u4ef6\u5939\uff0c\u5206\u522b\u662f <code>src</code> \u548c <code>include</code>\u3002\u5728\u91cc\u9762\u5206\u522b\u653e\u5165\u4ee5\u4e0b\u6587\u4ef6\uff1a</p> src/a.cppinclude/a.h <pre><code>#include \"a.h\"\n\nint main() {\n    return a;\n}\n</code></pre> <pre><code>int a = 1;\n</code></pre> <p>\u9996\u5148\u6211\u4eec\u76f4\u63a5\u8fd0\u884c <code>g++ -E src/a.cpp</code>\uff0c\u53ef\u4ee5\u770b\u5230\uff0c\u8fd9\u65f6\u5019\u9884\u5904\u7406\u5668\u8868\u793a\u81ea\u5df1\u627e\u4e0d\u5230 <code>a.h</code> \uff1a</p> <pre><code>$ g++ -E src/a.cpp\n# 1 \"src/a.cpp\"\n# 1 \"&lt;built-in&gt;\"\n# 1 \"&lt;command-line&gt;\"\n# 1 \"/usr/include/stdc-predef.h\" 1 3 4\n# 1 \"&lt;command-line&gt;\" 2\n# 1 \"src/a.cpp\"\nsrc/a.cpp:1:10: fatal error: a.h: No such file or directory\n    1 | #include \"a.h\"\n      |          ^~~~~\ncompilation terminated.\n</code></pre> <p>\u8fd9\u65f6\uff0c\u5c31\u9700\u8981\u6211\u4eec\u901a\u8fc7 <code>-I</code> \u9009\u9879\u989d\u5916\u63d0\u4f9b\u67e5\u627e\u76ee\u5f55\u3002\u8fd9\u65f6\u5019\u9884\u5904\u7406\u5668\u5c31\u77e5\u9053\u53bb\u54ea\u91cc\u627e\u5934\u6587\u4ef6\u4e86\uff0c\u5e76\u4e14 <code>a.h</code> \u4e2d\u7684\u5185\u5bb9\u4e5f\u88ab\u6b63\u786e\u5730\u590d\u5236\u8fdb\u6765\u4e86\u3002</p> <pre><code>$ g++ -E -Iinclude src/a.cpp\n# 1 \"src/a.cpp\"\n# 1 \"&lt;built-in&gt;\"\n# 1 \"&lt;command-line&gt;\"\n# 1 \"/usr/include/stdc-predef.h\" 1 3 4\n# 1 \"&lt;command-line&gt;\" 2\n# 1 \"src/a.cpp\"\n# 1 \"include/a.h\" 1\nint a = 1;\n# 2 \"src/a.cpp\" 2\n\nint main() {\n    return a;\n}\n</code></pre> <p>Note</p> <p>\u5982\u679c\u9700\u8981\u6307\u5b9a\u591a\u4e2a\u67e5\u627e\u76ee\u5f55\uff0c\u9700\u8981\u63d0\u4f9b\u591a\u4e2a <code>-I</code> \u9009\u9879\uff0c\u9884\u5904\u7406\u5668\u4f1a\u4f9d\u6b21\u67e5\u627e\u3002\u4f8b\u5982 <code>g++ -Iinclude1 -Iinclude2</code>\u3002</p>"},{"location":"basics/procedure/#\u7f16\u8bd1","title":"\u7f16\u8bd1","text":"<p>\u6e90\u6587\u4ef6\u7ecf\u8fc7\u9884\u5904\u7406\u540e\uff0c\u4fbf\u53ef\u4ee5\u8c03\u7528\u7f16\u8bd1\u5668\u5bf9\u6e90\u6587\u4ef6\u8fdb\u884c\u7f16\u8bd1\u4e86\u3002\u7b80\u5355\u6765\u8bb2\uff0c\u6bcf\u4e00\u4e2a <code>.cpp</code> \u6587\u4ef6\u53ef\u4ee5\u88ab\u79f0\u4e3a\u7f16\u8bd1\u5355\u5143\uff08Compilation Unit\uff09\u3002\u6bcf\u4e00\u4e2a\u7f16\u8bd1\u5355\u5143\u90fd\u53ef\u4ee5\u72ec\u7acb\u8fdb\u884c\u7f16\u8bd1\u3002\u7f16\u8bd1\u5668\u7684\u5de5\u4f5c\u662f\u89e3\u6790\u6e90\u6587\u4ef6\uff0c\u7ecf\u8fc7\u8bcd\u6cd5\u5206\u6790\u3001\u8bed\u6cd5\u5206\u6790\u3001\u4e2d\u95f4\u4ee3\u7801\u751f\u6210\u3001\u4ee3\u7801\u4f18\u5316\u7b49\u4e00\u7cfb\u5217\u590d\u6742\u7684\u64cd\u4f5c\uff0c\u6700\u7ec8\u751f\u6210\u4e00\u4e2a\u76ee\u6807\u5e73\u53f0\u7684\u6c47\u7f16\u6587\u4ef6\u3002</p> <p>\u8fd9\u4e00\u6b65\u7684\u8f93\u51fa\u662f\u6c47\u7f16\u6587\u4ef6\uff0c\u4e0d\u540c\u5e73\u53f0\u6240\u4f7f\u7528\u7684\u6c47\u7f16\u8bed\u8a00\u4e0d\u4e00\u6837\uff0c\u8fd9\u91cc\u4ee5 <code>x86-64</code> \u5e73\u53f0\u4e3a\u4f8b\u3002</p> Note <p><code>g++</code> \u6240\u4f7f\u7528\u7684 C++ \u7f16\u8bd1\u5668\u4e3a <code>cc1plus</code>\uff0c\u8fd9\u4e2a\u7a0b\u5e8f\u5e76\u4e0d\u5728\u9ed8\u8ba4\u7684 <code>PATH</code> \u4e2d\uff0c\u800c\u662f\u5728\u5e93\u6587\u4ef6\u4e2d\u3002\u5982\u679c\u4f60\u4f7f\u7528\u7684\u662f <code>g++</code> 9\uff0c\u90a3\u4e48\u5b83\u5c31\u5728 <code>/usr/lib/gcc/x86_64-linux-gnu/9/cc1plus</code>\u3002</p>"},{"location":"basics/procedure/#\u8bd5\u8bd5\u770b_1","title":"\u8bd5\u8bd5\u770b","text":"<p>\u6211\u4eec\u9996\u5148\u5c06\u4e4b\u524d\u7684 <code>hello.cpp</code> \u8fdb\u884c\u9884\u5904\u7406\uff0c\u4fdd\u5b58\u5230 <code>hello.preprocessed.cpp</code> \u4e2d\uff0c\u7136\u540e\u8c03\u7528 <code>cc1plus</code> \u5c06 <code>hello.preprocessed.cpp</code> \u7f16\u8bd1\u5230\u6c47\u7f16\u6587\u4ef6 <code>hello.preprocessed.s</code>\u3002</p> Note <p>\u5982\u679c\u4f60\u627e\u4e0d\u5230 <code>cc1plus</code>\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>-S</code> \u9009\u9879\uff0c<code>g++</code> \u4f1a\u5e2e\u6211\u4eec\u9884\u5904\u7406\u597d\u6587\u4ef6\uff0c\u7136\u540e\u7f16\u8bd1\uff0c\u5e76\u8f93\u51fa\u4e00\u4e2a\u6c47\u7f16\u6587\u4ef6\u540e\u4fbf\u505c\u6b62\u7f16\u8bd1\u8fc7\u7a0b\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u4e0b\u9762\u4e24\u4e2a\u547d\u4ee4\u7528 <code>g++ -S hello.cpp -o hello.preprocessed.s</code> \u4ee3\u66ff\u3002</p> <pre><code>$ cpp hello.cpp hello.preprocessed.cpp\n$ /usr/lib/gcc/x86_64-linux-gnu/9/cc1plus hello.preprocessed.cpp\n# ... \u7701\u7565\u5f88\u591a\u8f93\u51fa\nAnalyzing compilation unit\nPerforming interprocedural optimizations\n &lt;*free_lang_data&gt; &lt;visibility&gt; &lt;build_ssa_passes&gt; &lt;opt_local_passes&gt; &lt;remove_symbols&gt; &lt;targetclone&gt; &lt;free-fnsummary&gt;Streaming LTO\n &lt;whole-program&gt; &lt;hsa&gt; &lt;fnsummary&gt; &lt;inline&gt; &lt;free-fnsummary&gt; &lt;single-use&gt; &lt;comdats&gt;Assembling functions:\n &lt;materialize-all-clones&gt; &lt;simdclone&gt; int main() void __static_initialization_and_destruction_0(int, int) void _GLOBAL__sub_I_main()\nTime variable                                   usr           sys          wall               GGC\n phase setup                        :   0.00 (  0%)   0.00 (  0%)   0.01 (  2%)    1471 kB (  5%)\n phase parsing                      :   0.19 ( 86%)   0.24 ( 77%)   0.48 ( 81%)   25530 kB ( 83%)\n phase lang. deferred               :   0.02 (  9%)   0.06 ( 19%)   0.08 ( 14%)    3548 kB ( 12%)\n phase opt and generate             :   0.01 (  5%)   0.01 (  3%)   0.02 (  3%)     289 kB (  1%)\n |name lookup                       :   0.00 (  0%)   0.05 ( 16%)   0.05 (  8%)    1463 kB (  5%)\n |overload resolution               :   0.02 (  9%)   0.04 ( 13%)   0.02 (  3%)    1788 kB (  6%)\n callgraph optimization             :   0.00 (  0%)   0.00 (  0%)   0.01 (  2%)       0 kB (  0%)\n ipa inlining heuristics            :   0.00 (  0%)   0.01 (  3%)   0.00 (  0%)       0 kB (  0%)\n preprocessing                      :   0.01 (  5%)   0.02 (  6%)   0.04 (  7%)     377 kB (  1%)\n parser (global)                    :   0.04 ( 18%)   0.07 ( 23%)   0.18 ( 31%)    8434 kB ( 27%)\n parser struct body                 :   0.04 ( 18%)   0.02 (  6%)   0.05 (  8%)    5710 kB ( 19%)\n parser function body               :   0.03 ( 14%)   0.02 (  6%)   0.00 (  0%)    1043 kB (  3%)\n parser inl. func. body             :   0.02 (  9%)   0.00 (  0%)   0.01 (  2%)    1395 kB (  5%)\n parser inl. meth. body             :   0.02 (  9%)   0.06 ( 19%)   0.11 ( 19%)    2446 kB (  8%)\n template instantiation             :   0.05 ( 23%)   0.11 ( 35%)   0.17 ( 29%)    9572 kB ( 31%)\n integrated RA                      :   0.01 (  5%)   0.00 (  0%)   0.00 (  0%)      72 kB (  0%)\n thread pro- &amp; epilogue             :   0.00 (  0%)   0.00 (  0%)   0.01 (  2%)       4 kB (  0%)\n TOTAL                              :   0.22          0.31          0.59          30848 kB\n$ ls\nhello.cpp  hello.preprocessed.cpp  hello.preprocessed.s\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230 <code>cc1plus</code> \u8f93\u51fa\u4e86\u7f16\u8bd1\u540e\u7684\u6c47\u7f16\u6587\u4ef6 <code>hello.preprocessed.s</code>\u3002\u53ef\u4ee5\u6253\u5f00\u6765\u67e5\u770b\u5176\u4e2d\u7684\u5185\u5bb9\u3002</p> \u6269\u5c55\u77e5\u8bc6 - C++ \u547d\u540d\u6df7\u6dc6\uff08Mangling\uff09 <p>\u5728\u6c47\u7f16\u8bed\u8a00\u6587\u4ef6\u4e2d\uff0c\u4f60\u53ef\u80fd\u4f1a\u770b\u5230\u7c7b\u4f3c <code>_ZSt4endlIcSt11char_traitsIcEERSt13basic_ostreamIT_T0_ES6_</code> \u7684\u5947\u602a\u7b26\u53f7\u3002\u8fd9\u662f C++ \u7f16\u8bd1\u5668\u5bf9\u51fd\u6570\u8fdb\u884c\u547d\u540d\u6df7\u6dc6\u540e\u7684\u7ed3\u679c\u3002C++ \u4e2d\u6709\u51fd\u6570\u91cd\u8f7d\uff0c\u4ee5\u53ca\u547d\u540d\u7a7a\u95f4\u7b49 C \u6240\u6ca1\u6709\u7684\u8bed\u8a00\u7279\u6027\u3002\u4e3a\u4e86\u5b9e\u73b0\u8fd9\u4e9b\u7279\u6027\uff0cC++ \u7f16\u8bd1\u5668\u4f1a\u5c06\u51fd\u6570\u7684\u547d\u540d\u7a7a\u95f4\uff0c\u4ee5\u53ca\u8c03\u7528\u53c2\u6570\u7684\u7c7b\u578b\u90fd\u7f16\u7801\u5230\u51fd\u6570\u7b26\u53f7\u4e2d\uff0c\u4e5f\u5c31\u662f\u76f8\u5f53\u4e8e\u4e3a\u6bcf\u4e00\u4e2a\u51fd\u6570\u90fd\u521b\u5efa\u4e86\u65b0\u7684\u540d\u5b57\u3002\u8fd9\u6837\u5c31\u80fd\u533a\u5206\u5f00\u4e0d\u540c\u547d\u540d\u7a7a\u95f4\u4ee5\u53ca\u4e0d\u540c\u51fd\u6570\u91cd\u8f7d\u7684\u540c\u540d\u51fd\u6570\u4e86\u3002</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5982\u4f55\u6df7\u6dc6\u4e00\u4e2a\u51fd\u6570\u7684\u540d\u79f0\u5b8c\u5168\u53d6\u51b3\u4e8e\u7f16\u8bd1\u5668\uff0cC++ \u6807\u51c6\u4e2d\u5e76\u6ca1\u6709\u89c4\u5b9a\u7f16\u8bd1\u5668\u5e94\u5f53\u5982\u4f55\u6df7\u6dc6\u51fd\u6570\u540d\u79f0\u3002\u7f16\u8bd1\u5668\u53ea\u9700\u8981\u4fdd\u8bc1\u80fd\u591f\u533a\u5206\u540c\u540d\u51fd\u6570\u7684\u4e0d\u540c\u91cd\u8f7d\u5373\u53ef\u3002C++ \u53ea\u89c4\u5b9a\u4e86\u4e0d\u5141\u8bb8\u53ea\u901a\u8fc7\u4e0d\u540c\u7684\u8fd4\u56de\u503c\u7c7b\u578b\u6765\u91cd\u8f7d\u51fd\u6570\uff0c\u6240\u4ee5\u7f16\u8bd1\u5668\u53ef\u80fd\u4f1a\u5728\u6df7\u6dc6\u7684\u65f6\u5019\u7701\u7565\u8fd4\u56de\u503c\u7c7b\u578b\uff0c\u4e5f\u6709\u53ef\u80fd\u4e0d\u7701\u7565\u3002</p> <p>\u7cfb\u7edf\u4e2d\u4e5f\u81ea\u5e26\u4e86 <code>c++filt</code> \u8fd9\u4e2a\u5de5\u5177\u6765\u5e2e\u52a9\u6211\u4eec\u8fd8\u539f\u6df7\u6dc6\u7b26\u53f7\u5bf9\u5e94\u7684\u51fd\u6570\u7b7e\u540d\u3002\u6211\u4eec\u8fd0\u884c <code>c++filt</code> \u540e\uff0c\u8f93\u5165\u6df7\u6dc6\u540e\u7684\u540d\u79f0\u5e76\u56de\u8f66\uff0c\u5c31\u80fd\u5f97\u5230\u539f\u59cb\u51fd\u6570\u7b7e\u540d\u4e86\u3002</p> <pre><code>$ c++filt\n_ZStlsISt11char_traitsIcEERSt13basic_ostreamIcT_ES5_PKc\nstd::basic_ostream&lt;char, std::char_traits&lt;char&gt; &gt;&amp; std::operator&lt;&lt; &lt;std::char_traits&lt;char&gt; &gt;(std::basic_ostream&lt;char, std::char_traits&lt;char&gt; &gt;&amp;, char const*)\n_ZNSt8ios_base4InitC1Ev\nstd::ios_base::Init::Init()\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u7f16\u8bd1\u5668\u6709\u65f6\u5019\u4f1a\u7701\u7565\u8fd4\u56de\u503c\u7c7b\u578b\u6709\u65f6\u5019\u4e0d\u4f1a\u3002</p>"},{"location":"basics/procedure/#\u6c47\u7f16","title":"\u6c47\u7f16","text":"<p>\u5728\u5f97\u5230\u6c47\u7f16\u6587\u4ef6\u540e\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528\u6c47\u7f16\u5668\u5c06\u6c47\u7f16\u6587\u4ef6\u6c47\u7f16\u4e3a\u76ee\u6807\u6587\u4ef6\u4e86\uff08Object File\uff09\u3002\u6c47\u7f16\u5668\u7684\u5de5\u4f5c\u7b80\u5355\u5f88\u591a\uff0c\u53ea\u9700\u8981\u7ffb\u8bd1\u6c47\u7f16\u6587\u4ef6\u4e2d\u7684\u6307\u4ee4\uff0c\u8f93\u51fa\u5bf9\u5e94\u7684\u4e8c\u8fdb\u5236\u673a\u5668\u6307\u4ee4\uff0c\u5e76\u5c06\u6307\u4ee4\u7ec4\u88c5\u4e3a\u64cd\u4f5c\u7cfb\u7edf\u7684\u76ee\u6807\u6587\u4ef6\u683c\u5f0f\u5373\u53ef\u3002</p> <p>\u8fd9\u4e00\u6b65\u7684\u8f93\u51fa\u662f\u5bf9\u5e94\u5e73\u53f0\u7684\u4e8c\u8fdb\u5236\u76ee\u6807\u6587\u4ef6\uff0c\u5176\u4e2d\u5305\u542b\u4e86\u51fd\u6570\u7b26\u53f7\uff0c\u4ee5\u53ca\u5bf9\u5e94\u7684\u4e8c\u8fdb\u5236\u673a\u5668\u7801\u3002</p> Note <p>\u6c47\u7f16\u5668\u7684\u7a0b\u5e8f\u540d\u5b57\u662f <code>as</code>\u3002</p>"},{"location":"basics/procedure/#\u8bd5\u8bd5\u770b_2","title":"\u8bd5\u8bd5\u770b","text":"<p>\u6211\u4eec\u4f7f\u7528 <code>as</code> \u547d\u4ee4\uff0c\u5c06\u7f16\u8bd1\u5668\u8f93\u51fa\u7684\u6c47\u7f16\u6587\u4ef6\u6c47\u7f16\u5230\u76ee\u6807\u6587\u4ef6\u3002</p> <pre><code>$ as hello.preprocessed.s -o hello.preprocessed.o\n$ ls\nhello.cpp  hello.preprocessed.cpp  hello.preprocessed.o  hello.preprocessed.s\n</code></pre> Note <p>\u4f7f\u7528 <code>-c</code> \u9009\u9879\uff0c\u53ef\u4ee5\u8ba9 <code>g++</code> \u53ea\u751f\u6210\u76ee\u6807\u6587\u4ef6\u540e\uff0c\u5c31\u505c\u6b62\u7f16\u8bd1\u8fc7\u7a0b\u3002\u4f8b\u5982\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 <code>g++ -c hello.cpp -o hello.preprocessed.o</code> \u5f97\u5230\u540c\u6837\u7684\u76ee\u6807\u6587\u4ef6\u3002</p> \u4f7f\u7528 <code>file</code> \u547d\u4ee4\u67e5\u770b\u6587\u4ef6\u7c7b\u578b <p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 <code>file</code> \u547d\u4ee4\uff0c\u6765\u67e5\u770b\u4e00\u4e2a\u6587\u4ef6\u7684\u7c7b\u578b\u3002 <pre><code>$ file hello.preprocessed.o\nhello.preprocessed.o: ELF 64-bit LSB relocatable, x86-64, version 1 (SYSV), not stripped\n</code></pre> \u53ef\u4ee5\u770b\u5230\u8fd9\u662f\u4e00\u4e2a <code>ELF</code> \u6587\u4ef6\u3002</p> \u4f7f\u7528 <code>readelf</code> \u547d\u4ee4\u67e5\u770b\u4e00\u4e2a ELF \u6587\u4ef6\u7684\u4fe1\u606f <p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 <code>readelf</code> \u547d\u4ee4\uff0c\u6765\u67e5\u770b\u4e00\u4e2a ELF \u6587\u4ef6\u7684\u6587\u4ef6\u4fe1\u606f\u3002 <pre><code>$ readelf -a hello.preprocessed.o\nELF Header:\n    Magic:   7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00\n    Class:                             ELF64\n    Data:                              2's complement, little endian\n    Version:                           1 (current)\n    OS/ABI:                            UNIX - System V\n    ABI Version:                       0\n    Type:                              REL (Relocatable file)\n    Machine:                           Advanced Micro Devices X86-64\n    Version:                           0x1\n    Entry point address:               0x0\n    Start of program headers:          0 (bytes into file)\n    Start of section headers:          1832 (bytes into file)\n    Flags:                             0x0\n    Size of this header:               64 (bytes)\n    Size of program headers:           0 (bytes)\n    Number of program headers:         0\n    Size of section headers:           64 (bytes)\n    Number of section headers:         15\n    Section header string table index: 14\n\nSection Headers:\n    [Nr] Name              Type             Address           Offset\n        Size              EntSize          Flags  Link  Info  Align\n    [ 0]                   NULL             0000000000000000  00000000\n        0000000000000000  0000000000000000           0     0     0\n    [ 1] .text             PROGBITS         0000000000000000  00000040\n        0000000000000091  0000000000000000  AX       0     0     1\n    [ 2] .rela.text        RELA             0000000000000000  00000548\n        0000000000000108  0000000000000018   I      12     1     8\n    [ 3] .data             PROGBITS         0000000000000000  000000d1\n# ...\u7701\u7565\u5927\u6bb5\u8f93\u51fa\n</code></pre></p> \u4f7f\u7528 <code>nm</code> \u547d\u4ee4\u8f93\u51fa\u76ee\u6807\u6587\u4ef6\u4e2d\u7684\u7b26\u53f7 <p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 <code>nm</code> \u547d\u4ee4\uff0c\u6765\u67e5\u770b\u4e00\u4e2a\u4e8c\u8fdb\u5236\u76ee\u6807\u6587\u4ef6\u4e2d\u5305\u542b\u54ea\u4e9b\u7b26\u53f7\u3002 <pre><code>$ nm hello.preprocessed.o\n                 U __cxa_atexit\n                 U __dso_handle\n                 U _GLOBAL_OFFSET_TABLE_\n000000000000007c t _GLOBAL__sub_I_main\n0000000000000000 T main\n0000000000000033 t _Z41__static_initialization_and_destruction_0ii\n                 U _ZNSolsEPFRSoS_E\n                 U _ZNSt8ios_base4InitC1Ev\n                 U _ZNSt8ios_base4InitD1Ev\n                 U _ZSt4cout\n                 U _ZSt4endlIcSt11char_traitsIcEERSt13basic_ostreamIT_T0_ES6_\n0000000000000000 r _ZStL19piecewise_construct\n0000000000000000 b _ZStL8__ioinit\n                 U _ZStlsISt11char_traitsIcEERSt13basic_ostreamIcT_ES5_PKc\n</code></pre></p>"},{"location":"basics/procedure/#\u94fe\u63a5","title":"\u94fe\u63a5","text":"<p>\u5f97\u5230\u76ee\u6807\u6587\u4ef6\u540e\uff0c\u6211\u4eec\u8fd8\u4e0d\u80fd\u6267\u884c\u8fd9\u4e2a\u6587\u4ef6\u3002\u8fd9\u662f\u56e0\u4e3a\u76ee\u6807\u6587\u4ef6\u5f80\u5f80\u9700\u8981\u4f9d\u8d56\u672c\u8eab\u6ca1\u6709\u7684\u5916\u90e8\u51fd\u6570\u5b9e\u73b0\u3002\u5982\u679c\u6211\u4eec\u4f7f\u7528 <code>nm</code> \u547d\u4ee4\u67e5\u770b\u6211\u4eec\u7684\u76ee\u6807\u6587\u4ef6\uff0c\u5c31\u4f1a\u53d1\u73b0\u5f88\u591a <code>U</code>\uff0c\u8fd9\u5c31\u610f\u5473\u7740\u8fd9\u4e9b\u7b26\u53f7\u5728\u5f53\u524d\u76ee\u6807\u6587\u4ef6\u627e\u4e0d\u5230\u5b9a\u4e49\u3002\u540c\u65f6\uff0c\u4e3a\u4e86\u6267\u884c\u7a0b\u5e8f\uff0c\u8fd8\u6709\u8bb8\u591a\u9700\u8981\u548c\u64cd\u4f5c\u7cfb\u7edf\u4ea4\u4e92\u7684\u51fd\u6570\uff0c\u4f8b\u5982\u5206\u914d\u5185\u5b58\u3001\u8f93\u5165\u8f93\u51fa\u7b49\u3002\u8fd9\u4e9b\u6211\u4eec\u7684\u76ee\u6807\u6587\u4ef6\u901a\u901a\u90fd\u6ca1\u6709\u3002\u4e3a\u4e86\u80fd\u8ba9\u76ee\u6807\u6587\u4ef6\u4e2d\u7684\u7a0b\u5e8f\u8fd0\u884c\u8d77\u6765\uff0c\u8fd8\u9700\u8981\u6700\u540e\u4e00\u6b65\uff1a\u94fe\u63a5\u3002</p> <p>\u94fe\u63a5\u5c31\u662f\u5c06\u8bb8\u591a\u76ee\u6807\u6587\u4ef6\u5408\u5e76\u8d77\u6765\uff0c\u6700\u7ec8\u8f93\u51fa\u4e00\u4e2a\u53ef\u6267\u884c\u7684\u6587\u4ef6\u3002</p> Note <p>\u94fe\u63a5\u5668\u7a0b\u5e8f\u540d\u5b57\u662f <code>ld</code>\u3002</p>"},{"location":"basics/procedure/#\u8bd5\u8bd5\u770b_3","title":"\u8bd5\u8bd5\u770b","text":"<p>\u63a5\u4e0b\u6765\u4f60\u5c06\u770b\u5230\u672c\u7ae0\u6700\u590d\u6742\u7684\u4e00\u6761\u547d\u4ee4\uff0c\u4e0d\u8fc7\u4e0d\u8981\u5bb3\u6015\u3002</p> <pre><code>$ ld -static hello.preprocessed.o \\\n    /usr/lib/x86_64-linux-gnu/crt1.o \\\n    /usr/lib/x86_64-linux-gnu/crti.o \\\n    /usr/lib/gcc/x86_64-linux-gnu/9/crtbeginT.o \\\n    -L/usr/lib/gcc/x86_64-linux-gnu/9 \\\n    -L/usr/lib/x86_64-linux-gnu \\\n    -L/lib/x86_64-linux-gnu \\\n    -L/lib \\\n    -L/usr/lib \\\n    -lstdc++ \\\n    -lm \\\n    --start-group \\\n    -lgcc \\\n    -lgcc_eh \\\n    -lc \\\n    --end-group \\\n    /usr/lib/gcc/x86_64-linux-gnu/9/crtend.o \\\n    /usr/lib/x86_64-linux-gnu/crtn.o\n$ ls\na.out  hello.cpp  hello.preprocessed.cpp  hello.preprocessed.o  hello.preprocessed.s\n$ ./a.out\nHello, world\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u7ecf\u8fc7\u590d\u6742\u7684\u94fe\u63a5\u8fc7\u7a0b\uff0c\u6211\u4eec\u7ec8\u4e8e\u5f97\u5230\u4e86\u719f\u6089\u7684\u53ef\u6267\u884c\u6587\u4ef6\u3002</p> <code>a.out</code> \u7684\u7531\u6765 <p><code>a.out</code> \u8fd9\u4e2a\u540d\u5b57\u662f\u8d77\u6e90\u4e8e\u53e4\u8001\u7684 Unix \u7cfb\u7edf\uff0c\u662f \"assembler output\" \u7684\u7f29\u5199\uff0c\u6765\u81ea\u4e8e Ken Thompson \u7684 PDP-7 \u6c47\u7f16\u5668\u3002<code>a.out</code> \u4e5f\u662f\u4e00\u79cd\u4e8c\u8fdb\u5236\u683c\u5f0f\uff0c\u7531\u4e8e\u6b20\u7f3a\u6bd4\u8f83\u591a\u7684\u529f\u80fd\uff0c\u9010\u6e10\u88ab ELF\u3001PE \u7b49\u683c\u5f0f\u66ff\u4ee3\u3002\u65e9\u671f Linux \u7cfb\u7edf\u4e5f\u652f\u6301 <code>a.out</code> \u6587\u4ef6\u683c\u5f0f\uff0c\u73b0\u5728\u7684 Linux \u7cfb\u7edf\u5e38\u7528\u7684\u90fd\u662f ELF \u683c\u5f0f\u7684\u4e8c\u8fdb\u5236\uff0c\u800c <code>a.out</code> \u683c\u5f0f\u5728 Linux \u5185\u6838 5.1 \u7248\u672c\u4e2d\u88ab\u6b63\u5f0f\u79fb\u9664\u652f\u6301\u3002\u800c <code>a.out</code> \u8fd9\u4e2a\u540d\u5b57\u4ecd\u7136\u88ab\u7528\u6765\u4f5c\u4e3a\u7f16\u8bd1\u5668\u4ea7\u7269\u7684\u9ed8\u8ba4\u540d\u79f0\u3002\u66f4\u591a\u6545\u4e8b\u53ef\u4ee5\u53c2\u8003\u7ef4\u57fa\u767e\u79d1\u3002</p> <p>\u8c03\u7528 <code>ld</code> \u547d\u4ee4\uff0c\u53ea\u9700\u8981\u5c06\u6211\u4eec\u5e0c\u671b\u94fe\u63a5\u7684\u76ee\u6807\u6587\u4ef6\u4e00\u80a1\u8111\u4f20\u8fdb\u53bb\u5c31\u53ef\u4ee5\u4e86\u3002\u800c\u4e00\u4e9b\u7cfb\u7edf\u5e93\u5e76\u4e0d\u662f\u4ee5 <code>.o</code> \u7684\u76ee\u6807\u6587\u4ef6\u5f62\u5f0f\u5b58\u653e\u7684\uff0c\u800c\u662f\u4ee5 <code>.a</code> \u6587\u4ef6\u5f62\u5f0f\u5b58\u653e\u7684\u3002<code>.a</code> \u6587\u4ef6\u5176\u5b9e\u5c31\u662f\u5c06\u8bb8\u591a <code>.o</code> \u6587\u4ef6\u62fc\u8d77\u6765\u7684\u6587\u4ef6\u3002<code>.a</code> \u6587\u4ef6\u5f80\u5f80\u90fd\u4ee5 <code>lib***.a</code> \u7684\u5f62\u5f0f\u547d\u540d\u3002\u5982\u679c\u6211\u4eec\u4f20\u53c2 <code>-labc</code>\uff0c\u90a3\u4e48\u94fe\u63a5\u5668\u5c31\u4f1a\u53bb\u5bfb\u627e <code>libabc.a</code> \u8fd9\u4e2a\u6587\u4ef6\u3002\u8fd9\u4e2a\u76f8\u5f53\u4e8e\u662f\u4e00\u4e2a\u6377\u5f84\u3002</p> <p>\u94fe\u63a5\u5668\u548c\u9884\u5904\u7406\u5668\u4e00\u6837\uff0c\u5e76\u4e0d\u77e5\u9053 <code>.a</code> \u6587\u4ef6\u90fd\u5728\u54ea\uff0c\u6240\u4ee5\u9700\u8981\u6211\u4eec\u901a\u8fc7 <code>-L</code> \u9009\u9879\u6765\u6307\u5b9a\u5e93\u8def\u5f84\uff08Library Path\uff09\u3002\u914d\u5408\u4e0a\u9762\u7684 <code>-l</code>\uff0c\u94fe\u63a5\u5668\u5c31\u80fd\u627e\u5230 <code>.a</code> \u6587\u4ef6\u5e76\u94fe\u63a5\u8d77\u6765\u4e86\u3002</p> <p>\u4e00\u4e9b\u94fe\u63a5\u5668\u4e3a\u4e86\u63d0\u9ad8\u6548\u7387\uff0c\u53ea\u4f1a\u4fdd\u7559\u53c2\u6570\u5217\u8868\u524d\u9762\u7684\u76ee\u6807\u6587\u4ef6\u4e2d\u672a\u5b9a\u4e49\u7684\u51fd\u6570\u7b26\u53f7\uff0c\u5e76\u8bd5\u56fe\u5728\u540e\u9762\u7684\u76ee\u6807\u6587\u4ef6\u4e2d\u627e\u5230\u8fd9\u4e9b\u672a\u5b9a\u4e49\u7b26\u53f7\u3002</p> <p>\u6bd4\u5982\u8bf4\uff0c\u6211\u4eec\u6709 <code>a.o</code>\u3001<code>b.o</code> \u548c <code>c.o</code> \u4e09\u4e2a\u76ee\u6807\u6587\u4ef6\uff0c\u5176\u4e2d\u53ea\u6709 <code>c.o</code> \u5b58\u5728\u672a\u5b9a\u4e49\u7684\u51fd\u6570\u7b26\u53f7\uff0c\u90a3\u4e48\u5047\u5982\u6211\u4eec\u8c03\u7528 <code>ld a.o b.o c.o</code> \u5c06\u4f1a\u51fa\u73b0\u94fe\u63a5\u9519\u8bef\uff0c\u5373\u4f7f <code>a.o</code> \u548c <code>b.o</code> \u4e2d\u542b\u6709 <code>c.o</code> \u9700\u8981\u7684\u7b26\u53f7\u5b9a\u4e49\u3002\u800c\u662f\u9700\u8981\u8c03\u7528 <code>ld c.o a.o b.o</code>\u3002</p> <p>\u5f53\u7136\uff0c\u6709\u65f6\u5019\u6211\u4eec\u4e0d\u53ef\u907f\u514d\u5730\u4f1a\u5199\u51fa\u5faa\u73af\u5f15\u7528\u7684\u60c5\u51b5\u3002\u4f8b\u5982 <code>a.o</code> \u9700\u8981 <code>b.o</code> \u7684\u5b9a\u4e49\uff0c<code>b.o</code> \u9700\u8981 <code>c.o</code> \u7684\u5b9a\u4e49\uff0c<code>c.o</code> \u9700\u8981 <code>a.o</code> \u7684\u5b9a\u4e49\u3002\u6b64\u65f6\u6211\u4eec\u65e0\u8bba\u5982\u4f55\u8c03\u6574\u94fe\u63a5\u987a\u5e8f\u90fd\u4e0d\u53ef\u80fd\u94fe\u63a5\u6210\u529f\u3002\u6240\u4ee5\uff0c\u9488\u5bf9\u8fd9\u79cd\u7279\u6b8a\u60c5\u51b5\uff0c\u94fe\u63a5\u5668\u63d0\u4f9b\u4e86 <code>--start-group</code> \u548c <code>--end-group</code> \u8fd9\u4e00\u5bf9\u9009\u9879\u3002\u4f4d\u4e8e\u8fd9\u4e00\u5bf9\u9009\u9879\u4e2d\u7684\u76ee\u6807\u6587\u4ef6\uff0c\u94fe\u63a5\u5668\u4f1a\u4e0d\u65ad\u5730\u5faa\u73af\u89e3\u51b3\u672a\u5b9a\u4e49\u7b26\u53f7\uff0c\u76f4\u5230\u6ca1\u6709\u65b0\u7684\u672a\u5b9a\u4e49\u7b26\u53f7\u53ef\u4ee5\u88ab\u89e3\u51b3\u4e3a\u6b62\u3002\u5f53\u7b26\u53f7\u6bd4\u8f83\u591a\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u60f3\u8c61\u8fd9\u662f\u4e00\u4e2a\u5f88\u6162\u7684\u8fc7\u7a0b\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u5c3d\u53ef\u80fd\u907f\u514d\u8fd9\u79cd\u60c5\u51b5\u7684\u53d1\u751f\u3002</p> <p>\u8fd8\u6709\u4e00\u4e2a\u95ee\u9898\uff0c\u94fe\u63a5\u5668\u600e\u4e48\u77e5\u9053\u7a0b\u5e8f\u5e94\u8be5\u4ece\u54ea\u5f00\u59cb\u6267\u884c\uff1f\u5b9e\u9645\u4e0a <code>main</code> \u51fd\u6570\u5e76\u4e0d\u662f\u7a0b\u5e8f\u7684\u771f\u6b63\u5165\u53e3\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c<code>ld</code> \u4f1a\u5bfb\u627e <code>_start</code> \u7b26\u53f7\uff0c\u4f5c\u4e3a\u7a0b\u5e8f\u7684\u8d77\u70b9\u3002\u800c\u8fd9\u4e2a\u7b26\u53f7\uff0c\u5c31\u5305\u542b\u5728\u7cfb\u7edf\u8fd0\u884c\u5e93\u5f53\u4e2d\u3002\u5e93\u5f53\u4e2d\u7684 <code>_start</code> \u51fd\u6570\uff0c\u6700\u7ec8\u4f1a\u5728\u521d\u59cb\u5316\u8fd0\u884c\u73af\u5883\u540e\uff0c\u8c03\u7528\u6211\u4eec\u7684 <code>main</code> \u51fd\u6570\u3002</p> \u4f7f\u7528 <code>g++</code> \u8fdb\u884c\u94fe\u63a5 <p><code>g++</code> \u8c03\u7528\u65f6\uff0c\u4f1a\u68c0\u67e5\u6587\u4ef6\u7684\u7c7b\u578b\uff0c\u5982\u679c\u662f\u76ee\u6807\u6587\u4ef6\uff0c<code>g++</code> \u4f1a\u81ea\u52a8\u8c03\u7528\u94fe\u63a5\u5668\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u76f4\u63a5\u8c03\u7528 <code>g++ hello.preprocessed.o</code> \u4e5f\u53ef\u4ee5\u5f97\u5230\u6700\u7ec8\u7684\u53ef\u6267\u884c\u6587\u4ef6\u3002</p> \u67e5\u770b\u53ef\u6267\u884c\u6587\u4ef6\u548c\u76ee\u6807\u6587\u4ef6\u7684\u533a\u522b <p><pre><code>$ readelf -h a.out\nELF Header:\n    Magic:   7f 45 4c 46 02 01 01 03 00 00 00 00 00 00 00 00\n    Class:                             ELF64\n    Data:                              2's complement, little endian\n    Version:                           1 (current)\n    OS/ABI:                            UNIX - GNU\n    ABI Version:                       0\n    Type:                              EXEC (Executable file)\n    Machine:                           Advanced Micro Devices X86-64\n    Version:                           0x1\n    Entry point address:               0x404a90\n    Start of program headers:          64 (bytes into file)\n    Start of section headers:          2368032 (bytes into file)\n    Flags:                             0x0\n    Size of this header:               64 (bytes)\n    Size of program headers:           56 (bytes)\n    Number of program headers:         8\n    Size of section headers:           64 (bytes)\n    Number of section headers:         30\n    Section header string table index: 29\n</code></pre> \u53ef\u4ee5\u770b\u5230\u6b64\u65f6\u7684 <code>Type</code> \u53d8\u4e3a\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u540c\u65f6\u591a\u4e86\u4e00\u4e2a <code>Entry point address</code>\uff0c\u6807\u5fd7\u7740\u7a0b\u5e8f\u7684\u8d77\u70b9\u3002</p> <p>\u6211\u4eec\u4f7f\u7528 <code>nm</code> \u547d\u4ee4\uff0c\u6765\u67e5\u770b\u8fd9\u4e2a\u5730\u5740\u5bf9\u5e94\u7684\u7b26\u53f7\u3002</p> <pre><code>$ nm a.out | grep 404a90\n0000000000404a90 T _start\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u7a0b\u5e8f\u5165\u53e3\u5e76\u4e0d\u662f <code>main</code> \u51fd\u6570\uff0c\u800c\u662f\u5e93\u6240\u63d0\u4f9b\u7684 <code>_start</code> \u51fd\u6570\u3002</p>"},{"location":"basics/procedure/#\u4e0d\u540c\u64cd\u4f5c\u7cfb\u7edf\u7684\u77e5\u8bc6\u8fc1\u79fb","title":"\u4e0d\u540c\u64cd\u4f5c\u7cfb\u7edf\u7684\u77e5\u8bc6\u8fc1\u79fb","text":"<p>\u5728\u4e0d\u540c\u7684\u64cd\u4f5c\u7cfb\u7edf\u4e0a\uff0c\u7a0b\u5e8f\u7684\u7f16\u8bd1\u94fe\u63a5\u8fc7\u7a0b\u662f\u4e00\u6837\u7684\uff0c\u53ea\u662f\u4f7f\u7528\u4e86\u4e0d\u540c\u7684\u4e8c\u8fdb\u5236\u5b58\u50a8\u683c\u5f0f\uff0c\u4f8b\u5982\uff0cWindows \u4f7f\u7528 COFF \u548c PE \u683c\u5f0f\u5b58\u50a8\u5e93\u548c\u53ef\u6267\u884c\u6587\u4ef6\u3002\u4e0d\u540c\u7684\u4e8c\u8fdb\u5236\u683c\u5f0f\u867d\u7136\u5728\u7ec6\u8282\u4e0a\u6709\u6240\u5dee\u522b\uff0c\u4f46\u662f\u4fdd\u5b58\u7684\u5185\u5bb9\u57fa\u672c\u4e0a\u90fd\u662f\u4e00\u6837\u7684\uff0c\u4f8b\u5982\u7a0b\u5e8f\u7684\u5165\u53e3\u3001\u7a0b\u5e8f\u7684\u8fd0\u884c\u65b9\u5f0f\uff08\u6bd4\u5982 Windows \u4f1a\u5728 PE \u6587\u4ef6\u4e2d\u6807\u8bc6\u4e00\u4e2a\u7a0b\u5e8f\u662f\u7528\u56fe\u5f62\u754c\u9762\u8fd0\u884c\u8fd8\u662f\u547d\u4ee4\u884c\u754c\u9762\u8fd0\u884c\uff09\u3001\u7a0b\u5e8f\u4ee3\u7801\u7b49\u3002\u8fd9\u91cc\u662f\u4e0d\u540c\u64cd\u4f5c\u7cfb\u7edf\u4f7f\u7528\u7684\u4e8c\u8fdb\u5236\u7a0b\u5e8f\u683c\u5f0f\u5bf9\u6bd4\u3002</p> \u67e5\u770b Windows \u7684\u4e8c\u8fdb\u5236\u4fe1\u606f <p>Windows \u4e0a\u53ef\u4ee5\u4f7f\u7528 DUMPBIN \u7a0b\u5e8f\u6765\u67e5\u770b\u4e00\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\u7684\u4fe1\u606f\u3002\u8981\u4f7f\u7528\u8fd9\u4e2a\u5de5\u5177\uff0c\u53ef\u4ee5\u5355\u72ec\u4e0b\u8f7d\uff0c\u4e5f\u53ef\u4ee5\u5b89\u88c5 Visual Studio\uff0c\u7136\u540e\u542f\u52a8 Developer PowerShell for VS 2019\u3002</p> <p>Windows \u4e0a\u7684\u7f16\u8bd1\u5668\u662f <code>cl</code>\uff0c\u5982\u679c\u4f60\u7528\u7684\u662f Developer Powershell \u7684\u8bdd\uff0c\u53ef\u4ee5\u7528\u8fd9\u4e2a\u547d\u4ee4\u7f16\u8bd1\u7a0b\u5e8f\u3002\u4f7f\u7528 <code>g++</code> \u547d\u4ee4\u7f16\u8bd1\u4e5f\u53ef\u4ee5\u3002</p> <pre><code>&gt; cl /EHsc .\\hello.cpp\nMicrosoft (R) C/C++ Optimizing Compiler Version 19.28.29337 for x86\nCopyright (C) Microsoft Corporation.  All rights reserved.\n\nhello.cpp\nMicrosoft (R) Incremental Linker Version 14.28.29337.0\nCopyright (C) Microsoft Corporation.  All rights reserved.\n\n/out:hello.exe\nhello.obj\n&gt; dumpbin /headers hello.exe\nMicrosoft (R) COFF/PE Dumper Version 14.28.29337.0\nCopyright (C) Microsoft Corporation.  All rights reserved.\n\n\nDump of file .\\hello.exe\n\nPE signature found\n\nFile Type: EXECUTABLE IMAGE\n\nFILE HEADER VALUES\n             14C machine (x86)\n               4 number of sections\n        60FA3CB7 time date stamp Fri Jul 23 11:51:19 2021\n               0 file pointer to symbol table\n               0 number of symbols\n              E0 size of optional header\n             102 characteristics\n                   Executable\n                   32 bit word machine\n\nOPTIONAL HEADER VALUES\n             10B magic # (PE32)\n           14.28 linker version\n           1D000 size of code\n           11600 size of initialized data\n               0 size of uninitialized data\n            6905 entry point (00406905)\n            1000 base of code\n           1E000 base of data\n          400000 image base (00400000 to 0042FFFF)\n            1000 section alignment\n             200 file alignment\n            6.00 operating system version\n            0.00 image version\n            6.00 subsystem version\n               0 Win32 version\n           30000 size of image\n             400 size of headers\n               0 checksum\n               3 subsystem (Windows CUI)\n            8140 DLL characteristics\n                   Dynamic base\n                   NX compatible\n                   Terminal Server Aware\n          100000 size of stack reserve\n            1000 size of stack commit\n          100000 size of heap reserve\n            1000 size of heap commit\n               0 loader flags\n              10 number of directories\n               0 [       0] RVA [size] of Export Directory\n           2B34C [      28] RVA [size] of Import Directory\n               0 [       0] RVA [size] of Resource Directory\n               0 [       0] RVA [size] of Exception Directory\n               0 [       0] RVA [size] of Certificates Directory\n           2E000 [    1E84] RVA [size] of Base Relocation Directory\n           2989C [      1C] RVA [size] of Debug Directory\n               0 [       0] RVA [size] of Architecture Directory\n               0 [       0] RVA [size] of Global Pointer Directory\n               0 [       0] RVA [size] of Thread Storage Directory\n           298B8 [      40] RVA [size] of Load Configuration Directory\n               0 [       0] RVA [size] of Bound Import Directory\n           1E000 [     128] RVA [size] of Import Address Table Directory\n               0 [       0] RVA [size] of Delay Import Directory\n               0 [       0] RVA [size] of COM Descriptor Directory\n               0 [       0] RVA [size] of Reserved Directory\n\nSECTION HEADER #1\n   .text name\n   1CFD8 virtual size\n    1000 virtual address (00401000 to 0041DFD7)\n   1D000 size of raw data\n     400 file pointer to raw data (00000400 to 0001D3FF)\n       0 file pointer to relocation table\n       0 file pointer to line numbers\n       0 number of relocations\n       0 number of line numbers\n60000020 flags\n         Code\n         Execute Read\n\n# ... \u7701\u7565\n\n  Summary\n\n        2000 .data\n        E000 .rdata\n        2000 .reloc\n       1D000 .text\n</code></pre> <p>\u7a0b\u5e8f\u6709\u7c7b\u4f3c\u7684 Entry Point \u5730\u5740\uff0c\u8fd8\u6709 Windows \u4e0a\u6807\u8bc6\u4e00\u4e2a\u7a0b\u5e8f\u662f\u4e0d\u662f\u56fe\u5f62\u754c\u9762\u7a0b\u5e8f\u7684\u6807\u5fd7\u3002\u8fd9\u91cc CUI \u8868\u793a\u8fd9\u4e2a\u7a0b\u5e8f\u662f Console UI\uff0c\u4e5f\u5c31\u662f\u63a7\u5236\u53f0\u7a0b\u5e8f\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u770b\u770b\u8bb0\u4e8b\u672c\u7a0b\u5e8f\u7684\u6807\u5fd7\uff1a</p> <pre><code>&gt; dumpbin /headers C:\\Windows\\System32\\notepad.exe\nMicrosoft (R) COFF/PE Dumper Version 14.28.29337.0\nCopyright (C) Microsoft Corporation.  All rights reserved.\n\n\nDump of file C:\\Windows\\System32\\notepad.exe\n\nPE signature found\n\nFile Type: EXECUTABLE IMAGE\n\nFILE HEADER VALUES\n            8664 machine (x64)\n               7 number of sections\n        86FCBD69 time date stamp\n               0 file pointer to symbol table\n               0 number of symbols\n              F0 size of optional header\n              22 characteristics\n                   Executable\n                   Application can handle large (&gt;2GB) addresses\n\nOPTIONAL HEADER VALUES\n             20B magic # (PE32+)\n           14.20 linker version\n           24A00 size of code\n            E200 size of initialized data\n               0 size of uninitialized data\n           23DB0 entry point (0000000140023DB0)\n            1000 base of code\n       140000000 image base (0000000140000000 to 0000000140037FFF)\n            1000 section alignment\n             200 file alignment\n           10.00 operating system version\n           10.00 image version\n           10.00 subsystem version\n               0 Win32 version\n           38000 size of image\n             400 size of headers\n           36BB0 checksum\n               2 subsystem (Windows GUI)\n            C160 DLL characteristics\n                   High Entropy Virtual Addresses\n                   Dynamic base\n                   NX compatible\n                   Control Flow Guard\n                   Terminal Server Aware\n           80000 size of stack reserve\n           11000 size of stack commit\n          100000 size of heap reserve\n            1000 size of heap commit\n               0 loader flags\n              10 number of directories\n# ...\n</code></pre> <p>\u8bb0\u4e8b\u672c\u4e0d\u51fa\u610f\u5916\u7684\u662f GUI \u7a0b\u5e8f\u4e86\u3002\u5982\u679c\u4f60\u597d\u5947\u6709\u4ec0\u4e48\u5176\u4ed6\u7684 Subsystem\uff0c\u53ef\u4ee5\u770b\u5fae\u8f6f\u7684\u5b98\u65b9\u6587\u6863\u3002</p>"},{"location":"basics/procedure/#\u603b\u7ed3","title":"\u603b\u7ed3","text":"<p>\u81f3\u6b64\uff0c\u53d1\u751f\u5728 <code>g++</code> \u80cc\u540e\u7684\u6545\u4e8b\u4f60\u5df2\u7ecf\u7b80\u5355\u5730\u6709\u4e86\u4e00\u4e2a\u6982\u5ff5\u3002\u7406\u89e3\u8fd9\u4e9b\u8fc7\u7a0b\u4ee5\u53ca\u539f\u7406\u662f\u6784\u5efa\u66f4\u5927\u9879\u76ee\u7684\u57fa\u7840\u3002</p>"},{"location":"basics/static-dynamic-linkage/","title":"\u9759\u6001\u94fe\u63a5\u4e0e\u52a8\u6001\u94fe\u63a5","text":"<p>\u5728\u4e0a\u4e00\u8282\u7684\u6700\u540e\uff0c\u6211\u4eec\u770b\u5230\u4e86 <code>ld</code> \u547d\u4ee4\u4e2d\u542b\u6709 <code>-static</code> \u8fd9\u4e2a\u53c2\u6570\u3002\u8fd9\u544a\u8bc9\u94fe\u63a5\u5668\uff0c\u8981\u4f7f\u7528\u9759\u6001\u94fe\u63a5\u7684\u65b9\u5f0f\u751f\u6210\u6700\u540e\u7684\u53ef\u6267\u884c\u6587\u4ef6\u3002\u65e2\u7136\u6709\u9759\u6001\u94fe\u63a5\uff0c\u5c31\u4f1a\u6709\u52a8\u6001\u94fe\u63a5\u3002\u672c\u8282\u5c06\u5e26\u4f60\u4e86\u89e3\u4e24\u8005\u7684\u5dee\u522b\uff0c\u5e76\u5c06\u5e26\u4f60\u4e86\u89e3\u5982\u4f55\u521b\u5efa\u548c\u4f7f\u7528\u9759\u6001\u5e93\u548c\u52a8\u6001\u5e93\u3002</p>"},{"location":"basics/static-dynamic-linkage/#\u9759\u6001\u94fe\u63a5","title":"\u9759\u6001\u94fe\u63a5","text":"<p>\u5982\u679c\u53ef\u6267\u884c\u6587\u4ef6\u4ee5\u9759\u6001\u94fe\u63a5\u7684\u65b9\u5f0f\u94fe\u63a5\uff0c\u8fd9\u5c31\u610f\u5473\u7740\u5728\u94fe\u63a5\u7684\u65f6\u5019\uff0c\u6240\u6709\u7b26\u53f7\u7684\u4e8c\u8fdb\u5236\u4ee3\u7801\u90fd\u4f1a\u62f7\u8d1d\u5230\u6700\u7ec8\u7684\u53ef\u6267\u884c\u6587\u4ef6\u4e2d\u3002\u4f8b\u5982\uff0c\u5047\u5982\u6211\u4eec\u4f7f\u7528\u4e86 <code>printf</code> \u8fd9\u4e2a\u51fd\u6570\uff0c\u663e\u7136\u8fd9\u4e2a\u51fd\u6570\u7684\u4e8c\u8fdb\u5236\u4ee3\u7801\u5305\u542b\u5728\u7cfb\u7edf\u5e93\u4e2d\uff0c\u4f46\u662f\u5728\u94fe\u63a5\u7684\u65f6\u5019\uff0c\u4e5f\u4f1a\u62f7\u8d1d\u5230\u53ef\u6267\u884c\u6587\u4ef6\u91cc\u3002</p> <p>\u9759\u6001\u94fe\u63a5\u7684\u505a\u6cd5\u6bd4\u8f83\u7b80\u5355\uff0c\u800c\u4e14\u751f\u6210\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u517c\u5bb9\u6027\u6bd4\u8f83\u597d\uff0c\u56e0\u4e3a\u9700\u8981\u8c03\u7528\u7684\u51fd\u6570\u90fd\u5df2\u7ecf\u5728\u6587\u4ef6\u91cc\u4e86\uff0c\u76f4\u63a5\u62f7\u8d1d\u8fd9\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\u5230\u5176\u4ed6\u76f8\u540c\u7684\u64cd\u4f5c\u7cfb\u7edf\u6267\u884c\uff0c\u4e00\u822c\u6ca1\u6709\u4ec0\u4e48\u95ee\u9898\u3002\u5f53\u7136\uff0c\u5b83\u4e5f\u6709\u7f3a\u70b9\u3002</p> <p>\u4e00\u662f\u4e8c\u8fdb\u5236\u7684\u6587\u4ef6\u5927\u5c0f\u4f1a\u53d8\u5927\u3002\u7531\u4e8e\u5c06\u6240\u6709\u7528\u5230\u7684\u4e8c\u8fdb\u5236\u4ee3\u7801\u90fd\u62f7\u8d1d\u5230\u4e86\u6587\u4ef6\u4e2d\uff0c\u96be\u514d\u4f1a\u8ba9\u6587\u4ef6\u5927\u5c0f\u81a8\u80c0\u3002</p> <p>\u4e8c\u662f\u8fd0\u884c\u65f6\u5360\u7528\u5185\u5b58\u4f1a\u66f4\u591a\u3002\u6211\u4eec\u77e5\u9053\uff0c\u4ee3\u7801\u6700\u7ec8\u90fd\u662f\u8981\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u6267\u884c\u7684\uff0c\u4e8c\u8fdb\u5236\u6587\u4ef6\u5927\u5c0f\u81a8\u80c0\u5e26\u6765\u7684\u4e00\u4e2a\u540e\u679c\u5c31\u662f\u8fd0\u884c\u7684\u65f6\u5019\u5185\u5b58\u5360\u7528\u4f1a\u66f4\u591a\u3002\u5047\u5982\u6709\u5341\u4e2a\u8fd0\u884c\u7684\u7a0b\u5e8f\u90fd\u7528\u5230\u4e86\u540c\u4e00\u4e2a\u5e93\u91cc\u7684\u540c\u6837\u7684\u51fd\u6570\uff0c\u90a3\u4e48\u8fd9\u5341\u4e2a\u7a0b\u5e8f\u4f1a\u5206\u522b\u52a0\u8f7d\u5341\u6b21\u8fd9\u4e2a\u51fd\u6570\u5230\u5185\u5b58\u4e2d\uff01</p> <p>\u4e09\u662f\u5982\u679c\u5e93\u6709\u66f4\u65b0\u7684\u8bdd\uff0c\u9700\u8981\u91cd\u65b0\u7f16\u8bd1\u94fe\u63a5\u4e8c\u8fdb\u5236\u624d\u80fd\u4f7f\u7528\u65b0\u7684\u7248\u672c\u7684\u5e93\u3002</p>"},{"location":"basics/static-dynamic-linkage/#\u521b\u5efa\u548c\u4f7f\u7528\u9759\u6001\u94fe\u63a5\u5e93","title":"\u521b\u5efa\u548c\u4f7f\u7528\u9759\u6001\u94fe\u63a5\u5e93","text":"<p>\u5728\u4e0a\u4e00\u8282\u4e2d\uff0c\u6211\u4eec\u89c1\u5230\u4e86 <code>.a</code> \u6587\u4ef6\uff0c\u8fd9\u5c31\u662f\u9759\u6001\u5e93\u6587\u4ef6\uff0c\u4e5f\u662f\uff0c\u4e0b\u9762\u8ba9\u6211\u4eec\u6765\u8bd5\u8bd5\u770b\u521b\u5efa\u4e00\u4e2a\u6211\u4eec\u7684\u9759\u6001\u5e93\u6587\u4ef6\u3002\u5047\u8bbe\u6211\u4eec\u7684\u5e93\u63d0\u4f9b\u4e86\u4e24\u4e2a\u7b80\u5355\u7684\u51fd\u6570\uff0c\u4e00\u4e2a <code>add</code> \u51fd\u6570\u548c\u4e00\u4e2a <code>sub</code> \u51fd\u6570\uff0c\u7528\u6765\u505a\u6574\u6570\u7684\u52a0\u51cf\u6cd5\u3002\u6211\u4eec\u521b\u5efa\u4e24\u4e2a\u6587\u4ef6\uff0c<code>add.cpp</code> \u548c <code>sub.cpp</code>\u3002</p> add.cppsub.cpp <pre><code>int add(int a, int b) {\n    return a + b;\n}\n</code></pre> <pre><code>int sub(int a, int b) {\n    return a - b;\n}\n</code></pre> <p>\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u5206\u522b\u7f16\u8bd1\u4e24\u4e2a\u6587\u4ef6\u5230\u76ee\u6807\u6587\u4ef6\u3002</p> <pre><code>$ g++ -c -o add.o add.cpp\n$ g++ -c -o sub.o sub.cpp\n$ ls\nadd.cpp  add.o  sub.cpp  sub.o\n</code></pre> <p>\u7136\u540e\u6211\u4eec\u4f7f\u7528 <code>ar</code> \u5de5\u5177\uff0c\u5c06\u4e24\u4e2a\u76ee\u6807\u6587\u4ef6\u5408\u5e76\u4e3a\u4e00\u4e2a <code>.a</code> \u6587\u4ef6\u3002\u8bb0\u5f97 <code>.a</code> \u6587\u4ef6\u7684\u547d\u540d\u9075\u5faa <code>libxxx.a</code> \u7684\u683c\u5f0f\uff0c\u6211\u4eec\u8fd9\u91cc\u5c31\u8d77\u540d\u4e3a <code>libmylib.a</code>\u3002</p> <pre><code>$ ar r libmylib.a add.o sub.o\nar: creating libmylib.a\n$ ls\nadd.cpp  add.o  libmylib.a  sub.cpp  sub.o\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230 <code>ar</code> \u5de5\u5177\u5e2e\u52a9\u6211\u4eec\u521b\u5efa\u4e86\u4e00\u4e2a <code>libmylib.a</code> \u6587\u4ef6\u3002\u6211\u4eec\u7528 <code>nm</code> \u5de5\u5177\u6765\u770b\u770b\u91cc\u9762\u5305\u542b\u4e86\u4ec0\u4e48\u51fd\u6570\u3002</p> <pre><code>$ nm libmylib.a\n\nadd.o:\n0000000000000000 T _Z3addii\n\nsub.o:\n0000000000000000 T _Z3subii\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u4e00\u4e2a <code>.a</code> \u6587\u4ef6\u5176\u5b9e\u5c31\u662f\u51e0\u4e2a <code>.o</code> \u6587\u4ef6\u7684\u96c6\u5408\uff0c\u5e76\u4e14\u6211\u4eec\u7684\u51fd\u6570\u4e5f\u5305\u542b\u5728\u5185\u4e86\u3002</p> <p>\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u7f16\u5199\u4e00\u4e2a\u7b80\u5355\u7684\u7a0b\u5e8f\u6765\u8c03\u7528\u6211\u4eec\u7684\u5e93\u3002\u5728\u7f16\u5199\u7a0b\u5e8f\u4e4b\u524d\uff0c\u6211\u4eec\u9700\u8981\u63d0\u4f9b\u4e00\u4e2a\u5934\u6587\u4ef6 <code>mylib.h</code> \u6765\u544a\u8bc9\u4f7f\u7528\u6211\u4eec\u7684\u5e93\u7684\u4eba\uff0c\u6211\u4eec\u7684\u5e93\u90fd\u63d0\u4f9b\u4e86\u4ec0\u4e48\u51fd\u6570\u3002\u8fd9\u4e2a\u5934\u6587\u4ef6\u4e2d\u5305\u542b\u7684\u5c31\u662f\u8fd9\u4e2a\u5e93\u7684\u63a5\u53e3\u3002\u5934\u6587\u4ef6\u4e2d\u4e0d\u9700\u8981\u5199\u51fa\u51fd\u6570\u7684\u5b9a\u4e49\uff0c\u53ea\u9700\u8981\u58f0\u660e\u51fd\u6570\u7684\u53c2\u6570\u5217\u8868\u548c\u8fd4\u56de\u503c\u5c31\u53ef\u4ee5\u4e86\u3002</p> <p>\u8fd9\u4f53\u73b0\u4e86\u5f00\u53d1\u4e2d\u7684\u5c01\u88c5\u539f\u5219\u3002\u4f7f\u7528\u6211\u4eec\u7684\u5e93\u7684\u4eba\u4e0d\u9700\u8981\u5173\u5fc3\u6211\u4eec\u7684\u5e93\u5177\u4f53\u662f\u600e\u4e48\u5b9e\u73b0\u7684\uff0c\u53ea\u9700\u8981\u77e5\u9053\u5e93\u7684\u63a5\u53e3\u5373\u53ef\u3002\u5982\u4f55\u8bbe\u8ba1\u826f\u597d\u7684\u63a5\u53e3\uff0c\u65e2\u80fd\u4f7f\u66b4\u9732\u7684\u5b9e\u73b0\u6700\u5c11\uff0c\u53c8\u80fd\u63d0\u4f9b\u6700\u5927\u7684\u7075\u6d3b\u6027\uff0c\u5c06\u662f\u9700\u8981\u4e00\u4e2a\u4e0d\u65ad\u7ec3\u4e60\u4ee5\u53ca\u4e0e\u4ed6\u4eba\u8ba8\u8bba\u7684\u8fc7\u7a0b\u3002</p> mylib.h <pre><code>#ifndef __MYLIB_H__\n#define __MYLIB_H__\nint add(int a, int b);\nint sub(int a, int b);\n#endif\n</code></pre> <p>\u5f53\u5176\u4ed6\u4eba\u60f3\u8981\u4f7f\u7528\u6211\u4eec\u7684\u5e93\u7684\u65f6\u5019\uff0c\u53ea\u9700\u8981\u5728\u7f16\u5199\u4ee3\u7801\u7684\u65f6\u5019\uff0c\u5305\u542b\u6211\u4eec\u63d0\u4f9b\u7684\u5934\u6587\u4ef6\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528\u6211\u4eec\u7684\u51fd\u6570\u4e86\u3002</p> main.cpp <pre><code>#include &lt;iostream&gt;\n#include \"mylib.h\"\nusing namespace std;\n\nint main() {\n    cout &lt;&lt; \"add(1, 2) = \" &lt;&lt; add(1, 2) &lt;&lt; endl;\n    cout &lt;&lt; \"sub(1, 2) = \" &lt;&lt; sub(1, 2) &lt;&lt; endl;\n    return 0;\n}\n</code></pre> <p>\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u5c1d\u8bd5\u7f16\u8bd1\u6211\u4eec\u7684\u7a0b\u5e8f\u3002\u8bf7\u56de\u5fc6\u4e0a\u4e00\u8282\u4e2d\u5173\u4e8e\u9884\u5904\u7406\u5668\u548c\u94fe\u63a5\u5668\u7684\u5185\u5bb9\uff0c\u6211\u4eec\u9700\u8981\u5206\u522b\u4f7f\u7528 <code>-I</code> \u9009\u9879\u544a\u8bc9\u9884\u5904\u7406\u5668\u5934\u6587\u4ef6\u5728\u4ec0\u4e48\u5730\u65b9\u4ee5\u53ca\u4f7f\u7528 <code>-L</code> \u9009\u9879\u544a\u8bc9\u94fe\u63a5\u5668\u6211\u4eec\u7684\u5e93\u6587\u4ef6\u5728\u4ec0\u4e48\u5730\u65b9\u3002\u53e6\u5916\u6211\u4eec\u8fd8\u9700\u8981\u544a\u8bc9\u4f7f\u7528 <code>-l</code> \u9009\u9879\u544a\u8bc9\u94fe\u63a5\u5668\u6211\u4eec\u5e94\u8be5\u4f7f\u7528\u4ec0\u4e48\u5e93\u3002\u56e0\u6b64\u6211\u4eec\u5e76\u4e0d\u80fd\u7b80\u5355\u5730\u4f7f\u7528 <code>g++ main.cpp</code> \u6765\u7f16\u8bd1\u7a0b\u5e8f\uff0c\u800c\u662f\u8981\u63d0\u4f9b\u6b63\u786e\u7684\u9009\u9879\u3002\u53e6\u5916\uff0c\u94fe\u63a5\u5668\u5bf9\u4e8e\u94fe\u63a5\u9009\u9879\u7684\u987a\u5e8f\u4e5f\u662f\u6709\u4e00\u5b9a\u8981\u6c42\u7684\uff0c\u7528\u5230\u4e86\u5e93\u51fd\u6570\u7684\u7a0b\u5e8f\u9700\u8981\u653e\u5728\u5e93\u7684\u524d\u9762\u3002</p> <pre><code>$ g++ -I. main.cpp -L. -lmylib\n$ ./a.out\nadd(1, 2) = 3\nsub(1, 2) = -1\n</code></pre> <p>\u6211\u4eec\u7684\u7a0b\u5e8f\u7f16\u8bd1\u901a\u8fc7\uff0c\u8fd0\u884c\u4e5f\u6b63\u5e38\uff0c\u73b0\u5728\u4f60\u5df2\u7ecf\u5b66\u4f1a\u5982\u4f55\u521b\u5efa\u5e76\u4f7f\u7528\u4e00\u4e2a\u9759\u6001\u5e93\u4e86\uff01</p> <p>\u6211\u4eec\u6765\u770b\u770b\u4f7f\u7528\u9759\u6001\u5e93\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u5927\u5c0f\uff0c\u65b9\u4fbf\u7b49\u4e00\u4e0b\u548c\u52a8\u6001\u94fe\u63a5\u4f5c\u6bd4\u8f83\uff1a</p> <pre><code>$ ls -l ./a.out\n-rwxrwxr-x 1 howard howard 17496 Jul 11 17:39 ./a.out\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u6b64\u65f6\u7684\u4e8c\u8fdb\u5236\u5927\u5c0f\u662f 17496 \u5b57\u8282\u3002</p> \u4f7f\u7528 <code>extern \"C\"</code> \u5bfc\u51fa\u51fd\u6570 <p>\u5728\u4e0a\u4e00\u8282\u7684\u7f16\u8bd1\u90e8\u5206\u4e2d\uff0c\u6211\u4eec\u63d0\u5230 C++ \u7f16\u8bd1\u5668\u4f1a\u5bf9\u51fd\u6570\u547d\u540d\u505a\u6df7\u6dc6\u5904\u7406\uff0c\u5728\u4e0a\u9762 <code>nm</code> \u7684\u8f93\u51fa\u4e2d\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u770b\u5230\u6211\u4eec\u7684 <code>add</code> \u548c <code>sub</code> \u51fd\u6570\u540d\u79f0\u524d\u540e\u9644\u5e26\u4e86\u989d\u5916\u7684\u5b57\u7b26\u3002\u56e0\u4e3a\u547d\u540d\u6df7\u6dc6\u7684\u5b9e\u73b0\u4f9d\u8d56\u4e8e\u7f16\u8bd1\u5668\u5b9e\u73b0\uff0c\u751a\u81f3\u4e0d\u540c\u7248\u672c\u7684\u7f16\u8bd1\u5668\u6df7\u6dc6\u7684\u65b9\u5f0f\u4e5f\u4e0d\u4e00\u6837\u3002\u5982\u679c\u6211\u4eec\u4f7f\u7528 C \u8bed\u8a00\u7a0b\u5e8f\u6765\u8c03\u7528\u6211\u4eec\u7684\u5e93\uff0c\u6216\u8005\u4f7f\u7528\u4e86\u6df7\u6dc6\u65b9\u5f0f\u4e0d\u540c\u7684\u7f16\u8bd1\u5668\uff0c\u90a3\u4e48\u5c31\u4f1a\u53d1\u751f\u94fe\u63a5\u9519\u8bef\u3002</p> <p>\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0cC++ \u63d0\u4f9b\u4e86 <code>extern \"C\"</code> \u7684\u8bed\u6cd5\u6765\u7981\u7528\u4e00\u4e2a\u51fd\u6570\u7684\u547d\u540d\u6df7\u6dc6\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5982\u679c\u6211\u4eec\u7684 <code>sub.cpp</code> \u8fd9\u4e48\u5199\uff1a</p> <pre><code>extern \"C\" int sub(int a, int b) {\n    return a - b;\n}\n</code></pre> <p>\u90a3\u4e48\u7f16\u8bd1\u51fa\u6765\u7684\u76ee\u6807\u6587\u4ef6\u5c06\u4e0d\u4f1a\u53d1\u751f\u547d\u540d\u6df7\u6dc6\u3002</p> <pre><code>$ g++ -c -o sub.o sub.cpp\n$ nm sub.o\n0000000000000000 T sub\n</code></pre> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6211\u4eec\u7684\u5934\u6587\u4ef6\u4e5f\u9700\u8981\u5bf9\u5e94\u5730\u5728\u51fd\u6570\u58f0\u660e\u4e0a\u6dfb\u52a0 <code>extern \"C\"</code> \u5173\u952e\u8bcd\uff0c\u8fd9\u6837\u4f7f\u7528\u5e93\u7684\u7a0b\u5e8f\u5728\u7f16\u8bd1\u65f6\u4e5f\u4e0d\u4f1a\u5c06\u51fd\u6570\u547d\u540d\u6df7\u6dc6\uff0c\u624d\u80fd\u6b63\u786e\u5730\u94fe\u63a5\u3002</p> <p>\u5f53\u7136\uff0c\u5728\u6bcf\u4e00\u4e2a\u51fd\u6570\u524d\u90fd\u52a0 <code>extern \"C\"</code> \u592a\u9ebb\u70e6\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u7528\u82b1\u62ec\u53f7\u7684\u65b9\u5f0f\u6765\u58f0\u660e\u82b1\u62ec\u53f7\u5185\u7684\u51fd\u6570\u4e0d\u8981\u8fdb\u884c\u547d\u540d\u6df7\u6dc6\u3002\u4f8b\u5982\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u5934\u6587\u4ef6\u4e2d\u5199\uff1a</p> <pre><code>#ifndef __MYLIB_H__\n#define __MYLIB_H__\nextern \"C\" {\nint add(int a, int b);\nint sub(int a, int b);\n}\n#endif\n</code></pre> <p>\u8fd9\u6837\u6240\u6709\u7684\u51fd\u6570\u90fd\u4e0d\u4f1a\u8fdb\u884c\u547d\u540d\u6df7\u6dc6\u4e86\u3002\u5f53\u7136\uff0c\u8fd9\u8fd8\u6709\u4e00\u4e2a\u95ee\u9898\uff1aC \u8bed\u8a00\u5e76\u6ca1\u6709 <code>extern \"C\"</code> \u8fd9\u4e2a\u8bed\u6cd5\uff0c\u4f7f\u7528\u6211\u4eec\u7684\u5934\u6587\u4ef6\u4f1a\u51fa\u9519\u3002\u8fd9\u65f6\u5019\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 <code>__cplusplus</code> \u8fd9\u4e2a\u5b8f\u6765\u5224\u65ad\u6211\u4eec\u7684\u7f16\u8bd1\u5668\u662f\u5426 C++ \u7f16\u8bd1\u5668\uff0c\u5982\u679c\u4e0d\u662f\u7684\u8bdd\u5c31\u4e0d\u4f7f\u7528 <code>extern \"C\"</code>\u3002</p> <pre><code>#ifndef __MYLIB_H__\n#define __MYLIB_H__\n#ifdef __cplusplus\nextern \"C\" {\n#endif\nint add(int a, int b);\nint sub(int a, int b);\n#ifdef __cplusplus\n}\n#endif\n#endif\n</code></pre> <p>\u5728\u7f16\u5199\u5e93\u7684\u65f6\u5019\uff0c\u6700\u4f73\u5b9e\u8df5\u8fd8\u662f\u4f7f\u7528 <code>extern \"C\"</code> \u6765\u4fdd\u8bc1\u6211\u4eec\u7684\u5e93\u6709\u826f\u597d\u7684\u517c\u5bb9\u6027\u3002</p> <p> \u6ce8\u610f\uff1a\u4f7f\u7528 <code>extern \"C\"</code> \u540e\uff0c\u7531\u4e8e\u6ca1\u6709\u547d\u540d\u6df7\u6dc6\uff0c\u4e5f\u5c31\u65e0\u6cd5\u4f7f\u7528\u51fd\u6570\u91cd\u8f7d\u6216\u6a21\u677f\u7b49 C++ \u529f\u80fd\u3002\u6211\u4eec\u9700\u8981\u4fdd\u8bc1\u6ca1\u6709\u540c\u540d\u51fd\u6570\uff0c\u5426\u5219\u4f1a\u53d1\u751f\u94fe\u63a5\u51b2\u7a81\u3002</p>"},{"location":"basics/static-dynamic-linkage/#\u52a8\u6001\u94fe\u63a5","title":"\u52a8\u6001\u94fe\u63a5","text":"<p>\u4e3a\u4e86\u89e3\u51b3\u9759\u6001\u94fe\u63a5\u5e26\u6765\u7684\u5927\u5c0f\u81a8\u80c0\u95ee\u9898\uff0c\u4eba\u4eec\u63d0\u51fa\u4e86\u52a8\u6001\u94fe\u63a5\u7684\u65b9\u6cd5\uff0c\u5728\u7f16\u8bd1\u7684\u65f6\u5019\u5e76\u4e0d\u5c06\u5e93\u51fd\u6570\u7684\u4e8c\u8fdb\u5236\u4ee3\u7801\u62f7\u8d1d\u5230\u53ef\u6267\u884c\u6587\u4ef6\u4e2d\uff0c\u800c\u662f\u4ec5\u4ec5\u8bb0\u5f55\u4e0b\u6765\u8fd9\u4e2a\u51fd\u6570\u5e94\u8be5\u5230\u4ec0\u4e48\u6587\u4ef6\u4e2d\u53bb\u5bfb\u627e\u3002\u8fd0\u884c\u7684\u65f6\u5019\uff0c\u9700\u8981\u8c03\u7528\u8fd9\u4e2a\u51fd\u6570\u7684\u65f6\u5019\uff0c\u518d\u7531\u64cd\u4f5c\u7cfb\u7edf\u6765\u5e2e\u6211\u4eec\u53bb\u52a0\u8f7d\u5bf9\u5e94\u7684\u4e8c\u8fdb\u5236\u4ee3\u7801\u3002\u8fd9\u79cd\u5728\u8fd0\u884c\u65f6\u624d\u771f\u6b63\u52a0\u8f7d\u4e8c\u8fdb\u5236\u4ee3\u7801\u7684\u65b9\u5f0f\u5c31\u53eb\u52a8\u6001\u94fe\u63a5\u3002\u800c\u52a8\u6001\u94fe\u63a5\u9700\u8981\u94fe\u63a5\u5230\u5171\u4eab\u5e93\uff08Shared Library\uff09\uff0cWindows \u4e0a\u5e38\u89c1\u7684 <code>.dll</code> \u4ee5\u53ca Linux \u4e0a\u89c1\u5230\u7684 <code>.so</code> \u6587\u4ef6\u5c31\u662f\u7a0b\u5e8f\u8fd0\u884c\u7684\u52a8\u6001\u5e93\u4e86\u3002\u8fd9\u4e5f\u662f\u4e3a\u4ec0\u4e48\u6709\u65f6\u5019\u6211\u4eec\u8fd0\u884c\u7a0b\u5e8f\u7684\u65f6\u5019\uff0c\u5982\u679c\u6ca1\u6709\u5b89\u88c5\u597d\u8fd0\u884c\u65f6\u5e93\uff0c\u4f1a\u63d0\u793a\u201c\u7f3a\u5c11 xxx.dll\u201d\u800c\u65e0\u6cd5\u8fd0\u884c\u3002</p> <p>\u52a8\u6001\u94fe\u63a5\u89e3\u51b3\u4e86\u9759\u6001\u94fe\u63a5\u7684\u6587\u4ef6\u5927\u5c0f\u81a8\u80c0\u548c\u5185\u5b58\u5360\u7528\u589e\u591a\u7684\u95ee\u9898\u3002\u4e00\u65b9\u9762\uff0c\u53ef\u6267\u884c\u6587\u4ef6\u4e2d\u4e0d\u518d\u5305\u542b\u4e8c\u8fdb\u5236\u4ee3\u7801\uff0c\u53e6\u4e00\u65b9\u9762\uff0c\u4e0d\u540c\u7684\u8fdb\u7a0b\u53ef\u4ee5\u5171\u4eab\u540c\u6837\u7684\u51fd\u6570\u3002\u4f8b\u5982\uff0c\u5047\u5982\u6211\u4eec\u6709\u5341\u4e2a\u8fdb\u7a0b\u90fd\u7528\u5230\u4e86 <code>printf</code> \u8fd9\u4e2a\u51fd\u6570\uff0c\u90a3\u4e48\u8fd9\u5341\u4e2a\u8fdb\u7a0b\u53ef\u4ee5\u5171\u4eab\u5185\u5b58\u4e2d\u7684\u540c\u4e00\u4efd\u4e8c\u8fdb\u5236\u4ee3\u7801\uff0c\u800c\u4e0d\u5fc5\u91cd\u590d\u52a0\u8f7d\u4ee3\u7801\u5230\u5185\u5b58\u4e2d\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4f1a\u5904\u7406\u5171\u4eab\u7684\u7ec6\u8282\u3002</p> \u4f4d\u7f6e\u65e0\u5173\u4ee3\u7801 <p>\u7531\u4e8e\u52a8\u6001\u94fe\u63a5\uff0c\u8fd0\u884c\u65f6\u4e8c\u8fdb\u5236\u4ee3\u7801\u4f1a\u88ab\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u7684\u54ea\u4e2a\u4f4d\u7f6e\u662f\u5b8c\u5168\u4e0d\u77e5\u9053\u7684\u3002\u56e0\u6b64\uff0c\u52a8\u6001\u94fe\u63a5\u5e93\u4e2d\u7684\u4e8c\u8fdb\u5236\u4ee3\u7801\u5fc5\u987b\u88ab\u7f16\u8bd1\u6210\u4f4d\u7f6e\u65e0\u5173\u7684\u4ee3\u7801\uff08Position-Independent Code\uff09\u3002\u4f8b\u5982\uff0c\u5728\u9759\u6001\u94fe\u63a5\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u6307\u5b9a\u4e00\u4e2a\u53d8\u91cf <code>a</code> \u7684\u5730\u5740\u4e3a <code>0x1234</code>\uff0c\u4e4b\u540e\u9700\u8981\u4f7f\u7528 <code>a</code> \u7684\u503c\u7684\u8bdd\u53ea\u9700\u8981\u4f7f\u7528 <code>0x1234</code> \u8fd9\u4e2a\u5730\u5740\u3002\u4f46\u662f\u52a8\u6001\u94fe\u63a5\u7684\u8bdd\uff0c\u6211\u4eec\u65e0\u6cd5\u77e5\u9053\u5e93\u4f1a\u88ab\u52a0\u8f7d\u5230\u8fdb\u7a0b\u5185\u5b58\u7a7a\u95f4\u7684\u54ea\u4e2a\u5730\u5740\u4e0a\uff0c\u800c\u4e14\u4e0d\u540c\u8fdb\u7a0b\u52a0\u8f7d\u7684\u5730\u5740\u53ef\u80fd\u5b8c\u5168\u4e0d\u540c\u3002\u5f53\u7136\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba9\u52a0\u8f7d\u5668\u5728\u52a0\u8f7d\u7684\u65f6\u5019\u628a\u6240\u6709\u7684\u5730\u5740\u90fd\u66ff\u6362\u4e00\u904d\uff0c\u4f46\u5982\u679c\u6bcf\u6b21\u52a0\u8f7d\u90fd\u9700\u8981\u4fee\u6539\u5e93\u91cc\u7684\u5730\u5740\u7684\u8bdd\uff0c\u5f00\u9500\u4f1a\u975e\u5e38\u5927\u3002\u8fd9\u65f6\u5019\u6211\u4eec\u5c31\u9700\u8981\u5e93\u51fd\u6570\u4e0d\u80fd\u4f9d\u8d56\u7edd\u5bf9\u5730\u5740\uff0c\u800c\u662f\u9700\u8981\u5c06\u6240\u6709\u5730\u5740\u7f16\u7801\u4e3a\u76f8\u5bf9\u7684\u5730\u5740\u3002\u4f8b\u5982\uff0c\u53ef\u4ee5\u5c06\u5730\u5740\u7f16\u7801\u4e3a\u76f8\u5bf9\u4e8e\u76ee\u524d\u6307\u4ee4\u7684\u5730\u5740\u7684\u504f\u79fb\u3002\u8fd9\u6837\u7684\u4ee3\u7801\u5c31\u80fd\u5728\u4e0d\u505a\u4fee\u6539\u7684\u60c5\u51b5\u4e0b\u88ab\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u7684\u4efb\u4f55\u5730\u5740\u4e86\u3002</p> \u52a8\u6001\u94fe\u63a5\u5e93\u8fd0\u884c\u65f6\u52a0\u8f7d\u7684\u8fc7\u7a0b <p>\u5728\u52a8\u6001\u94fe\u63a5\u7684\u4e8c\u8fdb\u5236\u91cc\uff0c\u5b58\u5728\u7740 PLT\uff08Procedure Linkage Table\uff09\u4e0e GOT\uff08Global Offset Table\uff09\u4e24\u5f20\u8868\u3002\u5728\u7a0b\u5e8f\u542f\u52a8\u65f6\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4f1a\u53bb\u5c06\u52a8\u6001\u5e93\u6620\u5c04\u5230\u8fdb\u7a0b\u7684\u5730\u5740\u7a7a\u95f4\u4e2d\uff0c\u5e76\u5c06\u51fd\u6570\u7684\u5730\u5740\u586b\u5165 GOT \u8868\u4e2d\u3002\u52a8\u6001\u94fe\u63a5\u7684\u51fd\u6570\u5728\u8c03\u7528\u7684\u65f6\u5019\uff0c\u4f1a\u67e5\u627e GOT \u4e2d\u7b26\u53f7\u5bf9\u5e94\u7684\u5730\u5740\u5e76\u8df3\u8f6c\u8fc7\u53bb\u3002</p> <p>\u4e3a\u4e86\u52a0\u5feb\u7a0b\u5e8f\u542f\u52a8\u7684\u901f\u5ea6\uff0c\u64cd\u4f5c\u7cfb\u7edf\u5e76\u4e0d\u4f1a\u4e00\u6b21\u5c31\u5c06\u6240\u6709\u51fd\u6570\u52a0\u8f7d\u8fdb\u6765\uff0c\u800c\u662f\u5728 GOT \u8868\u4e2d\uff0c\u586b\u5165 PLT \u8868\u7684\u5730\u5740\uff0c\u5728\u7b2c\u4e00\u6b21\u8c03\u7528\u51fd\u6570\u65f6\uff0c\u4e0d\u4f1a\u76f4\u63a5\u8c03\u7528\u5230\u51fd\u6570\u672c\u8eab\uff0c\u800c\u662f PLT \u7684\u9ed8\u8ba4\u4ee3\u7801\u3002PLT \u7684\u4ee3\u7801\u4f1a\u53bb\u8c03\u7528\u64cd\u4f5c\u7cfb\u7edf\u7684\u51fd\u6570\uff0c\u52a0\u8f7d\u5bf9\u5e94\u7b26\u53f7\u7684\u5730\u5740\uff0c\u5e76\u6539\u5199 GOT \u8868\uff0c\u5c06\u5bf9\u5e94\u7684\u5730\u5740\u4ece PLT \u9ed8\u8ba4\u8868\u9879\u6539\u4e3a\u51fd\u6570\u5b9e\u9645\u7684\u5730\u5740\uff0c\u5b9e\u73b0\u61d2\u52a0\u8f7d\u7684\u8fc7\u7a0b\u3002</p> <p>\u8fd9\u4e5f\u4f53\u73b0\u4e86\u4e00\u4e2a\u7ecf\u5178\u539f\u5219\uff1a\u8ba1\u7b97\u673a\u7684\u6240\u6709\u95ee\u9898\u90fd\u53ef\u4ee5\u901a\u8fc7\u589e\u52a0\u4e00\u5c42\u95f4\u63a5\u6027\u6765\u89e3\u51b3\u3002</p> <p>\u5f53\u7136\uff0c\u52a8\u6001\u94fe\u63a5\u4e5f\u6709\u5b83\u81ea\u5df1\u7684\u95ee\u9898\u3002\u9996\u5148\uff0c\u7531\u4e8e\u8c03\u7528\u51fd\u6570\u9700\u8981\u5148\u67e5\u8868\u518d\u8df3\u8f6c\uff0c\u8fd0\u884c\u7684\u6027\u80fd\u4f1a\u6709\u4e00\u4e9b\u635f\u5931\u3002\u800c\u4e14\uff0c\u7531\u4e8e\u52a8\u6001\u5e93\u5fc5\u987b\u7f16\u8bd1\u4e3a PIC\uff0c\u6240\u6709\u7684\u7edd\u5bf9\u5bfb\u5740\u6307\u4ee4\u90fd\u4f1a\u53d8\u4e3a\u76f8\u5bf9\u5bfb\u5740\u6307\u4ee4\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u8fd0\u884c\u6548\u7387\u4e0b\u964d\uff0c\u4e0d\u8fc7\u73b0\u4ee3 CPU \u5bf9 PIC \u90fd\u6709\u8f83\u597d\u7684\u652f\u6301\uff0c\u53ef\u4ee5\u5ffd\u7565\u4e0d\u8ba1\u3002\u53e6\u5916\uff0c\u7531\u4e8e\u662f\u5728\u7a0b\u5e8f\u8fd0\u884c\u65f6\u624d\u52a0\u8f7d\u7684\u5e93\uff0c\u8fd9\u5c31\u9700\u8981\u5728\u53d1\u5e03\u7a0b\u5e8f\u65f6\uff0c\u4e5f\u8981\u5c06\u7a0b\u5e8f\u4f9d\u8d56\u7684\u52a8\u6001\u5e93\u4e00\u5e76\u53d1\u5e03\uff0c\u5982\u679c\u53ea\u53d1\u5e03\u4e8c\u8fdb\u5236\uff0c\u5c31\u9700\u8981\u7528\u6237\u81ea\u5df1\u5b89\u88c5\u597d\u5bf9\u5e94\u7684\u8fd0\u884c\u65f6\u5e93\uff0c\u4f8b\u5982\uff0c\u6211\u4eec\u5728 Steam \u5b89\u88c5\u6e38\u620f\u540e\uff0c\u5f80\u5f80\u8fd8\u9700\u8981\u5b89\u88c5 <code>Microsoft VC++ Redistributable</code>\uff0c\u5176\u5b9e\u5c31\u662f\u5b89\u88c5\u8fd9\u4e2a\u6e38\u620f\u9700\u8981\u7684\u52a8\u6001\u5e93\u3002\u6700\u540e\uff0c\u7531\u4e8e\u5404\u4e2a\u7a0b\u5e8f\u4f9d\u8d56\u7684\u52a8\u6001\u5e93\u7248\u672c\u53ef\u80fd\u4e0d\u540c\uff0c\u5728\u5b89\u88c5\u65f6\u5982\u679c\u4e92\u76f8\u8986\u76d6\u4e86\u52a8\u6001\u5e93\uff0c\u5c31\u4f1a\u9020\u6210\u4e25\u91cd\u7684\u95ee\u9898\uff0c\u751a\u81f3\u53ef\u80fd\u5bfc\u81f4\u5176\u4ed6\u7a0b\u5e8f\u65e0\u6cd5\u6b63\u5e38\u8fd0\u884c\u3002\u53e6\u5916\uff0c\u5728\u7a0b\u5e8f\u5378\u8f7d\u7684\u65f6\u5019\uff0c\u5982\u679c\u5220\u9664\u4e86\u4e00\u4e2a\u52a8\u6001\u5e93\uff0c\u90a3\u4e5f\u4f1a\u9020\u6210\u5176\u4ed6\u7a0b\u5e8f\u65e0\u6cd5\u8fd0\u884c\u3002</p> DLL Hell <p>\u5728 Windows \u4e0a\uff0c\u66fe\u7ecf\u6709\u8fc7\u8457\u540d\u7684 DLL Hell \u95ee\u9898\u3002\u5728\u65e9\u671f\uff0c\u8ba1\u7b97\u673a\u7684\u5185\u5b58\u8fd8\u6bd4\u8f83\u5c0f\uff0c\u6240\u4ee5\u4f7f\u7528\u52a8\u6001\u94fe\u63a5\u5e93\u5341\u5206\u53d7\u6b22\u8fce\u3002\u540c\u65f6\uff0c\u5fae\u8f6f\u5728\u65e9\u671f\u7684 Windows \u7248\u672c\u4e2d\uff0c\u5141\u8bb8\u5e76\u9f13\u52b1\u8f6f\u4ef6\u5b89\u88c5\u52a8\u6001\u5e93\u65f6\uff0c\u76f4\u63a5\u5b89\u88c5\u5230\u7cfb\u7edf\u5171\u4eab\u7684\u76ee\u5f55\u4e2d\u3002\u8bb8\u591a\u5b89\u88c5\u5668\u5e76\u4e0d\u4f1a\u68c0\u67e5\u5df2\u6709\u7684 DLL \u7248\u672c\u3002\u8fd9\u5c31\u5f88\u5bb9\u6613\u53d1\u751f\u52a8\u6001\u5e93\u4e92\u76f8\u8986\u76d6\u7684\u95ee\u9898\u3002\u800c\u4e14\u7531\u4e8e\u5fae\u8f6f\u7684\u8bbe\u8ba1\u5931\u8bef\uff0cDLL \u5e76\u6ca1\u6709\u5f88\u597d\u7684\u517c\u5bb9\u6027\uff0c\u4e00\u4e2a\u5c0f\u5c0f\u7684\u6539\u52a8\u53ef\u80fd\u4f1a\u4f7f DLL \u6587\u4ef6\u53d1\u751f\u5de8\u5927\u7684\u53d8\u5316\uff0c\u4f7f\u5f97\u7a0b\u5e8f\u65e0\u6cd5\u6b63\u5e38\u8fd0\u884c\u3002\u5047\u5982\u7a0b\u5e8f A \u4f7f\u7528\u4e86 2.0 \u7248\u672c\u7684 DLL\uff0c\u7a0b\u5e8f B \u4f7f\u7528\u4e86 1.0 \u7248\u672c\u7684 DLL\uff0c\u5982\u679c\u5148\u542f\u52a8\u7a0b\u5e8f B\uff0c\u90a3\u4e48\u5c31\u4f1a\u52a0\u8f7d\u65e7\u7248 DLL \u5230\u5185\u5b58\u4e2d\uff0c\u7b49\u7a0b\u5e8f A \u542f\u52a8\u7684\u65f6\u5019\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4e3a\u4e86\u8282\u7701\u5185\u5b58\uff0c\u4f1a\u5c06 1.0 \u7248\u672c\u7684 DLL \u6620\u5c04\u7ed9\u7a0b\u5e8f A\uff0c\u8fd9\u6837\u4e5f\u4f1a\u5bfc\u81f4\u7a0b\u5e8f A \u65e0\u6cd5\u6b63\u5e38\u8fd0\u884c\u3002</p> <p>Windows \u540e\u6765\u4e5f\u89e3\u51b3\u4e86\u8fd9\u4e2a\u95ee\u9898\uff0c\u4e00\u4e2a\u65b9\u6cd5\u662f\u4fdd\u62a4\u7cfb\u7edf\u7684 DLL \u4e0d\u88ab\u4fee\u6539\uff0c\u53e6\u4e00\u4e2a\u65b9\u6cd5\u662f\u4f7f\u7528 WinSxS \u6280\u672f\uff0c\u5728\u7cfb\u7edf\u91cc\u5b58\u653e DLL \u7684\u4e0d\u540c\u7248\u672c\uff0c\u5c3d\u7ba1\u5e94\u7528\u7a0b\u5e8f\u8fd8\u662f\u4f1a\u7528\u540c\u4e00\u4e2a\u540d\u5b57\u6765\u52a0\u8f7d DLL\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4f1a\u68c0\u67e5\u7248\u672c\u5e76\u52a0\u8f7d\u6b63\u786e\u7684\u4e8c\u8fdb\u5236\u4ee3\u7801\u3002\u8fd8\u6709\u4e00\u4e2a\u529e\u6cd5\u5c31\u662f\u76f4\u63a5\u5728 DLL \u6587\u4ef6\u540d\u52a0\u4e0a\u7248\u672c\u53f7\uff0c\u8fd9\u6837\u4e0d\u540c\u7248\u672c\u7684 DLL \u5c31\u4e0d\u518d\u662f\u540c\u4e00\u4e2a DLL \u4e86\u3002</p> <p>Linux \u89e3\u51b3 DLL Hell \u7684\u529e\u6cd5\u6709\u4e24\u4e2a\uff0c\u4e00\u4e2a\u662f <code>.so</code> \u6587\u4ef6\u4f1a\u5e26\u6709\u7248\u672c\u53f7\u3002\u5176\u6b21\uff0c\u5927\u591a\u6570 Linux \u8f6f\u4ef6\u53d1\u5e03\u7684\u65f6\u5019\u90fd\u4f1a\u63d0\u4f9b\u6e90\u4ee3\u7801\uff0c\u7528\u6237\u53ef\u4ee5\u81ea\u5df1\u7f16\u8bd1\u3002\u6700\u540e\uff0c\u5927\u591a\u6570 Linux \u53d1\u884c\u7248\u90fd\u5e26\u6709\u5305\u7ba1\u7406\u8f6f\u4ef6\u6765\u7ba1\u7406\u8f6f\u4ef6\u7684\u4f9d\u8d56\uff0c\u5728\u5b89\u88c5\u8f6f\u4ef6\u65f6\u5c31\u68c0\u67e5\u4f9d\u8d56\u95ee\u9898\uff0c\u907f\u514d\u4e86 DLL Hell\u3002</p>"},{"location":"basics/static-dynamic-linkage/#\u521b\u5efa\u548c\u4f7f\u7528\u52a8\u6001\u94fe\u63a5\u5e93","title":"\u521b\u5efa\u548c\u4f7f\u7528\u52a8\u6001\u94fe\u63a5\u5e93","text":"<p>\u6211\u4eec\u8fd8\u662f\u4ee5 <code>add.cpp</code> \u548c <code>sub.cpp</code> \u4e3a\u4f8b\uff0c\u521b\u5efa\u52a8\u6001\u5e93\u4e0d\u9700\u8981\u6211\u4eec\u5bf9\u4ee3\u7801\u505a\u4efb\u4f55\u4fee\u6539\uff0c\u53ea\u9700\u8981\u4fee\u6539\u7f16\u8bd1\u547d\u4ee4\u5373\u53ef\u3002\u9996\u5148\u6211\u4eec\u9700\u8981\u5c06\u4e24\u4e2a\u6587\u4ef6\u7f16\u8bd1\u4e3a PIC \u76ee\u6807\u6587\u4ef6\u3002\u6211\u4eec\u53ea\u9700\u8981\u5728\u7f16\u8bd1\u7684\u65f6\u5019\u6dfb\u52a0 <code>-fPIC</code> \u9009\u9879\u5373\u53ef\u3002\u4e3a\u4e86\u65b9\u4fbf\u4f60\u590d\u5236\u7c98\u8d34\uff0c\u6211\u4e5f\u5c06\u4e0a\u9762\u7684\u4ee3\u7801\u62f7\u8d1d\u4e00\u4efd\u5230\u4e0b\u9762\u6765\u3002</p> add.cppsub.cppmylib.hmain.cpp <pre><code>int add(int a, int b) {\n    return a + b;\n}\n</code></pre> <pre><code>int sub(int a, int b) {\n    return a - b;\n}\n</code></pre> <pre><code>#ifndef __MYLIB_H__\n#define __MYLIB_H__\nint add(int a, int b);\nint sub(int a, int b);\n#endif\n</code></pre> <pre><code>#include &lt;iostream&gt;\n#include \"mylib.h\"\nusing namespace std;\n\nint main() {\n    cout &lt;&lt; \"add(1, 2) = \" &lt;&lt; add(1, 2) &lt;&lt; endl;\n    cout &lt;&lt; \"sub(1, 2) = \" &lt;&lt; sub(1, 2) &lt;&lt; endl;\n    return 0;\n}\n</code></pre> <pre><code>$ g++ -fPIC -c -o add.o add.cpp\n$ g++ -fPIC -c -o sub.o sub.cpp\n</code></pre> <p>\u548c\u521b\u5efa\u9759\u6001\u5e93\u4e0d\u540c\uff0c\u6211\u4eec\u4e0d\u4f7f\u7528 <code>ar</code> \u5de5\u5177\u6765\u521b\u5efa\u5e93\u6587\u4ef6\uff0c\u800c\u662f\u4f7f\u7528 <code>ld</code> \u5de5\u5177\u6765\u521b\u5efa\u52a8\u6001\u5e93\u3002\u52a8\u6001\u5e93\u7684\u547d\u540d\u89c4\u5219\u548c <code>.a</code> \u6587\u4ef6\u7684\u547d\u540d\u89c4\u5219\u4e00\u6837\uff0c\u53ea\u662f\u540e\u7f00\u540d\u53d8\u4e3a <code>.so</code>\u3002\u94fe\u63a5\u5668\u94fe\u63a5\u65f6\u540c\u6837\u4f1a\u5c1d\u8bd5\u5bfb\u627e\u540d\u5b57\u76f8\u540c\u7684 <code>.so</code> \u6587\u4ef6\u3002\u4f8b\u5982\uff0c<code>-lmylib</code> \u4e5f\u4f1a\u8ba9\u94fe\u63a5\u5668\u627e\u5230 <code>libmylib.so</code>\u3002</p> <pre><code>$ ld -shared -o libmylib.so add.o sub.o\n</code></pre> <p>\u4f7f\u7528 <code>readelf</code> \u5de5\u5177\u53ef\u4ee5\u770b\u5230\uff0c\u6211\u4eec\u7684 <code>libmylib.so</code> \u662f\u52a8\u6001\u5e93\u7c7b\u578b\u4e86\u3002\u5e76\u4e14 <code>nm</code> \u5de5\u5177\u4e5f\u5c55\u793a\u4e86\u5176\u4e2d\u5305\u542b\u7684\u7b26\u53f7\u3002\u53ef\u4ee5\u770b\u5230\uff0c<code>.so</code> \u6587\u4ef6\u5e76\u4e0d\u662f\u7b80\u5355\u7684 <code>.o</code> \u6587\u4ef6\u7684\u96c6\u5408\uff0c\u5176\u4e2d\u7684\u51fd\u6570\u5730\u5740\u7ecf\u8fc7\u4e86\u4fee\u6539\u3002</p> <pre><code>$ readelf -h libmylib.so\nELF Header:\n  Magic:   7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00\n  Class:                             ELF64\n  Data:                              2's complement, little endian\n  Version:                           1 (current)\n  OS/ABI:                            UNIX - System V\n  ABI Version:                       0\n  Type:                              DYN (Shared object file)\n  Machine:                           Advanced Micro Devices X86-64\n  Version:                           0x1\n  Entry point address:               0x1000\n  Start of program headers:          64 (bytes into file)\n  Start of section headers:          12872 (bytes into file)\n  Flags:                             0x0\n  Size of this header:               64 (bytes)\n  Size of program headers:           56 (bytes)\n  Number of program headers:         9\n  Size of section headers:           64 (bytes)\n  Number of section headers:         13\n  Section header string table index: 12\n$ nm libmylib.so\n0000000000003f40 d _DYNAMIC\n0000000000001000 T _Z3addii\n0000000000001018 T _Z3subii\n</code></pre> <p>\u548c\u4f7f\u7528\u9759\u6001\u5e93\u4e00\u6837\uff0c\u6211\u4eec\u5728\u7a0b\u5e8f\u4e2d\u5305\u542b\u5e93\u7684\u5934\u6587\u4ef6\uff0c\u7136\u540e\u4f7f\u7528\u540c\u6837\u7684\u547d\u4ee4\u7f16\u8bd1\u5373\u53ef\u3002</p> <pre><code>$ g++ -I. main.cpp -L. -lmylib\n$ ./a.out\n./a.out: error while loading shared libraries: libmylib.so: cannot open shared object file: No such file or directory$ ./a.out\n</code></pre> <p>\u5c3d\u7ba1\u7f16\u8bd1\u6210\u529f\u4e86\uff0c\u4f46\u662f\u8fd0\u884c\u7684\u65f6\u5019\u5374\u63d0\u793a\u627e\u4e0d\u5230 <code>libmylib.so</code>\uff0c\u8fd9\u662f\u4e3a\u4ec0\u4e48\u5462\uff1f\u5f88\u5feb\u6211\u4eec\u5c31\u4f1a\u77e5\u9053\u5176\u4e2d\u7684\u539f\u7406\uff0c\u73b0\u5728\u6211\u4eec\u7b80\u5355\u7406\u89e3\u4e3a\u7cfb\u7edf\u9ed8\u8ba4\u5e76\u4e0d\u4f1a\u5728\u6211\u4eec\u7684\u6587\u4ef6\u5939\u91cc\u5bfb\u627e\u5171\u4eab\u5e93\uff0c\u8fd9\u4e2a\u662f\u7531 <code>LD_LIBRARY_PATH</code> \u73af\u5883\u53d8\u91cf\u51b3\u5b9a\u7684\u3002\u6211\u4eec\u5c06\u5f53\u524d\u76ee\u5f55\u52a0\u5165\u5230\u8fd9\u4e2a\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u7136\u540e\u518d\u8fd0\u884c\u7a0b\u5e8f\u3002</p> <pre><code>$ LD_LIBRARY_PATH=$(pwd):$LD_LIBRARY_PATH ./a.out\nadd(1, 2) = 3\nsub(1, 2) = -1\n</code></pre> <p>\u7a0b\u5e8f\u6b63\u786e\u5730\u8fd0\u884c\u8d77\u6765\u4e86\uff01\u73b0\u5728\uff0c\u4f60\u4e5f\u5b66\u4f1a\u4e86\u5982\u4f55\u521b\u5efa\u5e76\u4f7f\u7528\u4e00\u4e2a\u52a8\u6001\u5e93\u4e86\u3002</p> <p>\u6211\u4eec\u6765\u770b\u770b\u4f7f\u7528\u52a8\u6001\u94fe\u63a5\u5e93\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u5927\u5c0f\uff1a</p> <pre><code>$ ls -l ./a.out\n-rwxrwxr-x 1 howard howard 17432 Jul 11 17:52 ./a.out\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u6b64\u65f6\u7684\u4e8c\u8fdb\u5236\u5927\u5c0f\u662f 17432 \u5b57\u8282\uff0c\u6bd4\u4f7f\u7528\u9759\u6001\u94fe\u63a5\u5e93\u7684\u4e8c\u8fdb\u5236\u5c0f\u4e86 64 \u5b57\u8282\u3002</p> \u4f7f\u7528 <code>ldd</code> \u67e5\u770b\u7a0b\u5e8f\u4f9d\u8d56\u54ea\u4e9b\u52a8\u6001\u5e93 <p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 <code>ldd</code> \u547d\u4ee4\u6765\u67e5\u770b\u6211\u4eec\u7684\u7a0b\u5e8f\u4f9d\u8d56\u4ec0\u4e48\u52a8\u6001\u5e93\u3002</p> <pre><code>$ ldd a.out                            \n    linux-vdso.so.1 (0x00007fff77fe7000)\n    libmylib.so (0x00007fd011dc7000)\n    libstdc++.so.6 =&gt; /lib/x86_64-linux-gnu/libstdc++.so.6 (0x00007fd011bc5000)\n    libc.so.6 =&gt; /lib/x86_64-linux-gnu/libc.so.6 (0x00007fd0119db000)\n    libm.so.6 =&gt; /lib/x86_64-linux-gnu/libm.so.6 (0x00007fd01188c000)\n    /lib64/ld-linux-x86-64.so.2 (0x00007fd011dd2000)\n    libgcc_s.so.1 =&gt; /lib/x86_64-linux-gnu/libgcc_s.so.1 (0x00007fd011871000)\n</code></pre> \u4e0d\u8981 <code>ldd</code> \u4e0d\u4fe1\u4efb\u7684\u6587\u4ef6 <p><code>ldd</code> \u547d\u4ee4\u5b9e\u9645\u4e0a\u662f\u4f1a\u52a0\u8f7d\u53ef\u6267\u884c\u6587\u4ef6\u5e76\u6a21\u62df\u6267\u884c\u6d41\u7a0b\u7684\uff0c\u6076\u610f\u4ee3\u7801\u53ef\u80fd\u4f1a\u653b\u51fb\u4f60\u7684\u7cfb\u7edf\u3002\u56e0\u6b64\u4e0d\u8981\u5728\u4f60\u4e0d\u4fe1\u4efb\u7684\u6587\u4ef6\u4e0a\u6267\u884c <code>ldd</code> \u547d\u4ee4\u3002</p> Tip <p>\u5982\u679c\u4f60\u597d\u5947\u5c1d\u8bd5\u4e86\u7684\u8bdd\uff0c\u4f1a\u53d1\u73b0\u5373\u4f7f\u4e0a\u9762\u7f16\u8bd1\u76ee\u6807\u6587\u4ef6\u7684\u65f6\u5019\u6ca1\u6709\u6dfb\u52a0 <code>-fPIC</code> \u9009\u9879\uff0c\u4e5f\u80fd\u6b63\u5e38\u751f\u6210\u52a8\u6001\u5e93\u3002\u8fd9\u662f\u56e0\u4e3a\u6211\u4eec\u7684\u51fd\u6570\u5e76\u6ca1\u6709\u4f7f\u7528\u5230\u5168\u5c40\u7684\u6570\u636e\u5730\u5740\uff0c\u4e8b\u5b9e\u4e0a\uff0c\u90a3\u4e24\u4e2a\u51fd\u6570\u7684\u53c2\u6570\u4f1a\u76f4\u63a5\u901a\u8fc7\u5bc4\u5b58\u5668\u4f20\u9012\u3002\u4e3a\u4e86\u6f14\u793a <code>-fPIC</code> \u7684\u5fc5\u8981\u6027\uff0c\u6211\u4eec\u53ef\u4ee5\u4fee\u6539 <code>sub.cpp</code> \u4e3a\u4ee5\u4e0b\u4ee3\u7801\u3002</p> sub.cpp <pre><code>int constant = 42;\n\nint sub(int a, int b) {\n    return a - b;\n}\n\nint sub42(int a) {\n    return a - constant;\n}\n</code></pre> <p>\u6b64\u65f6\u6211\u4eec\u4e0d\u5e26 <code>-fPIC</code> \u7f16\u8bd1\u4e00\u904d <code>sub.cpp</code>\uff0c\u5e76\u5c1d\u8bd5\u4f7f\u7528 <code>ld</code> \u751f\u6210\u52a8\u6001\u5e93\u3002</p> <pre><code>$ g++ -c -o sub.o sub.cpp\n$ ld -shared -o libmylib.so sub.o add.o\nld: sub.o: warning: relocation against `constant' in read-only section `.text'\nld: sub.o: relocation R_X86_64_PC32 against symbol `constant' can not be used when making a shared object; recompile with -fPIC\nld: final link failed: bad value\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u6b64\u65f6 <code>ld</code> \u63d0\u793a <code>constant</code> \u8fd9\u4e2a\u53d8\u91cf\u65e0\u6cd5\u91cd\u65b0\u5b9a\u4f4d\uff0c\u9700\u8981\u6211\u4eec\u7528 <code>-fPIC</code> \u9009\u9879\u91cd\u65b0\u7f16\u8bd1\u3002</p>"},{"location":"basics/static-dynamic-linkage/#\u603b\u7ed3","title":"\u603b\u7ed3","text":"<p>\u672c\u8282\u4ecb\u7ecd\u4e86\u9759\u6001\u94fe\u63a5\u4e0e\u52a8\u6001\u94fe\u63a5\u7684\u533a\u522b\u4ee5\u53ca\u5982\u4f55\u521b\u5efa\u548c\u4f7f\u7528\u9759\u6001\u5e93\u548c\u52a8\u6001\u5e93\u3002\u6211\u4eec\u65e0\u6cd5\u9759\u6001\u94fe\u63a5\u5230\u4e00\u4e2a\u52a8\u6001\u5e93\uff0c\u4e5f\u65e0\u6cd5\u52a8\u6001\u94fe\u63a5\u5230\u4e00\u4e2a\u9759\u6001\u5e93\u3002\u5982\u679c\u4f7f\u7528\u9759\u6001\u5e93\uff0c\u90a3\u4e48\u53ea\u9700\u8981\u5728\u5f00\u53d1\u7684\u65f6\u5019\u7528\u5230\u5e93\u6587\u4ef6\u3002\u5982\u679c\u4f7f\u7528\u52a8\u6001\u5e93\uff0c\u6211\u4eec\u5728\u5f00\u53d1\u548c\u8fd0\u884c\u65f6\u90fd\u9700\u8981\u7528\u5230\u5e93\u6587\u4ef6\u3002</p> <p>\u5728\u94fe\u63a5\u65f6\uff0c\u4e00\u90e8\u5206\u5e93\u53ef\u80fd\u53ea\u63d0\u4f9b\u4e86\u52a8\u6001\u5e93\uff0c\u4e00\u90e8\u5206\u5e93\u53ea\u63d0\u4f9b\u4e86\u9759\u6001\u5e93\uff0c\u4e00\u90e8\u5206\u5219\u4e24\u8005\u90fd\u6709\u63d0\u4f9b\u3002\u94fe\u63a5\u65f6\uff0c\u94fe\u63a5\u5668\u4f1a\u81ea\u52a8\u9009\u62e9\u5408\u9002\u7684\u94fe\u63a5\u65b9\u5f0f\u8fdb\u884c\u94fe\u63a5\uff0c\u4e5f\u5c31\u662f\u8bf4\u4e00\u90e8\u5206\u5e93\u53ef\u80fd\u4ee5\u9759\u6001\u94fe\u63a5\u7684\u65b9\u5f0f\u94fe\u63a5\u5230\u4e8c\u8fdb\u5236\u4e2d\uff0c\u4e00\u90e8\u5206\u5e93\u5219\u4ee5\u52a8\u6001\u94fe\u63a5\u65b9\u5f0f\u94fe\u63a5\u5230\u4e8c\u8fdb\u5236\u4e2d\u3002</p>"},{"location":"build-system/","title":"\u6982\u89c8","text":"<p>\u5b66\u4e60\u4e86\u524d\u9762\u7684\u57fa\u7840\u77e5\u8bc6\uff0c\u73b0\u5728\u4f60\u5e94\u8be5\u5df2\u7ecf\u638c\u63e1\u4e86\u591a\u6587\u4ef6 C++ \u9879\u76ee\u7684\u7f16\u8bd1\u65b9\u6cd5\u3002\u63a5\u4e0b\u6765\uff0c\u672c\u7ae0\u5c06\u4f1a\u4ecb\u7ecd\u4e0d\u540c\u7684\u6784\u5efa\u7cfb\u7edf\u4ee5\u53ca\u5143\u6784\u5efa\u7cfb\u7edf\uff0c\u4e3a\u4e4b\u540e\u7f16\u8bd1\u66f4\u5927\u7684\u9879\u76ee\u505a\u51c6\u5907\u3002</p>"},{"location":"build-system/#\u4ec0\u4e48\u662f\u6784\u5efa\u7cfb\u7edf","title":"\u4ec0\u4e48\u662f\u6784\u5efa\u7cfb\u7edf\uff1f","text":"<p>\u7b80\u5355\u6765\u8bb2\uff0c\u6784\u5efa\u7cfb\u7edf\u5c31\u662f\u4e00\u4e2a\u5e2e\u4f60\u4ece\u6e90\u4ee3\u7801\u3001\u5e93\u6587\u4ef6\u6700\u7ec8\u6784\u5efa\u51fa\u4e00\u4e2a\u53ef\u6267\u884c\u4e8c\u8fdb\u5236\uff08\u6216\u5176\u4ed6\u4ea7\u7269\uff0c\u4f8b\u5982\u64cd\u4f5c\u7cfb\u7edf\u955c\u50cf\uff09\u7684\u5de5\u5177\u3002\u4f8b\u5982\uff0c\u5bf9\u4e8e C++ \u9879\u76ee\u800c\u8a00\uff0c\u5c31\u662f\u5e2e\u4f60\u5c06\u4e00\u5806 <code>.cpp</code>\u3001<code>.so</code> \u548c <code>.a</code> \u6587\u4ef6\u7f16\u8bd1\u51fa\u4e00\u4e2a\u53ef\u6267\u884c\u7684\u6587\u4ef6\u3002\u5b83\u4e00\u822c\u4f1a\u76f4\u63a5\u8c03\u7528\u7f16\u8bd1\u5668\u6765\u751f\u6210\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002</p>"},{"location":"build-system/#\u4e3a\u4ec0\u4e48\u9700\u8981\u6784\u5efa\u7cfb\u7edf","title":"\u4e3a\u4ec0\u4e48\u9700\u8981\u6784\u5efa\u7cfb\u7edf\uff1f","text":"<p>\u5728\u524d\u9762\u7684\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5c06\u6240\u6709\u7684\u6587\u4ef6\u4e00\u80a1\u8111\u5730\u4f20\u7ed9 <code>g++</code> \u547d\u4ee4\u5373\u53ef\uff0c\u770b\u8d77\u6765\u8fd9\u5df2\u7ecf\u8db3\u4ee5\u5f00\u59cb\u7f16\u5199\u9879\u76ee\u4e86\u3002\u6216\u8005\uff0c\u6211\u4eec\u5c06\u7f16\u8bd1\u547d\u4ee4\u76f4\u63a5\u5199\u5230\u4e00\u4e2a\u811a\u672c\u91cc\uff0c\u9700\u8981\u7f16\u8bd1\u7684\u8bdd\uff0c\u76f4\u63a5\u6267\u884c\u8fd9\u4e2a\u811a\u672c\u5c31\u597d\u4e86\u3002\u90a3\u4e48\uff0c\u6211\u4eec\u4e3a\u4ec0\u4e48\u8fd8\u9700\u8981\u6784\u5efa\u7cfb\u7edf\u5462\uff1f</p>"},{"location":"build-system/#\u4e30\u5bcc\u7684\u5de5\u5177\u51fd\u6570\u652f\u6301","title":"\u4e30\u5bcc\u7684\u5de5\u5177\u51fd\u6570\u652f\u6301","text":"<p>\u6784\u5efa\u7cfb\u7edf\u5305\u542b\u4e86\u4eba\u4eec\u591a\u5e74\u4ee5\u6765\u5728\u7f16\u8bd1\u8f6f\u4ef6\u7684\u7ecf\u9a8c\u603b\u7ed3\uff0c\u5f80\u5f80\u63d0\u4f9b\u4e86\u5927\u91cf\u7684\u5de5\u5177\u51fd\u6570\u6765\u8f85\u52a9\u6211\u4eec\u6784\u5efa\u8f6f\u4ef6\u3002\u4f8b\u5982\uff0c\u6784\u5efa\u7cfb\u7edf\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u6765\u6307\u5b9a\u54ea\u4e9b\u6e90\u6587\u4ef6\u9700\u8981\u53c2\u4e0e\u7f16\u8bd1\uff0c\u65e0\u9700\u6211\u4eec\u4e00\u4e2a\u4e2a\u624b\u52a8\u6307\u5b9a\uff1b\u800c\u6211\u4eec\u9700\u8981\u4ec0\u4e48\u4f9d\u8d56\u7684\u8bdd\uff0c\u4e5f\u53ea\u9700\u8981\u901a\u8fc7\u51fd\u6570\u58f0\u660e\u5373\u53ef\uff0c\u6709\u4e9b\u6784\u5efa\u7cfb\u7edf\u751a\u81f3\u4f1a\u5e2e\u52a9\u6211\u4eec\u4e0b\u8f7d\u597d\u6b63\u786e\u7684\u4f9d\u8d56\u3002</p>"},{"location":"build-system/#\u51cf\u5c11\u4e0d\u5fc5\u8981\u7684\u7f16\u8bd1","title":"\u51cf\u5c11\u4e0d\u5fc5\u8981\u7684\u7f16\u8bd1","text":"<p>\u5bf9\u4e8e\u4e00\u4e2a\u9879\u76ee\u800c\u8a00\uff0c\u6211\u4eec\u5f80\u5f80\u53ea\u4fee\u6539\u5176\u4e2d\u4e00\u4e24\u4e2a\u6587\u4ef6\u4e4b\u540e\uff0c\u5c31\u9700\u8981\u7f16\u8bd1\u8fd0\u884c\u8fdb\u884c\u8c03\u8bd5\uff0c\u800c\u5927\u90e8\u5206\u6587\u4ef6\u90fd\u662f\u6ca1\u6709\u4fee\u6539\u7684\u3002\u5982\u679c\u6211\u4eec\u6bcf\u6b21\u90fd\u5c06\u6240\u6709\u6587\u4ef6\u4f20\u9012\u7ed9\u7f16\u8bd1\u5668\uff0c\u90a3\u4e48\u5373\u4f7f\u6587\u4ef6\u6ca1\u6709\u4fee\u6539\uff0c\u4e5f\u4f1a\u88ab\u5168\u90e8\u91cd\u65b0\u7f16\u8bd1\uff0c\u975e\u5e38\u6d6a\u8d39\u65f6\u95f4\u3002\u6784\u5efa\u7cfb\u7edf\u5219\u4f1a\u5206\u6790\u54ea\u4e9b\u6587\u4ef6\u88ab\u4fee\u6539\u4e86\uff0c\u7136\u540e\u53ea\u91cd\u65b0\u7f16\u8bd1\u8fd9\u4e9b\u6587\u4ef6\uff0c\u518d\u8fdb\u884c\u94fe\u63a5\uff0c\u5c31\u80fd\u5927\u5927\u51cf\u5c11\u6784\u5efa\u7684\u65f6\u95f4\u4e86\u3002</p>"},{"location":"build-system/#\u9009\u62e9\u5408\u9002\u7684\u6784\u5efa\u7cfb\u7edf","title":"\u9009\u62e9\u5408\u9002\u7684\u6784\u5efa\u7cfb\u7edf","text":"<p>\u6784\u5efa\u7cfb\u7edf\u662f C++ \u9879\u76ee\u6700\u57fa\u7840\u7684\u4e00\u73af\uff0c\u4e0d\u8fc7 C++ \u7684\u81ea\u7531\u4e5f\u4f7f\u5f97\u4e0d\u540c\u9879\u76ee\u3001\u4e0d\u540c\u793e\u533a\u3001\u4e0d\u540c\u516c\u53f8\u7b49\u5404\u81ea\u884d\u751f\u51fa\u4e86\u4e0d\u540c\u7684\u6784\u5efa\u7cfb\u7edf\u3002\u5b83\u4eec\u6709\u5404\u81ea\u7684\u4f18\u7f3a\u70b9\uff0c\u9009\u62e9\u5408\u9002\u7684\u6784\u5efa\u7cfb\u7edf\u80fd\u63d0\u9ad8\u6784\u5efa\u6548\u7387\uff0c\u4ece\u800c\u63d0\u9ad8\u5f00\u53d1\u6548\u7387\u3002</p>"},{"location":"build-system/bazel/","title":"Bazel","text":"<p>Bazel \u662f\u8c37\u6b4c\u5f00\u6e90\u7684\u6784\u5efa\u7cfb\u7edf\uff0c\u5176\u5185\u90e8\u540d\u79f0\u53eb\u505a Blaze\uff0c\u9002\u5408\u5728\u5355\u4e00\u4ee3\u7801\u5e93\u4e0b\u4f7f\u7528\uff0c\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u8de8\u9879\u76ee\u4f7f\u7528\u4f9d\u8d56\uff0c\u540c\u65f6\u4e5f\u5185\u7f6e\u4e86\u591a\u79cd\u7f16\u8bd1\u811a\u672c\uff0c\u7528\u6237\u4e0d\u9700\u8981\u624b\u5199\u7f16\u8bd1\u547d\u4ee4\uff0c\u540c\u65f6\u8fd8\u53ef\u4ee5\u4ece\u6307\u5b9a\u7684 Git \u4ed3\u5e93\u6216\u8005 URL \u4e0b\u8f7d\u4f9d\u8d56\u6587\u4ef6\u7b49\u3002Bazel \u6784\u5efa\u65f6\u4f1a\u4f7f\u7528\u6c99\u7bb1\u73af\u5883\uff0c\u4fdd\u8bc1\u6bcf\u6b21\u6784\u5efa\u7684\u4ea7\u7269\u90fd\u662f\u5b8c\u5168\u4e00\u81f4\u7684\u3002</p> <p>Bazel \u7684\u4f18\u7f3a\u70b9\u90fd\u5f88\u660e\u663e\uff0c\u4f18\u70b9\u662f\u6784\u5efa\u547d\u4ee4\u7f16\u5199\u7b80\u5355\uff0c\u91c7\u7528\u4e86\u7c7b\u4f3c Python \u7684 Starlark \u8bed\u8a00\u4f5c\u4e3a DSL\uff0c\u800c\u4e14\u652f\u6301\u7ec6\u7c92\u5ea6\u7684\u7f16\u8bd1\u4ea7\u7269\u7ba1\u7406\uff0c\u4f7f\u5f97\u9879\u76ee\u4e92\u76f8\u5f15\u7528\u53d8\u5f97\u5341\u5206\u7b80\u5355\uff0c\u63d0\u9ad8\u4e86\u7f16\u8bd1\u7f13\u5b58\u7684\u6548\u7387\u3002\u540c\u65f6\uff0c\u5176\u91c7\u7528\u7684\u5ba2\u6237\u7aef\u670d\u52a1\u7aef\u6a21\u5f0f\uff0c\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u6269\u5c55\u5230\u591a\u53f0\u670d\u52a1\u5668\u4e0a\uff0c\u8fdb\u884c\u591a\u673a\u7684\u5206\u5e03\u5f0f\u7f16\u8bd1\u3002\u6c99\u7bb1\u5f0f\u6784\u5efa\u4fdd\u8bc1\u4e86\u51fd\u6570\u5f0f\u7684\u6784\u5efa\u8fc7\u7a0b\uff0c\u53ea\u8981\u8f93\u5165\u7ed9\u5b9a\u4e86\uff0c\u90a3\u4e48\u8f93\u51fa\u4e00\u5b9a\u662f\u5b8c\u5168\u4e00\u81f4\u7684\uff0c\u8fd9\u6837\u5c31\u4e0d\u4f1a\u6709\u7531\u4e8e\u73af\u5883\u4e0d\u4e00\u6837\u5bfc\u81f4\u6784\u5efa\u4ea7\u7269\u4e0d\u4e00\u6837\u7684\u73b0\u8c61\u3002\u540c\u65f6\uff0c\u6c99\u7bb1\u5f0f\u6784\u5efa\u4e5f\u8981\u6c42\u5f00\u53d1\u8005\u663e\u5f0f\u5730\u58f0\u660e\u6240\u6709\u7684\u4f9d\u8d56\uff0c\u8fd9\u6837\u4e00\u4e2a\u6a21\u5757\u6539\u52a8\u65f6\uff0c\u53ef\u4ee5\u5f88\u65b9\u4fbf\u5730\u901a\u8fc7\u81ea\u52a8\u5316\u5de5\u5177\u5206\u6790\u51fa\u53d7\u5f71\u54cd\u7684\u4e0b\u6e38\u6a21\u5757\u3002</p> <p>\u4f46\u662f\uff0c\u4e5f\u6b63\u56e0\u4e3a\u5176\u81ea\u5e26\u4e86\u4f9d\u8d56\u7ba1\u7406\uff0cBazel \u81ea\u6210\u4e00\u5957\u4f53\u7cfb\uff0c\u65e0\u6cd5\u5229\u7528\u597d\u73b0\u6210\u7684 CMake \u9879\u76ee\u7b49\uff0c\u5982\u679c\u901a\u8fc7\u6dfb\u52a0\u89c4\u5219\u6765\u8c03\u7528 CMake \u6784\u5efa\u9879\u76ee\uff0c\u5c31\u5931\u53bb\u4e86 Bazel \u7ec6\u7c92\u5ea6\u4f9d\u8d56\u7ba1\u7406\u7684\u4f18\u52bf\u3002\u540c\u65f6\uff0c\u5bf9\u4e8e\u81ea\u5e26\u4f9d\u8d56\u7ba1\u7406\u7684\u8bed\u8a00\uff0c\u4f8b\u5982 NodeJS\u3001Go\u3001Rust \u7b49\uff0c\u5c31\u9700\u8981\u7ef4\u62a4\u4e24\u5957\u4f9d\u8d56\u58f0\u660e\u6587\u4ef6\u3002\u4e5f\u5c31\u662f\u8bf4\uff0cBazel \u7684\u7f3a\u70b9\u5c31\u662f\u5bf9\u4e8e\u975e Bazel \u9879\u76ee\u6781\u5176\u4e0d\u53cb\u597d\uff0c\u9700\u8981\u7528\u6237\u81ea\u5df1\u7f16\u5199 Bazel \u6784\u5efa\u6587\u4ef6\uff0c\u5bf9\u4e8e\u590d\u6742\u7684\u9879\u76ee\uff0c\u8fc1\u79fb\u5230 Bazel \u5c06\u4f1a\u662f\u975e\u5e38\u9ebb\u70e6\u548c\u56f0\u96be\u7684\u5de5\u4f5c\u3002\u53e6\u5916\uff0c\u5728\u4e2a\u4eba\u4f7f\u7528\u7684\u65f6\u5019\uff0cBazel \u5219\u663e\u5f97\u975e\u5e38\u8017\u8d39\u8d44\u6e90\u3002\u9996\u5148\u662f\u5b83\u9700\u8981\u5728\u672c\u5730\u4f7f\u7528 Java \u542f\u52a8\u4e00\u4e2a\u6784\u5efa\u670d\u52a1\u5668\uff0c\u5728\u6784\u5efa\u5b8c\u6210\u4e4b\u540e\u4e5f\u4e0d\u4f1a\u9000\u51fa\uff0c\u5e38\u9a7b\u5360\u7528\u8d44\u6e90\uff0c\u5bf9\u4e8e\u8de8\u5e73\u53f0\u7684\u652f\u6301\u8fd8\u6709\u4e9b\u95ee\u9898\u3002\u6700\u540e\u5219\u662f IDE \u548c\u7f16\u8f91\u5668\u652f\u6301\u8fd8\u6bd4\u8f83\u6709\u9650\uff0c\u56e0\u4e3a\u4f9d\u8d56\u548c\u6784\u5efa\u4ea7\u7269\u90fd\u653e\u5728\u4e86 Bazel \u81ea\u5df1\u7684\u76ee\u5f55\u91cc\uff0c\u5bf9 C++ \u9879\u76ee\u542f\u7528\u667a\u80fd\u63d0\u793a\u4f1a\u6bd4\u8f83\u9ebb\u70e6\u3002</p> <p>\u5bf9\u6bd4\u4f18\u7f3a\u70b9\uff0cBazel \u53ef\u80fd\u66f4\u9002\u5408\u56e2\u961f\u5728\u6bd4\u8f83\u5927\u578b\u7684\u5355\u4e00\u4ee3\u7801\u5e93\u5408\u4f5c\u4f7f\u7528\uff0c\u5e76\u4f7f\u7528\u4e13\u95e8\u7684\u7f16\u8bd1\u670d\u52a1\u5668\u6765\u8fdb\u884c\u7f16\u8bd1\uff0c\u5171\u4eab\u7f16\u8bd1\u7f13\u5b58\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u9700\u8981\u81ea\u5df1\u7f16\u5199\u5de5\u5177\u89e3\u51b3\u4e00\u4e9b\u95ee\u9898\u3002</p>"},{"location":"build-system/build-cache/","title":"\u7f16\u8bd1\u7f13\u5b58","text":"<p>\u5728\u6784\u5efa\u6bd4\u8f83\u590d\u6742\u7684\u9879\u76ee\u7684\u65f6\u5019\uff0c\u4f8b\u5982\u53ef\u80fd\u4f7f\u7528\u4e86\u5927\u91cf\u7b2c\u4e09\u65b9\u5305\uff0c\u6216\u8005\u672c\u8eab\u9879\u76ee\u5c31\u5f88\u5e9e\u5927\uff0c\u90a3\u4e48\u53ef\u4ee5\u5c1d\u8bd5\u4f7f\u7528\u7f16\u8bd1\u7f13\u5b58\u5de5\u5177\u6765\u52a0\u901f\u6784\u5efa\u8fc7\u7a0b\u3002</p> <p>\u4f46\u662f\uff0c\u6211\u4eec\u521a\u624d\u4e5f\u63d0\u5230\uff0cMake \u7b49\u5de5\u5177\u4f1a\u68c0\u6d4b\u4f9d\u8d56\u7684\u6539\u52a8\uff0c\u4ece\u800c\u53ea\u7f16\u8bd1\u6709\u53d8\u5316\u7684\u6587\u4ef6\u3002\u90a3\u4e48\u7f16\u8bd1\u7f13\u5b58\u548c Make \u7b49\u68c0\u6d4b\u4f9d\u8d56\u6539\u52a8\u6709\u4ec0\u4e48\u4e0d\u4e00\u6837\u7684\u5730\u65b9\u5462\uff1f</p> <p>\u4e00\u822c\u6765\u8bf4\uff0c\u7f16\u8bd1\u7f13\u5b58\u5de5\u5177\u4f1a\u5c06\u7f16\u8bd1\u7684\u4ea7\u7269\uff0c\u4f8b\u5982\u76ee\u6807\u6587\u4ef6\u3001\u5e93\u6587\u4ef6\u7b49\uff0c\u4fdd\u5b58\u5230\u4e00\u4e2a\u5168\u5c40\u5171\u4eab\u7684\u76ee\u5f55\u4e0b\u9762\uff0c\u90a3\u4e48\uff0c\u5982\u679c\u6211\u4eec\u4e24\u4e2a\u9879\u76ee\u5404\u81ea\u4fdd\u5b58\u5f15\u7528\u4e86\u540c\u4e00\u4e2a\u7b2c\u4e09\u65b9\u5e93\uff0c\u7f16\u8bd1\u7f13\u5b58\u5de5\u5177\u53ef\u4ee5\u8fdb\u884c\u8de8\u9879\u76ee\u7684\u7f13\u5b58\u5171\u4eab\uff0c\u4ece\u800c\u8282\u7ea6\u6784\u5efa\u65f6\u95f4\u3002</p> <p>\u53e6\u5916\uff0c\u6709\u7684\u65f6\u5019\u6211\u4eec\u53ef\u80fd\u56e0\u4e3a\u5404\u79cd\u539f\u56e0\uff0c\u9700\u8981\u6e05\u7a7a\u76ee\u5f55\u4e0b\u7684\u6784\u5efa\u4ea7\u7269\u4ece\u5934\u6784\u5efa\uff0c\u7531\u4e8e\u7f16\u8bd1\u7f13\u5b58\u662f\u5b58\u653e\u5728\u522b\u7684\u4f4d\u7f6e\u7684\uff0c\u54ea\u6015\u6211\u4eec\u6e05\u7a7a\u4e86\u5f53\u524d\u76ee\u5f55\u7684\u7f16\u8bd1\u4ea7\u7269\uff0c\u4e0b\u4e00\u6b21\u4ece\u5934\u6784\u5efa\u7684\u65f6\u5019\uff0c\u8fd8\u53ef\u4ee5\u5229\u7528\u4e4b\u524d\u6784\u5efa\u4ea7\u7269\u52a0\u901f\u6784\u5efa\u3002\u6240\u4ee5\uff0c\u5373\u4f7f\u6784\u5efa\u7cfb\u7edf\u672c\u8eab\u5df2\u7ecf\u53ef\u4ee5\u9879\u76ee\u51cf\u5c11\u4e00\u90e8\u5206\u4e0d\u5fc5\u8981\u7684\u7f16\u8bd1\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u5229\u7528\u7f16\u8bd1\u7f13\u5b58\u8fdb\u4e00\u6b65\u5730\u52a0\u901f\u6784\u5efa\u3002</p> \u7f16\u8bd1\u7f13\u5b58\u7684\u6b63\u786e\u6027\u4fdd\u8bc1 <p>\u7f16\u8bd1\u7f13\u5b58\u4f1a\u4f7f\u7528\u6587\u4ef6\u5185\u5bb9\u54c8\u5e0c\u4ee5\u53ca\u7f16\u8bd1\u547d\u4ee4\u54c8\u5e0c\u7b49\u591a\u79cd\u56e0\u7d20\u6765\u786e\u4fdd\u7f16\u8bd1\u7f13\u5b58\u7684\u6b63\u786e\u6027\u3002\u4e00\u4e2a\u5408\u683c\u7684\u7f16\u8bd1\u7f13\u5b58\u5de5\u5177\uff0c\u5e94\u8be5\u662f\u8ba9\u4f7f\u7528\u8005\u5bdf\u89c9\u4e0d\u5230\u4efb\u4f55\u4e0d\u540c\u7684\u3002</p>"},{"location":"build-system/build-cache/#\u4f7f\u7528-ccache-\u8fdb\u884c\u7f16\u8bd1\u7f13\u5b58","title":"\u4f7f\u7528 ccache \u8fdb\u884c\u7f16\u8bd1\u7f13\u5b58","text":"<p>\u76ee\u524d\uff0c\u5bf9\u4e8e C/C++ \u800c\u8a00\uff0c\u5e38\u7528\u7684\u7f16\u8bd1\u7f13\u5b58\u5de5\u5177\u662f ccache\u3002\u5b83\u6709\u4e24\u79cd\u4f7f\u7528\u65b9\u6cd5\uff0c\u4e00\u662f\u5728\u7f16\u8bd1\u547d\u4ee4\u524d\u6dfb\u52a0 <code>ccache</code>\uff0c\u4f8b\u5982\u539f\u672c\u662f <code>g++ a.cpp</code>\uff0c\u90a3\u4e48\u53ea\u9700\u8981\u4f7f\u7528 <code>ccache g++ a.cpp</code> \u5c31\u80fd\u5229\u7528\u7f16\u8bd1\u7f13\u5b58\u3002\u53e6\u4e00\u79cd\u66f4\u52a0\u7b80\u5355\u7c97\u66b4\uff0c\u90a3\u5c31\u662f\u4f7f\u7528 <code>ccache</code> \u66ff\u6362\u6389 <code>gcc</code>\u3001<code>g++</code> \u7b49\u547d\u4ee4\u3002</p>"},{"location":"build-system/distributed-compiling/","title":"\u5206\u5e03\u5f0f\u7f16\u8bd1","text":"<p>\u5b9e\u9645\u5f00\u53d1\u4e2d\uff0c\u4f1a\u6709\u5de8\u578b\u7684 C/C++ \u9879\u76ee\uff0c\u4f8b\u5982 Linux\u3001PyTorch\u3001Chromium \u7b49\uff0c\u8fd9\u4e9b\u9879\u76ee\u7684\u4ee3\u7801\u6570\u91cf\u6570\u4ee5\u4e07\u8ba1\uff0c\u5728\u4e2a\u4eba\u7535\u8111\u4e0a\u7f16\u8bd1\u53ef\u80fd\u9700\u8981\u52a8\u8f84\u51e0\u4e2a\u5c0f\u65f6\uff0c\u54ea\u6015\u662f\u5728\u670d\u52a1\u5668\u4e0a\u7f16\u8bd1\uff0c\u53ef\u80fd\u8017\u8d39\u7684\u65f6\u95f4\u4e5f\u8981\u6570\u5341\u5206\u949f\u3002\u5373\u4f7f\u6709\u7f16\u8bd1\u7f13\u5b58\uff0c\u4f46\u662f\u6211\u4eec\u6709\u65f6\u5019\u4fee\u6539\u4e00\u4e2a\u5934\u6587\u4ef6\u53ef\u80fd\u4e5f\u4f1a\u5bfc\u81f4\u6570\u767e\u4e0a\u5343\u7684\u6587\u4ef6\u9700\u8981\u91cd\u65b0\u7f16\u8bd1\u3002\u5bf9\u4e8e\u8fd9\u79cd\u5de8\u578b\u9879\u76ee\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u591a\u53f0\u673a\u5668\u4e00\u8d77\u7f16\u8bd1\uff0c\u8fdb\u4e00\u6b65\u52a0\u901f\u7f16\u8bd1\u8fc7\u7a0b\u3002</p> <p>\u5206\u5e03\u5f0f\u7f16\u8bd1\u7684\u539f\u7406\u5c31\u662f\u5c06\u4efb\u52a1\u5207\u5206\u5f00\uff0c\u5c06\u9884\u5904\u7406\u540e\u7684\u6e90\u4ee3\u7801\u53d1\u9001\u5230\u5176\u4ed6\u673a\u5668\u4e0a\uff0c\u8ba9\u4e0d\u540c\u7684\u673a\u5668\u53bb\u5e76\u884c\u7f16\u8bd1\u7a0b\u5e8f\u7684\u4e0d\u540c\u90e8\u5206\uff0c\u4ece\u800c\u63d0\u9ad8\u5e76\u884c\u5ea6\u3002\u6700\u540e\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5c06\u7f16\u8bd1\u4ea7\u7269\u4e0b\u8f7d\u56de\u6765\u8fdb\u884c\u94fe\u63a5\u5373\u53ef\u3002</p> <p>\u5728\u591a\u4eba\u5408\u4f5c\u5f00\u53d1\u65f6\uff0c\u5206\u5e03\u5f0f\u7f16\u8bd1\u8fd8\u53ef\u4ee5\u5229\u7528\u7f16\u8bd1\u7f13\u5b58\uff0c\u8fd9\u6837\u53ea\u9700\u8981\u4e00\u4e2a\u4eba\u6267\u884c\u8fc7\u4e00\u6b21\u7f16\u8bd1\uff0c\u5176\u4ed6\u4eba\u5c31\u80fd\u76f4\u63a5\u4f7f\u7528\u670d\u52a1\u5668\u63d0\u4f9b\u7684\u7f13\u5b58\uff0c\u5927\u5927\u52a0\u901f\u6784\u5efa\u8fc7\u7a0b\u3002</p>"},{"location":"build-system/distributed-compiling/#\u4f7f\u7528-distcc-\u8fdb\u884c\u5206\u5e03\u5f0f\u7f16\u8bd1","title":"\u4f7f\u7528 distcc \u8fdb\u884c\u5206\u5e03\u5f0f\u7f16\u8bd1","text":"<p>\u76ee\u524d\uff0cC/C++ \u5e38\u7528\u7684\u5206\u5e03\u5f0f\u7f16\u8bd1\u5de5\u5177\u662f distcc\u3002</p>"},{"location":"build-system/distributed-compiling/#\u4f7f\u7528-distcc-\u548c-ccache-\u642d\u5efa\u5206\u5e03\u5f0f\u7f16\u8bd1\u7f13\u5b58","title":"\u4f7f\u7528 distcc \u548c ccache \u642d\u5efa\u5206\u5e03\u5f0f\u7f16\u8bd1\u7f13\u5b58","text":"<p>distcc \u8fd8\u53ef\u4ee5\u548c\u524d\u9762\u63d0\u5230\u7684 ccache \u4e00\u8d77\u4f7f\u7528\uff0c\u8fdb\u4e00\u6b65\u52a0\u5feb\u6784\u5efa\u6d41\u7a0b\u3002\u53ea\u9700\u8981\u5c06 distcc \u8c03\u7528\u7684\u7f16\u8bd1\u5668\u66ff\u6362\u4e3a ccache \u63d0\u4f9b\u7684\u5305\u88c5\u5668\u5373\u53ef\u3002</p>"},{"location":"build-system/make/","title":"Make","text":"<p>Make \u662f Unix \u7cfb\u7edf\u4e0a\u5386\u53f2\u60a0\u4e45\u7684\u6784\u5efa\u7cfb\u7edf\uff0c\u4f7f\u7528\u7684\u6784\u5efa\u6587\u4ef6\u53eb Makefile\uff0c\u7528\u6237\u53ef\u4ee5\u6307\u5b9a\u4e0d\u540c\u7684\u7f16\u8bd1\u76ee\u6807\u4ee5\u53ca\u6307\u5b9a\u5b83\u4eec\u7684\u76f8\u5173\u4f9d\u8d56\uff0cMake \u4f1a\u81ea\u52a8\u6784\u5efa\u76ee\u6807\u6240\u9700\u8981\u7684\u4f9d\u8d56\u6587\u4ef6\uff0c\u540c\u65f6\u4f1a\u5206\u6790\u54ea\u4e00\u4e9b\u4f9d\u8d56\u662f\u53ef\u4ee5\u4e0d\u7528\u91cd\u65b0\u6784\u5efa\u7684\uff0c\u5b9e\u73b0\u589e\u91cf\u6784\u5efa\uff0c\u52a0\u901f\u6784\u5efa\u8fc7\u7a0b\u3002</p> <p>\u8bb8\u591a\u5176\u4ed6\u7684\u6784\u5efa\u7cfb\u7edf\u6216\u591a\u6216\u5c11\u90fd\u662f\u5bf9 Make \u7684\u4e00\u4e2a\u6539\u8fdb\uff0c\u638c\u63e1 Make \u7684\u57fa\u672c\u6982\u5ff5\uff0c\u5c31\u5f88\u5bb9\u6613\u5b66\u4e60\u5176\u4ed6\u6784\u5efa\u7cfb\u7edf\u4e86\u3002</p> \u9605\u8bfb\u5efa\u8bae <p>\u5982\u679c\u4f60\u8d76\u65f6\u95f4\uff0c\u6216\u8005\u662f\u5728 Windows \u4e0a\u5f00\u53d1\uff0c\u90a3\u4e48\u53ef\u4ee5\u6682\u65f6\u8df3\u8fc7\u672c\u8282\uff0c\u76f4\u63a5\u770b CMake\uff0c\u8fd9\u662f\u4e00\u4e2a\u8de8\u5e73\u53f0\u7684\u5143\u6784\u5efa\u7cfb\u7edf\uff0c\u800c\u4e14\u4f7f\u7528\u4e86\u66f4\u7b80\u5355\u4e5f\u66f4\u9ad8\u5c42\u7ea7\u7684\u63cf\u8ff0\u8bed\u8a00\uff0c\u4f7f\u7528\u5b83\u7684\u524d\u63d0\u77e5\u8bc6\u4ec5\u9700\u8981\u638c\u63e1\u7a0b\u5e8f\u7684\u7f16\u8bd1\u4e0e\u94fe\u63a5\u3002</p>"},{"location":"build-system/make/#\u57fa\u7840\u6982\u5ff5","title":"\u57fa\u7840\u6982\u5ff5","text":"<p>\u6784\u5efa\u7cfb\u7edf\u4e2d\u7684\u57fa\u672c\u5143\u7d20\u53ea\u6709\u4e09\u4e2a\uff1a\u76ee\u6807\u3001\u4f9d\u8d56\u4ee5\u53ca\u6784\u5efa\u76ee\u6807\u7684\u6307\u4ee4\u3002</p> <p>\u76ee\u6807\u5f88\u597d\u7406\u89e3\uff0c\u4f8b\u5982\u6211\u4eec\u60f3\u751f\u6210\u4e00\u4e2a\u53eb <code>hello</code> \u7684\u53ef\u6267\u884c\u7a0b\u5e8f\uff0c\u90a3\u4e48 <code>hello</code> \u5c31\u662f\u4e00\u4e2a\u76ee\u6807\uff0c\u5982\u679c\u60f3\u751f\u6210\u4e00\u4e2a\u53eb <code>mylib</code> \u7684\u5e93\uff0c\u90a3\u4e48 <code>mylib</code> \u4e5f\u662f\u4e00\u4e2a\u76ee\u6807\u3002</p> <p>\u4f9d\u8d56\u540c\u6837\u5f88\u597d\u7406\u89e3\uff0c\u5c31\u662f\u4e00\u4e2a\u76ee\u6807\u8981\u751f\u6210\u7684\u8bdd\uff0c\u6709\u4ec0\u4e48\u4e1c\u897f\u662f\u5fc5\u987b\u5f97\u5148\u6784\u5efa\u51fa\u6765\u7684\u3002\u800c\u4f9d\u8d56\u672c\u8eab\u4e5f\u662f\u76ee\u6807\uff0c\u4e5f\u53ef\u4ee5\u662f\u6587\u4ef6\u3002\u4f8b\u5982\uff0c\u751f\u6210 <code>hello</code> \u4e4b\u524d\u9700\u8981\u5148\u751f\u6210 <code>mylib</code> \u7528\u6765\u94fe\u63a5\uff0c\u90a3\u4e48 <code>mylib</code> \u5c31\u662f <code>hello</code> \u7684\u4e00\u4e2a\u4f9d\u8d56\u3002\u800c <code>mylib</code> \u7684\u4f9d\u8d56\u53ef\u80fd\u662f <code>mylib.cpp</code> \u548c <code>mylib.h</code>\u3002\u5982\u679c\u6211\u4eec\u753b\u4e00\u4e2a\u56fe\uff0c\u6240\u6709\u7684\u76ee\u6807\u4f5c\u4e3a\u8282\u70b9\uff0c\u5b58\u5728\u4f9d\u8d56\u5173\u7cfb\u7684\u76ee\u6807\u4e4b\u95f4\uff0c\u753b\u4e00\u6761\u4ece\u88ab\u4f9d\u8d56\u7684\u76ee\u6807\u6307\u5411\u4f9d\u8d56\u5b83\u7684\u76ee\u6807\u7684\u7bad\u5934\uff0c\u5c31\u5f97\u5230\u4e86\u4e00\u5f20\u6709\u5411\u56fe\u3002\u5982\u679c\u8fd9\u4e2a\u6709\u5411\u56fe\u6709\u73af\u7684\u8bdd\uff0c\u5c31\u4f1a\u6709\u5faa\u73af\u4f9d\u8d56\u7684\u95ee\u9898\uff0c\u6ca1\u6709\u529e\u6cd5\u6784\u5efa\u3002\u800c\u5982\u679c\u8fd9\u4e2a\u56fe\u65e0\u73af\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u4f7f\u7528\u62d3\u6251\u6392\u5e8f\u7684\u65b9\u6cd5\uff0c\u4e0d\u65ad\u8fdb\u884c\u6784\u5efa\uff0c\u6700\u7ec8\u5f97\u5230\u7f16\u8bd1\u4ea7\u7269\u3002\u4e24\u4e2a\u76ee\u6807\u6ca1\u6709\u4f9d\u8d56\u7684\u8bdd\uff0c\u662f\u53ef\u4ee5\u5e76\u884c\u6784\u5efa\u7684\uff0c\u8fd9\u4e5f\u662f\u4f7f\u7528\u6784\u5efa\u7cfb\u7edf\u80fd\u52a0\u901f\u6784\u5efa\u7684\u4e00\u4e2a\u539f\u56e0\u3002</p> <p>\u800c\u6784\u5efa\u76ee\u6807\u7684\u6307\u4ee4\u5982\u5b57\u9762\u610f\u601d\uff0c\u5c31\u662f\u6211\u4eec\u5e94\u8be5\u600e\u4e48\u751f\u6210\u4e00\u4e2a\u4ea7\u7269\uff0c\u4f8b\u5982 <code>g++ hello.cpp</code>\u3002</p>"},{"location":"build-system/make/#makefile-\u683c\u5f0f","title":"Makefile \u683c\u5f0f","text":"<p>Makefile \u4e2d\u5bf9\u4e8e\u4e0a\u9762\u4e09\u4e2a\u5143\u7d20\u7684\u63cf\u8ff0\u5982\u4e0b\uff1a</p> <pre><code>\u76ee\u6807: \u4f9d\u8d561 \u4f9d\u8d562 ...\n    \u6784\u5efa\u6307\u4ee41\n    \u6784\u5efa\u6307\u4ee42\n    ...\n</code></pre> <p>\u7531\u4e8e\u5386\u53f2\u539f\u56e0\uff0c\u6784\u5efa\u6307\u4ee4\u524d\u7684\u7f29\u8fdb\u5fc5\u987b\u4f7f\u7528 Tab\uff0c\u4e5f\u5c31\u662f <code>\\t</code>\u3002</p>"},{"location":"build-system/ninja/","title":"Ninja","text":"<p>Ninja \u662f make \u7684\u66ff\u4ee3\u54c1\uff0c\u4f7f\u7528\u4e86\u4e0d\u4e00\u6837\u7684 DSL\uff0c\u6784\u5efa\u6587\u4ef6\u901a\u5e38\u547d\u540d\u4e3a <code>ninja.build</code>\u3002Ninja \u5ba3\u79f0\u5728\u4f9d\u8d56\u89e3\u6790\u548c\u589e\u91cf\u6784\u5efa\u65f6\u4f1a\u6bd4 make \u66f4\u5feb\uff0c\u540c\u65f6\u9ed8\u8ba4\u91c7\u7528\u4e86\u5e76\u884c\u7f16\u8bd1\uff0c\u65e0\u9700\u50cf make \u90a3\u6837\u901a\u8fc7 <code>-j</code> \u9009\u9879\u6765\u5f00\u542f\u5e76\u884c\u3002</p> <p>Ninja \u7684\u6784\u5efa\u6587\u4ef6\u8bed\u6cd5\u6bd4 makefile \u66f4\u7b80\u5355\uff0c\u529f\u80fd\u4e5f\u66f4\u5f31\uff0c\u5982\u679c\u8ba9\u4eba\u7c7b\u6765\u624b\u5199\u7684\u8bdd\u4f1a\u975e\u5e38\u957f\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u4e00\u822c\u4e0d\u624b\u5199 Ninja \u6587\u4ef6\uff0c\u800c\u662f\u901a\u8fc7\u5143\u6784\u5efa\u7cfb\u7edf\u6765\u751f\u6210\uff0c\u4f8b\u5982 GN\u3002Ninja \u5728 Windows \u4e0a\u4e5f\u662f\u53ef\u4ee5\u4f7f\u7528\u7684\u3002</p>"},{"location":"build-system/xmake/","title":"XMake","text":"<p>XMake \u662f\u57fa\u4e8e Lua \u8bed\u8a00\u7684\u7f16\u8bd1\u7cfb\u7edf\uff0c\u5b83\u7ed3\u5408\u4e86\u5305\u7ba1\u7406\u548c\u7f16\u8bd1\u7cfb\u7edf\uff0c\u53ea\u9700\u8981\u7f16\u5199\u4e00\u4e2a xmake \u811a\u672c\uff0c\u5c31\u80fd\u81ea\u52a8\u4e0b\u8f7d\u4f9d\u8d56\u5e76\u7f16\u8bd1\u9879\u76ee\uff0c\u4e0d\u9700\u8981\u50cf CMake \u90a3\u6837\u9700\u8981\u624b\u52a8\u5904\u7406\u4f9d\u8d56\u7684\u83b7\u53d6\uff0c\u4e5f\u4e0d\u9700\u8981\u50cf conan \u4ee5\u53ca vcpkg \u7b49\u7b2c\u4e09\u65b9\u5305\u7ba1\u7406\u8f6f\u4ef6\u90a3\u6837\u9700\u8981\u624b\u52a8\u4fee\u6539 CMake \u811a\u672c\u3002\u540c\u65f6 XMake \u5185\u7f6e\u4e86\u9664\u4e86 Windows \u4ee5\u53ca Linux \u4e4b\u5916\u8bb8\u591a\u5e73\u53f0\u7684\u652f\u6301\uff0c\u4f8b\u5982 Android\u3001iOS \u7b49\uff0c\u4e5f\u53ef\u4ee5\u517c\u5bb9\u5df2\u6709\u7684 CMake/Makefile \u7b49\u9879\u76ee\u3002</p>"},{"location":"ci/","title":"\u6982\u89c8","text":"<p>\u5982\u679c\u6bcf\u6b21\u7f16\u5199\u5b8c\u4ee3\u7801\u540e\uff0c\u90fd\u9700\u8981\u624b\u52a8\u8fd0\u884c\u7f16\u8bd1\u3001\u6d4b\u8bd5\uff0c\u4f1a\u6bd4\u8f83\u9ebb\u70e6\u3002\u501f\u52a9\u6301\u7eed\u96c6\u6210\u5de5\u5177\uff0c\u6211\u4eec\u53ef\u4ee5\u548c\u4ee3\u7801\u7248\u672c\u7ba1\u7406\u5e73\u53f0\u96c6\u6210\uff0c\u5728\u6bcf\u6b21\u4e0a\u4f20\u4ee3\u7801\u540e\uff0c\u8ba9\u670d\u52a1\u5668\u6765\u5e2e\u6211\u4eec\u7f16\u8bd1\u3001\u6d4b\u8bd5\uff0c\u5e76\u5c06\u7ed3\u679c\u4fdd\u5b58\u4e0b\u6765\uff0c\u65b9\u4fbf\u67e5\u770b\u3002</p> <p>\u672c\u8282\u5c06\u5e26\u4f60\u4e86\u89e3\u6301\u7eed\u96c6\u6210\u7684\u8fc7\u7a0b\u4ee5\u53ca\u5e38\u7528\u5e73\u53f0\u3002</p>"},{"location":"ci/#\u6301\u7eed\u96c6\u6210\u7684\u8fc7\u7a0b","title":"\u6301\u7eed\u96c6\u6210\u7684\u8fc7\u7a0b","text":"<p>\u7b80\u5355\u6765\u8bf4\uff0c\u6301\u7eed\u96c6\u6210\u5c31\u662f\u5728\u6bcf\u6b21\u4ee3\u7801\u63d0\u4ea4\u4e4b\u524d\uff0c\u90fd\u8fd0\u884c\u4e00\u7cfb\u5217\u7684\u81ea\u52a8\u5316\u5de5\u5177\uff0c\u4ee5\u4fdd\u8bc1\u4ee3\u7801\u5e93\u4e2d\u7684\u4ee3\u7801\u80fd\u591f\u6b63\u5e38\u7f16\u8bd1\u3001\u8fd0\u884c\u5e76\u901a\u8fc7\u6d4b\u8bd5\u3002\u901a\u8fc7\u81ea\u52a8\u5316\u7684\u5de5\u5177\uff0c\u53ef\u4ee5\u907f\u514d\u5f15\u5165\u9519\u8bef\uff0c\u540c\u65f6\u4e5f\u4fdd\u8bc1\u5927\u5bb6\u90fd\u5bf9\u4ec0\u4e48\u6837\u7684\u4ee3\u7801\u53ef\u4ee5\u63d0\u4ea4\u6709\u4e00\u5b9a\u5171\u8bc6\u3002</p> <p>\u4e00\u822c\u6765\u8bf4\uff0c\u6301\u7eed\u96c6\u6210\u662f\u5728\u670d\u52a1\u5668\u5b8c\u6210\u7684\u3002\u6301\u7eed\u96c6\u6210\u7cfb\u7edf\u548c\u7248\u672c\u7ba1\u7406\u7cfb\u7edf\u96c6\u6210\uff0c\u6bcf\u5f53\u5f00\u53d1\u8005\u5728\u81ea\u5df1\u7684\u4ee3\u7801\u5206\u652f\u5b8c\u6210\u4fee\u6539\u5e76\u63a8\u9001\u5230\u670d\u52a1\u5668\u4e4b\u540e\uff0c\u7248\u672c\u7ba1\u7406\u7cfb\u7edf\u5c31\u4f1a\u901a\u77e5\u6301\u7eed\u96c6\u6210\u7cfb\u7edf\u9488\u5bf9\u672c\u6b21\u63d0\u4ea4\u8fd0\u884c\u6d4b\u8bd5\u3002</p> Git Hooks <p>\u5bf9\u4e8e Git \u800c\u8a00\uff0c\u8fd9\u79cd\u901a\u77e5\u53ef\u4ee5\u4f7f\u7528 Git Hooks \u529f\u80fd\u4e2d\u7684 <code>post-receive</code> \u6765\u5b9e\u73b0\u3002\u5f53\u7136\u6211\u4eec\u4e00\u822c\u4e0d\u9700\u8981\u81ea\u5df1\u7f16\u5199\u811a\u672c\uff0c\u4e00\u4e9b\u4ee3\u7801\u6258\u7ba1\u5e73\u53f0\u4f8b\u5982 GitHub \u6216\u8005 GitLab \u90fd\u6709\u65b9\u4fbf\u6613\u7528\u7684 Web \u754c\u9762\u6765\u5e2e\u52a9\u6211\u4eec\u8fde\u63a5\u6301\u7eed\u96c6\u6210\u7cfb\u7edf\u3002</p> <p>\u4e00\u4e9b\u6743\u9650\u7ba1\u7406\u4e5f\u53ef\u4ee5\u901a\u8fc7 Git Hooks \u5b9e\u73b0\u3002</p> <p>\u6301\u7eed\u96c6\u6210\u7cfb\u7edf\u4e00\u822c\u4f1a\u6536\u5230\u4ee5\u4e0b\u4fe1\u606f\uff1a\u4ee3\u7801\u5e93\u3001\u5206\u652f\u4ee5\u53ca\u5bf9\u5e94\u7684 Commit \u4fe1\u606f\u3002\u6301\u7eed\u96c6\u6210\u7cfb\u7edf\u6839\u636e\u63a5\u6536\u5230\u7684\u53c2\u6570\u8fd0\u884c\u4e00\u7cfb\u5217\u7f16\u5199\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u811a\u672c\uff0c\u5e76\u6839\u636e\u811a\u672c\u8fd4\u56de\u503c\u51b3\u5b9a\u672c\u6b21\u8fd0\u884c\u662f\u5426\u6210\u529f\u3002\u6700\u540e\uff0c\u6301\u7eed\u96c6\u6210\u7cfb\u7edf\u4e5f\u4f1a\u53cd\u8fc7\u6765\u901a\u77e5\u7248\u672c\u7ba1\u7406\u7cfb\u7edf\u672c\u6b21\u8fd0\u884c\u662f\u5426\u6210\u529f\uff0c\u4ece\u800c\u5e2e\u52a9\u7248\u672c\u7ba1\u7406\u7cfb\u7edf\u51b3\u5b9a\u8fd9\u4e2a\u5206\u652f\u80fd\u5426\u5408\u5e76\u5230\u4e3b\u5206\u652f\u3002</p> <p>\u5e38\u7528\u7684\u6301\u7eed\u96c6\u6210\u7cfb\u7edf\u6709 Jenkins\u3001Drone CI\uff0c\u6216\u662f\u4e00\u4e9b\u7248\u672c\u7ba1\u7406\u7cfb\u7edf\u672c\u8eab\u5c31\u81ea\u5e26 CI \u529f\u80fd\uff0c\u4f8b\u5982 GitHub Actions\u3001GitLab CI\u3002</p>"},{"location":"ci/#\u6301\u7eed\u96c6\u6210\u7684\u914d\u7f6e","title":"\u6301\u7eed\u96c6\u6210\u7684\u914d\u7f6e","text":"<p>\u4e00\u822c\u800c\u8a00\uff0c\u6301\u7eed\u96c6\u6210\u7cfb\u7edf\u4f1a\u8bfb\u53d6\u4ee3\u7801\u5e93\u4e2d\u6307\u5b9a\u6587\u4ef6\u540d\u4f5c\u4e3a\u914d\u7f6e\u6587\u4ef6\uff0c\u4f8b\u5982 Jenkins \u4f1a\u8bfb\u53d6 <code>Jenkinsfile</code>\uff0c\u800c GitLab CI \u4f1a\u8bfb\u53d6 <code>.gitlab.ci.yml</code>\u3002\u4e0d\u540c\u7684\u6301\u7eed\u96c6\u6210\u7cfb\u7edf\u914d\u7f6e\u65b9\u5f0f\u5dee\u522b\u5f88\u5927\uff0c\u4f46\u662f\u6982\u5ff5\u4e0a\u90fd\u5dee\u4e0d\u591a\u3002\u9996\u5148\uff0c\u4e00\u4e2a\u6301\u7eed\u96c6\u6210\u914d\u7f6e\u4f1a\u6709\u4e00\u6761\u6d41\u6c34\u7ebf\uff08Pipeline\uff09\uff0c\u6d41\u6c34\u7ebf\u4e2d\u4f1a\u6709\u4e0d\u540c\u7684\u9636\u6bb5\uff08Stage\uff09\uff0c\u4e00\u4e2a\u9636\u6bb5\u4e2d\u4f1a\u6709\u4e0d\u540c\u7684\u4efb\u52a1\uff08Job\uff09\u3002\u4efb\u52a1\u662f\u8fd0\u884c\u7f16\u8bd1\u3001\u6d4b\u8bd5\u7b49\u7684\u57fa\u672c\u5355\u5143\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u4e00\u4e2a\u811a\u672c\u3002\u5982\u679c\u4efb\u52a1\u6ca1\u6709\u4f9d\u8d56\u5173\u7cfb\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u5e76\u884c\u8fd0\u884c\uff0c\u7c7b\u4f3c\u6784\u5efa\u7cfb\u7edf\u4e2d\u7684\u7b56\u7565\u3002\u5f53\u4e00\u4e2a\u9636\u6bb5\u4e2d\u7684\u6240\u6709\u4efb\u52a1\u90fd\u6210\u529f\u5b8c\u6210\u540e\uff0c\u624d\u4f1a\u6267\u884c\u4e0b\u4e00\u4e2a\u9636\u6bb5\u7684\u4efb\u52a1\u3002\u4f8b\u5982\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u5728\u7f16\u8bd1\u9636\u6bb5\u68c0\u67e5\u4ee3\u7801\u662f\u5426\u80fd\u591f\u7f16\u8bd1\uff0c\u4e0d\u80fd\u7684\u8bdd\u5c31\u6ca1\u6709\u5fc5\u8981\u4e5f\u6ca1\u6709\u529e\u6cd5\u8fd0\u884c\u6d4b\u8bd5\u9636\u6bb5\u3002</p> <p>\u4e00\u4e2a\u5178\u578b\u7684\u6d41\u6c34\u7ebf\u53ef\u80fd\u5305\u542b\u8fd9\u4e9b\u9636\u6bb5\uff1a\u9759\u6001\u68c0\u67e5\u2192\u7f16\u8bd1\u2192\u6d4b\u8bd5\u2192\u6253\u5305\u2192\u90e8\u7f72\u3002</p> <p>\u5728\u7f16\u5199\u4e00\u4e2a\u4efb\u52a1\u7684\u65f6\u5019\uff0c\u5f80\u5f80\u9700\u8981\u6307\u5b9a\u51e0\u4e2a\u53c2\u6570\uff1a</p> <ul> <li>\u8fd9\u4e2a\u4efb\u52a1\u5c5e\u4e8e\u54ea\u4e2a\u9636\u6bb5</li> <li>\u8fd9\u4e2a\u4efb\u52a1\u7684\u540d\u79f0</li> <li>\u8fd9\u4e2a\u4efb\u52a1\u6267\u884c\u6240\u9700\u8981\u7684\u73af\u5883\uff0c\u4f8b\u5982\u9700\u8981 Ubuntu 18.04 \u7684\u865a\u62df\u673a\uff0c\u6216\u8005 Nodejs:15 \u7684 Docker \u955c\u50cf</li> <li>\u8fd9\u4e2a\u4efb\u52a1\u7684\u6267\u884c\u811a\u672c\uff0c\u4f8b\u5982 <code>make</code></li> </ul> <p>\u5f53\u7136\u4e0d\u540c CI \u7cfb\u7edf\u4f1a\u63d0\u4f9b\u66f4\u591a\u9ad8\u7ea7\u7684\u529f\u80fd\uff0c\u4f8b\u5982\u6307\u5b9a\u5728\u67d0\u4e9b\u5206\u652f\u4e0a\u53ea\u8fd0\u884c\u57fa\u672c\u7684\u6d4b\u8bd5\uff0c\u6216\u8005\u5b9a\u65f6\u8fd0\u884c\u67d0\u4e9b\u4efb\u52a1\u7b49\u3002\u4e0d\u8fc7\u6700\u57fa\u672c\u7684\u529f\u80fd\u5c31\u662f\u5b9a\u4e49\u4efb\u52a1\uff0c\u7136\u540e\u5c06\u4efb\u52a1\u7ec4\u7ec7\u6210\u9636\u6bb5\u548c\u6d41\u6c34\u7ebf\u7136\u540e\u6267\u884c\u3002</p>"},{"location":"ci/github-actions/","title":"\u4f7f\u7528 Github Actions \u8fdb\u884c\u6301\u7eed\u96c6\u6210","text":"<p>\u81ea\u884c\u642d\u5efa CI \u670d\u52a1\u5668\u662f\u6bd4\u8f83\u8d39\u65f6\u8d39\u529b\u7684\u5de5\u4f5c\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u514d\u8d39\u7684 CI \u7cfb\u7edf\u6765\u8fd0\u884c CI\u3002\u672c\u8282\u4ee5 GitHub Actions \u4e3a\u4f8b\uff0c\u6765\u7ed9\u9879\u76ee\u8fd0\u884c CI\u3002</p>"},{"location":"codegen/","title":"\u6982\u89c8","text":"<p>\u4ee3\u7801\u751f\u6210\u7b80\u5355\u6765\u8bf4\u5c31\u662f\u5bf9\u4e00\u4e9b\u6a21\u677f\u8fdb\u884c\u7b80\u5355\u5730\u5b57\u7b26\u4e32\u66ff\u6362\uff0c\u751f\u6210\u6e90\u4ee3\u7801\u3002\u5728\u4e00\u4e9b\u5927\u578b\u7684\u9879\u76ee\u4e2d\uff0c\u6211\u4eec\u4e5f\u5f80\u5f80\u4f1a\u89c1\u5230\u4e00\u4e9b\u7528\u5de5\u5177\u751f\u6210\u51fa\u6765\u7684\u4ee3\u7801\u3002\u90a3\u4e48\uff0c\u65e2\u7136 C++ \u5df2\u7ecf\u6709\u5b8f\u548c\u6a21\u677f\uff0c\u4ee3\u7801\u751f\u6210\u7684\u4f18\u52bf\u5728\u54ea\u91cc\u5462\uff1f\u4ec0\u4e48\u65f6\u5019\u6211\u4eec\u9700\u8981\u4f7f\u7528\u4ee3\u7801\u751f\u6210\uff1f</p>"},{"location":"codegen/#\u9879\u76ee\u811a\u624b\u67b6","title":"\u9879\u76ee\u811a\u624b\u67b6","text":"<p>\u4f8b\u5982\uff0c\u6211\u4eec\u5199 C++ \u9879\u76ee\uff0c\u603b\u4f1a\u9700\u8981\u4f7f\u7528\u5230\u4e00\u4e9b\u5e38\u7528\u5e93\uff0c\u5e76\u4e14\u65b0\u5efa\u7c7b\u4f3c <code>src</code>\u3001<code>include</code> \u7684\u6587\u4ef6\u5939\uff0c\u4ee5\u53ca <code>CMakeLists.txt</code> \u7b49\u7528\u4e8e\u6784\u5efa\u7684\u6587\u4ef6\u3002\u53e6\u5916\uff0c\u5f53\u6211\u4eec\u5199\u7684\u7a0b\u5e8f\u529f\u80fd\u4e0a\u6bd4\u8f83\u76f8\u4f3c\uff0c\u6bd4\u5982\u90fd\u662f\u5199\u670d\u52a1\u5668\u4ee3\u7801\u7684\u8bdd\uff0c\u901a\u5e38\u4e5f\u4f1a\u9075\u5faa\u4e00\u5b9a\u7684\u8303\u5f0f\u3002\u5982\u679c\u6bcf\u6b21\u5199\u65b0\u9879\u76ee\u90fd\u4ece\u5934\u7f16\u5199\u8fd9\u4e9b\u6837\u672c\u4ee3\u7801\uff0c\u5c31\u662f\u6d6a\u8d39\u65f6\u95f4\u3002\u8fd9\u65f6\u5019\u6211\u4eec\u53ef\u4ee5\u9884\u5148\u7f16\u5199\u597d\u4e00\u4e9b\u6a21\u677f\u4ee3\u7801\uff0c\u7136\u540e\u4f7f\u7528\u811a\u672c\u66ff\u6362\u540d\u79f0\u7b49\u6765\u751f\u6210\u8fd9\u4e9b\u57fa\u672c\u7684\u811a\u624b\u67b6\uff0c\u8282\u7ea6\u65f6\u95f4\u3002</p>"},{"location":"codegen/#\u4ee3\u7801\u7ffb\u8bd1","title":"\u4ee3\u7801\u7ffb\u8bd1","text":""},{"location":"codegen/#\u63a5\u53e3\u63cf\u8ff0\u8bed\u8a00","title":"\u63a5\u53e3\u63cf\u8ff0\u8bed\u8a00","text":"<p>\u5728\u670d\u52a1\u5668\u9879\u76ee\u4e2d\uff0c\u6211\u4eec\u5f80\u5f80\u9700\u8981\u4f7f\u7528\u5230\u63a5\u53e3\u63cf\u8ff0\u8bed\u8a00\uff08IDL\uff09\uff0c\u65b9\u4fbf\u4e0d\u540c\u8bed\u8a00\u4e0e\u670d\u52a1\u5668\u8fdb\u884c\u901a\u4fe1\uff0c\u4f8b\u5982 Protocol Buffers\u3001Thrift \u7b49\u3002\u8fd9\u4e9b\u63a5\u53e3\u63cf\u8ff0\u8bed\u8a00\u662f\u72ec\u7acb\u4e8e\u6240\u6709\u8bed\u8a00\u7684 DSL\uff0c\u65e0\u6cd5\u76f4\u63a5\u88ab\u5f15\u7528\u3002\u8fd9\u65f6\u5019\u5c31\u9700\u8981\u751f\u6210\u51fa\u5bf9\u5e94\u7f16\u7a0b\u8bed\u8a00\u7684\u7ed3\u6784\u4f53\u4ee5\u53ca\u8f85\u52a9\u51fd\u6570\uff0c\u8fd9\u6837\u624d\u80fd\u88ab\u5f00\u53d1\u8005\u4f7f\u7528\u3002</p>"},{"location":"codegen/#sql-\u7ed3\u6784\u8f6c\u8bd1","title":"SQL \u7ed3\u6784\u8f6c\u8bd1","text":"<p>\u5047\u5982\u4f7f\u7528\u4e86 SQL \u6570\u636e\u5e93\uff0c\u90a3\u4e48\u53ef\u4ee5\u4ece\u6570\u636e\u5e93\u4e2d\u63d0\u53d6\u8868\u7ed3\u6784\uff0c\u751f\u6210\u5bf9\u5e94\u7684\u7ed3\u6784\u4f53\u5b9a\u4e49\uff0c\u4e5f\u53ef\u4ee5\u751f\u6210 IDL \u518d\u8fdb\u4e00\u6b65\u8f6c\u8bd1\u3002</p>"},{"location":"codegen/#\u9879\u76ee\u91cd\u6784","title":"\u9879\u76ee\u91cd\u6784","text":"<p>\u5728\u9762\u4e34\u5927\u89c4\u6a21\u7684 API \u53d8\u52a8\u4ee5\u53ca\u9879\u76ee\u91cd\u6784\u7b49\u60c5\u51b5\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee3\u7801\u5206\u6790\u5de5\u5177\u5148\u5bf9\u6e90\u4ee3\u7801\u8fdb\u884c\u5206\u6790\uff0c\u7136\u540e\u505a\u4e00\u5b9a\u53d8\u6362\u518d\u8f93\u51fa\u3002</p>"},{"location":"codegen/#\u8282\u7ea6\u91cd\u590d\u52b3\u52a8","title":"\u8282\u7ea6\u91cd\u590d\u52b3\u52a8","text":"<p>\u6709\u65f6\u5019\u6709\u4e00\u4e9b\u4ee3\u7801\u9700\u8981\u6709\u5927\u5757\u7684\u5305\u88c5\u51fd\u6570\uff0c\u8fd9\u65f6\u5019\u4f7f\u7528\u5b8f\u4f1a\u975e\u5e38\u590d\u6742\uff0c\u96be\u4ee5\u8c03\u8bd5\uff1b\u6216\u8005\u662f\u9700\u8981\u8de8\u8d8a\u591a\u4e2a\u6587\u4ef6\u6dfb\u52a0\u4ee3\u7801\uff0c\u4f8b\u5982\u6dfb\u52a0\u4e86\u4e00\u4e2a API\uff0c\u9700\u8981\u5bf9\u5e94\u5730\u6dfb\u52a0\u5904\u7406\u5668\u7b49\uff1b\u6216\u8005\u662f\u9700\u8981\u751f\u6210\u4e00\u4e9b\u6a21\u677f\u6ca1\u6709\u80fd\u529b\u751f\u6210\u7684\u90e8\u5206\uff0c\u4f8b\u5982\u751f\u6210\u51fd\u6570\u7b7e\u540d\u7b49\uff1b\u6709\u7684\u65f6\u5019\u751f\u6210\u4ee3\u7801\u6709\u5927\u91cf\u6761\u4ef6\u5224\u65ad\u6765\u751f\u6210\u4e0d\u540c\u7684\u4ee3\u7801\uff0c\u8fd9\u65f6\u5019\u4f7f\u7528\u6a21\u677f\u5c31\u4e0d\u592a\u7075\u6d3b\u3002</p> <p>\u4f8b\u5982\uff0cPyTorch \u5927\u91cf\u5730\u5229\u7528\u4e86\u4ee3\u7801\u751f\u6210\u6765\u751f\u6210 API \u4ee5\u53ca\u81ea\u52a8\u6c42\u5bfc\u4ee3\u7801\u3002</p>"},{"location":"codegen/#\u603b\u7ed3","title":"\u603b\u7ed3","text":"<p>\u4ee3\u7801\u751f\u6210\u7684\u7f3a\u70b9\u5c31\u662f\uff0c\u6bcf\u6b21\u4fee\u6539\u4e86\u6a21\u677f\u4ee3\u7801\u90fd\u8981\u91cd\u65b0\u751f\u6210\u4e00\u6b21\uff0c\u800c\u4e14\u751f\u6210\u51fa\u6765\u7684\u4ee3\u7801\u5f80\u5f80\u53ef\u8bfb\u6027\u6781\u5dee\u3002\u800c\u4e14\u5982\u679c\u4e0d\u5c06\u751f\u6210\u7684\u4ee3\u7801\u63d0\u4ea4\u5230\u7248\u672c\u7ba1\u7406\u8f6f\u4ef6\u7684\u8bdd\uff0c\u5f00\u53d1\u4eba\u5458\u8fd8\u9700\u8981\u989d\u5916\u5b89\u88c5\u4ee3\u7801\u751f\u6210\u5de5\u5177\u5e76\u8fd0\u884c\u4e00\u6b21\u4ee3\u7801\u751f\u6210\u624d\u80fd\u6b63\u5e38\u6d4f\u89c8\u548c\u7f16\u8bd1\u9879\u76ee\u3002\u53e6\u5916\uff0c\u4ee3\u7801\u751f\u6210\u5de5\u5177\u5f80\u5f80\u4f1a\u8986\u76d6\u6389\u5df2\u6709\u6587\u4ef6\uff0c\u9664\u4e86\u811a\u624b\u67b6\uff0c\u4e00\u822c\u751f\u6210\u51fa\u6765\u7684\u4ee3\u7801\u662f\u4e0d\u53ef\u4ee5\u7f16\u8f91\u7684\uff0c\u5f53\u7136\u5982\u679c\u4f60\u786e\u5b9a\u81ea\u5df1\u5728\u505a\u4ec0\u4e48\u4e5f\u53ef\u4ee5\u4fee\u6539\uff0c\u53ea\u662f\u9700\u8981\u6ce8\u610f\u4fee\u6539\u4e0d\u8981\u88ab\u4e0b\u4e00\u6b21\u7684\u751f\u6210\u7ed9\u8986\u76d6\u3002</p> <p>\u5f53\u7136\uff0c\u4ee3\u7801\u751f\u6210\u4e5f\u6709\u4f18\u70b9\uff0c\u751f\u6210\u7684\u4ee3\u7801\u4e00\u822c\u65b9\u4fbf\u7f16\u8bd1\u5668\u89e3\u6790\uff0c\u7f16\u8f91\u5668\u667a\u80fd\u63d0\u793a\u76f8\u6bd4\u4e8e\u5b8f\u4f1a\u66f4\u51c6\u786e\u3002\u800c\u4e14\u5728\u5355\u6b65\u8c03\u8bd5\u7684\u65f6\u5019\u4e5f\u4f1a\u66f4\u65b9\u4fbf\u3002</p> <p>\u5927\u90e8\u5206\u65f6\u5019\uff0c\u90fd\u5e94\u8be5\u4f7f\u7528\u5e93\u6216\u8005\u6a21\u677f\u6765\u91cd\u7528\u4ee3\u7801\uff0c\u4f46\u5728\u5fc5\u8981\u7684\u65f6\u5019\uff0c\u4f8b\u5982\u8de8\u8bed\u8a00\u5171\u4eab\u5b9a\u4e49\u3001\u4f7f\u7528\u5b8f\u6216\u8005\u6a21\u677f\u8fc7\u4e8e\u590d\u6742\u3001\u8de8\u6587\u4ef6\u6dfb\u52a0\u4ee3\u7801\u6216\u8005\u8bed\u8a00\u672c\u8eab\u6839\u672c\u6ca1\u6709\u63d0\u4f9b\u5b8f\u6216\u8005\u6a21\u677f\u7684\u60c5\u51b5\u4e0b\uff0c\u4e5f\u53ef\u4ee5\u9002\u5f53\u5229\u7528\u4ee3\u7801\u751f\u6210\u6765\u8282\u7ea6\u5de5\u4f5c\u91cf\u3002</p>"},{"location":"collaboration/getting-started-on-a-project/","title":"\u5feb\u901f\u4e0a\u624b\u9879\u76ee","text":"<p>\u5728\u4e86\u89e3\u4e00\u4e2a\u65b0\u7684\u9879\u76ee\u7684\u65f6\u5019\uff0c\u5982\u679c\u6ca1\u6709\u591a\u5c11\u7ecf\u9a8c\u7684\u8bdd\u5f80\u5f80\u4f1a\u88ab\u5e9e\u5927\u7684\u4ee3\u7801\u5e93\u6240\u9707\u64bc\u800c\u611f\u5230\u4e0d\u77e5\u6240\u63aa\uff0c\u4f46\u6bd5\u7adf\u9879\u76ee\u4e5f\u662f\u4eba\u5199\u51fa\u6765\u7684\uff0c\u4e0d\u7528\u62c5\u5fc3\u7406\u89e3\u4e0d\u4e86\u7684\u95ee\u9898\uff0c\u53ea\u662f\u9700\u8981\u627e\u5230\u4e00\u4e2a\u6b63\u786e\u7684\u65b9\u6cd5\u6765\u5feb\u901f\u4e0a\u624b\u3002</p>"},{"location":"collaboration/getting-started-on-a-project/#\u5c1d\u8bd5\u7f16\u8bd1","title":"\u5c1d\u8bd5\u7f16\u8bd1","text":"<p>\u4e86\u89e3\u4e00\u4e2a\u9879\u76ee\u4e4b\u524d\uff0c\u6700\u597d\u5148\u6309\u7167\u6587\u6863\u5c1d\u8bd5\u642d\u5efa\u5f00\u53d1\u73af\u5883\uff0c\u7136\u540e\u5c1d\u8bd5\u7f16\u8bd1\u6574\u4e2a\u9879\u76ee\u3002\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\uff0c\u4f60\u5c31\u53ef\u4ee5\u5927\u81f4\u4e86\u89e3\u5230\u9879\u76ee\u4f7f\u7528\u7684\u5f00\u53d1\u5de5\u5177\u3001\u5f00\u53d1\u65f6\u4f9d\u8d56\u4ee5\u53ca\u8fd0\u884c\u65f6\u4f9d\u8d56\uff0c\u4ece\u800c\u5bf9\u9879\u76ee\u7684\u5916\u90e8\u73af\u5883\u6709\u4e00\u5b9a\u4e86\u89e3\u3002\u53e6\u5916\uff0c\u4e00\u4e9b\u9879\u76ee\u53ef\u80fd\u4f1a\u9700\u8981\u6839\u636e\u7f16\u8bd1\u73af\u5883\u6765\u751f\u6210\u914d\u7f6e\u5934\u6587\u4ef6\uff0c\u4e5f\u6709\u4e00\u4e9b\u4ee3\u7801\u53ef\u80fd\u9700\u8981\u751f\u6210\uff0c\u5c06\u9879\u76ee\u7f16\u8bd1\u4e00\u6b21\u53ef\u4ee5\u786e\u4fdd\u5c06\u9700\u8981\u7684\u6587\u4ef6\u90fd\u751f\u6210\u5b8c\u6bd5\u3002</p>"},{"location":"collaboration/getting-started-on-a-project/#\u914d\u7f6e-ide","title":"\u914d\u7f6e IDE","text":"<p>\u5bf9\u4e8e\u5927\u578b\u9879\u76ee\u800c\u8a00\uff0c\u4e00\u4e2a\u597d\u7528\u7684 IDE \u5fc5\u4e0d\u53ef\u5c11\uff0cIDE \u5f3a\u5927\u7684\u4ee3\u7801\u5206\u6790\u529f\u80fd\u53ef\u4ee5\u5e2e\u6211\u4eec\u5feb\u901f\u5206\u6790\u9879\u76ee\u7ed3\u6784\uff0c\u67e5\u627e\u7c7b\u3001\u51fd\u6570\u7684\u4f7f\u7528\u548c\u5b9a\u4e49\u7b49\uff0c\u5bf9\u4e8e\u9605\u8bfb\u4ee3\u7801\u4e5f\u975e\u5e38\u6709\u5e2e\u52a9\u3002\u5982\u679c\u4f7f\u7528 CMake \u7684\u8bdd\uff0c\u53ef\u4ee5\u8981\u6c42\u751f\u6210 <code>compile_commands.json</code> \u6765\u63d0\u4f9b\u667a\u80fd\u63d0\u793a\u6240\u5fc5\u8981\u7684\u7f16\u8bd1\u4fe1\u606f\uff0c\u5982\u5b8f\u5b9a\u4e49\u4ee5\u53ca\u5e73\u53f0\u76f8\u5173\u7684\u51fd\u6570\u7b49\u3002\u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528 <code>Visual Studio</code> \u751f\u6210\u5668\uff0c\u6765\u751f\u6210 Visual Studio \u9879\u76ee\u3002</p>"},{"location":"collaboration/getting-started-on-a-project/#\u8fd0\u884c\u7a0b\u5e8f","title":"\u8fd0\u884c\u7a0b\u5e8f","text":"<p>\u5f53\u5f00\u53d1\u73af\u5883\u642d\u5efa\u5b8c\u6210\uff0c\u4ee5\u53ca\u68c0\u67e5\u9879\u76ee\u80fd\u591f\u6b63\u5e38\u7f16\u8bd1\u4e4b\u540e\uff0c\u5c31\u9700\u8981\u5c1d\u8bd5\u8fd0\u884c\u5176\u4e2d\u7684\u4ee3\u7801\u3002\u5bf9\u4e8e\u670d\u52a1\u5668\u9879\u76ee\uff0c\u4f8b\u5982 MySQL\u3001TiDB \u7b49\uff0c\u5f80\u5f80\u4f1a\u7f16\u8bd1\u51fa\u6765\u4e00\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u53ea\u9700\u8981\u6839\u636e\u6587\u6863\uff0c\u914d\u7f6e\u597d\u8fd0\u884c\u73af\u5883\u540e\u68c0\u67e5\u7a0b\u5e8f\u80fd\u5426\u6b63\u5e38\u8fd0\u884c\u5373\u53ef\u3002\u5bf9\u4e8e\u5e93\u9879\u76ee\uff0c\u4f8b\u5982 rocksdb \u7b49\uff0c\u5219\u5f80\u5f80\u4f1a\u7f16\u8bd1\u51fa\u4e00\u4e2a\u5e93\u6587\u4ef6\uff0c\u8fd9\u65f6\u5019\u662f\u6ca1\u6709\u529e\u6cd5\u76f4\u63a5\u6267\u884c\u7684\u3002\u4f46\u662f\uff0c\u5e93\u9879\u76ee\u4e00\u822c\u90fd\u4f1a\u5e26\u6709\u6d4b\u8bd5\uff08test\uff09\u6216\u8005\u793a\u4f8b\u7a0b\u5e8f\uff08example\uff09\uff0c\u5728\u7f16\u8bd1\u7684\u65f6\u5019\u5f80\u5f80\u4e5f\u4f1a\u5c06\u5b83\u4eec\u7f16\u8bd1\u51fa\u6765\uff0c\u6211\u4eec\u8fd9\u65f6\u5019\u53ef\u4ee5\u5c1d\u8bd5\u8fd0\u884c\u8fd9\u4e9b\u6d4b\u8bd5\u6216\u8005\u793a\u4f8b\u7a0b\u5e8f\u6765\u68c0\u67e5\u5e93\u662f\u5426\u6b63\u5e38\u3002</p>"},{"location":"collaboration/getting-started-on-a-project/#\u9605\u8bfb\u6e90\u7801","title":"\u9605\u8bfb\u6e90\u7801","text":"<p>\u4e00\u822c\u800c\u8a00\uff0c\u5927\u578b\u8f6f\u4ef6\u9879\u76ee\u5f80\u5f80\u5305\u542b\u4e86\u9519\u7efc\u590d\u6742\u7684\u591a\u79cd\u6a21\u5757\uff0c\u5982\u679c\u76f4\u63a5\u624e\u8fdb\u53bb\u8bfb\u6e90\u7801\u7684\u8bdd\u80af\u5b9a\u662f\u4f1a\u8ff7\u5931\u5728\u4ee3\u7801\u7684\u6d77\u6d0b\u4e2d\uff0c\u800c\u4e14\u6536\u6548\u751a\u5fae\u3002\u4e00\u822c\u800c\u8a00\uff0c\u8bfb\u6e90\u7801\u7684\u65f6\u5019\u9700\u8981\u5e26\u7740\u4e00\u4e2a\u7279\u5b9a\u7684\u76ee\u7684\uff0c\u4f8b\u5982\u4f60\u9700\u8981\u4fee\u590d\u67d0\u4e2a\u6a21\u5757\u7684 Bug\uff0c\u6216\u8005\u4f60\u60f3\u4e86\u89e3\u67d0\u4e00\u4e2a\u529f\u80fd\u662f\u5982\u4f55\u5b9e\u73b0\u7684\u3002\u5bf9\u4e8e\u5927\u578b\u9879\u76ee\u800c\u8a00\uff0c\u5f80\u5f80\u4f1a\u4f7f\u7528\u5230\u8fd0\u884c\u65f6\u591a\u6001\u7684\u529f\u80fd\uff0c\u5149\u662f\u9605\u8bfb\u9759\u6001\u7684\u4ee3\u7801\u53ef\u80fd\u5f88\u96be\u7406\u89e3\uff0c\u56e0\u6b64\uff0c\u63a8\u8350\u4f60\u4f7f\u7528 IDE \u7684\u8c03\u8bd5\u5668\u529f\u80fd\u6765\u8fd0\u884c\u7a0b\u5e8f/\u6d4b\u8bd5/\u793a\u4f8b\uff0c\u5728\u4f60\u611f\u5174\u8da3\u7684\u51fd\u6570\u4e2d\u4e0b\u65ad\u70b9\uff0c\u6216\u8005\u8ba9\u8c03\u8bd5\u5668\u5728\u7a0b\u5e8f\u5165\u53e3\u5904\u6682\u505c\uff0c\u7136\u540e\u4e00\u6b65\u6b65\u5730\u8fd0\u884c\uff0c\u6765\u5e2e\u52a9\u4f60\u4e86\u89e3\u7a0b\u5e8f\u7684\u6267\u884c\u8fc7\u7a0b\u4ee5\u53ca\u4e2d\u95f4\u72b6\u6001\u3002</p> <p>\u5f53\u7136\uff0c\u5982\u679c\u662f\u591a\u7ebf\u7a0b\u7a0b\u5e8f\u6216\u8005\u4f60\u61d2\u5f97\u4f7f\u7528\u8c03\u8bd5\u5668\uff0c\u53ef\u4ee5\u6253\u5f00 <code>Debug</code> \u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f7f\u7528\u8f93\u51fa\u5927\u6cd5\u6765\u8c03\u8bd5\u7a0b\u5e8f\u3002</p>"},{"location":"collaboration/git-workflow/","title":"\u6982\u89c8","text":"<p>\u5728\u548c\u4ed6\u4eba\u5408\u4f5c\u5f00\u53d1\u7684\u65f6\u5019\uff0c\u9700\u8981\u6211\u4eec\u66f4\u7075\u6d3b\u5730\u5904\u7406\u4ee3\u7801\u76ee\u5f55\u3002\u5728\u57fa\u672c\u7684 Git \u7248\u672c\u7ba1\u7406\u4e4b\u5916\uff0c\u6709\u8bb8\u591a\u662f\u5728\u591a\u4eba\u5408\u4f5c\u65f6\u4f1a\u7ecf\u5e38\u51fa\u73b0\u800c\u4e14\u590d\u6742\u7684\u60c5\u51b5\u3002\u6bd4\u5982\u8bf4\u4ee3\u7801\u5408\u5e76\u4f1a\u4ea7\u751f\u51b2\u7a81\uff0c\u6216\u8005\u6709\u65f6\u5019\u6211\u4eec\u9700\u8981\u67e5\u770b\u5e76\u5e2e\u52a9\u5176\u4ed6\u5f00\u53d1\u8005\u8c03\u8bd5\u4ed6\u4eec\u9047\u5230\u7684\u95ee\u9898\uff0c\u53c8\u6216\u8005\u6211\u4eec\u9700\u8981\u5c06\u4fee\u6539\u9009\u62e9\u6027\u5730\u5408\u5e76\u5230\u5176\u4ed6\u5206\u652f\u4e0a\u7b49\u3002\u63a5\u4e0b\u6765\u6211\u4eec\u5c06\u4ecb\u7ecd\u5b9e\u9645\u591a\u4eba\u5408\u4f5c\u4e2d\u53ef\u80fd\u51fa\u73b0\u7684\u68d8\u624b\u573a\u666f\uff0c\u5e76\u63d0\u4f9b\u4e0d\u540c\u7684\u89e3\u51b3\u65b9\u6848\u3002</p>"},{"location":"collaboration/git-workflow/fork-and-multi-remote-repositories/","title":"fork \u4e0e\u591a\u8fdc\u7aef\u4ed3\u5e93\u4e0b\u7684\u534f\u4f5c","text":"<p>\u5728\u4ee5 GitHub \u4e3a\u4ee3\u8868\u7684\u5f00\u6e90\u793e\u533a\u5e73\u53f0\u4e2d\uff0c\u5b58\u5728\u7740\u4e00\u4e2a\u8f83\u4e3a\u7279\u522b\u7684\u6982\u5ff5\uff1afork\u3002\u5b83\u7684\u4f5c\u7528\u662f\u5bf9\u4efb\u610f\u7528\u6237\u7684\u4ed3\u5e93\u8fdb\u884c\u201c\u590d\u5236\u201d\uff0c\u5f97\u5230\u4e00\u4e2a\u5c5e\u4e8e\u81ea\u5df1\u7684\u4ed3\u5e93\u3002\u5728 GitHub \u4e0a\u7684\u5f00\u6e90\u9879\u76ee\u4e2d\uff0cfork \u662f\u5e38\u89c1\u7684\u534f\u4f5c\u65b9\u6cd5\u4e4b\u4e00\u3002</p> <p>\u6839\u636e GitHub \u5b98\u65b9\u6587\u6863\u300aAbout forks\u300b\u7684\u4ecb\u7ecd\uff0cfork \b\u7684\u4e00\u4e2a\u7a81\u51fa\u7528\u9014\u5728\u4e8e\uff1a\u5bf9\u4e8e\u5f88\u591a\u5f00\u6e90\u9879\u76ee\u6765\u8bf4\uff0c\u4eba\u4eec\u53ef\u4ee5\u4f7f\u7528 fork \u6765\u5f97\u5230\u4e00\u4e2a\u65b0\u4ed3\u5e93\uff0c\u5e76\u5728\u65b0\u4ed3\u5e93\u91cc\u6839\u636e\u81ea\u5df1\u7684\u60f3\u6cd5\u63d0\u4ea4\u8bb8\u591a\u4fee\u6539\uff0c\u7136\u540e\u5728\u672c\u5730\u8fdb\u884c\u5145\u5206\u7684\u6d4b\u8bd5\u4e4b\u540e\u901a\u8fc7 pull request \u6765\u5c06\u81ea\u5df1\u7684\u4fee\u6539\u63d0\u4ea4\u5230\u539f\u6765\u7684\u4ee3\u7801\u4ed3\u5e93\u4e2d\u3002</p> <p>\u4e3a\u4ec0\u4e48\u9700\u8981\u4e00\u4e2a\u65b0\u4ed3\u5e93\u5462\uff1f\u8fd9\u662f\u56e0\u4e3a\u539f\u4ed3\u5e93\u5e76\u4e0d\u516c\u5f00\u63d0\u4f9b push \u6743\u9650\uff0c\u56e0\u6b64\u5373\u4f7f\u6ca1\u6709\u6743\u9650\u7684\u4eba\u4eec\u53ef\u4ee5\u628a\u4ed3\u5e93\u514b\u9686\u4e0b\u6765\uff0c\u5728\u672c\u5730\u521b\u5efa\u5206\u652f\u5e76\u63d0\u4ea4\u4fee\u6539\uff0c\u4f46\u4ed6\u4eec\u5e76\u4e0d\u80fd\u8fdb\u884c <code>push</code> \u64cd\u4f5c\uff0c\u81ea\u7136\u4e5f\u5c31\u65e0\u6cd5\u76f4\u63a5\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u6765\u63d0\u4ea4\u4ee3\u7801\uff0c\u4ee5\u53ca\u5c06\u81ea\u5df1\u7684\u5206\u652f\u76f4\u63a5\u5408\u8fdb\u4e3b\u5206\u652f\u91cc\u3002</p> Info <p>\u6839\u636e\u300aAbout collaborative development models\u300b\uff0c\u4e0a\u8ff0\u7684\u6a21\u5f0f\u4e5f\u88ab\u79f0\u4e3a Fork and pull model\uff0c\u5728\u5f00\u6e90\u9879\u76ee\u4e2d\u975e\u5e38\u6d41\u884c\u3002\u4e5f\u6709\u4e00\u79cd Shared repository model\uff0c\u5b83\u5141\u8bb8\u8d21\u732e\u8005\u76f4\u63a5\u5bf9\u4ed3\u5e93\u8fdb\u884c push\u3002\u8fd9\u79cd\u6a21\u5f0f\u5728\u79c1\u6709\u9879\u76ee\u4e2d\u8f83\u4e3a\u5e38\u89c1\u3002</p> <p>fork \u7684\u529f\u80fd\u5e76\u4e0d\u5c40\u9650\u4e8e\u6b64\u3002\u4e00\u4e9b\u5f00\u6e90\u9879\u76ee\u6709\u65f6\u5019\u4f1a\u56e0\u4e3a\u5404\u79cd\u539f\u56e0\uff08\u4eba\u529b\u4e0d\u8db3\u3001\u6cd5\u5f8b\u7ea6\u675f\u3001\u7406\u5ff5\u51b2\u7a81\u7b49\uff09\uff0c\u8fdf\u8fdf\u4e0d\u80fd\u63d0\u4f9b\u4e00\u4e9b\u65b0\u529f\u80fd\u3002\u8fd9\u65f6\u5bf9\u8fd9\u4e9b\u529f\u80fd\u6709\u5f3a\u70c8\u9700\u6c42\u7684\u4eba\u4eec\u4f1a\u4e3a\u6b64\u5f00\u8f9f\u4e00\u4e2a fork\uff0c\u4e13\u95e8\u5728\u8fd9\u4e2a fork \u4e0a\u7f16\u5199\u65b0\u529f\u80fd\u7684\u4ee3\u7801\u3002\u540c\u65f6\uff0cfork \u63d0\u4f9b\u4ece\u6e90\u4ed3\u5e93\u62c9\u53d6\u65b0\u4fee\u6539\u7684\u529f\u80fd\uff0c\u8ba9 fork \u51fa\u6765\u7684\u9879\u76ee\u5f97\u4ee5\u4e0e\u6e90\u9879\u76ee\u4fdd\u6301\u540c\u6b65\u3002\b\u4f8b\u5982\uff0cMultiMC5-Cracked \u662f\u57fa\u4e8e\u8457\u540d Minecraft\uff08\u6211\u7684\u4e16\u754c\uff09\u6e38\u620f\u542f\u52a8\u5668 MultiMC5 \u7684 fork \u7248\u672c\u3002\u56e0\u4e3a\u540e\u8005\u4e0d\u652f\u6301\u5728\u4e0d\u63d0\u4f9b\u6b63\u7248\u8d26\u53f7\u7684\u60c5\u51b5\u4e0b\u542f\u52a8\u6e38\u620f\uff0c\u6240\u4ee5\u524d\u8005\u8bde\u751f\u5e76\u63d0\u4f9b\u4e86\u65b0\u7684\u529f\u80fd\uff0c\u8ba9\u7528\u6237\u80fd\u591f\u4f7f\u7528\u975e\u6b63\u7248\u8d26\u53f7\u542f\u52a8\u6e38\u620f\u3002</p>"},{"location":"collaboration/git-workflow/fork-and-multi-remote-repositories/#\u6dfb\u52a0\u8fdc\u7aef\u4ed3\u5e93\u5e76-checkout","title":"\u6dfb\u52a0\u8fdc\u7aef\u4ed3\u5e93\u5e76 checkout","text":"<p>\u73b0\u5728\uff0c\u8bd5\u60f3\u6211\u4eec\u5c31\u662f MultiMC5-Cracked \u7684\u4f5c\u8005\uff0c\u90a3\u4e48\u53c8\u8be5\u5982\u4f55\u5728 fork \u51fa\u6765\u7684\u4ed3\u5e93\u91cc\u4ece\u6e90\u4ed3\u5e93\u62c9\u53d6\u6700\u65b0\u7684\u4fee\u6539\u5462\uff1f\u9996\u5148\uff0c\u6211\u4eec\u9700\u8981\u5728\u672c\u5730\u4ed3\u5e93\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>$ git remote -v\norigin  git@github.com:AfoninZ/MultiMC5-Cracked.git (fetch)\norigin  git@github.com:AfoninZ/MultiMC5-Cracked.git (push)\n</code></pre> <p>\u6211\u4eec\u4f7f\u7528\u6b64\u547d\u4ee4\u5217\u51fa\u4e86\u5f53\u524d\u4ed3\u5e93\u7684\u8fdc\u7aef\u4ed3\u5e93\u5730\u5740\uff0c\u5176\u4e2d\u7684 <code>(fetch)</code> \u548c <code>(push)</code> \u610f\u5473\u7740\u5bf9\u5e94\u7684\u8fdc\u7aef\u4ed3\u5e93\u53ef\u4ee5\u7528\u6765\u8fdb\u884c\u62c9\u53d6\u548c\u63a8\u9001 commit\u3002\u7136\u540e\u6211\u4eec\u4f7f\u7528 <code>git remote add</code> \u547d\u4ee4\u6765\u6dfb\u52a0\u65b0\u7684\u8fdc\u7aef\u4ed3\u5e93\uff1a</p> <pre><code>$ git remote add upstream git@github.com:MultiMC/MultiMC5.git\n$ git remote -v\norigin  git@github.com:AfoninZ/MultiMC5-Cracked.git (fetch)\norigin  git@github.com:AfoninZ/MultiMC5-Cracked.git (push)\nupstream    git@github.com:MultiMC/MultiMC5.git (fetch)\nupstream    git@github.com:MultiMC/MultiMC5.git (push)\n</code></pre> <p>\u6211\u4eec\u5c06\u6e90\u4ed3\u5e93 MultiMC5 \u6dfb\u52a0\u4e3a\u5f53\u524d\u4ed3\u5e93\u7684\u53e6\u4e00\u4e2a\u8fdc\u7aef\u4ed3\u5e93\u3002\u867d\u7136\u5b83\u540c\u6837\u6709\u4e00\u4e2a <code>(push)</code> \u6807\u8bc6\uff0c\u4f46\u6211\u4eec\u5e76\u4e0d\u80fd\u76f4\u63a5\u5c06 commit \u63a8\u9001\u5230\u6e90\u4ed3\u5e93\uff0c\u56e0\u4e3a\u6211\u4eec\u6ca1\u6709\u6743\u9650\u3002\u4e4b\u540e\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 <code>git fetch upstream</code> \u6765\u62c9\u53d6\u6e90\u4ed3\u5e93\u7684\u5206\u652f\u4fe1\u606f\uff1a</p> <pre><code>remote: Enumerating objects: 365, done.\nremote: Counting objects: 100% (333/333), done.\nremote: Compressing objects: 100% (99/99), done.\nremote: Total 365 (delta 264), reused 303 (delta 234), pack-reused 32\nReceiving objects: 100% (365/365), 131.51 KiB | 5.98 MiB/s, done.\nResolving deltas: 100% (266/266), completed with 121 local objects.\nFrom github.com:MultiMC/MultiMC5\n * [new branch]        beature/debrand                           -&gt; upstream/beature/debrand\n * [new branch]        develop                                   -&gt; upstream/develop\n// \u8fd9\u91cc\u7701\u7565\u4e86\u4e00\u4e9b\u65e0\u5173\u7d27\u8981\u7684\u5206\u652f\n * [new branch]        stable                                    -&gt; upstream/stable\n * [new tag]           0.6.12                                    -&gt; 0.6.12\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0cGit \u5c06\u6e90\u4ed3\u5e93\u7684\u5404\u79cd\u6570\u636e\u5df2\u7ecf\u62c9\u53d6\u4e86\u4e0b\u6765\uff0c\u5305\u62ec\u5404\u79cd\u5206\u652f\u7684\u4fe1\u606f\u7b49\u3002\u73b0\u5728\u5982\u679c\u6211\u4eec\u9700\u8981\u5c06\u6e90\u4ed3\u5e93\u7684 <code>stable</code> \u5206\u652f\u5408\u5e76\u5165\u6211\u4eec\u81ea\u5df1\u7684\u4ed3\u5e93\u7684 <code>stable</code> \u5206\u652f\uff0c\u53ea\u9700\u8fd0\u884c <code>git merge upstream/stable</code> \u5373\u53ef\u3002</p> Info <p>\u4f60\u53ef\u80fd\u4f1a\u5728\u4f7f\u7528 <code>git checkout stable</code> \u6765\u5207\u6362\u5230\u672c\u5730 <code>stable</code> \u5206\u652f\u65f6\u9047\u5230\u4ee5\u4e0b\u9519\u8bef\uff1a</p> <pre><code>$ git checkout stable\nhint: If you meant to check out a remote tracking branch on, e.g. 'origin',\nhint: you can do so by fully qualifying the name with the --track option:\nhint:\nhint:     git checkout --track origin/&lt;name&gt;\nhint:\nhint: If you'd like to always have checkouts of an ambiguous &lt;name&gt; prefer\nhint: one remote, e.g. the 'origin' remote, consider setting\nhint: checkout.defaultRemote=origin in your config.\nfatal: 'stable' matched multiple (2) remote tracking branches\n</code></pre> <p>\u8fd9\u91cc Git \u662f\u5728\u8bf4\uff1a<code>origin</code> \u548c <code>upstream</code> \u4e0a\u90fd\u6709\u540d\u4e3a <code>stable</code> \u7684\u5206\u652f\uff0c\u56e0\u6b64\u6211\u4eec\u8981\u4e48\u901a\u8fc7 <code>--track</code> \u53c2\u6570\u624b\u52a8\u6307\u5b9a\u8fdc\u7aef\u4ed3\u5e93\uff0c\u8981\u4e48\u901a\u8fc7 <code>git config</code> \u6765\u8bbe\u7f6e\u9ed8\u8ba4\u8981\u9009\u62e9\u7684\u8fdc\u7aef\u4ed3\u5e93\u3002</p>"},{"location":"collaboration/git-workflow/fork-and-multi-remote-repositories/#\u68c0\u67e5\u4ed6\u4eba\u7684-pull-request","title":"\u68c0\u67e5\u4ed6\u4eba\u7684 Pull request","text":"<p>\u5047\u5982\u6211\u4eec\u662f\u5f00\u6e90\u9879\u76ee\u7684\u4f5c\u8005\uff0c\u6709\u4eba\u5411\u6211\u4eec\u53d1\u6765\u4e86\u4e00\u4e2a Pull request\u3002\u5728\u8fd9\u4e2a PR \u91cc\uff0c\u4ed6\u58f0\u79f0\u5e2e\u52a9\u6211\u4eec\u5b9e\u73b0\u4e86\u4e00\u4e9b\u65b0\u529f\u80fd\uff0c\u6216\u8005\u4fee\u590d\u4e86\u4e00\u4e9b bug\u3002\u8981\u9a8c\u8bc1\u4ed6\u7684\u8bf4\u6cd5\uff0c\u6211\u4eec\u5f88\u6709\u53ef\u80fd\u9700\u8981\u5f97\u5230\u4ed6\u4fee\u6539\u7684\u5206\u652f\u5bf9\u5e94\u7684\u6e90\u7801\uff0c\u7136\u540e\u8fdb\u884c\u9700\u8981\u7684\u4e00\u4e9b\u6b65\u9aa4\uff0c\u4f8b\u5982\u7f16\u8bd1\u8fd0\u884c\uff0c\u624b\u52a8\u6d4b\u8bd5\u7b49\u3002\u6211\u4eec\u6709\u4e24\u79cd\u65b9\u6cd5\u6765\u5f97\u5230 Pull request \u5bf9\u5e94\u7684\u6e90\u7801\u3002</p>"},{"location":"collaboration/git-workflow/fork-and-multi-remote-repositories/#\u76f4\u63a5-fetch-\u5bf9\u5e94\u7684-pull-request","title":"\u76f4\u63a5 fetch \u5bf9\u5e94\u7684 Pull request","text":"<p>\u50cf GitHub \u8fd9\u6837\u7684\u5e73\u53f0\u652f\u6301\u76f4\u63a5\u5728\u672c\u5730\u4ed3\u5e93\u8fd0\u884c <code>git fetch origin pull/ID/head:BRANCHNAME</code> \u6765\u5c06\u7f16\u53f7\u4e3a <code>ID</code> \u7684 Pull request \u5bf9\u5e94\u7684\u5206\u652f\u62c9\u53d6\u5230\u672c\u5730\u540d\u4e3a <code>BRANCHNAME</code> \u7684\u5206\u652f\u4e0a\u3002</p>"},{"location":"collaboration/git-workflow/fork-and-multi-remote-repositories/#\u6dfb\u52a0-refspec","title":"\u6dfb\u52a0 Refspec","text":"<p>\u6211\u4eec\u9700\u8981\u4fee\u6539\u672c\u5730\u4ed3\u5e93\u7684 <code>.git/config</code> \u6587\u4ef6\uff0c\u5728 <code>[remote \"origin\"]</code> \u680f\u76ee\u4e0b\u6dfb\u52a0\u65b0\u7684\u4e00\u884c\uff1a</p> <pre><code>fetch = +refs/pull/*/head:refs/pull/origin/*\n</code></pre> Info <p>\u8fd9\u9879\u914d\u7f6e\u88ab\u5b98\u65b9\u6587\u6863\u79f0\u4e3a Refspec\uff0c\u5b83\u6307\u5b9a\u4e86 Git \u5e94\u8be5\u5c06\u8fdc\u7aef\u4ed3\u5e93\u7684\u54ea\u4e9b reference \u62c9\u53d6\u5230\u672c\u5730\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5b83\u7684\u914d\u7f6e\u4e3a\uff1a</p> <pre><code>fetch = +refs/heads/*:refs/remotes/origin/*\n</code></pre> <p>\u5b83\u610f\u5473\u7740\u5728\u8fdb\u884c <code>git fetch</code> \u65f6\uff0cGit \u4f1a\u5c06\u8fdc\u7aef\u4ed3\u5e93\u4e0a <code>refs/heads</code> \u6587\u4ef6\u5939\u4e0b\u7684\u6240\u6709 reference \u6587\u4ef6\u62c9\u53d6\u5230\u672c\u5730\u7684 <code>refs/remotes/origin/</code> \u6587\u4ef6\u5939\u91cc\u3002\u4e3a\u4e86\u80fd\u591f\u62c9\u53d6 Pull request\uff0c\u6211\u4eec\u53ef\u4ee5\u6dfb\u52a0\u4e0a\u8ff0\u7684\u65b0\u7684\u4e00\u884c\u914d\u7f6e\u3002\u66f4\u591a\u7ec6\u8282\u8bf7\u89c1\u5b98\u65b9\u6587\u6863\u3002</p> <p>\u4e4b\u540e\u6211\u4eec\u8fd0\u884c <code>git fetch origin</code>\uff0c\u5f97\u5230\u4e86\u4ee5\u4e0b\u8f93\u51fa\u3002\u6211\u4eec\u8fd9\u91cc\u4ecd\u4ee5\u4e0a\u6587\u63d0\u5230\u7684 MultiMC5-Cracked \u5728 GitHub \u4e0a\u7684\u4ed3\u5e93\u4e3a\u4f8b\uff1a</p> <pre><code>$ git fetch origin\nremote: Enumerating objects: 772, done.\nremote: Counting objects: 100% (406/406), done.\nremote: Compressing objects: 100% (88/88), done.\nremote: Total 772 (delta 289), reused 394 (delta 283), pack-reused 366\nReceiving objects: 100% (772/772), 140.63 KiB | 249.00 KiB/s, done.\nResolving deltas: 100% (352/352), completed with 59 local objects.\nFrom github.com:AfoninZ/MultiMC5-Cracked\n * [new ref]           refs/pull/1/head  -&gt; refs/pull/origin/1\n * [new ref]           refs/pull/10/head -&gt; refs/pull/origin/10\n * [new ref]           refs/pull/11/head -&gt; refs/pull/origin/11\n // \u4ee5\u4e0b\u7701\u7565\n</code></pre> <p>\u6211\u4eec\u62c9\u53d6\u4e86\u6b64\u4ed3\u5e93\u7684\u6240\u6709 Pull request \u5bf9\u5e94\u7684\u5206\u652f\uff0c\u5176\u4e2d\u7684\u6570\u5b57\u5c31\u662f Pull request \u7684\u7f16\u53f7\u3002\u5982\u679c\u6211\u4eec\u60f3\u8981\u68c0\u67e5\u7f16\u53f7\u4e3a <code>11</code> \u7684 Pull request\uff0c\u53ef\u4ee5\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a<code>git checkout -b pr-11 pull/origin/11</code> \u6765\u5207\u6362\u5230\u5bf9\u5e94\u7684\u5206\u652f\u3002</p> Warning <p><code>refs/pull</code> \u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u90fd\u662f\u53ea\u8bfb\u7684\uff0c\u8fd9\u610f\u5473\u7740\u65e0\u8bba\u6211\u4eec\u4f7f\u7528\u7684\u662f\u65b9\u6cd5\u4e00\u8fd8\u662f\u65b9\u6cd5\u4e8c\uff0c\u5728\u5207\u6362\u5230 <code>pr-11</code> \u5206\u652f\u4e4b\u540e\u90fd\u65e0\u6cd5\u76f4\u63a5\u8fdb\u884c <code>push</code>\u3002\u4e0d\u8fc7\u6211\u4eec\u4ecd\u7136\u53ef\u4ee5\u901a\u8fc7 <code>git push origin NAME</code> \u6765\u5c06\u5f53\u524d\u5206\u652f\u63a8\u9001\u5230\u8fdc\u7aef\u4ed3\u5e93\u91cc\u4e00\u4e2a\u65b0\u7684\u53eb\u505a <code>NAME</code> \u7684\u5206\u652f\u4e0a\u3002</p>"},{"location":"collaboration/git-workflow/resolve-conflicts/","title":"\u89e3\u51b3\u4ee3\u7801\u5408\u5e76\u51b2\u7a81","text":"<p>\u5728\u4f7f\u7528 Git \u5bf9\u6211\u4eec\u7684\u9879\u76ee\u4ee3\u7801\u8fdb\u884c\u7248\u672c\u7ba1\u7406\u65f6\uff0c\u6211\u4eec\u5f80\u5f80\u4f1a\u4f7f\u7528\u5404\u79cd\u5206\u652f\uff08branch\uff09\u6765\u5c06\u6211\u4eec\u7684\u4ee3\u7801\u9694\u79bb\u5728\u5176\u4ed6\u4eba\u7684\u5206\u652f\u548c\u4e3b\u5206\u652f\u4ee5\u5916\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u80fd\u786e\u4fdd\u6211\u4eec\u7684\u4ee3\u7801\u4e0d\u4f1a\u5f71\u54cd\u5230\u5176\u4ed6\u4eba\uff0c\u4e5f\u4e0d\u4f1a\u5f71\u54cd\u5230\u9879\u76ee\u7684\u4e3b\u5206\u652f\u3002\u7136\u800c\uff0c\u5f53\u6211\u4eec\u5b8c\u6210\u4e86\u81ea\u5df1\u7684\u5de5\u4f5c\uff0c\u51c6\u5907\u5c06\u81ea\u5df1\u7684\u5206\u652f\u5408\u5e76\u5230\u4e3b\u5206\u652f\u65f6\uff0c\u6709\u53ef\u80fd\u4f1a\u51fa\u73b0\u5408\u5e76\u51b2\u7a81\uff08merge conflict\uff09\uff0c\u5bfc\u81f4\u6211\u4eec\u7684\u5206\u652f\u65e0\u6cd5\u88ab\u5408\u5e76\u3002</p> Info <p>\u672c\u6587\u4e2d\u4f1a\u591a\u6b21\u51fa\u73b0\u4e3b\u5206\u652f\u7684\u6982\u5ff5\u3002\u72ed\u4e49\u4e0a\uff0c\u4e3b\u5206\u652f\u6307\u7684\u662f\u50cf <code>master</code> \u5206\u652f\u6216 <code>main</code> \u5206\u652f\u8fd9\u6837\u7684\u5206\u652f\uff0c\u5b83\u4eec\u662f\u5404\u79cd\u7279\u6027\uff08feature\uff09\u5206\u652f\u3001bug \u4fee\u590d\u5206\u652f\u7b49\u5206\u652f\u7684\u6700\u7ec8\u5f52\u5c5e\u3002\u5e7f\u4e49\u4e0a\uff0c\u5b83\u4eec\u4e5f\u53ef\u4ee5\u6307\u90a3\u4e9b\u6c47\u805a\u4e86\u591a\u4e2a\u5206\u652f\u7684\u4fee\u6539\u7684\u5206\u652f\uff0c\u6bd4\u5982\u5f00\u53d1\uff08develop\uff09\u5206\u652f\u6216\u8005\u6d4b\u8bd5\uff08test\uff09\u5206\u652f\uff0c\u8fd9\u4e9b\u5206\u652f\u5728\u7ecf\u8fc7\u5145\u5206\u7684\u6d4b\u8bd5\u4e4b\u540e\u4f1a\u8fdb\u5165\u4e0b\u4e00\u4e2a\u6d41\u7a0b\uff0c\u6bd4\u5982\u5408\u5e76\u5230\u6700\u7ec8\u7684 <code>master</code> \u5206\u652f\u3002</p> <p>\u4ec0\u4e48\u662f\u5408\u5e76\u51b2\u7a81\uff1f\u5982\u4f55\u89e3\u51b3\u5408\u5e76\u51b2\u7a81\uff1f\u672c\u7bc7\u6587\u7ae0\u63a5\u4e0b\u6765\u5c06\u4e00\u4e00\u4ecb\u7ecd\u3002\u6b64\u5916\uff0c\u672c\u6587\u8fd8\u4f1a\u5bf9\u6bd4 <code>git merge</code> \u548c <code>git rebase</code> \u5728\u5408\u5e76\u5206\u652f\u4e0a\u7684\u533a\u522b\uff0c\u4ee5\u53ca\u4ecb\u7ecd <code>fast-forward</code> \u65b9\u6cd5\u548c\u4e00\u4e9b\u6709\u6548\u7f13\u89e3\u5408\u5e76\u51b2\u7a81\u4ea7\u751f\u7684\u65b9\u6cd5\u3002</p>"},{"location":"collaboration/git-workflow/resolve-conflicts/#\u4ec0\u4e48\u662f\u5408\u5e76\u51b2\u7a81","title":"\u4ec0\u4e48\u662f\u5408\u5e76\u51b2\u7a81","text":"<p>\u4e00\u822c\u6765\u8bf4\uff0c\u5047\u8bbe\u6211\u4eec\u5728 <code>a</code> \u5206\u652f\u4e0a\u901a\u8fc7 <code>git merge b</code> \u6216\u8005 <code>git rebase b</code> \u6765\u5c06 <code>b</code> \u5206\u652f\u5408\u5e76\u8fdb\u5f53\u524d\u7684\u5206\u652f\uff0c\u540c\u65f6\u53d1\u751f\u4e86\u4ee5\u4e0b\u60c5\u51b5\u4e2d\u7684\u81f3\u5c11\u4e00\u4e2a\u65f6\uff0c\u5c31\u4f1a\u53d1\u751f\u5408\u5e76\u51b2\u7a81\uff1a</p> <ul> <li><code>a</code> \u5206\u652f\u548c <code>b</code> \u5206\u652f\u7684\u4f5c\u8005\u4fee\u6539\u7684\u4ee3\u7801\u4e2d\u90fd\u5305\u542b\u540c\u4e00\u4e2a\u6587\u4ef6\u7684\u540c\u4e00\u884c\u3002</li> <li><code>a</code> \u5206\u652f\u7684\u4f5c\u8005\u4fee\u6539\u4e86\u67d0\u4e2a\u6587\u4ef6\uff0c\u800c <code>b</code> \u5206\u652f\u7684\u4f5c\u8005\u5220\u9664\u4e86\u8fd9\u4e2a\u6587\u4ef6\u3002</li> </ul> <p>\u4f8b\u5982\uff0c\u5047\u8bbe <code>a</code> \u5206\u652f\u548c <code>b</code> \u5206\u652f\u90fd\u6e90\u4e8e <code>master</code> \u5206\u652f\uff0c\u6b64\u5206\u652f\u53ea\u6709\u4e00\u4e2a <code>example.txt</code> \u6587\u4ef6\uff1a</p> example.txt <p><code>linenums=\"1\" line one line two line three</code></p> <p><code>a</code> \u5206\u652f\u7684\u4f5c\u8005\u5c06\u7b2c\u4e8c\u884c\u4fee\u6539\u4e3a\u4e86 <code>line 2</code> \u800c <code>b</code> \u5206\u652f\u7684\u4f5c\u8005\u5c06\u7b2c\u4e8c\u884c\u4fee\u6539\u4e3a\u4e86 <code>line \u4e8c</code>\uff0c\u6b64\u65f6\u5982\u679c <code>a</code> \u5206\u652f\u60f3\u8981\u5408\u5e76\u5165 <code>b</code> \u5206\u652f\uff0cGit \u65e0\u6cd5\u786e\u5b9a\u5408\u5e76\u7684\u7ed3\u679c\u91cc <code>example.txt</code> \u7684\u7b2c\u4e8c\u884c\u5230\u5e95\u5e94\u8be5\u53d6 <code>a</code> \u5206\u652f\u7684\u4fee\u6539\uff0c\u8fd8\u662f\u53d6 <code>b</code> \u5206\u652f\u7684\u4fee\u6539\uff0c\u5408\u5e76\u51b2\u7a81\u5c31\u6b64\u53d1\u751f\u3002</p> <p>\u5982\u679c\u4f60\u4f7f\u7528\u4e86 <code>git merge b</code> \u547d\u4ee4\uff0c\u4f60\u4f1a\u5f97\u5230\u4ee5\u4e0b\u7684\u8f93\u51fa\uff1a</p> <pre><code>$ git merge b\nAuto-merging example.txt\nCONFLICT (content): Merge conflict in example.txt\nAutomatic merge failed; fix conflicts and then commit the result.\n</code></pre> <p>\u5982\u679c\u4f60\u4f7f\u7528\u4e86 <code>git rebase b</code> \u547d\u4ee4\uff0c\u4f60\u4f1a\u5f97\u5230\u4ee5\u4e0b\u7684\u8f93\u51fa\uff1a</p> <pre><code>$ git rebase b\nAuto-merging example.txt\nCONFLICT (content): Merge conflict in example.txt\nerror: could not apply 4404526... commit a 1\nResolve all conflicts manually, mark them as resolved with\n\"git add/rm &lt;conflicted_files&gt;\", then run \"git rebase --continue\".\nYou can instead skip this commit: run \"git rebase --skip\".\nTo abort and get back to the state before \"git rebase\", run \"git rebase --abort\".\nCould not apply 4404526... commit a 1\n</code></pre> Note <p>\u867d\u7136\u6211\u4eec\u4f7f\u7528\u7684\u547d\u4ee4\u53eb\u505a <code>git rebase</code>\uff0c\u4f46\u662f Git \u7684\u8f93\u51fa\u91cc\u4ecd\u7136\u53eb\u505a <code>merging</code>\u3002\u4e0d\u8981\u548c <code>git merge</code> \u6df7\u6dc6\uff0c\u524d\u8005\u4ee5\u53ca\u672c\u6587\u6807\u9898\u91cc\u7684\u201c\u5408\u5e76\u201d\u6307\u7684\u662f\u5e7f\u4e49\u4e0a\u5c06\u4e24\u4e2a\u5206\u652f\u7684\u4ee3\u7801\u5408\u5e76\u7684\u8fc7\u7a0b\u3002\u800c <code>git rebase</code> \u548c <code>git merge</code> \u90fd\u80fd\u5b9e\u73b0\u8fd9\u4e00\u8fc7\u7a0b\uff0c\u4f46\u5b58\u5728\u4e00\u4e9b\u663e\u8457\u7684\u533a\u522b\uff0c\u6211\u4eec\u4e0b\u6587\u4f1a\u8ba8\u8bba\u3002</p> Note <p>\u4e00\u822c\u60c5\u51b5\u4e0b\uff0cGit \u5728\u5206\u652f\u5408\u5e76\u65f6\u4f1a\u81ea\u52a8\u4e3a\u6211\u4eec\u89e3\u51b3\u5927\u591a\u6570\u7684\u5408\u5e76\u95ee\u9898\uff0c\u6bd4\u5982\u5728 <code>a</code> \u5206\u652f\u7684\u4ee3\u7801\u4e2d\u5957\u7528 <code>b</code> \u5206\u652f\u7684\u5404\u79cd\u4fee\u6539\uff0c\u5982\u65b0\u5efa\u6587\u4ef6\u3001\u5220\u9664\u6587\u4ef6\u3001\u4fee\u6539\u4ee3\u7801\u884c\u7b49\uff0c\u53ea\u8981\u8fd9\u4e9b\u64cd\u4f5c\u4e0d\u4f1a\u4ea7\u751f\u4e0a\u8ff0\u7684\u5408\u5e76\u51b2\u7a81\u3002\u800c\u90a3\u4e9b\u51fa\u73b0\u5408\u5e76\u51b2\u7a81\u7684\u4fee\u6539\u624d\u4f1a\u7559\u7ed9\u7528\u6237\u81ea\u5df1\u89e3\u51b3\u3002</p> <p>\u5728\u591a\u4eba\u534f\u4f5c\u7684\u4e2d\u5927\u578b\u9879\u76ee\u4e2d\uff0c\u5408\u5e76\u51b2\u7a81\u5219\u66f4\u52a0\u5bb9\u6613\u53d1\u751f\u3002\u6b63\u5982\u4e0a\u6587\u6240\u8bf4\uff0c\u6bcf\u4e2a\u4eba\u5de5\u4f5c\u5728\u81ea\u5df1\u7684\u5206\u652f\u4e0a\u65f6\u53ef\u4ee5\u81ea\u7531\u5730\u6839\u636e\u81ea\u5df1\u7684\u5de5\u4f5c\u9700\u8981\u4fee\u6539\u4ee3\u7801\uff0c\u800c\u4e0d\u7528\u987e\u53ca\u5176\u4ed6\u4eba\uff0c\u56e0\u6b64\u5de5\u4f5c\u5728\u4e0d\u540c\u5206\u652f\u4e0a\u7684\u4e24\u4e2a\u4eba\u4fee\u6539\u4e86\u540c\u4e00\u884c\u4ee3\u7801\u7684\u6982\u7387\u4e5f\u5c31\u968f\u4e4b\u63d0\u5347\u3002\u9664\u6b64\u4e4b\u5916\uff0c\u5982\u679c\u4f60\u7684\u5206\u652f\u7531\u4e8e\u5de5\u4f5c\u8fdb\u5ea6\u7f13\u6162\uff0c\u8fdf\u8fdf\u4e0d\u80fd\u88ab\u5408\u5e76\uff0c\u90a3\u4e48\u8fd9\u79cd\u65f6\u95f4\u56e0\u7d20\u5bfc\u81f4\u51fa\u73b0\u5408\u5e76\u51b2\u7a81\u7684\u6982\u7387\u548c\u89c4\u6a21\u4e5f\u4f1a\u5927\u5927\u63d0\u5347\u3002</p>"},{"location":"collaboration/git-workflow/resolve-conflicts/#\u5982\u4f55\u89e3\u51b3\u5408\u5e76\u51b2\u7a81","title":"\u5982\u4f55\u89e3\u51b3\u5408\u5e76\u51b2\u7a81","text":"<p>Git \u5728\u9047\u5230\u5408\u5e76\u51b2\u7a81\u65f6\uff0c\u4f1a\u5c06\u53d1\u751f\u51b2\u7a81\u7684\u884c\u4f7f\u7528\u5177\u6709\u7279\u6b8a\u683c\u5f0f\u7684\u51e0\u884c\u66ff\u4ee3\u3002\u6211\u4eec\u4ecd\u4ee5\u4e0a\u6587\u7684 <code>example.txt</code> \u4e3a\u4f8b\u5b50\uff0c\u5728\u6267\u884c\u5408\u5e76\u64cd\u4f5c\u4e4b\u540e\uff0c\u8ba9\u6211\u4eec\u67e5\u770b <code>example.txt</code> \u7684\u5185\u5bb9\uff1a</p> example.txt <p>``` linenums=\"1\" line one &lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD line 2 ======= line \u4e8c</p> <p>b line three ```</p> <p>\u8fd9\u91cc\uff0cGit \u5c06\u4e24\u4e2a\u5206\u652f\u5bf9\u8fd9\u884c\u505a\u7684\u4fee\u6539\u90fd\u5217\u4e86\u51fa\u6765\uff0c\u5e76\u4f7f\u7528 <code>=======</code> \u8fdb\u884c\u5206\u5272\uff0c\u540c\u65f6\u4f7f\u7528 <code>&lt;&lt;&lt;&lt;&lt;&lt;&lt;</code> \u548c <code>&gt;&gt;&gt;&gt;&gt;&gt;&gt;</code> \u5206\u522b\u6807\u51fa\u5f53\u524d\u5206\u652f\u548c\u8981\u5408\u5e76\u8fdb\u6765\u7684\u5206\u652f\u540d\u3002Git \u5728\u8fd9\u91cc\u7684\u610f\u601d\u662f\u8ba9\u6211\u4eec\u81ea\u5df1\u68c0\u67e5\u4e00\u4e0b\u8be5\u5982\u4f55\u5904\u7f6e\u51b2\u7a81\u3002</p> <p>\u4e0d\u8981\u88ab\u5206\u5272\u7ebf\u6240\u8bef\u5bfc\uff0cGit \u4f7f\u7528\u5b83\u4eec\u4ec5\u4ec5\u662f\u4e3a\u4e86\u533a\u5206\u4e0d\u540c\u5206\u652f\u7684\u4fee\u6539\uff0c\u5e76\u4e0d\u662f\u5728\u8bf4\u4f60\u53ea\u80fd\u4fdd\u7559\u5176\u4e2d\u4e00\u65b9\u7684\u4fee\u6539\u3002\u6211\u4eec\u5e94\u8be5\u7ed3\u5408\u5b9e\u9645\u60c5\u51b5\u505a\u51fa\u51b3\u5b9a\uff0c\u6bd4\u5982\u6211\u4eec\u53ef\u4ee5\u7efc\u5408\u53cc\u65b9\u7684\u4fee\u6539\uff0c\u518d\u7a0d\u5fae\u4fee\u6539\u4e00\u4e0b\u5f97\u5230\u6700\u540e\u7684\u7ed3\u679c\uff1b\u4e5f\u53ef\u4ee5\u653e\u5f03\u4e00\u65b9\u7684\u4fee\u6539\u3002\u5bf9\u4e8e\u590d\u6742\u7684\u9879\u76ee\u6765\u8bf4\uff0c\u6211\u4eec\u4e00\u822c\u90fd\u9700\u8981\u4ed4\u7ec6\u89c2\u5bdf\u51b2\u7a81\u7684\u53cc\u65b9\u7684\u4fee\u6539\uff0c\u4ed4\u7ec6\u601d\u8003\u89e3\u51b3\u65b9\u6848\uff0c\u786e\u4fdd\u5728\u8ba9\u7a0b\u5e8f\u6700\u7ec8\u6b63\u5e38\u5730\u4f53\u73b0\u51fa\u53cc\u65b9\u4fee\u6539\u7684\u540c\u65f6\uff0c\u4e0d\u5f15\u5165\u989d\u5916\u7684 bug \u7b49\u95ee\u9898\u3002</p> <p>\u8981\u5904\u7f6e\u8fd9\u91cc\u7684\u51b2\u7a81\uff0c\u6211\u4eec\u6709\u4e24\u79cd\u529e\u6cd5\uff1a\u4e00\u79cd\u662f\u6bd4\u8f83\u539f\u59cb\u7684\u7eaf\u6587\u672c\u7f16\u8f91\uff0c\u5373\u76f4\u63a5\u4fee\u6539\u5176\u4e2d\u7684\u51e0\u884c\uff1b\u53e6\u4e00\u79cd\u662f\u501f\u52a9\u73b0\u4ee3\u7684\u4ee3\u7801\u7f16\u8f91\u5668\u63d0\u4f9b\u7684 Git \u652f\u6301\uff0c\u4f7f\u7528\u53ef\u89c6\u5316\u7684\u65b9\u5f0f\u9ad8\u6548\u5730\u89e3\u51b3\u51b2\u7a81\u3002\u65e0\u8bba\u4f60\u9009\u62e9\u54ea\u79cd\u65b9\u6cd5\uff0c\u8bf7\u786e\u4fdd Git \u6dfb\u52a0\u7684\u4e09\u884c\u6807\u8bb0\u88ab\u5220\u53bb\uff0c\u539f\u56e0\u8bf7\u89c1\u4e0b\u6587\u3002</p> Info <p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 <code>git status</code> \u6765\u67e5\u770b\u5f53\u524d\u5408\u5e76\u51b2\u7a81\u7684\u72b6\u6001\uff0c\u5982\u4e0b\u6240\u793a\uff0c\u8f93\u51fa\u4e2d\u5217\u51fa\u4e86\u53d1\u751f\u51b2\u7a81\u7684\u6587\u4ef6\u540d\uff0c\u4ee5\u53ca\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 <code>git merge --abort</code> \u6765\u7ec8\u6b62\u8fd9\u6b21\u5408\u5e76\uff0c\u4e5f\u5c31\u662f\u5c06\u5f53\u524d\u7684\u4ed3\u5e93\u56de\u9000\u5230\u6211\u4eec\u6267\u884c <code>git merge b</code> \u4e4b\u524d\u7684\u72b6\u6001\u3002</p> <pre><code>On branch a\nYou have unmerged paths.\n    (fix conflicts and run \"git commit\")\n    (use \"git merge --abort\" to abort the merge)\n\nUnmerged paths:\n    (use \"git add &lt;file&gt;...\" to mark resolution)\n        both modified:   example.txt\n\nno changes added to commit (use \"git add\" and/or \"git commit -a\")\n</code></pre>"},{"location":"collaboration/git-workflow/resolve-conflicts/#\u7eaf\u6587\u672c\u7f16\u8f91","title":"\u7eaf\u6587\u672c\u7f16\u8f91","text":"<p>\u4f7f\u7528\u7eaf\u6587\u672c\u7f16\u8f91\u7684\u65b9\u6cd5\u5904\u7f6e\u51b2\u7a81\u65f6\uff0c\u6211\u4eec\u53ea\u9700\u8981\u6309\u9700\u5220\u9664\u76f8\u5e94\u7684\u884c\u5373\u53ef\u3002\u6bd4\u5982\uff0c\u5982\u679c\u6211\u4eec\u60f3\u8981\u53ea\u4fdd\u7559\u6211\u4eec\u81ea\u5df1\u7684\u4fee\u6539\uff0c\u53ef\u4ee5\u5c06\u53bb\u6389\u7b2c 2\u30014\u30015\u30016 \u884c\uff1a</p> example.txt <p><code>linenums=\"1\" line one line 2 line three</code></p> <p>\u5982\u679c\u6211\u4eec\u60f3\u8981\u540c\u65f6\u4fdd\u7559\u6211\u4eec\u7684\u548c\u5206\u652f B \u7684\u4fee\u6539\uff0c\u53ef\u4ee5\u53ea\u53bb\u6389\u7b2c 2\u30014\u30016 \u884c\u3002\u5bf9\u4e8e\u6211\u4eec\u7b80\u5355\u7684 <code>example.txt</code> \u4f8b\u5b50\u6765\u8bf4\uff0c\u4f7f\u7528\u7eaf\u6587\u672c\u7f16\u8f91\u7684\u65b9\u5f0f\u6548\u7387\u8fd8\u4e0d\u9519\uff0c\u4f46\u662f\u5f53\u6211\u4eec\u5de5\u4f5c\u5728\u4e00\u4e2a\u89c4\u6a21\u8f83\u5927\u7684\u591a\u4eba\u534f\u4f5c\u9879\u76ee\u65f6\uff0c\u51fa\u73b0\u7684\u51b2\u7a81\u5f80\u5f80\u884c\u6570\u66f4\u591a\uff0c\u7275\u626f\u7684\u4ee3\u7801\u903b\u8f91\u4e5f\u66f4\u4e3a\u590d\u6742\uff0c\u6b64\u65f6\u5904\u7406\u8fd9\u4e9b\u51b2\u7a81\u7684\u96be\u5ea6\u5c31\u4f1a\u52a0\u5927\uff0c\u6211\u4eec\u4e5f\u4f1a\u66f4\u52a0\u5bb9\u6613\u72af\u9519\u3002</p> Attention <p>Git \u4e0d\u4f1a\u68c0\u67e5\u4f60\u5bf9\u5408\u5e76\u51b2\u7a81\u7684\u5904\u7406\u662f\u5426\u201c\u6b63\u786e\u201d\u3002\u5bf9\u4e8e\u4e0a\u9762\u7684\u4f8b\u5b50\uff0c\u5373\u4f7f\u4f60\u4ec0\u4e48\u90fd\u4e0d\u505a\uff0c\u4e5f\u5c31\u662f\u4fdd\u7559 <code>&lt;&lt;&lt;&lt;&lt;&lt;&lt;</code> \u548c <code>&gt;&gt;&gt;&gt;&gt;&gt;&gt;</code> \u7b49\u90e8\u5206\uff0c\u4f60\u4f9d\u7136\u53ef\u4ee5\u6b63\u5e38\u4f7f\u7528 <code>git add</code>\u3001 <code>git commit</code> \u548c <code>git push</code> \u6765\u5c06\u4f60\u7684\u4ee3\u7801\u63d0\u4ea4\u5230\u8fdc\u7aef\u4ed3\u5e93\u4e2d\u3002\u8fd9\u662f\u6781\u5176\u5371\u9669\u7684\uff0c\u9057\u7559\u4e0b\u7684\u8fd9\u4e9b\u90e8\u5206\u5f80\u5f80\u4f1a\u8ba9\u6e90\u4ee3\u7801\u65e0\u6cd5\u901a\u8fc7\u7f16\u8bd1\uff1b\u6216\u8005\u66f4\u5371\u9669\u7684\u60c5\u51b5\u662f\u5b83\u901a\u8fc7\u4e86\u7f16\u8bd1\uff0c\u5e76\u5728\u751f\u4ea7\u73af\u5883\u4e0b\u5bfc\u81f4\u4e86\u6076\u52a3\u7684\u5f71\u54cd\u3002</p> <p>\u4e5f\u8bb8\u4f60\u8ba4\u4e3a\u81ea\u5df1\u4e0d\u4f1a\u611a\u8822\u5230\u5fd8\u8bb0\u5bf9\u51b2\u7a81\u8fdb\u884c\u5904\u7406\uff0c\u4f46\u5b9e\u8df5\u8868\u660e\u5f53\u53d1\u751f\u51b2\u7a81\u7684\u6587\u4ef6\u6570\u76ee\u4f17\u591a\u65f6\uff0c\u90a3\u4e9b\u4ec5\u4ec5\u4f9d\u9760\u7eaf\u6587\u672c\u7f16\u8f91\u7684\u65b9\u6cd5\u6765\u89e3\u51b3\u51b2\u7a81\u7684\u4eba\u4eec\u5f88\u5bb9\u6613\u4f1a\u6f0f\u6389\u51e0\u4e2a\u53d1\u751f\u51b2\u7a81\u7684\u6587\u4ef6\uff0c\u6216\u8005\u662f\u51e0\u5904\u51b2\u7a81\u3002\u56e0\u6b64\uff0c\u4e3a\u4e86\u5b89\u5168\u6027\u548c\u9ad8\u6548\u7387\uff0c\u6211\u4eec\u63a8\u8350\u4f7f\u7528\u63a5\u4e0b\u6765\u4ecb\u7ecd\u7684\u53ef\u89c6\u5316\u65b9\u6cd5\u6765\u5904\u7406\u5408\u5e76\u51b2\u7a81\u3002</p>"},{"location":"collaboration/git-workflow/resolve-conflicts/#\u53ef\u89c6\u5316","title":"\u53ef\u89c6\u5316","text":"<p>\u73b0\u4ee3\u7684\u4ee3\u7801\u7f16\u8f91\u5668\u666e\u904d\u5185\u5efa\u6216\u8005\u901a\u8fc7\u63d2\u4ef6\u63d0\u4f9b\u4e86\u826f\u597d\u7684 Git \u652f\u6301\uff0c\u8ba9\u6211\u4eec\u53ef\u4ee5\u4ee5\u53ef\u89c6\u5316\u7684\u65b9\u5f0f\u9ad8\u6548\u5730\u89e3\u51b3\u5408\u5e76\u51b2\u7a81\u3002\u4f8b\u5982\u5728 VSCode \u4e2d\uff0c\u5982\u679c\u6211\u4eec\u6253\u5f00\u4e0a\u9762\u51fa\u73b0\u51b2\u7a81\u7684 <code>example.txt</code>\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff1a</p> <p></p> <p>VSCode \u4e3a\u6211\u4eec\u9ad8\u4eae\u4e86\u51fa\u73b0\u51b2\u7a81\u7684\u884c\uff0c\u4f7f\u7528\u7eff\u8272\u8868\u793a\u5f53\u524d\u5206\u652f\u7684\u6539\u52a8\uff0c\u4f7f\u7528\u84dd\u8272\u8868\u793a\u8981\u5408\u5e76\u8fdb\u6765\u7684\u5206\u652f\u7684\u6539\u52a8\u3002\u540c\u65f6\uff0c\u5728\u9ad8\u4eae\u5757\u7684\u4e0a\u65b9\uff0c\u6211\u4eec\u8fd8\u80fd\u770b\u5230\u51e0\u4e2a\u9009\u9879\u6309\u94ae\u3002\u5206\u522b\u662f\uff1a</p> <ol> <li>\u5957\u7528\u5f53\u524d\u7684\u6539\u52a8\uff08Accept Current Change\uff09</li> <li>\u5957\u7528\u5408\u5e76\u8fdb\u6765\u7684\u5206\u652f\u7684\u6539\u52a8\uff08Accept Incoming Change\uff09</li> <li>\u4e24\u8fb9\u7684\u6539\u52a8\u90fd\u5957\u7528\uff08Accept Both Change\uff09</li> <li>\u5bf9\u6bd4\u4e24\u8fb9\u7684\u6539\u52a8\uff08Compare Changes\uff09</li> </ol> <p>\u5176\u4e2d\u7b2c\u56db\u4e2a\u6309\u94ae\u70b9\u51fb\u4e4b\u540e\u4f1a\u51fa\u73b0\uff1a</p> <p></p> <p>VSCode \u4f1a\u5c55\u793a\u4e00\u4e2a\u4e24\u680f\u7684\u4ee3\u7801\u9875\uff0c\u5bf9\u6bd4\u4e24\u4e2a\u5206\u652f\u505a\u51fa\u7684\u6539\u52a8\uff0c\u8ba9\u6211\u4eec\u66f4\u6e05\u6670\u5730\u770b\u5230\u533a\u522b\u3002</p> <p>\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u9664\u4e86\u80fd\u591f\u53ef\u89c6\u5316\u5730\u5c55\u793a\u6539\u52a8\uff0cVSCode \u8fd8\u80fd\u591f\u5217\u51fa\u53d1\u751f\u4e86\u5408\u5e76\u51b2\u7a81\u5730\u6240\u6709\u6587\u4ef6\uff0c\u5e76\u4ee5\u7ea2\u8272\u6807\u8bb0\u5176\u6587\u4ef6\u540d\uff0c\u964d\u4f4e\u6211\u4eec\u6f0f\u6389\u51b2\u7a81\u6587\u4ef6\u7684\u53ef\u80fd\u6027\u3002</p> <p></p> <p></p> <p>\u50cf GitHub \u548c GitLab \u8fd9\u6837\u7684\u5e73\u53f0\u4e5f\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u5728\u7ebf\u7684\u51b2\u7a81\u89e3\u51b3\u529f\u80fd\uff0c\u4f46\u5bf9\u4e8e\u8fc7\u4e8e\u590d\u6742\u7684\u51b2\u7a81\uff0c\u5b83\u4eec\u57fa\u672c\u4e0d\u80fd\u89e3\u51b3\uff0c\u800c\u662f\u4f1a\u8981\u6c42\u4f60\u5728\u672c\u5730\u89e3\u51b3\u3002\u4e0b\u56fe\u4e3a GitHub \u4e3a Pull requests \u63d0\u4f9b\u7684\u51b2\u7a81\u89e3\u51b3\u9875\u9762\uff0c\u5b83\u5217\u51fa\u4e86\u53d1\u751f\u51b2\u7a81\u7684\u6587\u4ef6\u5217\u8868\uff0c\u4ee5\u53ca\u9ad8\u4eae\u663e\u793a\u4e86\u51b2\u7a81\u4ee3\u7801\u884c\uff1a</p> <p></p>"},{"location":"collaboration/git-workflow/resolve-conflicts/#\u7f13\u89e3\u5408\u5e76\u51b2\u7a81\u7684\u4ea7\u751f","title":"\u7f13\u89e3\u5408\u5e76\u51b2\u7a81\u7684\u4ea7\u751f","text":"<p>\u4e5f\u8bb8\u770b\u5230\u8fd9\u91cc\uff0c\u4f60\u4f1a\u8ba4\u4e3a Git \u7684\u5408\u5e76\u51b2\u7a81\u89e3\u51b3\u8d77\u6765\u672a\u514d\u4e5f\u592a\u8fc7\u9ebb\u70e6\u3002\u5176\u5b9e\uff0c\u53ea\u8981\u56e2\u961f\u7684\u7f16\u7801\u4e60\u60ef\u5f97\u5f53\uff0c\u6211\u4eec\u80fd\u591f\u9047\u5230\u7684\u5408\u5e76\u51b2\u7a81\u5176\u5b9e\u4f1a\u76f8\u5f53\u5730\u5c11\u3002\u672c\u6587\u5728\u6b64\u7ed9\u51fa\u4e00\u4e9b\u80fd\u591f\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u964d\u4f4e\u5408\u5e76\u51b2\u7a81\u53d1\u751f\u6982\u7387\u7684\u65b9\u6cd5\uff1a</p> <ul> <li>\u5c3d\u91cf\u5bf9\u9879\u76ee\u4ee3\u7801\u8fdb\u884c\u6a21\u5757\u5316\u8c03\u6574\uff0c\u8ba9\u6bcf\u4e2a\u4eba\u90fd\u5de5\u4f5c\u5728\u76f8\u5bf9\u72ec\u7acb\u7684\u4ee3\u7801\u6a21\u5757\u4e2d\uff0c\u8fd9\u6837\u4e0d\u540c\u7684\u5206\u652f\u95f4\u5c31\u4e0d\u5bb9\u6613\u51fa\u73b0\u5bf9\u76f8\u540c\u884c\u7684\u4fee\u6539\u3002</li> <li>Bug \u4fee\u590d\u5206\u652f\u5e94\u8be5\u786e\u4fdd\u5c3d\u91cf\u8f7b\u5de7\uff0c\u4e00\u4e2a\u5206\u652f\u5bf9\u5e94\u4e00\u4e2a bug \u4fee\u590d\uff0c\u51cf\u5c11\u5206\u652f\u5bf9\u9879\u76ee\u4ee3\u7801\u7684\u4fee\u6539\u91cf\u3002</li> <li>\u52a0\u5feb\u5206\u652f\u4ece\u521b\u5efa\u5230\u5408\u5e76\u7684\u901f\u5ea6\uff0c\u8fd9\u6d89\u53ca\u5230\u9009\u7528\u5408\u7406\u7684\u9879\u76ee\u7ba1\u7406\u65b9\u6cd5\uff0c\u4ee5\u53ca\u4ee3\u7801\u5ba1\u67e5\u5236\u5ea6\u3002</li> </ul>"},{"location":"collaboration/git-workflow/resolve-conflicts/#git-rebase-\u548c-git-merge-\u7684\u533a\u522b","title":"<code>git rebase</code> \u548c <code>git merge</code> \u7684\u533a\u522b","text":"<p>\u6211\u4eec\u5728\u524d\u6587\u8bb2\u8fc7\uff0c\u8fd9\u4e24\u4e2a\u547d\u4ee4\u90fd\u53ef\u4ee5\u5c06\u4e24\u4e2a\u5206\u652f\u7684\u4ee3\u7801\u8fdb\u884c\u5408\u5e76\uff0c\u800c\u4e14\u5408\u5e76\u51fa\u73b0\u51b2\u7a81\u65f6\u90fd\u9700\u8981\u6211\u4eec\u624b\u52a8\u5904\u7406\u51b2\u7a81\u4ee3\u7801\u884c\uff0c\u5e76\u4e14\u6267\u884c\u4e00\u4e9b\u547d\u4ee4\u6765\u786e\u8ba4\u63d0\u4ea4\u3002\u4ece\u5b83\u4eec\u6267\u884c\u7684\u7ed3\u679c\u6765\u770b\uff0c\u4e24\u8005\u7684\u529f\u80fd\u662f\u76f8\u540c\u7684\uff0c\u4f46\u5b83\u4eec\u5374\u5728\u5b9e\u73b0\u7684\u65b9\u5f0f\u4e0a\u5b58\u5728\u663e\u8457\u7684\u533a\u522b\u3002</p> <p>\u7b80\u5355\u6765\u8bf4\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u6bcf\u4e00\u4e2a\u5206\u652f\u770b\u4f5c\u4e00\u4e2a\u7531 commit \u4f5c\u4e3a\u8282\u70b9\u6784\u6210\u7684\u6811\u679d\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p></p> <p>\b\b\u56fe\u4e2d\u7684\u6bcf\u4e00\u4e2a\u5706\u5708\u8868\u793a\u4e00\u6b21 commit\uff0c\u4e09\u4e2a\u7bad\u5934\u5206\u522b\u8868\u793a\u4e09\u4e2a\u5206\u652f\u76ee\u524d\u6307\u5411\u7684 commit \u5e8f\u5217\u3002\u4ece\u56fe\u4e2d\u53ef\u4ee5\u770b\u5230 <code>branch-a</code> \u7684 commit \u5e8f\u5217\u662f <code>C0 -&gt; C1 -&gt; C2 -&gt; C3</code>\uff0c\u4e5f\u5c31\u662f\u8bf4\u8fd9\u4e2a\u5206\u652f\u4e0a\u6709\u8fd9\u6837\u7684\u4e00\u4e9b commit\u3002\u800c <code>main</code> \u7684 commit \u5e8f\u5217\u5219\u4e3a <code>C0 -&gt; C1 -&gt; C2</code>\u3002</p> <p>\u73b0\u5728\u7ee7\u7eed\u4f7f\u7528 <code>example.txt</code> \u7684\u4f8b\u5b50\uff0c\u6211\u4eec\u5728 <code>a</code> \u5206\u652f\u4e0a\u6267\u884c <code>git log --graph --format=oneline</code> \u6765\u67e5\u770b\u5f53\u524d\u5206\u652f\u7684\u5386\u53f2\u8bb0\u5f55\uff0c\u5f97\u5230\u4ee5\u4e0b\u8f93\u51fa\uff1a</p> <pre><code>* 4404526ee52af9994b409c713e1efc6651cef99e (HEAD -&gt; a, origin/a) commit a 1\n* 1518bc8eaa5ad79e31ef41b9b229d231bb82ccb2 (origin/master, master) commit master 1\n</code></pre> <p>\u5728\u8f93\u51fa\u4e2d\uff0ccommit \u6309\u7167\u65f6\u95f4\u4ece\u8fd1\u5230\u8fdc\u7684\u987a\u5e8f\u4f9d\u6b21\u88ab\u8f93\u51fa\u3002\u5176\u4e2d\u7b2c\u4e00\u884c\u62ec\u53f7\u91cc\u7684 <code>HEAD -&gt; a</code> \u8868\u793a a \u5206\u652f\u6700\u65b0\u7684 commit \u5c31\u662f\u5f53\u524d\u884c\u5bf9\u5e94\u7684 commit\uff0c\u5e76\u4e14\u6211\u4eec\u76ee\u524d\u6b63\u5728\u8fd9\u4e2a commit \u4e0a\u5de5\u4f5c\u3002</p> Info <p>\u8f93\u51fa\u4e2d\u7684\u7b2c\u4e8c\u4e2a commit\uff0c\u540e\u9762\u7684\u62ec\u53f7\u5185\u5bb9 <code>origin/master, master</code> \u7684\u610f\u601d\u5206\u522b\u662f\uff1a\u8fdc\u7a0b\u4ed3\u5e93\u7684 <code>master</code> \u5206\u652f\u6307\u5411\u4e86\u6b64 commit\uff0c\u672c\u5730\u4ed3\u5e93\u7684\u4e5f\u662f\u3002\u5e76\u4e0d\u662f\u6240\u6709\u8f93\u51fa\u7684 commit \u90fd\u4f1a\u6709\u8fd9\u6837\u7684\u62ec\u53f7\u3002</p>"},{"location":"collaboration/git-workflow/resolve-conflicts/#git-merge","title":"<code>git merge</code>","text":"<p>\u5047\u5982\u6211\u4eec\u6b64\u65f6\u6267\u884c <code>git merge b</code> \u5e76\u89e3\u51b3\u51b2\u7a81\uff0c\u6211\u4eec\u518d\u8fd0\u884c <code>git log --graph --format=oneline</code> \u4f1a\u5f97\u5230\u4ee5\u4e0b\u8f93\u51fa\uff1a</p> <pre><code>*   6ee34e9a5bac24b26a958bd6f658c70b056f1f26 (HEAD -&gt; a) Merge branch 'b' into a\n|\\\n| * ab0502e4504a5f05012daf075611a74055fc83b2 (origin/b, b) commit b 1\n* | 4404526ee52af9994b409c713e1efc6651cef99e (origin/a) commit a 1\n|/\n* 1518bc8eaa5ad79e31ef41b9b229d231bb82ccb2 (origin/master, master) commit master 1\n</code></pre> <p>\u8f93\u51fa\u7684\u5185\u5bb9\u590d\u6742\u4e86\u5f88\u591a\uff0c\u6ce8\u610f\u91cc\u9762\u7684 <code>|</code>\u3001<code>\\</code> \u548c <code>/</code> \u7b26\u53f7\uff0c\u5b83\u4eec\u8868\u793a\u76f4\u7ebf\u548c\u6298\u7ebf\uff0c<code>*</code> \u7b26\u53f7\u8868\u793a\u4e00\u4e2a\u8282\u70b9\uff0c\u8fd9\u79cd\u4f5c\u56fe\u65b9\u5f0f\u8868\u8fbe\u7684\u5185\u5bb9\u548c\u4e0a\u9762\u7ed9\u51fa\u7684\u84dd\u5e95\u56fe\u7247\u76f8\u4f3c\u3002</p> <p>\u7531\u4e8e\u6211\u4eec\u901a\u8fc7 <code>git merge b</code> \u6765\u5c06 <code>b</code> \u5206\u652f\u4e0a\u7684 commit \u5408\u5e76\u5230\u6211\u4eec\u7684 <code>a</code> \u5206\u652f\u91cc\uff0cGit \u4f1a\u5728\u5386\u53f2\u8bb0\u5f55\u4e2d\u4e3a\u6211\u4eec\u5b8c\u6574\u5730\u8f93\u51fa <code>b</code> \u5206\u652f\u4e0a\u7684\u6240\u6709 commit\uff0c\u5e76\u6700\u7ec8\u4ee5\u4e00\u4e2a\u6298\u7ebf\u6c47\u5165 <code>a</code> \u5206\u652f\u91cc\u5728\u8fdb\u884c <code>git merge</code> \u4e4b\u540e\u81ea\u52a8\u4ea7\u751f\u7684\u4e00\u6b21 commit \u4e0a\u3002</p>"},{"location":"collaboration/git-workflow/resolve-conflicts/#git-rebase","title":"<code>git rebase</code>","text":"<p>\u5982\u679c\u6211\u4eec\u6267\u884c\u7684\u4e0d\u662f <code>git merge</code> \u800c\u662f <code>git rebase</code> \u53c8\u4f1a\u5982\u4f55\u5462\uff1f\u5728\u4fee\u590d\u51b2\u7a81\u4e4b\u540e\uff0c\u8fd0\u884c <code>git log --graph --format=oneline</code> \u5f97\u5230\u7684\u8f93\u51fa\u5982\u4e0b\uff1a</p> <pre><code>* dbb05d13734ee3054d0f132edd3bdf97a0997cbd (HEAD -&gt; a) commit a 1\n* ab0502e4504a5f05012daf075611a74055fc83b2 (origin/b, b) commit b 1\n* 1518bc8eaa5ad79e31ef41b9b229d231bb82ccb2 (origin/master, master) commit master 1\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0 <code>rebase</code> \u547d\u4ee4\u4fee\u6539\u4e86 <code>a</code> \u5206\u652f\u7684 commit \u5e8f\u5217\uff0c\u5c06 <code>a</code> \u5728\u548c <code>b</code> \u7684\u5206\u53c9\u70b9\uff0c\u4e5f\u5c31\u662f\u7b2c\u4e09\u884c\u6307\u5411\u7684 commit \u4e4b\u540e\u7684\u6240\u6709 commit\uff08\u4e3a\u4e86\u7b80\u5355\uff0c\u6211\u4eec\u7684\u4f8b\u5b50\u53ea\u6709\u7b2c\u4e00\u884c\u5bf9\u5e94\u7684 commit\uff09\uff0c\u91cd\u65b0\u8bbe\u7f6e\u5230\u4e86 <code>b</code> \u5206\u652f\u6700\u65b0\u7684 commit \u4e0a\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u73b0\u5728\u7684\u5f97\u5230\u7684 <code>a</code> \u5206\u652f\uff0c\u7b49\u4ef7\u4e8e\u6211\u4eec\u4e00\u5f00\u59cb\u5c31\u4ece <code>b</code> \u5206\u652f\u4e0a\u65b0\u5efa\u4e00\u4e2a\u5206\u652f\u8fdb\u884c\u4fee\u6539\u3002</p> <p>Git \u5e76\u6ca1\u6709\u50cf <code>merge</code> \u90a3\u6837\u518d\u8f93\u51fa\u4e00\u4e9b\u6298\u7ebf\u4e86\uff0c\u6211\u4eec\u5f97\u5230\u4e86\u4e00\u4e2a\u5e73\u5766\u7684\u3001\u7528\u4e00\u6761\u76f4\u7ebf\u5c31\u80fd\u4e32\u8d77\u6765\u8868\u793a\u7684 commit \u8bb0\u5f55\uff0c\u5b83\u4eec\u770b\u4e0a\u53bb\u66f4\u52a0\u7b80\u5355\u3001\u76f4\u89c2\u3002</p>"},{"location":"collaboration/git-workflow/resolve-conflicts/#\u5bf9\u6bd4","title":"\u5bf9\u6bd4","text":"<p>\u7a76\u7adf\u5e94\u8be5\u4f7f\u7528 <code>merge</code> \u8fd8\u662f <code>rebase</code>\uff0c\u6216\u8005\u8bf4\u8fd9\u4e24\u79cd\u65b9\u6cd5\u5b70\u4f18\u5b70\u52a3\uff0c\u662f\u7a0b\u5e8f\u5458\u4eec\u9664\u4e86\u7a76\u7adf\u4f7f\u7528 tab \u8fd8\u662f space \u4f5c\u4e3a\u7f29\u8fdb\u5916\u7684\u53c8\u4e00\u4e2a\u4e89\u8bba\u4e0d\u4f11\u7684\u8bdd\u9898\u3002</p> <p>\u5bf9\u4e8e <code>merge</code> \u6765\u8bf4\uff0c\u867d\u7136\u5b83\u8f83\u4e3a\u5b89\u5168\uff0c\u80fd\u591f\u76f4\u89c2\u5730\u5c55\u793a\u5404\u4e2a\u5206\u652f\u7684\u5173\u7cfb\uff0c\u4f46\u662f\u5728\u5927\u578b\u9879\u76ee\u4e2d\u5f80\u5f80\u4f1a\u9047\u5230\u5206\u652f\u6570\u91cf\u8fc7\u591a\u5bfc\u81f4 Git \u5386\u53f2\u8bb0\u5f55\u4e71\u6210\u4e00\u56e2\u7684\u95ee\u9898\u3002\u5bf9\u4e8e <code>rebase</code> \u6765\u8bf4\uff0c\u5b83\u5219\u80fd\u591f\u4ea7\u751f\u5e73\u6574\u3001\u7b80\u5355\u7684\u5386\u53f2\u8bb0\u5f55\uff0c\u4f46\u7f3a\u70b9\u662f\u9690\u85cf\u4e86\u771f\u6b63\u7684\u63d0\u4ea4\u8bb0\u5f55\u3002</p> Caution <p>\u7531\u4e8e <code>rebase</code> \u4f1a\u5bf9\u5f53\u524d\u5206\u652f\u7684 commit \u5e8f\u5217\u9020\u6210\u8f83\u5927\u5e45\u5ea6\u7684\u4fee\u6539\uff0c\u6211\u4eec\u5fc5\u987b\u8c28\u614e\u5730\u4f7f\u7528\u5b83\u3002\u4f8b\u5982\uff0c\u5982\u679c\u6211\u4eec\u5728\u516c\u5171\u7684\u5206\u652f\uff0c\u6bd4\u5982 <code>master</code> \u4e0a\u6267\u884c <code>rebase</code>\uff0c\u90a3\u4e48\u5f88\u53ef\u80fd\u4f1a\u5bf9\u5176\u4ed6\u5728\u6b64\u5206\u652f\u4e0a\u5de5\u4f5c\u7684\u4eba\u9020\u6210\u6076\u52a3\u5f71\u54cd\uff0c\u4f8b\u5982\u9020\u6210\u5927\u91cf\u7684\u5408\u5e76\u51b2\u7a81\u3002</p> <p>\u53c8\u5982\uff0c<code>rebase</code> \u53ef\u80fd\u4f1a\u5bfc\u81f4\u91cd\u590d\u51b2\u7a81\u7684\u95ee\u9898\u3002\u5982\u679c\u5728 <code>a</code> \u5206\u652f\u4e0a\u8fdb\u884c <code>git rebase master</code>\uff0c\u800c\u5728 <code>master</code> \u4e0a\u53c8\u51fa\u73b0\u4e86\u5f88\u591a\u65b0\u7684\u63d0\u4ea4\uff0c\u90a3\u4e48\u5728 Git \u5bf9\u4f60\u7684 <code>a</code> \u5206\u652f\u4e0a\u7684\u65b0\u63d0\u4ea4\u8fdb\u884c\u51b2\u7a81\u68c0\u67e5\u65f6\uff0c\u4e00\u79cd\u4e0d\u5e78\u7684\u60c5\u51b5\u662f\u4f60\u5728 <code>a</code> \u5206\u652f\u4e0a\u7684\u5927\u91cf\u63d0\u4ea4\u90fd\u4ea7\u751f\u4e86\u51b2\u7a81\uff0c\u800c Git \u4f1a\u8981\u6c42\u4f60\u4e00\u4e2a\u4e00\u4e2a\u5730\u89e3\u51b3\u8fd9\u4e9b\u63d0\u4ea4\u5bf9\u5e94\u7684\u51b2\u7a81\u3002\u4f46\u662f\u8fd9\u79cd\u60c5\u51b5\u5bf9\u4e8e <code>merge</code> \u6765\u8bf4\u5374\u4e0d\u662f\u95ee\u9898\uff0c\u56e0\u4e3a\u5b83\u4f1a\u5148\u5c06 <code>master</code> \u4e0a\u65b0\u7684\u63d0\u4ea4\u201d\u538b\u7f29\u201c\u4e3a\u4e00\u4e2a\u63d0\u4ea4\uff0c\u7136\u540e\u548c\u5f53\u524d\u7684\u5206\u652f\u8fdb\u884c\u51b2\u7a81\u68c0\u67e5\uff0c\u56e0\u6b64\u6211\u4eec\u6700\u591a\u53ea\u4f1a\u9700\u8981\u89e3\u51b3\u4e00\u6b21\u5408\u5e76\u51b2\u7a81\u3002</p> <p>\u7a76\u7adf\u662f\u4f7f\u7528 <code>merge</code> \u8fd8\u662f <code>rebase</code>\uff0c\u66f4\u591a\u8ba8\u8bba\u53ef\u4ee5\u5728\u4e92\u8054\u7f51\u4e0a\u641c\u7d22\u5f97\u5230\uff0c\u672c\u6587\u7ae0\u4e0d\u4f1a\u7ed9\u51fa\u51b3\u5b9a\u6027\u7684\u5efa\u8bae\uff0c\u4f46\u4f1a\u5728\u540e\u6587\u5217\u4e3e\u4e00\u4e9b\u6709\u7ecf\u9a8c\u7684\u5f00\u53d1\u8005\u7684\u5b9e\u8df5\uff0c\u4ec5\u4f9b\u53c2\u8003\u3002\u5982\u679c\u4f60\u662f Git \u7684\u521d\u5b66\u8005\uff0c\u6211\u4eec\u5efa\u8bae\u4f7f\u7528 <code>merge</code> \u4e3a\u4e3b\u3002</p>"},{"location":"collaboration/git-workflow/resolve-conflicts/#git-pull","title":"<code>git pull</code>","text":"<p>\u9664\u4e86\u4e3b\u52a8\u5c06\u5f53\u524d\u7684\u5de5\u4f5c\u5206\u652f\u4e0e\u53e6\u4e00\u4e2a\u5206\u652f\u8fdb\u884c\u5408\u5e76\u4e4b\u5916\uff0c\u6211\u4eec\u8fd8\u6709\u4e00\u4e2a\u5e38\u7528\u7684\u64cd\u4f5c\u4f1a\u6d89\u53ca\u5206\u652f\u5408\u5e76\uff1a<code>git pull</code>\u3002\u6309\u7167 Git \u5b98\u65b9\u6587\u6863\uff0c\u5b83\u7684\u4f5c\u7528\u662f\u62c9\u53d6\u8fdc\u7aef\u4ed3\u5e93\u7684\u66f4\u65b0\uff0c\u5e76\u5c06\u5f53\u524d\u5206\u652f\u5bf9\u5e94\u7684\u8fdc\u7aef\u5206\u652f\u8fdb\u884c\u5408\u5e76\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5b83\u7b49\u4ef7\u4e8e\uff1a</p> <pre><code>$ git fetch\n$ git merge FETCH_HEAD\n</code></pre> <p>\u4e5f\u5c31\u662f\u8bf4\uff0c\u5047\u5982\u6211\u4eec\u5728 <code>master</code> \u5206\u652f\u4e0a\u4f7f\u7528\u4e86 <code>git pull</code>\uff0c\u5e76\u4e14\u5176\u4ed6\u4eba\u4e4b\u524d\u5728\u6b64\u5206\u652f\u4e0a\u7559\u4e0b\u4e86\u5f88\u591a\u65b0\u7684 commit\uff0c\u90a3\u4e48 <code>git pull</code> \u5c06\u4f1a\u5728\u62c9\u53d6 <code>master</code> \u5bf9\u5e94\u7684\u8fdc\u7aef\u5206\u652f\uff08\u901a\u5e38\u662f <code>origin/master</code>\uff09\u4e4b\u540e\uff0c\u5c06 <code>origin/master</code> \u5206\u652f\u5408\u5e76\u5230 <code>master</code> \u4e0a\u3002</p> <p>\u6211\u4eec\u4ecd\u4f7f\u7528 <code>example.txt</code> \u7684\u4f8b\u5b50\uff0c\u5047\u5982\u6b64\u65f6\u6709\u4eba\u5728 <code>master</code> \u5206\u652f\u4e0a\u6dfb\u52a0\u4e86\u65b0\u7684\u4e00\u884c\uff1a</p> example.txt <p><code>linenums=\"1\" hl_lines=\"4\" line one line two line three line four</code></p> <p>\u6b64\u65f6\u6211\u4eec\u672c\u5730\u7684 <code>master</code> \u5206\u652f\u8fd8\u6ca1\u6709\u66f4\u65b0\uff0c\u4f9d\u7136\u662f\u539f\u6765\u7684\u4e09\u884c\uff0c\u90a3\u4e48\u6211\u4eec\u6b64\u65f6\u8fd0\u884c <code>git pull</code>\uff0cGit \u4f1a\u50cf\u4e0a\u6587\u7684\u60c5\u51b5\u4e00\u6837\u8981\u6c42\u6211\u4eec\u4e3a\u81ea\u52a8\u751f\u6210\u7684 commit \u586b\u5199 commit message\u3002\u7136\u540e\uff0c\u6211\u4eec\u8fd0\u884c <code>git push</code>\uff0c\u6700\u7ec8\u8fd0\u884c <code>git log --graph --format=oneline</code>\uff0c</p> <pre><code>*   2777790053f709f8caec337a5ee8349cf1147573 (HEAD -&gt; master, origin/master) Merge remote-tracking branch 'origin/master'\n|\\\n| * 554a828d80dd12a7b10267e594c22722b2e25907 commit master 2\n|/\n* 1518bc8eaa5ad79e31ef41b9b229d231bb82ccb2 commit master 1\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u5373\u4f7f\u6ca1\u6709\u51fa\u73b0\u5408\u5e76\u51b2\u7a81\uff0c<code>git merge</code> \u4f9d\u7136\u4f1a\u4ea7\u751f\u4e00\u4e2a commit\uff0c\u5e76\u4e14\u4f1a\u5728 commit \u8bb0\u5f55\u91cc\u7559\u4e0b\u6298\u7ebf\u3002\u6709\u4eba\u4f1a\u8ba4\u4e3a\uff0c\u8fd9\u79cd\u65b9\u5f0f\u4f1a\u8ba9\u6211\u4eec\u4e3b\u5206\u652f\u7684 commit \u8bb0\u5f55\u53d8\u5f97\u6df7\u4e71\uff0c\u4e3a\u4ec0\u4e48\u6211\u4eec\u53ea\u662f\u7b80\u5355\u5730\u540c\u6b65\u4e86\u4e00\u4e0b\u672c\u5730\u7684 <code>master</code> \u5206\u652f\uff0c\u5c31\u8981\u5728 commit \u8bb0\u5f55\u91cc\u7559\u4e0b\u8fd9\u4e48\u590d\u6742\u7684\u8bb0\u5f55\u5462\uff1f\u4e8e\u662f\uff0c\u4ed6\u4eec\u4f1a\u91c7\u7528 <code>git pull --rebase</code> \u547d\u4ee4\uff0c\u8ba9 Git \u5728 <code>git fetch</code> \u4e4b\u540e\u8fd0\u884c <code>rebase</code> \u800c\u4e0d\u662f <code>merge</code>\uff0c\u8fd9\u6837\u5f97\u5230\u7684 commit \u8bb0\u5f55\u5982\u4e0b\uff1a</p> <pre><code>* 554a828d80dd12a7b10267e594c22722b2e25907 (HEAD -&gt; master, origin/master) commit master 2\n* 1518bc8eaa5ad79e31ef41b9b229d231bb82ccb2 commit master 1\n</code></pre> <p>\u5bf9\u6bd4\u8d77\u6765\uff0c\u786e\u5b9e\u7b80\u5355\u4e86\u5f88\u591a\uff0c\u770b\u4e0a\u53bb\u4e5f\u66f4\u52a0\u7b26\u5408\u6211\u4eec\u5bf9\u8fd9\u79cd\u7b80\u5355\u540c\u6b65\u64cd\u4f5c\u7684\u9884\u671f\u3002</p> Info <p>\u4f60\u53ef\u4ee5\u4f7f\u7528 <code>git config pull.rebase true</code> \u6765\u8ba9 <code>git pull</code> \u9ed8\u8ba4\u4f7f\u7528 <code>rebase</code> \u800c\u4e0d\u662f <code>merge</code>\u3002</p>"},{"location":"collaboration/git-workflow/resolve-conflicts/#fast-forward","title":"<code>fast-forward</code>","text":"<p>\u6709\u4eba\u62c5\u5fc3 <code>rebase</code> \u4f1a\u5728 <code>git pull</code> \u65f6\u51fa\u73b0\u4e0a\u6587\u6240\u8bf4\u7684\u4e00\u4e9b\u95ee\u9898\uff0c\u56e0\u800c\u4ed6\u4eec\u4f1a\u4f7f\u7528\u88ab\u79f0\u4e3a <code>fast-forward</code> \u65b9\u6cd5\u6765\u53d6\u4ee3 <code>rebase</code> \u548c\u666e\u901a\u7684 <code>merge</code>\u3002\u5bf9\u5e94\u7684\u547d\u4ee4\u662f <code>git pull --ff-only</code>\uff0c\u5b83\u7b49\u4ef7\u4e8e\u4ee5\u4e0b\u4e24\u4e2a\u547d\u4ee4\uff1a</p> <pre><code>$ git fetch\n$ git merge --ff-only FETCH_HEAD\n</code></pre> <p>\u4ece\u547d\u4ee4\u4e2d\u53ef\u4ee5\u770b\u5230\uff0c<code>fast-forward</code> \u662f\u4e00\u79cd\u7279\u6b8a\u7684 <code>merge</code>\u3002\u7b80\u5355\u6765\u8bf4\uff0c\u4ed6\u4f1a\u50cf <code>rebase</code> \u90a3\u6837\u5408\u5e76\u5206\u652f\uff0c\u4e0d\u4f1a\u51fa\u73b0\u989d\u5916\u7684 commit\uff0c\u4e5f\u4e0d\u4f1a\u5728 commit \u8bb0\u5f55\u91cc\u7559\u4e0b\u6298\u7ebf\u3002\u4f46\u662f\uff0c\u5982\u679c\u51fa\u73b0\u50cf\u5408\u5e76\u51b2\u7a81\u8fd9\u6837\u7684\u95ee\u9898\uff0c\u5b83\u4f1a\u62d2\u7edd\u8fdb\u884c\u5408\u5e76\u3002\u7531\u6b64\u770b\u6765\uff0c<code>fast-forward</code> \u662f\u4e00\u4e2a\u76f8\u5f53\u5b89\u5168\u7684\u5408\u5e76\u65b9\u6cd5\u3002\u5f88\u591a\u4eba\u90fd\u63a8\u8350\u4f7f\u7528 <code>fast-forward</code>\u3002</p> Info <p>\u4f60\u53ef\u4ee5\u4f7f\u7528 <code>git config pull.ff only</code> \u6765\u8ba9 <code>git pull</code> \u9ed8\u8ba4\u4f7f\u7528 <code>fast-forward</code>\u3002</p>"},{"location":"collaboration/git-workflow/resolve-conflicts/#\u53c2\u8003\u5b9e\u8df5","title":"\u53c2\u8003\u5b9e\u8df5","text":"<p>\u5728\u672c\u6587\u7684\u6700\u540e\uff0c\u6211\u4eec\u6765\u770b\u770b\u5728\u591a\u4eba\u534f\u4f5c\u80cc\u666f\u4e0b\u8f83\u4e3a\u5e38\u89c1\u7684 Git \u5b9e\u8df5\uff0c\u4f9b\u8bfb\u8005\u53c2\u8003\u3002</p>"},{"location":"collaboration/git-workflow/resolve-conflicts/#\u5728\u81ea\u5df1\u7684\u5206\u652f\u4e0a\u4f7f\u7528-rebase","title":"\u5728\u81ea\u5df1\u7684\u5206\u652f\u4e0a\u4f7f\u7528 <code>rebase</code>","text":"<p>\u5728\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u4f1a\u56e0\u4e3a\u8981\u6dfb\u52a0\u4e00\u9879\u65b0\u529f\u80fd\uff0c\u6216\u8005\u662f\u8fdb\u884c\u4e00\u9879\u4fee\u590d\u5de5\u4f5c\u800c\u5728\u4e3b\u5206\u652f\u91cc\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5206\u652f\uff0c\u7136\u540e\u5728\u4e0a\u9762\u5de5\u4f5c\u3002</p> <p>\u67d0\u4e9b\u65f6\u5019\uff0c\u6211\u4eec\u7684\u5de5\u4f5c\u53ef\u80fd\u9700\u8981\u4f9d\u8d56\u522b\u4eba\u65b0\u505a\u51fa\u7684\u4fee\u6539\uff0c\u6bd4\u5982\u67d0\u4eba\u4fee\u4e86\u4e00\u4e2a bug \u5e76\u628a\u5206\u652f\u5408\u5e76\u5230\u4e86\u4e3b\u5206\u652f\u91cc\uff0c\u800c\u6211\u4eec\u521a\u597d\u9700\u8981\u8fd9\u4e2a bug \u7684\u4fee\u590d\u3002\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5c06\u4e3b\u5206\u652f\u4f7f\u7528 <code>rebase</code> \u6765\u5408\u5e76\u5230\u6211\u4eec\u81ea\u5df1\u7684\u5206\u652f\u4e0a\u3002</p> <p>\u8fd9\u6837\u505a\u6539\u53d8\u4e86\u6211\u4eec\u5206\u652f\u7684\u63d0\u4ea4\u8bb0\u5f55\uff0c\u56e0\u4e3a\u6211\u4eec\u7684\u5206\u652f\u539f\u672c\u662f\u4ece\u4e3b\u5206\u652f\u4e0a\u66f4\u65e9\u7684\u63d0\u4ea4\u4e0a\u5206\u51fa\u6765\u7684\uff0c<code>rebase</code> \u4e4b\u540e\u5219\u8ba9\u5b83\u53d8\u6210\u4e86\u57fa\u4e8e\u4e3b\u5206\u652f\u7684\u6700\u65b0\u63d0\u4ea4\u3002\u8fd9\u6837\u505a\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u662f\u53ef\u4ee5\u63a5\u53d7\u7684\uff0c\u6211\u4eec\u4e0d\u59a8\u5bf9\u6bd4\u4e00\u4e0b\u5982\u679c\u4f7f\u7528\u7684\u662f <code>merge</code> \u4f1a\u600e\u4e48\u6837\uff1a</p> <ol> <li>\u5982\u4e0a\u6587\u6240\u8bf4\uff0c\u5b83\u4f1a\u5728\u6211\u4eec\u7684\u5206\u652f\u4e0a\u4ea7\u751f\u4e00\u4e2a\u5408\u5e76\u7684 commit\u3002</li> <li>\u540c\u65f6\uff0c\u5728\u63d0\u4ea4\u8bb0\u5f55\u91cc\u4f1a\u51fa\u73b0\u4e00\u6761\u4ece\u4e3b\u5206\u652f\u6307\u5411\u6211\u4eec\u7684\u5206\u652f\u7684\u6298\u7ebf\u3002</li> </ol> <p>\u8fd9\u6837\u7684\u7ed3\u679c\u8ba9\u4eba\u96be\u4ee5\u63a5\u53d7\uff0c\u6211\u4eec\u53ea\u662f\u60f3\u5229\u7528\u4e00\u4e0b\u4e3b\u5206\u652f\u4e0a\u6700\u65b0\u7684\u4fee\u6539\uff0c\u5374\u5bf9\u63d0\u4ea4\u8bb0\u5f55\u4ea7\u751f\u4e86\u8fd9\u4e9b\u770b\u4e0a\u53bb\u4e0d\u592a\u5fc5\u8981\u7684\u5f71\u54cd\u3002\u5982\u679c\u6211\u4eec\u4f7f\u7528 <code>rebase</code>\uff0c\u6211\u4eec\u5c06\u6446\u8131\u4e0a\u9762\u7684\u4e24\u70b9\u7ed3\u679c\uff0c\u5f97\u5230\u6e05\u6670\u76f4\u89c2\u7684\u63d0\u4ea4\u8bb0\u5f55\u3002\u5f53\u7136\uff0c\u4f7f\u7528 <code>rebase</code> \u4f9d\u7136\u5b58\u5728\u4e0a\u6587\u63d0\u5230\u7684\u91cd\u590d\u51b2\u7a81\u7684\u95ee\u9898\uff0c\u4f46\u5bf9\u4e8e\u6211\u4eec\u81ea\u5df1\u7684\u5206\u652f\u6765\u8bf4\u95ee\u9898\u51fa\u73b0\u7684\u6982\u7387\u6216\u51b2\u7a81\u7684\u89c4\u6a21\u662f\u8f83\u4f4e\u7684\uff0c\u56e0\u4e3a\u6211\u4eec\u7684\u5206\u652f\u4e00\u822c\u53ea\u4f1a\u6709\u8f83\u4e3a\u5c11\u91cf\u7684\u4fee\u6539\u3002</p>"},{"location":"collaboration/git-workflow/resolve-conflicts/#\u5728\u5408\u5e76\u81ea\u5df1\u5206\u652f\u65f6\u4f7f\u7528-merge---no-ff","title":"\u5728\u5408\u5e76\u81ea\u5df1\u5206\u652f\u65f6\u4f7f\u7528 <code>merge --no-ff</code>","text":"<p>\u4e00\u822c\u6765\u8bf4\uff0c\u5f53\u6211\u4eec\u5728\u81ea\u5df1\u7684\u5206\u652f\u4e0a\u5b8c\u6210\u5de5\u4f5c\u4e4b\u540e\uff0c\u6211\u4eec\u4f1a\u5728\u4e3b\u5206\u652f\u4e0a\u4f7f\u7528 <code>git merge --no-ff</code> \u6765\u5408\u5e76\u6211\u4eec\u81ea\u5df1\u7684\u5206\u652f\u3002\u4e3a\u4ec0\u4e48\u8981\u4f7f\u7528 <code>--no-ff</code> \u53c2\u6570\u5462\uff1f</p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c<code>merge</code> \u4f1a\u4f7f\u7528 <code>--ff</code>\uff0c\u4e5f\u5c31\u662f\u8bf4\u5728\u6761\u4ef6\u5141\u8bb8\u7684\u60c5\u51b5\u4e0b\u4f7f\u7528 <code>fast-forward</code>\uff0c\u5426\u5219\u4f1a\u521b\u5efa\u4e00\u4e2a\u7528\u4e8e\u5408\u5e76\u7684 commit\u3002<code>--no-ff</code> \u5219\u662f\u7981\u6b62\u4f7f\u7528 <code>fast-forward</code>\uff0c\u8ba9 Git \u603b\u662f\u521b\u5efa\u4e00\u4e2a\u65b0\u7684 commit\u3002</p> <p>\u4e8c\u8005\u7684\u533a\u522b\u4e3b\u8981\u4f53\u73b0\u5728\u8fd9\u6837\u7684\u4e00\u79cd\u60c5\u51b5\uff1a\u6211\u4eec\u7684\u4e3b\u5206\u652f <code>develop</code> \u4e00\u76f4\u90fd\u6ca1\u6709\u4efb\u4f55\u4fee\u6539\uff0c\u540c\u65f6\u6211\u4eec\u5728\u521a\u5206\u51fa\u6765\u7684 <code>feature</code> \u5206\u652f\u505a\u4e86\u51e0\u4e2a commit \u5e76\u5408\u5e76\u5230\u4e3b\u5206\u652f\uff0c\u8fd9\u65f6\u4e8c\u8005\u7684\u533a\u522b\u5982\u4e0b\u56fe\u6240\u793a\uff08\u56fe\u7247\u6765\u81ea\u300aA successful Git branching model\u300b\uff1a</p> <p></p> <p>\u4e8c\u8005\u5f97\u5230\u4e86\u4e0d\u540c\u7684\u63d0\u4ea4\u8bb0\u5f55\u3002\u53f3\u8fb9\u7684 <code>--ff</code> \u5728\u6267\u884c\u65f6\u53d1\u73b0\u60c5\u51b5\u9002\u5408\uff0c\u4f7f\u7528\u4e86 <code>fast-forward</code>\uff0c\u5bfc\u81f4\u6211\u4eec\u5f97\u5230\u4e86\u4e00\u6761\u5448\u76f4\u7ebf\u5f62\u6001\u7684\u63d0\u4ea4\u8bb0\u5f55\u3002\u8fd9\u6837\u770b\u4e0a\u53bb\u867d\u7136\u5f88\u6e05\u6670\uff0c\u4f46\u5b83\u8ba9\u6211\u4eec\u7684 <code>feature</code> \u5206\u652f\u88ab\u5305\u542b\u5230\u4e86 <code>develop</code> \u5206\u652f\u91cc\u3002\u5728\u53ef\u89c6\u5316\u7684 Git \u5de5\u5177\u91cc\uff0c\u5de6\u8fb9\u4ea7\u751f\u7684\u63d0\u4ea4\u8bb0\u5f55\u80fd\u591f\u8ba9\u4eba\u4eec\u66f4\u76f4\u89c2\u5730\u770b\u5230 <code>feature</code> \u5206\u652f\u7684\u5b58\u5728\uff0c\u5e76\u4e14\u4e5f\u80fd\u6e05\u6670\u5730\u5c55\u73b0 <code>feature</code> \u5206\u652f\u7684\u72ec\u7acb\u6027\uff08\u4ece\u54ea\u91cc\u5206\u51fa\u6765\uff0c\u53c8\u6c47\u5165\u5230\u54ea\u91cc\uff09\u3002</p>"},{"location":"collaboration/git-workflow/resolve-conflicts/#\u7075\u6d3b\u8fd0\u7528-squash","title":"\u7075\u6d3b\u8fd0\u7528 squash","text":"<p>squash \u6307\u7684\u662f\u5c06\u82e5\u5e72\u4e2a commit \u5408\u5e76\u4e3a\u4e00\u4e2a\u5355\u72ec\u7684 commit\u3002\u6b64\u6280\u5de7\u5e38\u7528\u5728\u6211\u4eec\u5728\u81ea\u5df1\u7684\u5206\u652f\u4e0a\u5de5\u4f5c\u5b8c\u6210\u540e\uff0c\u5728\u5408\u5e76\u5230\u4e3b\u5206\u652f\u4e4b\u524d\u3002\u6709\u4e9b\u56e2\u961f\u9f13\u52b1\u8fd9\u6837\u505a\uff0c\u56e0\u4e3a\u5728 squash \u4e4b\u540e\uff0c\u6211\u4eec\u7684\u5206\u652f\u53ea\u5269\u4e0b\u4e00\u4e2a commit\uff0c\u8fd9\u6837\u5728\u5408\u5e76\u4e4b\u540e\uff0c\u6211\u4eec\u53ea\u4f1a\u5728\u4e3b\u5206\u652f\u7684\u63d0\u4ea4\u8bb0\u5f55\u4e0a\u7559\u4e0b\u4e00\u4e2a commit \u7684\u8bb0\u5f55\uff0c\u800c\u8fd9\u4e2a commit \u6b63\u597d\u5bf9\u5e94\u4e86\u4e00\u4e2a\u5206\u652f\u7684\u6240\u6709\u4fee\u6539\uff0c\u56e0\u6b64\u5ba1\u9605\u8d77\u6765\u662f\u65b9\u4fbf\u4e14\u76f4\u89c2\u7684\u3002</p> <p>\u8981\u8fdb\u884c squash\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4ea4\u4e92\u5f0f <code>rebase</code>\u3002\u901a\u8fc7\u8fd0\u884c <code>git rebase -i HEAD~n</code>\uff0cGit \u4f1a\u8c03\u51fa\u6587\u672c\u7f16\u8f91\u5668\u6765\u7f16\u8f91\u5f53\u524d\u5206\u652f\u6700\u8fd1 <code>n</code> \u4e2a commit \u7684\u8bb0\u5f55\uff0c\u4f8b\u5982\uff1a</p> <pre><code>pick d62788c commit a 2\npick e7eb691 commit a 3\npick e4846ad commit a 4\n\n# Rebase 1bf37aa..e4846ad onto 1bf37aa (3 commands)\n#\n# Commands:\n# p, pick &lt;commit&gt; = use commit\n# r, reword &lt;commit&gt; = use commit, but edit the commit message\n# e, edit &lt;commit&gt; = use commit, but stop for amending\n# s, squash &lt;commit&gt; = use commit, but meld into previous commit\n# f, fixup &lt;commit&gt; = like \"squash\", but discard this commit's log message\n# x, exec &lt;command&gt; = run command (the rest of the line) using shell\n# b, break = stop here (continue rebase later with 'git rebase --continue')\n# d, drop &lt;commit&gt; = remove commit\n# l, label &lt;label&gt; = label current HEAD with a name\n# t, reset &lt;label&gt; = reset HEAD to a label\n# m, merge [-C &lt;commit&gt; | -c &lt;commit&gt;] &lt;label&gt; [# &lt;oneline&gt;]\n</code></pre> <p>\u6ce8\u610f\uff0ccommit \u7684\u8f93\u51fa\u987a\u5e8f\u4e3a\u4ece\u8001\u5230\u65b0\uff0c\u6700\u4e0b\u9762\u7684\u4e00\u884c\u624d\u662f\u6700\u65b0\u7684 commit\u3002\u5c06 \u6700\u4e0b\u9762\u7684\u4e24\u884c\u524d\u9762\u7684 <code>pick</code> \u547d\u4ee4\u4fee\u6539\u4e3a <code>s</code> \u6216 <code>squash</code>\uff0c\u5e76\u4fdd\u5b58\u9000\u51fa\uff0c\u8fd9\u6837 Git \u5c31\u4f1a\u5c06\u6700\u65b0\u7684\u4e24\u4e2a commit \u5408\u5e76\u5230\u7b2c\u4e00\u4e2a commit \u91cc\uff0c\u540c\u65f6\u8c03\u51fa\u53e6\u4e00\u4e2a\u6587\u672c\u7f16\u8f91\u5668\u6765\u8981\u6c42\u6211\u4eec\u8f93\u5165\u8fd9\u4e2a\u65b0\u7684\u878d\u5408 commit \u7684\u4fe1\u606f\u3002</p> Info <p>\u4ea4\u4e92\u5f0f <code>rebase</code> \u8fd8\u6709\u5f88\u591a\u5f3a\u5927\u7684\u529f\u80fd\u3002\u5982\u679c\u4f60\u60f3\u77e5\u9053\u6709\u5173\u5176\u4ed6\u547d\u4ee4\u7684\u4f5c\u7528\uff0c\u8bf7\u53c2\u8003\u5b98\u65b9\u6587\u6863\u3002</p> Info <p><code>git merge</code> \u4e5f\u6709\u4e00\u4e2a\u53eb\u505a <code>--squash</code> \u9009\u9879\uff0c\u5b83\u7684\u4f5c\u7528\u662f\u5c06\u76ee\u6807\u5206\u652f\u7684\u6240\u6709\u65b0\u7684 commit \u5408\u5e76\u4e3a\u4e00\u4e2a\u878d\u5408 commit \u5e76\u653e\u5230\u5f53\u524d\u5206\u652f\u4e0a\uff0c\u4f46\u4e0d\u4f1a\u5bf9\u76ee\u6807\u5206\u652f\u505a\u4efb\u4f55\u4fee\u6539\u3002</p>"},{"location":"collaboration/git-workflow/switching-branches/","title":"\u9ad8\u6548\u5730\u5904\u7406\u5206\u652f\u5207\u6362","text":"<p>\u5728\u591a\u4eba\u5171\u540c\u5728\u4e00\u4e2a repo \u4e2d\u5229\u7528\u5206\u652f\u529f\u80fd\u8fdb\u884c\u5408\u4f5c\u5f00\u53d1\u7684\u65f6\u5019\uff0c\u6709\u65f6\u5019\u6211\u4eec\u53ef\u80fd\u9700\u8981\u6765\u56de\u5207\u6362\u5206\u652f\uff0c\u7528\u6765\u4e34\u65f6\u7d27\u6025\u4fee\u590d\u4ee3\u7801\uff0c\u6216\u8005\u5e2e\u540c\u4e8b\u540c\u5b66 debug\u3002</p> <p>\u672c\u6587\u4f1a\u4ecb\u7ecd Git \u4e2d\u7684\u4e24\u6761\u975e\u5e38\u6709\u7528\u7684\u547d\u4ee4\uff1a<code>git stash</code> \u548c <code>git worktree</code>\u3002\u5b83\u4eec\u80fd\u591f\u5e2e\u52a9\u4f60\u9ad8\u6548\u5730\u4f7f\u7528 Git \u7ba1\u7406\u81ea\u5df1\u7f16\u5199\u7684\u5404\u79cd\u4fee\u6539\uff0c\u5feb\u901f\u5730\u5728\u5206\u652f\u95f4\u5207\u6362\u800c\u4e0d\u5f71\u54cd\u4f60\u5728\u4e0a\u4e00\u4e2a\u5206\u652f\u91cc\u8fd8\u6ca1\u6709\u63d0\u4ea4\u7684\u4fee\u6539\u3002\u4e0a\u9762\u7684\u6587\u5b57\u53ef\u80fd\u770b\u4e0a\u53bb\u6709\u4e9b\u8d39\u89e3\uff0c\u8bf7\u7ee7\u7eed\u9605\u8bfb\u4e0b\u6587\uff0c\u6211\u4eec\u4f1a\u7ed3\u5408\u4f8b\u5b50\u6765\u4ecb\u7ecd\u8fd9\u4e24\u4e2a\u5f3a\u5927\u7684\u547d\u4ee4\u7684\u57fa\u672c\u4f7f\u7528\u3002</p>"},{"location":"collaboration/git-workflow/switching-branches/#stash","title":"stash","text":"<p>\u6709\u7684\u65f6\u5019\uff0c\u6211\u4eec\u53ef\u80fd\u5728\u81ea\u5df1\u7684\u5206\u652f\u4e0a\u8fdb\u884c\u7740\u5de5\u4f5c\uff0c\u6682\u5b58\u533a\u548c\u5de5\u4f5c\u533a\u91cc\u542b\u6709\u5927\u91cf\u4fee\u6539\u3002\u800c\u8fd9\u65f6 leader \u7a81\u7136\u8ba9\u6211\u4eec\u7acb\u523b\u4fee\u590d\u4e00\u4e2a\u4e25\u91cd\u7684 bug\uff0c\u800c\u8fd9\u9700\u8981\u6211\u4eec\u5207\u6362\u5230\u4e3b\u5206\u652f\u8fdb\u884c\u4fee\u6539\u3002</p> <p>\u6211\u4eec\u4e0d\u5e0c\u671b\u5728\u5207\u6362\u5206\u652f\u4e4b\u540e\u6682\u5b58\u533a\u548c\u5de5\u4f5c\u533a\u91cc\u8fd8\u7559\u7740\u6211\u4eec\u4e4b\u524d\u7684\u4fee\u6539\uff0c\u56e0\u4e3a\u6211\u4eec\u4e4b\u524d\u7684\u4fee\u6539\u53ef\u80fd\u8fd8\u4e0d\u5b8c\u5584\uff0c\u4f1a\u8ba9\u7a0b\u5e8f\u65e0\u6cd5\u8fd0\u884c\u3002\u800c\u4e14\uff0c\u6709\u65f6\u5019\u6211\u4eec\u8fd8\u6ca1\u63d0\u4ea4\u7684\u4fee\u6539\u4f1a\u548c\u5176\u4ed6\u5206\u652f\u7684\u63d0\u4ea4\u4ea7\u751f\u51b2\u7a81\uff0c\u8fd9\u65f6 Git \u5e76\u4e0d\u5141\u8bb8\u6211\u4eec\u5207\u6362\u5206\u652f\uff0c\u5c31\u50cf\u4e0b\u9762\u7684\u63d0\u793a\u4e00\u6837\uff1a</p> <p>``` hl_lines=\"4\" $ git checkout a error: Your local changes to the following files would be overwritten by checkout:     example.txt Please commit your changes or stash them before you switch branches. Aborting <pre><code>\u4ed4\u7ec6\u4e00\u770b\uff0cGit \u63d0\u793a\u6211\u4eec\u8981\u4e48\u63d0\u4ea4\u4fee\u6539\uff0c\u8981\u4e48\u4f7f\u7528 `stash`\u3002\u63d0\u4ea4\u4fee\u6539\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u662f\u4e0d\u53ef\u63a5\u53d7\u7684\uff0c\u6211\u4eec\u4e0d\u60f3\u63d0\u4ea4\u4e00\u4e9b\u8fd8\u6ca1\u6709\u771f\u6b63\u5b8c\u6210\u7684\u4fee\u6539\u3002\u8fd9\u65f6 `git stash` \u547d\u4ee4\u5c31\u80fd\u6d3e\u4e0a\u7528\u573a\u4e86\u3002\n\nstash \u5728\u82f1\u8bed\u91cc\u7684\u610f\u601d\u662f\u85cf\u533f\uff0c\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u53ef\u4ee5\u5c06\u6682\u5b58\u533a\u548c\u5de5\u4f5c\u533a\u91cc\u7684\u4fee\u6539\u6682\u65f6\u85cf\u8d77\u6765\uff0c\u7136\u540e Git \u4f1a\u8ba4\u4e3a\u6211\u4eec\u4ec0\u4e48\u4fee\u6539\u4e5f\u6ca1\u505a\uff0c\u6211\u4eec\u56e0\u6b64\u53ef\u4ee5\u987a\u5229\u5730\u5207\u6362\u5230\u65b0\u7684\u5206\u652f\u3002\u7b49\u5230 bug \u4fee\u590d\u5b8c\u6210\uff0c\u6211\u4eec\u5207\u56de\u539f\u6765\u7684\u5206\u652f\u4e4b\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba9\u539f\u6765\u88ab\u85cf\u8d77\u6765\u7684\u4fee\u6539\u91cd\u65b0\u201c\u73b0\u5f62\u201d\uff0c\u51fa\u73b0\u5728\u6682\u5b58\u533a\u6216\u5de5\u4f5c\u533a\u4e2d\u3002\n\n\u6211\u4eec\u4ee5\u4e00\u4e2a\u53ea\u6709 `example.txt` \u8fd9\u4e2a\u6587\u4ef6\u7684\u4ed3\u5e93\u4e3a\u4f8b\u5b50\uff0c\u5047\u5982\u6211\u4eec\u6b64\u65f6\u5728 `a` \u5206\u652f\u4e0a\u5411\u5b83\u672b\u5c3e\u6dfb\u52a0\u4e86\u65b0\u7684\u4e00\u884c `new line`\uff0c\u4f46\u8fd8\u6ca1\u6765\u5f97\u53ca\u8fdb\u884c `git add` \u6216\u8005\u662f `git commit` \u7b49\u64cd\u4f5c\u3002\u8fd9\u65f6\u5019 leader \u9700\u8981\u6211\u4eec\u4ece `master` \u5206\u652f\u4e0a\u5207\u51fa\u65b0\u7684 `bug-fix` \u5206\u652f\u6765\u4fee\u590d\u4e00\u4e2a bug\uff0c\u90a3\u4e48\u8fd9\u65f6\u5019\u6211\u4eec\u53ef\u4ee5\u8fd0\u884c `git stash`\uff0c\u5f97\u5230\u4ee5\u4e0b\u8f93\u51fa\uff1a\n</code></pre> $ git stash Saved working directory and index state WIP on a: 4404526 commit a 1 <pre><code>Git \u63d0\u793a\u8bf4\u5df2\u7ecf\u4fdd\u5b58\u4e86\u5f53\u524d\u7684\u4fee\u6539\u3002\u8fd9\u65f6\u6211\u4eec\u8fd0\u884c `git status`\uff0c\u53ef\u4ee5\u5f97\u5230\u4ee5\u4e0b\u8f93\u51fa\uff1a\n</code></pre> $ git status On branch a Your branch is up to date with 'origin/a'.</p> <p>nothing to commit, working tree clean <pre><code>\u6211\u4eec\u7684\u5de5\u4f5c\u533a\u548c\u6682\u5b58\u533a\u90fd\u4e3a\u7a7a\uff0c\u5c31\u597d\u50cf\u6211\u4eec\u4ece\u6765\u6ca1\u6709\u505a\u51fa\u90a3\u884c\u4fee\u6539\u4e00\u6837\uff01\u8fd9\u65f6\u6211\u4eec\u5c31\u80fd\u5207\u6362\u5230\u5176\u4ed6\u5206\u652f\uff0c\u8fdb\u884c\u522b\u7684\u5de5\u4f5c\u4e86\u3002\u5f53\u6211\u4eec\u56de\u5230 `a` \u5206\u652f\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528 `git stash pop` \u6765\u6062\u590d\u4e4b\u524d\u7684\u4fee\u6539\uff1a\n</code></pre> On branch a Your branch is up to date with 'origin/a'.</p> <p>Changes not staged for commit:   (use \"git add ...\" to update what will be committed)   (use \"git restore ...\" to discard changes in working directory)     modified:   example.txt <p>no changes added to commit (use \"git add\" and/or \"git commit -a\") Dropped refs/stash@{0} (6349d71a1c2d7647b38e917b5e4506afd4ae5a3a) <pre><code>\u53ef\u4ee5\u770b\u5230\uff0c\u6211\u4eec\u4e4b\u524d\u5bf9 `example.txt` \u7684\u4fee\u6539\u5df2\u7ecf\u91cd\u65b0\u51fa\u73b0\u3002\u4ee5\u4e0a\u5c31\u662f `git stash` \u7684\u57fa\u672c\u7528\u6cd5\u4ecb\u7ecd\u3002\n\n???+info\n    `git stash` \u547d\u4ee4\u5176\u5b9e\u662f `git stash push` \u7684\u7f29\u5199\u3002\u4ece `push` \u548c `pop` \u7684\u5173\u7cfb\u53ef\u4ee5\u770b\u51fa\uff0cGit \u4fdd\u5b58\u6211\u4eec\u4fee\u6539\u7684\u6570\u636e\u7ed3\u6784\u662f\u4e00\u4e2a\u6808\uff0c\u8fd9\u610f\u5473\u7740\u6211\u4eec\u53ef\u4ee5\u591a\u6b21\u4f7f\u7528 `git stash`\uff0c\u5e76\u901a\u8fc7 `push` \u548c `pop` \u6765\u5b58\u53d6\u6211\u4eec\u7684\u4fee\u6539\u3002\n\n    \u7279\u522b\u5730\uff0c\u8fdb\u884c `push` \u548c `pop` \u64cd\u4f5c\u5e76\u4e0d\u662f\u5fc5\u987b\u5728\u540c\u4e00\u4e2a\u5206\u652f\u4e0a\u8fdb\u884c\uff0c\u6211\u4eec\u53ef\u4ee5\u6682\u5b58\u5728\u4e00\u4e2a\u5206\u652f\u4e0a\u7684\u4fee\u6539\uff0c\u7136\u540e\u5c06\u5b83\u91ca\u653e\u5230\u53e6\u4e00\u4e2a\u5206\u652f\u4e0a\u3002\n\n    \u4f7f\u7528 `git stash list` \u547d\u4ee4\u53ef\u4ee5\u67e5\u770b\u5f53\u524d\u6682\u5b58\u7684\u6240\u6709\u6279\u6b21\u7684\u4fee\u6539\u3002\u5176\u4ed6\u547d\u4ee4\u53ca\u66f4\u591a\u53c2\u6570\u8bf7\u89c1[\u5b98\u65b9\u6587\u6863](https://git-scm.com/docs/git-stash)\u3002\n\n## working trees\n\n\u4e0a\u8ff0\u7684 `stash` \u547d\u4ee4\u4f7f\u7528\u8d77\u6765\u975e\u5e38\u7b80\u5355\uff0c\u4f46\u5728\u4e00\u4e9b\u7279\u5b9a\u7684\u573a\u666f\u4e0b\u5374\u5e76\u4e0d\u80fd\u7ed9\u6211\u4eec\u5e26\u6765\u4fbf\u5229\u3002\u5982\u679c\u6211\u4eec\u6b63\u5728\u4fee\u6539\u7684\u6e90\u4ee3\u7801\u6b63\u5728\u88ab\u4e00\u4e9b\u5916\u90e8\u7a0b\u5e8f\u6240\u4f9d\u8d56\uff0c\u90a3\u4e48\u5728\u6211\u4eec\u8fdb\u884c `stash` \u4e4b\u540e\u8fd9\u4e9b\u5916\u90e8\u7a0b\u5e8f\u7684\u8fd0\u884c\u5c06\u4f1a\u53d7\u5230\u5f71\u54cd\uff0c\u4f46\u8fd9\u4e9b\u5f71\u54cd\u5f80\u5f80\u662f\u4e0d\u5fc5\u8981\u6216\u8005\u4f1a\u62d6\u7d2f\u6211\u4eec\u5de5\u4f5c\u7684\u3002\n\n\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\u662f\uff1a\u6211\u4eec\u542f\u52a8\u4e86\u4e00\u4e2a HTTP \u670d\u52a1\u5668\u6765\u8ba9\u6211\u4eec\u53ef\u4ee5\u8bbf\u95ee `localhost` \u6765\u5b9e\u65f6\u67e5\u770b\u6211\u4eec\u6b63\u5728\u7f16\u8f91\u7684\u524d\u7aef\u9879\u76ee\uff0c\u6bcf\u5f53\u6211\u4eec\u4fee\u6539\u6e90\u6587\u4ef6\uff0c\u6211\u4eec\u7684\u6d4f\u89c8\u5668\u5c31\u4f1a\u770b\u5230\u6700\u65b0\u7684\u7ed3\u679c\u3002\u8fd9\u65f6\u5982\u679c\u6211\u4eec\u8fd0\u884c `stash` \u5e76\u5207\u6362\u5230\u5176\u4ed6\u5206\u652f\u8fdb\u884c\u5de5\u4f5c\uff0c\u6211\u4eec\u7684\u6d4f\u89c8\u5668\u4e5f\u4f1a\u81ea\u52a8\u5c55\u793a\u5bf9\u5e94\u7684\u4fee\u6539\u3002\u95ee\u9898\u5728\u4e8e\u5bf9\u4e8e\u4e00\u4e9b\u590d\u6742\u7684\u524d\u7aef\u9879\u76ee\u6765\u8bf4\uff0c\u5bf9\u6e90\u7801\u7684\u4fee\u6539\u4f1a\u9700\u8981\u7ecf\u8fc7\u4e00\u7cfb\u5217\u590d\u6742\u7684\u7f16\u8bd1\u6b65\u9aa4\u624d\u80fd\u6700\u7ec8\u8f93\u51fa\u7ed9\u6d4f\u89c8\u5668\uff0c\u800c\u7f16\u8bd1\u7684\u8fc7\u7a0b\u4f1a\u6d88\u8017\u5927\u91cf\u7684 CPU \u8d44\u6e90\u548c\u5185\u5b58\uff0c\u62d6\u7d2f\u6211\u4eec\u7535\u8111\u7684\u6027\u80fd\u3002\u53e6\u4e00\u4e2a\u4f8b\u5b50\u662f\uff0c\u6211\u4eec\u5728\u539f\u6765\u7684\u5206\u652f\u4e0a\u5f00\u53d1\u65f6\u542f\u52a8\u4e86\u4e00\u4e9b\u8f85\u52a9\u5de5\u5177\uff0c\u8fd9\u4e9b\u5de5\u5177\u4f9d\u8d56\u5f53\u524d\u7684\u4ee3\u7801\uff0c\u5982\u679c\u8fd9\u65f6\u7a81\u7136\u5207\u6362\u5230\u53e6\u4e00\u4e2a\u5206\u652f\uff0c\u90a3\u4e48\u53e6\u4e00\u4e2a\u5206\u652f\u4e0a\u4e00\u4e9b\u622a\u7136\u4e0d\u540c\u7684\u4ee3\u7801\u4f1a\u8ba9\u8fd9\u4e9b\u5de5\u5177\u5d29\u6e83\u3002\n\n**\u5982\u679c\u80fd\u591f\u5728\u4fdd\u7559\u5f53\u524d\u4fee\u6539\u7684\u540c\u65f6\uff0c\u8ba9\u5f53\u524d\u7684\u6e90\u6587\u4ef6\u90fd\u4e0d\u53d8\uff0c\u5e76\u4e14\u6211\u4eec\u8fd8\u80fd\u5207\u6362\u5230\u5176\u4ed6\u5206\u652f\u8fdb\u884c\u5de5\u4f5c\u5c31\u597d\u4e86\u3002**\u8fd9\u770b\u8d77\u6765\u6709\u4e9b\u532a\u5937\u6240\u601d\uff0cGit \u5207\u6362\u4e00\u4e2a\u5206\u652f\u4e4b\u540e\uff0c\u4ed3\u5e93\u76ee\u5f55\u91cc\u7684\u6240\u6709\u6e90\u6587\u4ef6\u4e0d\u662f\u4f1a\u53d8\u6210\u76f8\u5e94\u5206\u652f\u7684\u6587\u4ef6\u5417\uff1f\u7684\u786e\u5982\u6b64\uff0c\u9664\u975e\u6211\u4eec\u4f7f\u7528\u5f3a\u5927\u7684 `git worktree` \u547d\u4ee4\u3002\n\nGit working trees \u5b9e\u73b0\u4e0a\u8ff0\u76ee\u6807\u7684\u65b9\u6cd5\u662f**\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u6587\u4ef6\u5939\u6765\u653e\u7f6e\u8981\u5207\u6362\u5230\u7684\u5206\u652f\u5bf9\u5e94\u7684\u6240\u6709\u6e90\u6587\u4ef6**\u3002\u4ecd\u4ee5\u4e0a\u6587\u7684 `example.txt` \u4e3a\u4f8b\uff0c\u5047\u5982\u6211\u4eec\u6b64\u65f6\u5728 `a` \u5206\u652f\u505a\u4e86\u4e00\u4e9b\u4fee\u6539\uff0c\u4f46\u662f\u8fd8\u6ca1\u6709\u8fd0\u884c\u50cf `git add` \u6216\u8005 `git commit` \u8fd9\u6837\u7684\u547d\u4ee4\u3002\u6b64\u65f6\u6211\u4eec\u88ab\u8981\u6c42\u5207\u6362\u5230 `master` \u5206\u652f\u4e0a\u4fee\u6539\u4e00\u4e2a bug\u3002\u6211\u4eec\u53ef\u4ee5\u8fd0\u884c `git worktree add ../fix-bug-on-master master`\uff0c\u5f97\u5230\u4ee5\u4e0b\u8f93\u51fa\uff1a\n</code></pre> $ git worktree add ../fix-bug-on-master master  Preparing worktree (checking out 'master') HEAD is now at 554a828 commit master 2 <pre><code>???+info\n    \u547d\u4ee4\u4e2d\u7684 `../fix-bug-on-master` \u4ee3\u8868\u4e00\u4e2a\u8def\u5f84\uff0c\u544a\u8bc9 Git \u5e94\u8be5\u521b\u5efa\u54ea\u4e2a\u6587\u4ef6\u5939\u3002`master` \u8868\u793a\u8981\u5207\u6362\u7684\u5206\u652f\u540d\uff0c\u53ef\u4ee5\u7701\u7565\u8fd9\u4e2a\u53c2\u6570\u8868\u793a\u76f4\u63a5\u4f7f\u7528\u5f53\u524d\u7684\u5206\u652f\u3002\u66f4\u591a\u53c2\u6570\u8bf7\u89c1[\u5b98\u65b9\u6587\u6863](https://git-scm.com/docs/git-worktree)\u3002\n\n\u6b64\u65f6 Git \u4f1a\u5c06\u5f53\u524d `master` \u5206\u652f\u7684\u6e90\u6587\u4ef6\u91ca\u653e\u5230 `../fix-bug-on-master` \u6587\u4ef6\u5939\u91cc\uff0c\u800c\u6211\u4eec\u5f53\u524d\u5206\u652f\u4ee5\u53ca\u521a\u521a\u505a\u7684\u6240\u6709\u4fee\u6539\u90fd\u4e0d\u53d8\u3002\u76f8\u5f53\u4e8e\u6211\u4eec\u624b\u52a8\u5207\u6362\u5230\u4e86 `..` \u6587\u4ef6\u5939\uff0c\u7136\u540e\u5c06\u4ed3\u5e93\u514b\u9686\u5230\u4e86 `fix-bug-on-master` \u6587\u4ef6\u5939\u91cc\u3002\n\n\u6b64\u65f6\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 `cd ../fix-bug-on-master` \u6765\u5207\u6362\u6587\u4ef6\u5939\uff0c\u5f00\u59cb bug \u7684\u4fee\u590d\u5de5\u4f5c\uff0c\u6700\u540e\u8fdb\u884c commit\u3002\u5f53\u6211\u4eec\u5b8c\u6210\u5de5\u4f5c\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5220\u9664\u6b64\u6587\u4ef6\u5939\uff0c\u5e76\u8fd0\u884c `git worktree remove ./fix-bug-on-master` \u6765\u79fb\u9664\u8fd9\u4e2a working tree\u3002\u6211\u4eec\u53ef\u4ee5\u5728\u4e00\u4e2a\u4ed3\u5e93\u7684\u6587\u4ef6\u5939\u91cc\u901a\u8fc7 `git worktree list` \u6765\u67e5\u770b\u5f53\u524d\u4ed3\u5e93\u4ee5\u53ca\u76f8\u5173\u7684 working tree \u5217\u8868\u3002\n\n\u5bf9\u6bd4\u4f7f\u7528 `stash`\uff0c\u867d\u7136 `worktree` \u5728\u4f7f\u7528\u4e0a\u66f4\u52a0\u9ebb\u70e6\uff0c\u4f46\u662f\u5b83\u4e3a\u6211\u4eec\u5728\u4e0d\u540c\u5206\u652f\u548c\u4fee\u6539\u4e4b\u95f4\u63d0\u4f9b\u4e86\u826f\u597d\u7684\u9694\u79bb\u6027\uff0c\u8ba9\u6211\u4eec\u53ef\u4ee5\u540c\u65f6\u5728\u4e0d\u540c\u5206\u652f\u5bf9\u5e94\u7684\u4ed3\u5e93\u76ee\u5f55\u91cc\u8fdb\u884c\u5de5\u4f5c\u3002\u7a76\u7adf\u5e94\u8be5\u4f7f\u7528\u54ea\u4e2a\u5e94\u5f53\u53d6\u51b3\u4e8e\u6211\u4eec\u9047\u5230\u7684\u5b9e\u9645\u95ee\u9898\u3002\u5982\u679c\u5728\u5207\u6362\u5206\u652f\u65f6\u4e0d\u5e0c\u671b\u5bf9\u5f53\u524d\u7684\u6e90\u6587\u4ef6\u8fdb\u884c\u6539\u53d8\uff0c\u90a3\u4e48\u6211\u4eec\u5f80\u5f80\u9700\u8981\u4f7f\u7528 `worktree`\uff0c\u5426\u5219\u4f7f\u7528\u7b80\u5355\u7684 `stash` \u5c31\u80fd\u6ee1\u8db3\u6211\u4eec\u7684\u9700\u8981\u3002\n\n## working trees \u4e0e clone\n\n\u6211\u4eec\u5728\u4e0a\u6587\u8bf4\u8fc7\uff0c\u521b\u5efa\u4e00\u4e2a working tree \u76f8\u5f53\u4e8e\u5c06\u6e90\u4ed3\u5e93\u514b\u9686\u5230\u4e86\u4e00\u4e2a\u65b0\u7684\u7a7a\u6587\u4ef6\u5939\u91cc\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u4e0b\u9762\u7684\u4e24\u6761\u547d\u4ee4\u90fd\u53ef\u4ee5\u8ba9\u6211\u4eec\u5f97\u5230\u4e00\u4e2a\u65b0\u7684\u6587\u4ef6\u5939\uff0c\u5728\u8fd9\u4e2a\u6587\u4ef6\u5939\u91cc\uff0c\u6211\u4eec\u6709 `a` \u5206\u652f\u5bf9\u5e94\u7684\u6e90\u4ee3\u7801\uff1a\n</code></pre> $ git worktree add ../branch-a a $ git clone -b a  ../branch-a <pre><code>\u5373\u4f7f\u5728\u7ed3\u679c\u7c7b\u4f3c\u7684\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u4f9d\u7136\u5efa\u8bae\u4f7f\u7528 working trees \u800c\u4e0d\u662f clone\u3002\u539f\u56e0\u5982\u4e0b\u6587\u6240\u8bf4\u3002\u6ce8\u610f\u6211\u4eec\u4ecd\u7136\u4f7f\u7528\u4e0a\u9762\u7684 `a` \u5206\u652f\u4e0e `master` \u5206\u652f\u7684\u4f8b\u5b50\u3002\n\n\u5bf9\u4e8e\u4e00\u4e2a\u5b58\u653e Git \u4ed3\u5e93\u7684\u6587\u4ef6\u5939\u800c\u8a00\uff0c**\u5b83\u5b9e\u9645\u5360\u7528\u7684\u78c1\u76d8\u7a7a\u95f4\u5e76\u4e0d\u4ec5\u4ec5\u662f\u5404\u79cd\u6e90\u4ee3\u7801\u6587\u4ef6\u7684\u5360\u7528\u7a7a\u95f4\uff0c\u8fd8\u5305\u62ec `.git` \u6587\u4ef6\u5939\u91cc\u9762\u7684\u5404\u79cd\u6587\u4ef6\u7684\u5360\u7528**\u3002\u7279\u522b\u662f `.git/objects` \u6587\u4ef6\u5939\u91cc\u5b58\u653e\u7684\u5404\u79cd blob \u6587\u4ef6\u3002\u4f8b\u5982\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u4e2d\u5927\u578b\u7684\u524d\u7aef\u9879\u76ee\u4ed3\u5e93\u6587\u4ef6\u5939\u6765\u8bf4\uff0c\u5b83\u5360\u7528\u78c1\u76d8\u7a7a\u95f4\u5927\u7ea6 `10G`\uff0c\u5176\u4e2d\u4ec5 `.git` \u6587\u4ef6\u5939\u5c31\u5360\u7528\u4e86 `3G`\u3002\n\n???+info\n    `.git/objects` \u91cc\u9762\u7684 blob \u6587\u4ef6\u662f\u4ec0\u4e48\uff1f\u5b83\u4eec\u5176\u5b9e\u662f\u538b\u7f29\u540e\u7684 commit \u4fe1\u606f\u3001\u6e90\u6587\u4ef6\u7b49\u3002\u4ece\u67d0\u79cd\u610f\u4e49\u4e0a\u6765\u8bf4 Git \u662f\u4e00\u4e2a\u952e\u503c\u5b58\u50a8\u8f6f\u4ef6\uff0c\u5176\u4e2d\u7684\u201c\u503c\u201d\u5c31\u88ab\u5b58\u653e\u5728\u8fd9\u4e9b blob \u6587\u4ef6\u4e2d\u3002\u5982\u679c\u4f60\u60f3\u4e86\u89e3 Git \u7684\u8fd9\u4e9b\u5185\u90e8\u539f\u7406\uff0c\u8bf7\u53c2\u8003\u5b98\u65b9\u6587\u6863\u4e2d\u7684[\u300aGit Internals - Git Objects\u300b](https://git-scm.com/book/en/v2/Git-Internals-Git-Objects)\u3002\n\n\u5982\u679c\u6211\u4eec\u4f7f\u7528 `clone` \u6765\u5f97\u5230\u4e00\u4e2a\u5207\u6362\u5230\u53e6\u4e00\u4e2a\u5206\u652f\u7684\u4ed3\u5e93\u6587\u4ef6\u5939\uff0c\u5bf9\u4e8e\u5c0f\u9879\u76ee\u6765\u8bf4\u5c1a\u53ef\u63a5\u53d7\uff0c\u4f46\u5bf9\u4e8e\u4e0a\u8ff0\u4f46\u4e2d\u5927\u578b\u9879\u76ee\u6765\u8bf4\u5219\u4f1a\u4ea7\u751f\u6781\u5927\u7684\u78c1\u76d8\u5360\u7528\u3002\u4e0e\u4e4b\u4ea7\u751f\u9c9c\u660e\u5bf9\u6bd4\u7684\u662f `worktree`\uff0c\u5b83**\u4f1a\u5728\u4ea7\u751f\u7684\u65b0\u6587\u4ef6\u5939\u91cc\u590d\u7528\u539f\u6765\u7684\u4ed3\u5e93\u7684 `.git` \u6587\u4ef6\u5939**\u3002\u4f60\u4f1a\u53d1\u73b0\u5728\u5f97\u5230\u7684\u65b0\u6587\u4ef6\u5939\u91cc\uff0c`.git` \u662f\u4e00\u4e2a\u6587\u4ef6\u800c\u4e0d\u662f\u6587\u4ef6\u5939\uff0c\u5185\u5bb9\u5982\u4e0b\uff1a\n</code></pre> gitdir: /\u539f\u6765\u7684\u4ed3\u5e93\u6587\u4ef6\u5939\u8def\u5f84/.git/worktrees/a ``` <p><code>worktree</code> \u4ea7\u751f\u7684\u65b0\u4ed3\u5e93\u5b9e\u9645\u4e0a\u6307\u5411\u4e86\u539f\u6765\u7684\u4ed3\u5e93\u3002\u5b83\u4eec\u4f1a\u5171\u7528\u4e00\u4e2a <code>.git</code> \u6587\u4ef6\u5939\uff0c\u5927\u5927\u51cf\u5c11\u4e86\u6574\u4f53\u7684\u78c1\u76d8\u5360\u7528\u3002\u540c\u65f6\uff0c<code>worktree</code> \u521b\u5efa\u7684\u6587\u4ef6\u5939\u4e0e\u6e90\u6587\u4ef6\u5939\u5171\u4eab <code>.git</code> \u6587\u4ef6\u5939\uff0c\u8fd9\u4f7f\u5f97\u6211\u4eec\u53ea\u9700\u5728\u5176\u4e2d\u4e00\u4e2a\u6587\u4ef6\u5939\u91cc\u8fdb\u884c <code>git fetch</code> \u6765\u83b7\u5f97\u8fdc\u7aef\u7684\u66f4\u65b0\uff0c\u5e76\u5bf9\u672c\u5730\u7684\u5206\u652f\u8fdb\u884c\u66f4\u65b0\u7b49\u64cd\u4f5c\uff0c\u907f\u514d\u4e86\u5728\u4e24\u4e2a\u6587\u4ef6\u5939\u91cc\u91cd\u590d\u5730\u8fd0\u884c <code>git fetch</code> \u7b49\u547d\u4ee4\u3002</p> Info <p>\u5982\u679c\u4f60\u5728\u65b0\u7684\u6587\u4ef6\u5939\u91cc\u8f93\u5165 <code>git checkout master</code>\uff0c\u4f60\u4f1a\u5f97\u5230\u4ee5\u4e0b\u7684\u9519\u8bef\u63d0\u793a\uff1a</p> <p><code>fatal: 'master' is already checked out at '/\u539f\u6765\u7684\u4ed3\u5e93\u6587\u4ef6\u5939\u8def\u5f84'</code></p> <p>Git \u544a\u8bc9\u6211\u4eec <code>master</code> \u5206\u652f\u5df2\u7ecf\u51fa\u73b0\u5728\u539f\u6765\u7684\u6587\u4ef6\u5939\u91cc\uff0c\u4e0d\u80fd\u518d\u5207\u6362\u3002\u8fd9\u8fdb\u4e00\u6b65\u8bf4\u660e\u4e86\u901a\u8fc7 <code>worktree</code> \u547d\u4ee4\u5efa\u7acb\u7684\u6587\u4ef6\u5939\u548c\u6e90\u6587\u4ef6\u5939\u7684\u7d27\u5bc6\u5173\u7cfb\uff0c\u4e0d\u5141\u8bb8\u5207\u6362\u5230\u540c\u4e00\u4e2a\u5206\u652f\u662f\u56e0\u4e3a\u53ef\u80fd\u4f1a\u5bfc\u81f4\u4fee\u6539\u7684\u51b2\u7a81\u3002</p>"},{"location":"debugging/","title":"\u6982\u89c8","text":"<p>\u5728\u7f16\u5199\u7a0b\u5e8f\u7684\u65f6\u5019\uff0c\u6211\u4eec\u96be\u514d\u4f1a\u72af\u9519\u5199 bug\uff0c\u719f\u7ec3\u638c\u63e1\u8c03\u8bd5\u5668\u7684\u4f7f\u7528\u53ef\u4ee5\u5927\u5927\u5730\u5e2e\u52a9\u6211\u4eec\u66f4\u5feb\u5730\u627e\u5230\u9519\u8bef\u3002\u672c\u8282\u4e3b\u8981\u5e26\u4f60\u4e86\u89e3\u600e\u6837\u4f7f\u7528\u547d\u4ee4\u884c\u4ee5\u53ca\u53ef\u89c6\u5316\u8c03\u8bd5\u5668\u8c03\u8bd5\u7a0b\u5e8f\uff0c\u5e76\u5e26\u4f60\u4e86\u89e3\u5982\u4f55\u4fdd\u5b58\u5e76\u8c03\u8bd5\u7a0b\u5e8f\u7684\u5d29\u6e83\u73b0\u573a\u3002</p>"},{"location":"debugging/coredump/","title":"\u8c03\u8bd5\u5185\u5b58\u8f6c\u50a8\u6587\u4ef6","text":"<p>\u5728\u7a0b\u5e8f\u5d29\u6e83\u7684\u65f6\u5019\uff0c\u6211\u4eec\u53ef\u80fd\u4f1a\u770b\u5230\u8fd9\u4e48\u4e00\u884c\u63d0\u793a</p> <pre><code>[1]    14439 segmentation fault (core dumped)  ./a.out\n</code></pre> <p>\u90a3\u4e48\u5176\u4e2d\u7684 <code>core dumped</code> \u5c31\u4ee3\u8868\u4e86\u5185\u5b58\u8f6c\u50a8\u7684\u610f\u601d\u3002\u5185\u5b58\u8f6c\u50a8\u770b\u4e0a\u53bb\u5f88\u9ad8\u5927\u4e0a\uff0c\u5176\u5b9e\u5c31\u662f\u628a\u7a0b\u5e8f\u8fd0\u884c\u65f6\u5019\u7684\u5185\u5b58\u4ee5\u53ca\u72b6\u6001\u90fd\u4fdd\u5b58\u5230\u4e86\u6587\u4ef6\u91cc\u800c\u5df2\u3002\u901a\u8fc7\u8fd9\u4e2a\u8f6c\u50a8\u6587\u4ef6\uff0c\u6211\u4eec\u5c31\u80fd\u590d\u539f\u7a0b\u5e8f\u5d29\u6e83\u65f6\u5019\u7684\u73b0\u573a\uff0c\u901a\u8fc7\u8c03\u8bd5\u5668\u5c1d\u8bd5\u5b9a\u4f4d\u95ee\u9898\u4e86\u3002</p>"},{"location":"debugging/coredump/#linux-\u4e0a\u8c03\u8bd5\u5185\u5b58\u8f6c\u50a8","title":"Linux \u4e0a\u8c03\u8bd5\u5185\u5b58\u8f6c\u50a8","text":"<p>\u4e0b\u9762\u6765\u5199\u4e00\u6bb5\u7ecf\u5178\u7684\u8bbf\u95ee\u7a7a\u6307\u9488\u7684\u7a0b\u5e8f\u3002</p> segfault.cpp <pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nvoid crash() {\n    int count = 0;\n    while (1) {\n        if (count == 10) {\n            *static_cast&lt;int*&gt;(0) = 1;\n        }\n        cout &lt;&lt; count &lt;&lt; endl;\n        ++count;\n    }\n}\n\nint main() {\n    crash();\n    return 0;\n}\n</code></pre> <p>\u7f16\u8bd1\u8fd0\u884c\uff0c\u7a0b\u5e8f\u4e0d\u51fa\u610f\u5916\u5730\u5d29\u6e83\u4e86\u3002</p> <pre><code>$ g++ -g segfault.cpp\n$ ./a.out\n0\n1\n2\n3\n4\n5\n6\n7\n8\n9\n[1]    14795 segmentation fault (core dumped)  ./a.out\n</code></pre> <p>\u4f46\u662f\uff0c\u6211\u4eec\u4e5f\u6ca1\u6709\u770b\u5230\u6709\u4ec0\u4e48 core \u6587\u4ef6\uff0c\u8fd9\u662f\u56e0\u4e3a\u9ed8\u8ba4\u60c5\u51b5\u4e0b Linux \u7cfb\u7edf\u4e2d\u7684\u9650\u5236\u4e86 core \u6587\u4ef6\u5927\u5c0f\u4e3a 0\uff0c\u6240\u4ee5\u4e0d\u4f1a\u6709\u4efb\u4f55\u7684\u5185\u5b58\u8f6c\u50a8\u4fdd\u5b58\u3002\u6211\u4eec\u9700\u8981\u901a\u8fc7 <code>ulimit</code> \u6307\u4ee4\u6765\u68c0\u67e5\u548c\u8bbe\u7f6e core \u6587\u4ef6\u5927\u5c0f\u9650\u5236\u3002</p> <pre><code>$ ulimit -c \n0\n$ ulimit -c unlimited\n$ ulimit -c\nunlimited\n</code></pre> <p>\u8fd9\u6837\u5c31\u53ef\u4ee5\u6682\u65f6\u5c06 core \u6587\u4ef6\u5927\u5c0f\u9650\u5236\u8bbe\u7f6e\u4e3a\u65e0\u9650\u5236\u3002\u7136\u540e\u518d\u6b21\u8fd0\u884c\u6211\u4eec\u7684\u7a0b\u5e8f\uff0c\u53ef\u4ee5\u770b\u5230\u8fd9\u6b21\u6709 core \u6587\u4ef6\u751f\u6210\u4e86\u3002</p> Note <p>\u901a\u8fc7 <code>ulimit</code> \u8bbe\u7f6e\u7684\u9650\u5236\u53ea\u5728\u5f53\u524d\u7684 Shell \u6709\u7528\u3002\u5982\u679c\u60f3\u6c38\u4e45\u8bbe\u7f6e\uff0c\u53ef\u4ee5\u53c2\u8003 <code>limits.conf</code> \u6587\u6863\u8bbe\u7f6e <code>/etc/security/limits.conf</code>\u3002</p> <pre><code>$ ./a.out\n0\n1\n2\n3\n4\n5\n6\n7\n8\n9\n[1]    15430 segmentation fault (core dumped)  ./a.out\n$ ls\na.out  core  segfault.cpp\n$ file core\ncore: ELF 64-bit LSB core file, x86-64, version 1 (SYSV), SVR4-style, from './a.out', real uid: 1000, effective uid: 1000, real gid: 1000, effective gid: 1000, execfn: './a.out', platform: 'x86_64'\n</code></pre> core \u6587\u4ef6\u6743\u9650 <p><pre><code>$ ls -lh core\n-rw------- 1 howard howard 496K  July 27 21:27 core\n</code></pre> \u53ef\u4ee5\u770b\u5230\uff0ccore \u6587\u4ef6\u9ed8\u8ba4\u7684\u6743\u9650\u662f\u53ea\u6709\u5f53\u524d\u7528\u6237\u53ef\u8bfb\u53ef\u5199\u3002\u8fd9\u662f\u56e0\u4e3a core \u6587\u4ef6\u662f\u7a0b\u5e8f\u8fd0\u884c\u5185\u5b58\u7684\u5feb\u7167\uff0c\u5728\u4e00\u4e9b\u654f\u611f\u7684\u573a\u5408\uff0c\u4f8b\u5982\u7528\u4e8e\u7528\u6237\u767b\u5f55\u7684\u670d\u52a1\uff0c\u53ef\u80fd\u4f1a\u4fdd\u5b58\u4e86\u4e00\u4e9b\u660e\u6587\u7684\u5bc6\u7801\u7b49\uff0c\u6240\u4ee5\u8981\u5c3d\u53ef\u80fd\u8ba9\u66f4\u5c11\u7684\u7528\u6237\u53ef\u4ee5\u8bbf\u95ee core \u6587\u4ef6\u3002</p> \u4fee\u6539 core \u6587\u4ef6\u7684\u4fdd\u5b58\u8def\u5f84 <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0ccore \u6587\u4ef6\u5c31\u662f\u4ee5 <code>core</code> \u8fd9\u4e2a\u6587\u4ef6\u540d\u4fdd\u5b58\u5230\u7a0b\u5e8f\u7684\u8fd0\u884c\u76ee\u5f55\u4e0b\u3002\u5982\u679c\u6709\u591a\u4e2a\u7a0b\u5e8f\u4f7f\u7528\u4e86\u540c\u6837\u7684\u8fd0\u884c\u76ee\u5f55\uff0c\u5219\u5728 core \u6587\u4ef6\u5df2\u7ecf\u5b58\u5728\u7684\u60c5\u51b5\u4e0b\uff0c\u4e0d\u4f1a\u751f\u6210\u65b0\u7684 core \u6587\u4ef6\u53bb\u8986\u76d6\u3002</p> <p>\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539 /proc/sys/kernel/core_uses_pid \u6587\u4ef6\u8ba9\u751f\u6210 core \u6587\u4ef6\u540d\u52a0\u4e0a pid \u53f7\u3002\u4f8b\u5982 <code>echo 1 &gt; /proc/sys/kernel/core_uses_pid</code> \u540e\uff0c\u751f\u6210\u7684 core \u6587\u4ef6\u540d\u5c06\u4f1a\u53d8\u6210 core.$pid\uff0c\u5176\u4e2d $pid \u8868\u793a\u8be5\u8fdb\u7a0b\u7684 PID\u3002</p> <p>\u8fd8\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539 /proc/sys/kernel/core_pattern \u6765\u63a7\u5236\u751f\u6210 core \u6587\u4ef6\u4fdd\u5b58\u7684\u4f4d\u7f6e\u4ee5\u53ca\u6587\u4ef6\u540d\u683c\u5f0f\u3002</p> <p>\u4f7f\u7528 <code>gdb</code>\uff0c\u6211\u4eec\u53ef\u4ee5\u52a0\u8f7d core \u6587\u4ef6\u8fdb\u884c\u8c03\u8bd5\uff0c\u548c\u4f7f\u7528 <code>gdb</code> \u542f\u52a8\u88ab\u8c03\u8bd5\u7a0b\u5e8f\u5dee\u4e0d\u591a\uff0c\u540c\u6837\u9700\u8981\u7f16\u8bd1\u65f6\u751f\u6210\u8c03\u8bd5\u4fe1\u606f\uff0c\u4e0d\u540c\u7684\u662f\u9700\u8981\u5728 <code>gdb</code> \u547d\u4ee4\u540e\u52a0 core \u6587\u4ef6\u540d\u3002</p> <pre><code>$ gdb a.out core\n# ...\nReading symbols from a.out...\n[New LWP 15648]\nCore was generated by `./a.out'.\nProgram terminated with signal SIGSEGV, Segmentation fault.\n#0  crash () at segfault.cpp:8\n8                   *static_cast&lt;int*&gt;(0) = 1;\n(gdb) print count\n$1 = 10\n(gdb) bt\n#0  crash () at segfault.cpp:8\n#1  0x000055a405baf206 in main () at segfault.cpp:16\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u8c03\u8bd5\u5668\u52a0\u8f7d\u4e86 core \u6587\u4ef6\uff0c\u6062\u590d\u4e86\u7a0b\u5e8f\u8fd0\u884c\u65f6\u5019\u7684\u73b0\u573a\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u68c0\u67e5\u7a0b\u5e8f\u5d29\u6e83\u65f6\u5019\u7684\u53d8\u91cf\u4ee5\u53ca\u8c03\u7528\u6808\u7b49\uff0c\u6765\u6392\u67e5 bug\u3002\u9664\u4e86\u4e0d\u53ef\u4ee5\u8fd0\u884c\u7a0b\u5e8f\u4ee5\u5916\uff0c\u5176\u4ed6\u90fd\u548c\u666e\u901a\u7684\u8c03\u8bd5\u6ca1\u6709\u533a\u522b\u3002</p> Note <p>\u5728\u5f00\u542f O1 \u4ee5\u4e0a\u7684\u4f18\u5316\u7ea7\u522b\u65f6\uff0c\u7f16\u8bd1\u5668\u53ef\u80fd\u4f1a\u7701\u7565\u7528\u4e8e\u56de\u6eaf\u7684\u6808\u5e27\u6307\u9488\uff0c\u8fd9\u4e0d\u5229\u4e8e\u8c03\u8bd5\u7a0b\u5e8f\u3002\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u53ef\u4ee5\u4f7f\u7528\u7f16\u8bd1\u5668\u7684 <code>-fno-omit-frame-pointer</code> \u9009\u9879\u6765\u4fdd\u7559\u6808\u5e27\u6307\u9488\u3002\u53e6\u5916\uff0c\u5982\u679c\u7a0b\u5e8f\u5d29\u6e83\u7684\u65f6\u5019\uff0c\u7834\u574f\u4e86\u7528\u4e8e\u56de\u6eaf\u7684\u6808\u5e27\u4fe1\u606f\uff0c\u90a3\u4e48\u5373\u4f7f\u62e5\u6709 core \u6587\u4ef6\uff0c\u53ef\u80fd\u4e5f\u6bd4\u8f83\u96be\u4ee5\u5b9a\u4f4d\u95ee\u9898\u3002</p>"},{"location":"debugging/coredump/#\u624b\u52a8\u751f\u6210-core-\u6587\u4ef6","title":"\u624b\u52a8\u751f\u6210 core \u6587\u4ef6","text":"<p>\u9664\u4e86\u7a0b\u5e8f\u5f02\u5e38\u9000\u51fa\u4f1a\u751f\u6210 core \u6587\u4ef6\u4ee5\u5916\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u901a\u8fc7 <code>gcore</code> \u547d\u4ee4\u6765\u83b7\u5f97\u4e00\u4e2a\u8fd0\u884c\u4e2d\u7684\u8fdb\u7a0b\u7684\u5185\u5b58\u8f6c\u50a8\u3002\u9996\u5148\u6211\u4eec\u5199\u4e00\u4e2a\u6b7b\u5faa\u73af\u7a0b\u5e8f\uff1a</p> loop.cpp <pre><code>#include &lt;iostream&gt;\n#include &lt;unistd.h&gt;\nusing namespace std;\n\nvoid loop() {\n    int count = 0;\n    while (1) {\n        sleep(1);\n        cout &lt;&lt; count &lt;&lt; endl;\n        ++count;\n    }\n}\n\nint main() {\n    loop();\n    return 0;\n}\n</code></pre> <p>\u7f16\u8bd1\u8fd0\u884c\uff0c\u7136\u540e\u5f00\u7b2c\u4e8c\u4e2a\u7ec8\u7aef\u8fdb\u884c\u64cd\u4f5c\u3002\u9996\u5148\u5220\u9664\u5df2\u6709\u7684 core \u6587\u4ef6\uff0c\u7136\u540e\u8bbe\u7f6e core \u6587\u4ef6\u9650\u5236\uff0c\u4f7f\u7528 <code>pidof</code> \u627e\u5230\u8fdb\u7a0b\u7684 PID\uff0c\u7528 <code>gcore</code> \u751f\u6210\u8f6c\u50a8\u6587\u4ef6\u3002\u9700\u8981\u6ce8\u610f\u4f7f\u7528 <code>gcore</code> \u547d\u4ee4\u9700\u8981\u6709 root \u6743\u9650\u3002</p> \u7b2c\u4e00\u4e2a\u7ec8\u7aef\u7b2c\u4e8c\u4e2a\u7ec8\u7aef <pre><code>$ g++ -g loop.cpp\n$ ./a.out\n0\n1\n2\n3\n...\n</code></pre> <pre><code>$ rm core\n$ ulimit -c unlimited\n$ pidof a.out\n15932\n$ sudo gcore 15932\n0x00007fe9eabbb00a in clock_nanosleep () from /lib/x86_64-linux-gnu/libc.so.6\nwarning: Memory read failed for corefile section, 4096 bytes at 0xffffffffff600000.\nSaved corefile core.15932\n[Inferior 1 (process 15932) detached]\n$ ls\na.out  loop.cpp  core.15932\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230 <code>gcore</code> \u751f\u6210\u7684 core \u6587\u4ef6\u4f1a\u5e26\u6709 PID \u540e\u7f00\u3002\u800c\u7a0b\u5e8f\u5728\u8f6c\u50a8\u4e4b\u540e\u4e0d\u53d7\u5f71\u54cd\uff0c\u53ef\u4ee5\u7ee7\u7eed\u8fd0\u884c\u3002\u63a5\u4e0b\u6765\u53ef\u4ee5\u7528\u4e0a\u9762\u63d0\u5230\u7684\u65b9\u6cd5\u52a0\u8f7d core \u6587\u4ef6\u8fdb\u884c\u8c03\u8bd5\u3002</p> \u8c28\u614e\u4f7f\u7528 <code>gcore</code> \u547d\u4ee4 <p>\u5bf9\u5185\u5b58\u5360\u7528\u8f83\u9ad8\u7684\u7a0b\u5e8f\u4f7f\u7528 <code>gcore</code> \u547d\u4ee4\u7684\u8bdd\u53ef\u80fd\u9700\u8981\u8f83\u957f\u65f6\u95f4\u6765\u4fdd\u5b58\u5185\u5b58\u5feb\u7167\uff0c\u53ef\u80fd\u4f1a\u9020\u6210\u7a0b\u5e8f\u8fd0\u884c\u7684\u957f\u65f6\u95f4\u5361\u987f\u3002</p> \u5207\u8bb0\u4fdd\u5b58\u73b0\u573a <p>\u5185\u5b58\u8f6c\u50a8\u662f\u7a0b\u5e8f\u8fd0\u884c\u73b0\u573a\u7684\u5feb\u7167\uff0c\u5bf9\u4e8e\u8c03\u8bd5\u6709\u7740\u91cd\u8981\u4f5c\u7528\uff0c\u5728\u9047\u5230\u96be\u4ee5\u590d\u73b0\u6216\u8005\u65e5\u5fd7\u96be\u4ee5\u6392\u67e5\u7684 bug \u65f6\uff0c\u4e00\u5b9a\u8981\u6ce8\u610f\u8bbe\u7f6e\u597d\u64cd\u4f5c\u7cfb\u7edf\u53c2\u6570\uff0c\u4fdd\u5b58\u5e76\u5229\u7528\u597d core \u6587\u4ef6\u6765\u5e2e\u52a9\u6211\u4eec\u5f00\u53d1\u8005\u8fdb\u884c\u8c03\u8bd5\u3002\u4f8b\u5982\uff0c\u5047\u5982\u9047\u5230\u7a0b\u5e8f\u6b7b\u9501\u7b49\u95ee\u9898\uff0c\u9700\u8981\u91cd\u542f\u7a0b\u5e8f\u65f6\uff0c\u6700\u597d\u5148\u7528 <code>gcore</code> \u4fdd\u5b58\u597d\u73b0\u573a\uff0c\u7136\u540e\u518d\u91cd\u542f\uff0c\u6216\u8005\u4f7f\u7528 <code>SIGABRT</code> \u7b49\u4fe1\u53f7\u4e2d\u6b62\u7a0b\u5e8f\uff0c\u8ba9\u64cd\u4f5c\u7cfb\u7edf\u5e2e\u6211\u4eec\u751f\u6210\u5185\u5b58\u8f6c\u50a8\u3002\u5f53\u7136\uff0c\u5982\u679c\u7a0b\u5e8f\u5d29\u6e83\u6b21\u6570\u6bd4\u8f83\u591a\uff0c\u4e5f\u9700\u8981\u6ce8\u610f\u597d\u5185\u5b58\u8f6c\u50a8\u7684\u6e05\u7406\uff0c\u9632\u6b62\u5360\u7528\u5927\u91cf\u78c1\u76d8\u7a7a\u95f4\u3002</p>"},{"location":"debugging/gdb/","title":"gdb \u8c03\u8bd5\u5de5\u5177","text":""},{"location":"debugging/gdb/#\u5bf9\u7279\u5b9a\u7ebf\u7a0b\u6253\u5370\u65ad\u70b9","title":"\u5bf9\u7279\u5b9a\u7ebf\u7a0b\u6253\u5370\u65ad\u70b9","text":"<p>\u5728 gdb \u4e2d\uff0c\u9ed8\u8ba4\u6253\u65ad\u70b9\u4f1a\u5e94\u7528\u5230\u5168\u90e8\u7ebf\u7a0b\u4e0a\uff0c\u8fd9\u65f6\u5019\u5982\u679c\u591a\u4e2a\u7ebf\u7a0b\u540c\u65f6\u6267\u884c\u4e86\u540c\u6837\u7684\u4ee3\u7801\uff0c\u90a3\u4e48\u65ad\u70b9\u5c31\u4f1a\u5728\u4e0d\u540c\u7ebf\u7a0b\u6765\u56de\u5207\u6362\uff0c\u4e0d\u65b9\u4fbf\u8ddf\u8e2a\u3002gdb \u53ef\u4ee5\u4f7f\u7528 <code>break xxx thread yyy</code> \u7684\u8bed\u6cd5\uff0c\u53ea\u5bf9\u67d0\u4e2a\u7ebf\u7a0b\u6253\u65ad\u70b9<sup>1</sup>\u3002</p>"},{"location":"debugging/gdb/#\u53c2\u8003\u8d44\u6599","title":"\u53c2\u8003\u8d44\u6599","text":"<ol> <li> <p>https://sourceware.org/gdb/onlinedocs/gdb/Thread_002dSpecific-Breakpoints.html \u21a9</p> </li> </ol>"},{"location":"deployment/","title":"\u6982\u89c8","text":"<p>\u7f16\u5199\u8c03\u8bd5\u5b8c\u6211\u4eec\u7684\u7a0b\u5e8f\u4e4b\u540e\uff0c\u662f\u65f6\u5019\u90e8\u7f72\u4e0a\u7ebf\u7a0b\u5e8f\u4e86\u3002\u5728\u4e00\u4e2a\u5206\u5de5\u5408\u4f5c\u7684\u56e2\u961f\u91cc\uff0c\u5176\u5b9e\u5230\u8fd9\u4e00\u6b65\u5df2\u7ecf\u4f1a\u6709\u8fd0\u7ef4\u6765\u5e2e\u52a9\u4f60\u5b8c\u6210\u4e0a\u7ebf\u4efb\u52a1\u4e86\u3002\u4e0d\u8fc7\uff0c\u5047\u5982\u4f60\u662f\u4e00\u4e2a\u5355\u6253\u72ec\u6597\u7684\u7a0b\u5e8f\u5458\uff0c\u6216\u8005\u56e2\u961f\u4e2d\u6ca1\u6709\u4eba\u5e2e\u4f60\u5b8c\u6210\u8fd9\u9879\u4efb\u52a1\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u4f60\u4eb2\u81ea\u4e0a\u9635\u90e8\u7f72\u4e86\u3002</p> <p>\u5bf9\u4e8e\u4e00\u4e2a\u670d\u52a1\u8fdb\u7a0b\uff0c\u9996\u5148\u6211\u4eec\u5e0c\u671b\u5b83\u80fd\u591f\u8dd1\u8d77\u6765\uff0c\u8fd9\u5c31\u6d89\u53ca\u5230\u4f9d\u8d56\u7684\u7ba1\u7406\u3002\u7136\u540e\uff0c\u6211\u4eec\u5f53\u7136\u662f\u5e0c\u671b\u5b83\u80fd\u4e00\u76f4\u7a33\u5b9a\u5730\u8fd0\u884c\u4e0b\u53bb\uff0c\u8fd9\u5c31\u6d89\u53ca\u5230\u5982\u4f55\u76d1\u63a7\u6211\u4eec\u7684\u670d\u52a1\u8fdb\u7a0b\u662f\u5426\u6b63\u5e38\u3002\u6700\u540e\u662f\u9700\u8981\u8ba9\u8fd9\u4e2a\u670d\u52a1\u53ef\u4ee5\u6b63\u5e38\u63a5\u6536\u8bf7\u6c42\uff0c\u6d89\u53ca\u5230\u9632\u706b\u5899\u4ee5\u53ca\u4ee3\u7406\u7b49\u3002\u8ba1\u7b97\u673a\u79d1\u5b66\u7ecf\u8fc7\u6570\u5341\u5e74\u7684\u53d1\u5c55\uff0c\u81ea\u7136\u540c\u6837\u662f\u884d\u751f\u51fa\u4e86\u5404\u79cd\u5404\u6837\u7684\u4f9d\u8d56\u6253\u5305\u4ee5\u53ca\u90e8\u7f72\u5de5\u5177\uff0c\u4e0b\u9762\u5c31\u4ecb\u7ecd\u5982\u4f55\u7ba1\u7406\u8fd0\u884c\u65f6\u4f9d\u8d56\u4ee5\u53ca\u5982\u4f55\u81ea\u52a8\u62c9\u8d77\u670d\u52a1\u3002</p>"},{"location":"deployment/docker/","title":"Docker","text":"<p>Docker \u662f\u4e00\u5957\u5229\u7528\u4e86 Linux \u5bb9\u5668\u6280\u672f\u7684\u5de5\u5177\u3002\u4f7f\u7528 Docker\uff0c\u6211\u4eec\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u5c06\u6211\u4eec\u7684\u5e94\u7528\u7a0b\u5e8f\u6253\u5305\uff0c\u5e76\u5728\u4e0e\u7cfb\u7edf\u9694\u79bb\u7684\u73af\u5883\u4e2d\u8fd0\u884c\uff0c\u5c31\u50cf\u662f\u865a\u62df\u673a\u4e00\u6837\u3002\u4e0d\u8fc7\uff0c\u5728\u4f7f\u7528 Docker \u524d\uff0c\u9700\u8981\u5b89\u88c5 Docker\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0cDocker \u53ea\u80fd\u5728 Linux \u4e0b\u8fd0\u884c\uff0c\u5982\u679c\u4f60\u4f7f\u7528\u7684\u662f Windows\uff0c\u9700\u8981\u501f\u52a9 WSL2 \u6216\u8005\u865a\u62df\u673a\u6765\u8fd0\u884c\u3002</p> cgroups \u4e0e Linux Namespace <p>Docker \u4e3b\u8981\u4f7f\u7528\u4e86 cgroups \u6280\u672f\u4ee5\u53ca Linux Namespace \u6280\u672f\u3002cgroups \u7528\u4e8e\u8d44\u6e90\u7684\u5171\u4eab\u9650\u5236\uff0c\u4f8b\u5982\u9650\u5236 CPU \u5360\u7528\u7387\u3001\u5185\u5b58\u4f7f\u7528\u7a7a\u95f4\u3001\u78c1\u76d8 IO \u7b49\uff0c\u800c Linux Namespace \u5219\u7528\u4e8e\u7cfb\u7edf\u6743\u9650\u7684\u9694\u79bb\uff0c\u4f8b\u5982\u9694\u79bb IPC \u7a7a\u95f4\u3001\u7f51\u7edc\u7a7a\u95f4\u3001\u7528\u6237\u6743\u9650\u7a7a\u95f4\u7b49\u3002</p> OCI \u6807\u51c6 <p>Docker \u548c Linux \u57fa\u91d1\u4f1a\u63d0\u51fa\u4e86 OCI \u6807\u51c6\uff0c\u4fc3\u8fdb\u5bb9\u5668\u6280\u672f\u7684\u5f00\u653e\u53d1\u5c55\u3002\u7406\u8bba\u4e0a\u652f\u6301 OCI \u6807\u51c6\u7684\u5de5\u5177\u90fd\u53ef\u4ee5\u4e92\u76f8\u66ff\u6362\uff0c\u4f8b\u5982 Podman \u7b49\u3002</p>"},{"location":"deployment/docker/#\u6784\u5efa\u5e94\u7528\u955c\u50cf","title":"\u6784\u5efa\u5e94\u7528\u955c\u50cf","text":""},{"location":"deployment/docker/#\u4f7f\u7528-docker-compose-\u7f16\u6392\u5e94\u7528","title":"\u4f7f\u7528 Docker Compose \u7f16\u6392\u5e94\u7528","text":""},{"location":"deployment/packaging/","title":"\u7a0b\u5e8f\u7684\u6253\u5305","text":"<p>\u4e00\u822c\u6765\u8bf4\uff0c\u5728\u6bd4\u8f83\u6b63\u5f0f\u7684\u9879\u76ee\u4e2d\uff0c\u5f00\u53d1\u7684\u673a\u5668\u548c\u5b9e\u9645\u8fd0\u884c\u670d\u52a1\u7684\u673a\u5668\u4e0d\u4f1a\u662f\u540c\u4e00\u53f0\u3002\u4e00\u822c\u800c\u8a00\uff0c\u6211\u4eec\u4e5f\u4e0d\u4f1a\u5728\u670d\u52a1\u5668\u4e0a\u642d\u5efa\u4e00\u6a21\u4e00\u6837\u7684\u5f00\u53d1\u73af\u5883\uff0c\u6240\u4ee5\uff0c\u6211\u4eec\u4e00\u822c\u4e5f\u4e0d\u4f1a\u628a\u6e90\u4ee3\u7801\u4e0a\u4f20\u4e0a\u53bb\u7f16\u8bd1\u4e00\u6b21\uff0c\u800c\u6211\u4eec\u7684\u7a0b\u5e8f\u4e8c\u8fdb\u5236\u4e0a\u4f20\u4e0a\u53bb\u4e5f\u5f88\u53ef\u80fd\u662f\u4e0d\u80fd\u8fd0\u884c\u8d77\u6765\u7684\u3002\u6240\u4ee5\uff0c\u5728\u670d\u52a1\u5668\u4e0a\u8fd0\u884c\u7a0b\u5e8f\u4e4b\u524d\uff0c\u6211\u4eec\u9996\u5148\u8981\u89e3\u51b3\u7684\u95ee\u9898\u5c31\u662f\uff0c\u600e\u6837\u628a\u6211\u4eec\u7684\u7a0b\u5e8f\u8fd0\u884c\u6240\u9700\u8981\u7684\u4f9d\u8d56\u4ee5\u53ca\u73af\u5883\u5728\u670d\u52a1\u5668\u4e0a\u590d\u73b0\uff1f\u8fd9\u5c31\u6d89\u53ca\u5230\u7a0b\u5e8f\u7684\u6253\u5305\u3002</p>"},{"location":"deployment/packaging/#\u7eaf\u9759\u6001\u94fe\u63a5","title":"\u7eaf\u9759\u6001\u94fe\u63a5","text":"<p>\u6700\u7b80\u5355\u7c97\u66b4\u7684\u65b9\u6cd5\u5c31\u662f\u4f7f\u7528\u7eaf\u9759\u6001\u94fe\u63a5\uff0c\u8fd9\u6837\u6240\u6709\u7684\u4f9d\u8d56\u5e93\u90fd\u6253\u5305\u5230\u4e86\u53ef\u6267\u884c\u6587\u4ef6\u4e2d\uff0c\u53ef\u6267\u884c\u6587\u4ef6\u672c\u8eab\u5c31\u662f\u7a0b\u5e8f\u5305\uff0c\u53ea\u8981\u64cd\u4f5c\u7cfb\u7edf\u4e00\u6837\uff0c\u6211\u4eec\u76f4\u63a5\u628a\u7a0b\u5e8f\u548c\u914d\u7f6e\u6587\u4ef6\u4e0a\u4f20\u4e0a\u53bb\u5373\u53ef\u3002\u8fd9\u79cd\u505a\u6cd5\u7684\u95ee\u9898\u5728\u4e8e\uff0c\u5047\u5982\u6211\u4eec\u7684\u7a0b\u5e8f\u5f88\u5927\uff0c\u4f8b\u5982\u7f16\u8bd1\u51fa\u6765\u7684\u4e8c\u8fdb\u5236\u6709\u4e0a\u767e MB\uff0c\u90a3\u4e48\u54ea\u6015\u4fee\u6539\u4e86\u5f88\u5c0f\u4e00\u90e8\u5206\uff0c\u4e5f\u9700\u8981\u628a\u6574\u4e2a\u6587\u4ef6\u91cd\u65b0\u4e0a\u4f20\u4e0a\u53bb\u3002\u5f53\u7136\uff0c\u53ef\u4ee5\u4f7f\u7528 rsync \u7b49\u5de5\u5177\u51cf\u5c11\u4f20\u8f93\u91cf\u3002</p>"},{"location":"deployment/systemd/","title":"systemd \u90e8\u7f72","text":"<p>\u76ee\u524d\uff0c\u8f83\u65b0\u7684 Linux \u53d1\u884c\u7248\uff0c\u90fd\u5df2\u7ecf\u4f7f\u7528\u4e86 systemd \u4f5c\u4e3a\u7cfb\u7edf\u5b88\u62a4\u8fdb\u7a0b\uff0c\u8d1f\u8d23\u7cfb\u7edf\u5404\u4e2a\u670d\u52a1\u8fdb\u7a0b\u7684\u7ba1\u7406\u3002\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 systemd \u6765\u5b88\u62a4\u6211\u4eec\u7684\u670d\u52a1\u8fdb\u7a0b\uff0c\u5b9e\u73b0\u81ea\u52a8\u91cd\u542f\u7b49\u529f\u80fd\u3002</p>"},{"location":"deployment/systemd/#\u5e38\u7528\u7684\u76ee\u5f55\u5b89\u6392","title":"\u5e38\u7528\u7684\u76ee\u5f55\u5b89\u6392","text":"<p>Linux \u6ca1\u6709\u89c4\u5b9a\u7a0b\u5e8f\u4ee5\u53ca\u914d\u7f6e\u5fc5\u987b\u5b89\u88c5\u5728\u54ea\u4e2a\u76ee\u5f55\u4e0b\uff0c\u4f46\u4e3a\u4e86\u7ba1\u7406\u65b9\u4fbf\uff0c\u4e00\u822c\u800c\u8a00\u53ef\u4ee5\u91c7\u7528\u4ee5\u4e0b\u7684\u5b58\u653e\u8def\u5f84\uff1a</p>"},{"location":"deployment/systemd/#\u53ef\u6267\u884c\u6587\u4ef6","title":"\u53ef\u6267\u884c\u6587\u4ef6","text":"<p>\u5168\u5c40\u7684\u53ef\u6267\u884c\u6587\u4ef6\u4e00\u822c\u5b89\u88c5\u5728 <code>/usr/local</code> \u4e0b\uff0c\u5176\u4e2d\u53ef\u6267\u884c\u7a0b\u5e8f\u5728 <code>/usr/local/bin</code> \u4e0b\uff0c\u800c\u8fd0\u884c\u5e93\u7b49\u5728 <code>/usr/local/lib</code> \u4e0b\u3002\u4e00\u822c\u8fd9\u79cd\u7a0b\u5e8f\u662f\u901a\u8fc7 <code>make install</code> \u547d\u4ee4\u5b89\u88c5\u7684\u3002\u6709\u4e00\u4e9b\u53ea\u6709\u4e00\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\u7684\u547d\u4ee4\u884c\u7a0b\u5e8f\uff0c\u4e5f\u53ef\u4ee5\u653e\u5728 <code>/usr/local/bin</code> \u4e0b\u3002</p> <p>\u5bf9\u4e8e\u5df2\u7ecf\u63d0\u4f9b\u4e86\u5b89\u88c5\u5668\u7684\u7a0b\u5e8f\uff0c\u4f8b\u5982 Matlab\uff0c\u5219\u53ef\u4ee5\u5b89\u88c5\u5230 <code>/opt</code> \u76ee\u5f55\u4e0b\uff0c\u4f8b\u5982 Matlab \u53ef\u4ee5\u5b89\u88c5\u5230 <code>/opt/matlab</code> \u4e0b\uff0c\u53ef\u6267\u884c\u6587\u4ef6\u4e00\u822c\u4f1a\u5b58\u653e\u5728 <code>/opt/xxx/bin/xxx</code> \u4e2d\u3002</p>"},{"location":"deployment/systemd/#\u914d\u7f6e\u6587\u4ef6","title":"\u914d\u7f6e\u6587\u4ef6","text":"<p>\u914d\u7f6e\u6587\u4ef6\u4e00\u822c\u6709\u5168\u5c40\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u4e5f\u6709\u7528\u6237\u7684\u914d\u7f6e\u6587\u4ef6\u3002\u901a\u5e38\u800c\u8a00\uff0c\u5168\u5c40\u914d\u7f6e\u6587\u4ef6\u7531\u7cfb\u7edf\u7ba1\u7406\u5458\u7ba1\u7406\uff0c\u5b58\u653e\u5728 <code>/etc</code> \u76ee\u5f55\u4e0b\u3002\u4f8b\u5982\uff0c<code>nginx</code> \u7a0b\u5e8f\u7684\u914d\u7f6e\u6587\u4ef6\u5c31\u5b58\u653e\u5728 <code>/etc/nginx</code> \u76ee\u5f55\u4e0b\u3002\u800c\u7528\u6237\u7279\u5b9a\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u4e00\u822c\u53ef\u4ee5\u5b58\u653e\u5728 <code>~/.config</code> \u76ee\u5f55\u4e0b\uff0c\u6216\u8005 <code>~/.$APP</code> \u76ee\u5f55\u4e0b\uff0c\u4f8b\u5982\uff0c\u5982\u679c\u4f60\u5199\u4e86\u4e00\u4e2a\u670d\u52a1\u5668\u7a0b\u5e8f\u53eb <code>my-server</code>\uff0c\u53ef\u4ee5\u5c06\u914d\u7f6e\u6587\u4ef6\u653e\u5230 <code>~/.my-server</code> \u4e2d\u3002</p> <p>\u4e0d\u540c\u7684\u7a0b\u5e8f\u5bf9\u4e8e\u914d\u7f6e\u6587\u4ef6\u7684\u641c\u7d22\u8fc7\u7a0b\u4e0d\u4e00\u6837\uff0c\u6709\u7684\u7a0b\u5e8f\u4f1a\u5185\u7f6e\u82e5\u5e72\u4e2a\u641c\u7d22\u8def\u5f84\uff0c\u5e76\u6309\u7167\u4f18\u5148\u7ea7\u4f9d\u6b21\u8986\u76d6\u914d\u7f6e\uff0c\u6709\u7684\u7a0b\u5e8f\u5fc5\u987b\u624b\u52a8\u6307\u5b9a\u4e00\u4e2a\u914d\u7f6e\u6587\u4ef6\u8def\u5f84\uff0c\u6216\u8005\u4f7f\u7528\u9ed8\u8ba4\u7684\u914d\u7f6e\u6587\u4ef6\u8def\u5f84\u542f\u52a8\u3002</p>"},{"location":"deployment/systemd/#\u7f16\u5199-unit-\u6587\u4ef6","title":"\u7f16\u5199 Unit \u6587\u4ef6","text":"<p>\u901a\u8fc7 systemd \u670d\u52a1\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba9\u7a0b\u5e8f\u5f00\u673a\u81ea\u542f\uff0c\u5e76\u5728\u5d29\u6e83\u9000\u51fa\u7684\u65f6\u5019\u7531\u7cfb\u7edf\u81ea\u52a8\u91cd\u65b0\u542f\u52a8\u3002\u4e00\u822c\u6765\u8bf4\uff0c\u6211\u4eec\u9700\u8981\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u6307\u5b9a\uff1a</p> <ul> <li>\u670d\u52a1\u7684\u4fe1\u606f</li> <li>\u670d\u52a1\u7684\u4f9d\u8d56</li> <li>\u542f\u505c\u547d\u4ee4</li> <li>\u8fd0\u884c\u73af\u5883</li> </ul> <p>\u8981\u521b\u5efa\u4e00\u4e2a Unit\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u547d\u4ee4 <code>systemctl edit --full --force --user my-server.service</code> \u6765\u521b\u5efa\u5e76\u7f16\u8f91\u4e00\u4e2a Unit \u6587\u4ef6\u3002</p> <p>\u5728\u7f16\u8f91\u5668\u4e2d\uff0c\u6309\u7167\u4ee5\u4e0b\u6a21\u677f\u7f16\u5199\u5185\u5bb9\uff1a</p> my-server.service <pre><code>[Unit]\nDescription=my-server\n\n[Service]\nWorkingDirectory=/home/my-server\nType=simple\nEnvironment=LOGLEVEL=info\nEnvironment=SECRET_KEY=secret\nExecStart=/home/my-server/bin/my-server --port=8080\nRestart=on-failure\nUser=my-server\nGroup=my-server\nLimitCORE=infinity\n\n[Install]\nWantedBy=multi-user.target\n</code></pre> <p>\u5176\u4e2d <code>ExecStart</code> \u8868\u793a\u7a0b\u5e8f\u542f\u52a8\u7684\u547d\u4ee4\uff0c<code>WorkingDirectory</code> \u8868\u793a\u7a0b\u5e8f\u8fd0\u884c\u7684\u65f6\u5019\u7684\u5de5\u4f5c\u76ee\u5f55\uff0c\u800c <code>Environment</code> \u5219\u8868\u793a\u7a0b\u5e8f\u8fd0\u884c\u65f6\u7684\u73af\u5883\u53d8\u91cf\u3002</p> <p>\u4fdd\u5b58\u9000\u51fa\u7f16\u8f91\u5668\u4e4b\u540e\uff0csystemd \u5c31\u4f1a\u5c06\u6587\u4ef6\u5185\u5bb9\u653e\u5230\u5408\u9002\u7684\u5730\u65b9\u3002\u8fd9\u65f6\u5019\u8fd8\u4e0d\u80fd\u81ea\u52a8\u542f\u52a8\u7a0b\u5e8f\uff0c\u8fd8\u9700\u8981\u6267\u884c <code>systemctl --user enable my-server</code> \u5c06\u7a0b\u5e8f\u52a0\u5165\u5230\u5f00\u673a\u542f\u52a8\u7684\u5217\u8868\u4e2d\uff0c\u7136\u540e\u6267\u884c <code>systemctl --user start my-server</code> \u5c06\u7a0b\u5e8f\u542f\u52a8\u3002\u6211\u4eec\u8fd8\u53ef\u4ee5\u901a\u8fc7 <code>systemctl --user status my-server</code> \u6765\u67e5\u770b\u7a0b\u5e8f\u8fd0\u884c\u7684\u72b6\u6001\uff0c\u901a\u8fc7 <code>journalctl --user -u my-server</code> \u53ef\u4ee5\u770b\u5230\u7a0b\u5e8f\u7684\u6807\u51c6\u8f93\u51fa\u5185\u5bb9\u3002</p>"},{"location":"documentation/","title":"\u6982\u89c8","text":"<p>\u7a0b\u5e8f\u7f16\u5199\u8c03\u8bd5\u5b8c\u6210\u540e\uff0c\u5e76\u4e0d\u610f\u5473\u7740\u5de5\u4f5c\u7684\u5b8c\u6210\u3002\u6211\u4eec\u8fd8\u9700\u8981\u7f16\u5199\u5f00\u53d1\u6587\u6863\u4ee5\u53ca\u4f7f\u7528\u6587\u6863\uff0c\u65b9\u4fbf\u5176\u4ed6\u4eba\u6765\u63a5\u624b\u548c\u4f7f\u7528\u6211\u4eec\u7684\u7a0b\u5e8f\u3002</p>"},{"location":"logging/","title":"\u6982\u89c8","text":"<p>\u5728\u7a0b\u5e8f\u4e0a\u7ebf\u8fd0\u884c\u4e4b\u540e\uff0c\u6211\u4eec\u901a\u5e38\u96be\u4ee5\u518d\u4f7f\u7528\u8c03\u8bd5\u5668\u8c03\u8bd5\u7a0b\u5e8f\uff0c\u6211\u4eec\u4e0d\u53ef\u80fd\u8ba9\u7528\u6237\u7684\u8bf7\u6c42\u5361\u5728\u90a3\u3002\u800c\u4e14\u5728\u5e73\u65f6\u5f00\u53d1\u7684\u65f6\u5019\uff0c\u6211\u4eec\u6709\u65f6\u5019\u4e5f\u4f1a\u72af\u61d2\u4e0d\u7528\u8c03\u8bd5\u5668\u3002\u800c\u591a\u7ebf\u7a0b\u751a\u81f3\u591a\u8fdb\u7a0b\u4ee5\u53ca\u5206\u5e03\u5f0f\u7684\u8c03\u8bd5\u66f4\u662f\u56f0\u96be\u3002</p> <p>\u5728\u4f7f\u7528\u8c03\u8bd5\u5668\u8c03\u8bd5\u7a0b\u5e8f\u6bd4\u8f83\u56f0\u96be\u7684\u65f6\u5019\uff0c\u8f93\u51fa\u65e5\u5fd7\u4fbf\u6210\u4e3a\u4e86\u53e6\u4e00\u4e2a\u8c03\u8bd5\u7684\u6709\u529b\u5de5\u5177\u3002\u5728\u5e73\u65f6\u8c03\u7a0b\u5e8f\u7684\u65f6\u5019\uff0c\u4f60\u80af\u5b9a\u7528\u8fc7 <code>printf</code> \u6216\u8005 <code>cout</code> \u6765\u8f93\u51fa\u7a0b\u5e8f\u7684\u4e2d\u95f4\u72b6\u6001\u6216\u8005\u663e\u793a\u7a0b\u5e8f\u6267\u884c\u5230\u4e86\u54ea\u4e00\u6b65\u3002\u5176\u5b9e\u7528\u65e5\u5fd7\u4e5f\u662f\u540c\u6837\u7684\u601d\u60f3\uff0c\u5c31\u662f\u8ba9\u7a0b\u5e8f\u8fd0\u884c\u7684\u65f6\u5019\u8f93\u51fa\u4e00\u4e9b\u4fe1\u606f\u6765\u5e2e\u52a9\u6211\u4eec\u8bca\u65ad\u95ee\u9898\uff0c\u6216\u8005\u786e\u4fdd\u7a0b\u5e8f\u8fd0\u884c\u6b63\u5e38\u3002</p> <p>\u5f53\u7136\uff0c\u5728\u4e25\u8083\u7684 C++ \u9879\u76ee\u4e2d\uff0c\u6211\u4eec\u80af\u5b9a\u4e0d\u80fd\u76f4\u63a5 <code>cout</code> \u5b8c\u4e8b\uff0c\u800c\u662f\u9700\u8981\u4f7f\u7528\u65e5\u5fd7\u5e93\u3002\u901a\u5e38\u6765\u8bf4\uff0c\u65e5\u5fd7\u5e93\u548c <code>cout</code> \u6bd4\u8d77\u6765\u6709\u4ee5\u4e0b\u529f\u80fd\u3002</p> <ul> <li>\u652f\u6301\u4fe1\u606f\u7684\u5206\u7ea7\u3002\u4f8b\u5982 <code>DEBUG</code>\u3001<code>INFO</code>\u3001<code>WARNING</code>\u3001<code>ERROR</code> \u7b49\uff0c\u8fd9\u6837\u5f00\u53d1\u5b8c\u6210\u540e\u4e0d\u9700\u8981\u6ce8\u91ca\u6389\u8f93\u51fa\u8bed\u53e5\uff0c\u53ea\u9700\u8981\u8c03\u6574\u7b49\u7ea7\u3002</li> <li>\u652f\u6301\u591a\u4e2a\u8f93\u51fa\u76ee\u7684\u5730\u3002\u4f8b\u5982\u6211\u4eec\u53ef\u4ee5\u8ba9\u4e00\u6761\u65e5\u5fd7\u540c\u65f6\u6253\u5370\u5728\u5c4f\u5e55\u4e0a\u4ee5\u53ca\u8f93\u51fa\u5230\u6587\u4ef6\u91cc\u65b9\u4fbf\u5206\u6790\u3002</li> <li>\u652f\u6301\u65e5\u5fd7\u6eda\u52a8\u3002\u65e5\u5fd7\u6587\u4ef6\u592a\u591a\u7684\u65f6\u5019\uff0c\u65e5\u5fd7\u5e93\u4f1a\u5220\u9664\u4e00\u4e9b\u8fc7\u65f6\u7684\u65e0\u5173\u7d27\u8981\u7684\u65e5\u5fd7\u3002</li> <li>\u66f4\u9ad8\u7684\u6027\u80fd\u3002\u65e5\u5fd7\u5e93\u4e3a\u4e86\u4e0d\u5f71\u54cd\u7a0b\u5e8f\u7684\u6267\u884c\u6548\u7387\uff0c\u901a\u5e38\u4f1a\u9ad8\u5ea6\u4f18\u5316\u683c\u5f0f\u5316\u4ee5\u53ca\u8f93\u51fa\u7684\u6027\u80fd\u3002</li> <li>\u591a\u7ebf\u7a0b\u5904\u7406\u3002\u4f7f\u7528 <code>printf</code> \u6216\u8005 <code>cout</code>\uff0c\u5728\u591a\u7ebf\u7a0b\u540c\u65f6\u8f93\u51fa\u7684\u65f6\u5019\uff0c\u6709\u53ef\u80fd\u4e00\u884c\u65e5\u5fd7\u4f1a\u6df7\u6742\u591a\u4e2a\u7ebf\u7a0b\u7684\u8f93\u51fa\uff0c\u65e5\u5fd7\u5e93\u53ef\u4ee5\u6b63\u786e\u9ad8\u6548\u5730\u540c\u6b65\u8f93\u51fa\uff0c\u907f\u514d\u8f93\u51fa\u6df7\u4e71\u7684\u73b0\u8c61\u3002</li> </ul>"},{"location":"logging/binary-logging/","title":"\u4e8c\u8fdb\u5236\u65e5\u5fd7","text":"<p>\u5728\u5bf9\u5ef6\u8fdf\u6781\u7aef\u654f\u611f\u7684\u7a0b\u5e8f\u91cc\uff0c\u6709\u65f6\u4f1a\u8fde\u683c\u5f0f\u5316\u6587\u672c\u7684\u5f00\u9500\u90fd\u4e0d\u80fd\u63a5\u53d7\uff0c\u5e0c\u671b\u65e5\u5fd7\u7cfb\u7edf\u80fd\u591f\u8fdb\u4e00\u6b65\u51cf\u5c11\u8ba1\u7b97\u91cf\u4ee5\u53ca IO \u91cf\u3002NanoLog \u5c31\u662f\u6839\u636e\u8fd9\u6837\u7684\u601d\u60f3\u8bbe\u8ba1\u51fa\u6765\u7684\u65e5\u5fd7\u7cfb\u7edf\u3002</p> <p>\u8003\u8651\u5230\u65e5\u5fd7\u7cfb\u7edf\u4e2d\u7684\u5927\u90e8\u5206\u5b57\u7b26\u4e32\u90fd\u662f\u4e0d\u53d8\u7684\uff0c\u53ea\u6709\u5176\u4e2d\u5c11\u6570\u51e0\u4e2a\u53d8\u91cf\u4f1a\u6539\u53d8\uff0c\u90a3\u4e48\u5c31\u6ca1\u6709\u5fc5\u8981\u6bcf\u6b21\u90fd\u8f93\u51fa\u91cd\u590d\u7684\u5185\u5bb9\uff0c\u800c\u662f\u5728\u7f16\u8bd1\u9636\u6bb5\u5c31\u9884\u5904\u7406\u597d\u6240\u6709\u683c\u5f0f\u5b57\u7b26\u4e32\uff0c\u53ea\u63d0\u53d6\u9700\u8981\u4fdd\u5b58\u7684\u53d8\u91cf\u4f4d\u7f6e\u3002\u5728\u5b9e\u9645\u8fd0\u884c\u65f6\uff0c\u5c31\u53ef\u4ee5\u53ea\u5199\u5165\u5bf9\u5e94\u7684\u5b57\u7b26\u4e32 ID \u4ee5\u53ca\u6d89\u53ca\u7684\u53d8\u91cf\u5373\u53ef\u3002\u8003\u8651\u5230 CPU \u901f\u5ea6\u8fdc\u6bd4\u78c1\u76d8\u3001\u7f51\u7edc\u7b49 IO \u8bbe\u5907\u901f\u5ea6\u5feb\uff0c\u4e3a\u4e86\u51cf\u5c11\u5199\u5165 IO \u5f00\u9500\uff0c\u8fd8\u53ef\u4ee5\u5c06\u65e5\u5fd7\u5148\u538b\u7f29\u540e\u518d\u5199\u5165\u3002\u9700\u8981\u67e5\u770b\u7684\u65f6\u5019\uff0c\u518d\u4f7f\u7528\u89e3\u538b\u7f29\u5de5\u5177\uff0c\u5c06\u4e8c\u8fdb\u5236\u65e5\u5fd7\u6587\u4ef6\u89e3\u538b\uff0c\u5e76\u6839\u636e\u683c\u5f0f\u5b57\u7b26\u4e32\u8fd8\u539f\u4e3a\u4eba\u7c7b\u53ef\u8bfb\u7684\u7eaf\u6587\u672c\u3002\u8fd9\u76f8\u5f53\u4e8e\u5c06\u8fd0\u884c\u65f6\u7684\u5f00\u9500\u5206\u644a\u5230\u4e86\u7f16\u8bd1\u65f6\u548c\u540e\u5904\u7406\u9636\u6bb5\u3002</p>"},{"location":"logging/structured-logging/","title":"\u7ed3\u6784\u5316\u65e5\u5fd7","text":"<p>\u57fa\u4e8e\u683c\u5f0f\u5b57\u7b26\u4e32\u683c\u5f0f\u5316\u7684\u7eaf\u6587\u672c\u65e5\u5fd7\u5728\u5206\u6790\u7684\u65f6\u5019\u901a\u5e38\u8fd8\u662f\u9700\u8981\u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u6216\u8005\u8bed\u6cd5\u89e3\u6790\u5668\u6765\u63d0\u53d6\u65e5\u5fd7\u4e2d\u7684\u4fe1\u606f\u3002\u90a3\u4e48\uff0c\u65e2\u7136\u6211\u4eec\u8fd8\u662f\u9700\u8981\u4f7f\u7528\u5de5\u5177\u6765\u5206\u6790\u65e5\u5fd7\uff0c\u90a3\u4e48\u4e3a\u4ec0\u4e48\u4e0d\u76f4\u63a5\u8f93\u51fa\u5de5\u5177\u53ef\u4ee5\u89e3\u6790\u7684\u683c\u5f0f\u5462\uff1f\u4f8b\u5982\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u65e5\u5fd7\u8f93\u51fa\u6210 JSON \u683c\u5f0f\uff1a</p> <p>\u4f8b\u5982\uff1a</p> <pre><code>LOG(INFO) &lt;&lt; \"Test Logging userID = \" &lt;&lt; userID &lt;&lt; \", username = \" &lt;&lt; username;\n</code></pre> <p>\u53ef\u4ee5\u53d8\u6210\uff1a</p> <pre><code>logger.info(\"Test Logging\", Int(\"user-id\", userID), String(\"username\", username));\n</code></pre> <p>\u8ba9\u65e5\u5fd7\u5e93\u8f93\u51fa\uff1a</p> <pre><code>{\"level\":\"info\",\"ts\":1614743088.538128,\"caller\":\"main.cpp:15\",\"user-id\":1,\"username\":\"howard\",\"func\":\"test\",\"msg\":\"Test Logging\"}\n</code></pre> <p>\u4f7f\u7528\u8fd9\u79cd\u65b9\u5f0f\uff0c\u6211\u4eec\u4e0d\u518d\u5c06\u53d8\u91cf\u4fe1\u606f\u6839\u636e\u683c\u5f0f\u5b57\u7b26\u4e32\u7f16\u7801\u6210\u4e00\u6bb5\u7eaf\u6587\u672c\uff0c\u800c\u662f\u5c06\u53d8\u91cf\u4fe1\u606f\u89c6\u4e3a KV \u6570\u636e\u5bf9\uff0c\u9644\u52a0\u5230\u4fe1\u606f\u4e2d\uff0c\u8fd9\u6837\u7684\u65e5\u5fd7\u4eba\u7c7b\u53ef\u8bfb\uff0c\u4e5f\u6709\u73b0\u6210\u7684\u89e3\u6790\u5668\u6765\u89e3\u6790\uff0c\u65b9\u4fbf\u5904\u7406\u548c\u68c0\u7d22\u3002</p>"},{"location":"memory/","title":"\u6982\u89c8","text":"<p>\u670d\u52a1\u5668\u7a0b\u5e8f\u4e0d\u540c\u4e8e\u5e73\u5e38\u7684\u547d\u4ee4\u884c\u7a0b\u5e8f\uff0c\u901a\u5e38\u9700\u8981\u5728\u7ebf\u8fd0\u884c\u5f88\u957f\u65f6\u95f4\uff0c\u901a\u5e38\u4ee5\u5929\u4ee5\u6708\u8ba1\u3002\u5982\u679c\u6211\u4eec\u4e0d\u6ce8\u610f\u5185\u5b58\u7684\u7ba1\u7406\uff0c\u90a3\u4e48\u6709\u53ef\u80fd\u4f1a\u53d1\u751f\u5185\u5b58\u6cc4\u6f0f\u7684\u60c5\u51b5\uff0c\u4e5f\u5c31\u662f\u7a0b\u5e8f\u4f7f\u7528\u7684\u5185\u5b58\u4e0d\u80fd\u5f97\u5230\u6b63\u786e\u91ca\u653e\uff0c\u4ece\u800c\u8017\u5c3d\u7cfb\u7edf\u5185\u5b58\u3002\u800c\u5047\u5982\u91ca\u653e\u64cd\u4f5c\u4e0d\u5f53\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u8bbf\u95ee\u91ce\u6307\u9488\u7684\u60c5\u51b5\u53d1\u751f\uff0c\u9020\u6210\u7a0b\u5e8f\u5d29\u6e83\u3002\u65e0\u8bba\u5982\u4f55\uff0c\u5982\u4f55\u6b63\u786e\u5730\u7ba1\u7406\u5185\u5b58\u5728\u670d\u52a1\u5668\u7f16\u7a0b\u4e2d\u90fd\u81f3\u5173\u91cd\u8981\u3002</p> <p>\u672c\u7ae0\u5c06\u4ecb\u7ecd\u5185\u5b58\u7ba1\u7406\u7684\u5e38\u7528\u6280\u5de7\u4ee5\u53ca\u5982\u4f55\u4f7f\u7528\u5de5\u5177\u6392\u67e5\u5185\u5b58\u6cc4\u9732\u4ee5\u53ca\u5185\u5b58\u5b89\u5168\u7684\u95ee\u9898\u3002</p>"},{"location":"memory/address-sanitizer/","title":"\u4f7f\u7528 AddressSanitizer \u68c0\u67e5\u5185\u5b58\u5b89\u5168\u95ee\u9898","text":"<p>AddressSanitizer \u662f Google \u5f00\u53d1\u7684\u5185\u5b58\u9519\u8bef\u68c0\u6d4b\u5668\uff0c\u53ef\u4ee5\u68c0\u67e5\u7f13\u51b2\u533a\u6ea2\u51fa\u4ee5\u53ca\u8bbf\u95ee\u91ce\u6307\u9488\u7b49\u5185\u5b58\u9519\u8bef\u3002\u76ee\u524d\uff0c\u8f83\u65b0\u7248\u672c\u7684 GCC \u7f16\u8bd1\u5668\u4ee5\u53ca clang \u7f16\u8bd1\u5668\u90fd\u5df2\u7ecf\u5185\u7f6e AddressSanitizer \u7684\u652f\u6301\u3002\u4f7f\u7528\u4e86 AddressSanitizer \u7684\u7a0b\u5e8f\u901a\u5e38\u4f1a\u6bd4\u4e0d\u4f7f\u7528\u7684\u6162 2 \u500d\u5de6\u53f3\u3002</p> <p>\u8981\u4f7f\u7528 AddressSanitizer\uff0c\u53ea\u9700\u8981\u4f7f\u7528\u7f16\u8bd1\u5668\u7684 <code>-fsanitize=address</code> \u9009\u9879\u5373\u53ef\u3002\u4f8b\u5982\uff0c\u6709\u4e00\u4e2a\u6570\u7ec4\u8d8a\u754c\u7684\u7a0b\u5e8f\uff1a</p> overflow.cpp <pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n\nint main() {\n    std::vector&lt;int&gt; v{1, 2, 3};\n    std::cout &lt;&lt; v[10000] &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre> <p>\u6253\u5f00\u7f16\u8bd1\u5668\u7684 AddressSanitizer \u5f00\u5173\u7f16\u8bd1\u540e\u8fd0\u884c\uff0c\u5c31\u80fd\u770b\u5230\u7a0b\u5e8f\u5728\u8bbf\u95ee\u6570\u7ec4\u8d8a\u754c\u7684\u65f6\u5019\u88ab\u7ec8\u6b62\u5e76\u8f93\u51fa\u9519\u8bef\u4fe1\u606f\u4e86\uff1a</p> <pre><code>$ g++ -g -fsanitize=address overflow.cpp\n$ ./a.out\n=================================================================\n==10814==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x602000009c50 at pc 0x55cd5d020679 bp 0x7ffc59648d50 sp 0x7ffc59648d40\nREAD of size 4 at 0x602000009c50 thread T0\n    #0 0x55cd5d020678 in main /home/howard/overflow.cpp:6\n    #1 0x7f92281e6cb1 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x28cb1)\n    #2 0x55cd5d02038d in _start (/home/howard/a.out+0x238d)\n\nAddress 0x602000009c50 is a wild pointer.\nSUMMARY: AddressSanitizer: heap-buffer-overflow /home/howard/overflow.cpp:6 in main\n# ...\n</code></pre> <p>\u9664\u4e86\u4e0d\u5b89\u5168\u7684\u5185\u5b58\u8bbf\u95ee\u4e4b\u5916\uff0cAddressSanitizer \u4e5f\u53ef\u4ee5\u68c0\u6d4b\u51fa\u5185\u5b58\u6cc4\u9732\u7684\u95ee\u9898\uff0c\u4f8b\u5982\uff1a</p> leak.cpp <pre><code>int main() {\n    int* arr = new int[100];\n    return 0;\n}\n</code></pre> <p>\u540c\u6837\u6253\u5f00 AddressSanitizer \u7f16\u8bd1\u8fd0\u884c\uff1a</p> <pre><code>$ g++ -g -fsanitize=address leak.cpp\n$ ./a.out\n\n=================================================================\n==11173==ERROR: LeakSanitizer: detected memory leaks\n\nDirect leak of 400 byte(s) in 1 object(s) allocated from:\n    #0 0x7ff377401097 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102\n    #1 0x55b65daf319e in main /home/howard/leak.cpp:2\n    #2 0x7ff376e41cb1 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x28cb1)\n\nSUMMARY: AddressSanitizer: 400 byte(s) leaked in 1 allocation(s).\n</code></pre>"},{"location":"memory/memory-pool/","title":"\u5185\u5b58\u6c60","text":"<p>\u7a0b\u5e8f\u4f7f\u7528\u7684\u5185\u5b58\u6700\u7ec8\u90fd\u662f\u9700\u8981\u901a\u8fc7\u64cd\u4f5c\u7cfb\u7edf\u7ba1\u7406\u7684\u3002\u4f46\u662f\u5982\u679c\u6bcf\u6b21\u9700\u8981\u65b0\u7684\u5185\u5b58\u90fd\u4f7f\u7528\u7cfb\u7edf\u8c03\u7528\u5411\u64cd\u4f5c\u7cfb\u7edf\u7533\u8bf7\uff0c\u6216\u8005\u91ca\u653e\u5185\u5b58\u4e5f\u901a\u8fc7\u7cfb\u7edf\u8c03\u7528\u91ca\u653e\u7684\u8bdd\uff0c\u663e\u7136\u4f1a\u964d\u4f4e\u7a0b\u5e8f\u7684\u6027\u80fd\u3002\u6240\u4ee5\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5185\u5b58\u6c60\u6280\u672f\u6765\u51cf\u5c11\u7cfb\u7edf\u8c03\u7528\u7684\u6b21\u6570\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u5c31\u662f\u6211\u4eec\u5148\u5411\u7cfb\u7edf\u7533\u8bf7\u4e00\u5927\u5757\u5185\u5b58\uff0c\u7136\u540e\u6211\u4eec\u9700\u8981\u4f7f\u7528\u5185\u5b58\u7684\u65f6\u5019\uff0c\u76f4\u63a5\u4ece\u5185\u5b58\u6c60\u4e2d\u505a\u6807\u8bb0\u5206\u51fa\u4e00\u5757\u5373\u53ef\uff0c\u800c\u91ca\u653e\u5185\u5b58\u7684\u65f6\u5019\u540c\u6837\u53ea\u9700\u8981\u5728\u5185\u5b58\u6c60\u4e2d\u505a\u4e2a\u6807\u8bb0\u5373\u53ef\u3002\u4e8b\u5b9e\u4e0a\uff0c\u6211\u4eec\u5e38\u7528\u7684 <code>malloc()</code> \u548c <code>free()</code> \u51fd\u6570\u5c31\u662f\u8fd9\u6837\u7ba1\u7406\u5185\u5b58\u7684\u3002</p>"},{"location":"memory/smart-pointer/","title":"\u667a\u80fd\u6307\u9488","text":"<p>\u4f17\u6240\u5468\u77e5\uff0c\u6307\u9488\u662f C++ \u7f16\u7a0b\u4e2d\u7684\u4e00\u5927\u96be\u5173\u3002\u4f7f\u7528\u6307\u9488\u7684\u65f6\u5019\uff0c\u6211\u4eec\u9700\u8981\u9632\u6b62\u8bbf\u95ee\u5df2\u7ecf\u91ca\u653e\u7684\u5185\u5b58\uff0c\u540c\u65f6\u4e5f\u9700\u8981\u907f\u514d\u91ca\u653e\u540c\u4e00\u4e2a\u6307\u9488\u4e24\u6b21\u3002\u5728\u7a0b\u5e8f\u89c4\u6a21\u8fd8\u6bd4\u8f83\u5c0f\u7684\u65f6\u5019\uff0c\u53ef\u80fd\u8fd9\u4e0d\u662f\u4ec0\u4e48\u5927\u95ee\u9898\uff0c\u4f46\u4e00\u65e6\u51fd\u6570\u7684\u8c03\u7528\u5173\u7cfb\u590d\u6742\u8d77\u6765\uff0c\u9075\u5b88\u4e0a\u9762\u7684\u89c4\u5219\u5c31\u6ca1\u6709\u8fd9\u4e48\u5bb9\u6613\u4e86\u3002</p> <p>\u5728\u73b0\u4ee3 C++ \u7f16\u7a0b\u4e2d\uff0c\u4e3a\u4e86\u4fdd\u8bc1\u5185\u5b58\u5b89\u5168\u4ee5\u53ca\u9632\u6b62\u5185\u5b58\u6cc4\u6f0f\uff0c\u5e94\u8be5\u4f7f\u7528\u667a\u80fd\u6307\u9488\uff0c\u5e76\u5c3d\u91cf\u51cf\u5c11\u88f8\u6307\u9488\u7684\u4f7f\u7528\uff0c\u4e5f\u5c3d\u91cf\u4e0d\u8981\u4f7f\u7528 <code>new</code> \u548c <code>delete</code>\u3002\u667a\u80fd\u6307\u9488\u4fdd\u5b58\u4e86\u5185\u5b58\u5730\u5740\u7684\u4f7f\u7528\u4fe1\u606f\uff0c\u5e76\u5229\u7528\u4e86 C++ RAII \u7684\u7279\u6027\uff0c\u5728\u667a\u80fd\u6307\u9488\u5bf9\u8c61\u751f\u547d\u5468\u671f\u7ed3\u675f\u65f6\uff0c\u4f7f\u7528\u6790\u6784\u51fd\u6570\u81ea\u52a8\u91ca\u653e\u6307\u9488\u6240\u5bf9\u5e94\u7684\u5185\u5b58\u3002\u6700\u5e38\u7528\u7684\u667a\u80fd\u6307\u9488\u6709 <code>std::unique_ptr</code>\u3001<code>std::shared_ptr</code> \u4ee5\u53ca <code>std::weak_ptr</code>\u3002</p> \u4f7f\u7528\u667a\u80fd\u6307\u9488\u7684\u5f00\u9500 <p>\u667a\u80fd\u6307\u9488\u76f8\u6bd4\u4e8e\u88f8\u6307\u9488\uff0c\u4f1a\u5e26\u6765\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u7684\u989d\u5916\u5f00\u9500\u3002\u4e0d\u8fc7\uff0c\u53ea\u6709\u5f53\u4f60\u7f16\u5199\u7684\u5e94\u7528\u5bf9\u6027\u80fd\u975e\u5e38\u654f\u611f\uff0c\u624d\u4f7f\u7528\u88f8\u6307\u9488\u6216\u5f15\u7528\u3002</p>"},{"location":"memory/smart-pointer/#\u6240\u6709\u6743","title":"\u6240\u6709\u6743","text":"<p>\u5728\u4ecb\u7ecd\u667a\u80fd\u6307\u9488\u4e4b\u524d\uff0c\u5148\u4ecb\u7ecd\u4e00\u4e2a\u91cd\u8981\u7684\u6982\u5ff5\uff1a\u6240\u6709\u6743\uff08Ownership\uff09\u3002\u6240\u6709\u6743\u5c31\u662f\u6307\u4e00\u4e2a\u6307\u9488\u5e94\u8be5\u7531\u8c01\u201c\u62e5\u6709\u201d\uff0c\u8fd9\u4e2a\u6240\u6709\u8005\u5c31\u9700\u8981\u8d1f\u8d23\u91ca\u653e\u5185\u5b58\u3002</p> <p>\u6240\u6709\u6743\u53ef\u4ee5\u662f\u552f\u4e00\u7684\uff0c\u4e5f\u5c31\u662f\u540c\u65f6\u95f4\u4e00\u4e2a\u6307\u9488\u53ea\u80fd\u88ab\u4e00\u4e2a\u5bf9\u8c61\u62e5\u6709\uff0c\u5982\u679c\u9700\u8981\u4f20\u9012\u6307\u9488\uff0c\u5219\u9700\u8981\u8f6c\u79fb\u6240\u6709\u6743\u3002\u7c7b\u4f3c\u4e8e\u4e00\u4e2a\u81ea\u4e60\u5ba4\uff0c\u4e00\u6b21\u53ea\u80fd\u6709\u4e00\u4e2a\u4eba\u5728\u623f\u95f4\u91cc\uff0c\u8fd9\u4e2a\u4eba\u8981\u4e48\u548c\u53e6\u5916\u4e00\u4e2a\u4eba\u4ea4\u6362\u4f4d\u7f6e\uff0c\u8981\u4e48\u81ea\u5df1\u79bb\u5f00\u623f\u95f4\u5e76\u5173\u706f\u3002</p> <p>\u6240\u6709\u6743\u4e5f\u53ef\u4ee5\u662f\u5171\u4eab\u7684\uff0c\u53ef\u4ee5\u540c\u65f6\u88ab\u591a\u4e2a\u5bf9\u8c61\u62e5\u6709\uff0c\u8fd9\u65f6\u5019\u5c31\u548c\u88f8\u6307\u9488\u5dee\u4e0d\u591a\u3002\u90a3\u4e48\uff0c\u5171\u4eab\u6240\u6709\u6743\u7684\u6307\u9488\uff0c\u8981\u600e\u4e48\u624d\u80fd\u77e5\u9053\u4ec0\u4e48\u65f6\u5019\u53ef\u4ee5\u5b89\u5168\u7684\u4f7f\u7528\u548c\u91ca\u653e\u5462\uff1f\u6700\u5e38\u7528\u7684\u65b9\u5f0f\u5c31\u662f\u5f15\u7528\u8ba1\u6570\uff08Reference Counting\uff09\uff0c\u6709\u5bf9\u8c61\u8981\u4f7f\u7528\u8fd9\u4e2a\u6307\u9488\u4e86\uff0c\u5c31\u7ed9\u5f15\u7528\u8ba1\u6570\u52a0\u4e00\uff0c\u4f7f\u7528\u5b8c\u6bd5\u4e86\uff0c\u5c31\u7ed9\u5f15\u7528\u8ba1\u6570\u51cf\u4e00\u3002\u7b49\u5230\u5f15\u7528\u8ba1\u6570\u53d8\u4e3a 0 \u4e86\uff0c\u5c31\u8bf4\u660e\u6ca1\u6709\u4eba\u4f7f\u7528\u8fd9\u4e2a\u6307\u9488\u4e86\uff0c\u53ef\u4ee5\u5b89\u5168\u5730\u91ca\u653e\u4e86\u3002\u7c7b\u4f3c\u4e8e\u4e00\u4e2a\u5f88\u5927\u7684\u81ea\u4e60\u5ba4\uff0c\u53ef\u4ee5\u6709\u5f88\u591a\u4eba\u5728\u91cc\u9762\uff0c\u4f46\u662f\u8d70\u7684\u65f6\u5019\u600e\u4e48\u77e5\u9053\u623f\u95f4\u91cc\u6ca1\u6709\u4eba\u4e86\u5462\uff1f\u53ef\u4ee5\u5728\u95e8\u53e3\u653e\u4e00\u4e2a\u7f50\u5b50\uff0c\u6709\u4eba\u8fdb\u6765\u5c31\u653e\u4e00\u4e2a\u786c\u5e01\u8fdb\u53bb\uff0c\u6709\u4eba\u8d70\u4e86\u5c31\u62ff\u56de\u4e00\u4e2a\u786c\u5e01\u3002\u6700\u540e\u62ff\u7a7a\u7f50\u5b50\u7684\u4eba\u5c31\u77e5\u9053\u6ca1\u6709\u4eba\u5728\u81ea\u4e60\u5ba4\u91cc\u4e86\uff0c\u53ef\u4ee5\u5173\u706f\u4e86\u3002\u5f53\u7136\uff0c\u5982\u679c\u6709\u4eba\u5fd8\u8bb0\u653e\u786c\u5e01\u4e86\uff0c\u90a3\u5c31\u6709\u53ef\u80fd\u88ab\u5fd8\u5728\u623f\u95f4\u91cc\u4e86\uff0c\u5982\u679c\u6709\u4eba\u5fd8\u8bb0\u62ff\u786c\u5e01\u4e86\uff0c\u623f\u95f4\u5c31\u6c38\u8fdc\u5173\u4e0d\u4e86\u706f\u4e86\u3002</p>"},{"location":"memory/smart-pointer/#stdunique_ptr","title":"<code>std::unique_ptr</code>","text":"<p><code>std::unique_ptr</code> \u8868\u793a\u4e00\u4e2a\u6307\u9488\u6700\u591a\u53ea\u80fd\u88ab\u5f15\u7528\u4e00\u6b21\uff0c\u4e5f\u5c31\u662f\u4e0d\u5b58\u5728\u5171\u4eab\u7684\u5173\u7cfb\u3002\u4f7f\u7528\u65f6\u5e94\u8be5\u4f7f\u7528 <code>std::make_unique</code> \u6765\u751f\u6210\u4e00\u4e2a\u6307\u5411\u5bf9\u8c61\u7684 <code>std::unique_ptr</code>\u3002<code>std::unique_ptr</code> \u4e0d\u5141\u8bb8\u62f7\u8d1d\uff0c\u4e5f\u5c31\u662f\u8bf4\u4f20\u9012 <code>std::unique_ptr</code> \u7684\u65f6\u5019\u53ea\u80fd\u4f7f\u7528 <code>std::move</code> \u6765\u4f7f\u7528\u79fb\u52a8\u8bed\u4e49\u3002</p>"},{"location":"memory/smart-pointer/#stdshared_ptr","title":"<code>std::shared_ptr</code>","text":"<p><code>std::shared_ptr</code> \u8868\u793a\u4e00\u4e2a\u6307\u9488\u53ef\u80fd\u88ab\u591a\u6b21\u5f15\u7528\uff0c\u4e5f\u5c31\u662f\u5b58\u5728\u7740\u5171\u4eab\u7684\u5173\u7cfb\u3002\u4f7f\u7528\u65f6\u5e94\u8be5\u4f7f\u7528 <code>std::shared_ptr</code> \u6765\u751f\u6210\u4e00\u4e2a\u6307\u5411\u5bf9\u8c61\u7684 <code>std::shared_ptr</code>\u3002<code>std::shared_ptr</code> \u5141\u8bb8\u62f7\u8d1d\uff0c\u5728\u4f7f\u7528\u65f6\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u6309\u503c\u4f20\u9012\u7684\u65b9\u5f0f\u6765\u4f7f\u7528\u3002</p> <p><code>std::shared_ptr</code> \u4e2d\u5185\u7f6e\u4e86\u5f15\u7528\u8ba1\u6570\uff0c\u5f53\u53d1\u751f\u62f7\u8d1d\u7684\u65f6\u5019\u5c31\u4f1a\u7ed9\u5f15\u7528\u8ba1\u6570\u52a0\u4e00\uff0c\u6790\u6784\u51fd\u6570\u5219\u4f1a\u51cf\u4e00\u3002\u5f53\u5f15\u7528\u8ba1\u6570\u4e3a 0 \u8bf4\u660e\u8fd9\u4e2a\u6307\u9488\u5df2\u7ecf\u65e0\u4eba\u4f7f\u7528\u4e86\uff0c\u5c31\u4f1a\u8c03\u7528\u5bf9\u8c61\u7684\u6790\u6784\u51fd\u6570\u53bb\u91ca\u653e\u5185\u5b58\u3002</p>"},{"location":"memory/smart-pointer/#stdweak_ptr","title":"<code>std::weak_ptr</code>","text":"<p><code>std::weak_ptr</code> \u662f\u4e00\u4e2a\u5177\u6709\u8ff7\u60d1\u6027\u7684\u540d\u5b57\uff0c\u5b83\u5b9e\u9645\u4e0a\u4e0d\u662f\u4e00\u4e2a\u6307\u9488\uff0c\u4e0d\u80fd\u50cf\u666e\u901a\u6307\u9488\u4e00\u6837\u4f7f\u7528 <code>*</code> \u548c <code>-&gt;</code> \u6765\u8bbf\u95ee\u5bf9\u8c61\u3002\u5b83\u66f4\u50cf\u662f\u4e00\u4e2a\u5151\u6362\u5238\uff0c\u7528\u6765\u5151\u6362 <code>std::shared_ptr</code>\u3002<code>std::weak_ptr</code> \u5fc5\u987b\u6307\u5411\u4e00\u4e2a <code>std::shared_ptr</code>\uff0c\u4f46\u662f\u5b83\u4e0d\u7b97\u5728 <code>std::shared_ptr</code> \u7684\u5f15\u7528\u8ba1\u6570\u91cc\uff0c\u4e5f\u5c31\u662f\u8bf4\u54ea\u6015\u8fd8\u6709 <code>std::weak_ptr</code> \u5b58\u5728\uff0c\u5b83\u6307\u5411\u7684\u5185\u5b58\u4e5f\u6709\u53ef\u80fd\u5df2\u7ecf\u88ab\u91ca\u653e\u4e86\u3002\u5b83\u7684\u4f7f\u7528\u573a\u666f\u6bd4\u8f83\u6709\u9650\uff0c\u4e00\u79cd\u662f\u6253\u7834\u5faa\u73af\u5f15\u7528\uff0c\u4e00\u79cd\u5c31\u662f\u4e0b\u9762\u7684 <code>this</code> \u95ee\u9898\u3002</p>"},{"location":"memory/smart-pointer/#stdenable_shared_from_this","title":"<code>std::enable_shared_from_this</code>","text":"<p>\u6709\u7684\u65f6\u5019\uff0c\u6211\u4eec\u9700\u8981\u5728\u5bf9\u8c61\u5185\u90e8\u751f\u6210\u4e00\u4e2a\u667a\u80fd\u6307\u9488\u8fd4\u56de\uff0c\u4f8b\u5982\uff1a</p> <pre><code>class A {\npublic:\n    std::shared_ptr&lt;A&gt; get_shared_ptr() {\n        return std::shared_ptr&lt;A&gt;(this);\n    }\n};\n\nint main() {\n    std::shared_ptr&lt;A&gt; a = std::make_shared&lt;A&gt;();\n    {\n       std::shared_ptr&lt;A&gt; ptr = a-&gt;get_shared_ptr();\n    }\n}\n</code></pre> <p>\u4f46\u662f\u8fd9\u6837\u4f1a\u6709\u53cc\u91cd\u91ca\u653e\u7684\u95ee\u9898\uff1a\u8fd9\u4e2a\u6307\u9488\u7684\u5f15\u7528\u8ba1\u6570\u88ab\u521d\u59cb\u5316\u4e3a 1\uff0c\u4f7f\u7528\u5b8c\u6bd5\u540e\u5c31\u4f1a\u91ca\u653e\uff0c\u800c\u8fd9\u4e2a\u5bf9\u8c61\u81ea\u5df1\u4e5f\u4f1a\u8c03\u7528\u4e00\u6b21\u6790\u6784\u51fd\u6570\u3002\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>std::enable_shared_from_this</code>\uff1a</p> <pre><code>class A : public std::enable_shared_from_this&lt;A&gt; {\npublic:\n    std::shared_ptr&lt;A&gt; get_shared_ptr() {\n        return shared_from_this();\n    }\n};\n</code></pre> <p>\u7ee7\u627f\u4e86\u8fd9\u4e2a\u7c7b\u4e4b\u540e\uff0c\u5bf9\u8c61\u5c31\u53ef\u4ee5\u4f7f\u7528 <code>shared_from_this</code> \u65b9\u6cd5\u5f97\u5230\u6307\u5411\u81ea\u5df1\u7684 <code>std::shared_ptr</code> \u800c\u4e0d\u4f1a\u6709\u53cc\u91cd\u91ca\u653e\u7684\u95ee\u9898\u4e86\u3002<code>std::enable_shared_from_this</code> \u7c7b\u91cc\u5305\u542b\u4e00\u4e2a <code>std::weak_ptr</code> \u5bf9\u8c61\uff0c\u800c\u5728 <code>std::shared_ptr</code> \u6784\u9020\u51fd\u6570\u91cc\uff0c\u4f1a\u68c0\u67e5\u8fd9\u4e2a\u5bf9\u8c61\u662f\u4e0d\u662f <code>std::enable_shared_from_this</code> \u7684\u6d3e\u751f\u7c7b\uff0c\u5982\u679c\u662f\u7684\u8bdd\uff0c\u5c31\u4f1a\u5c06\u6784\u9020\u7684 <code>std::shared_ptr</code> \u8d4b\u503c\u7ed9 <code>std::weak_ptr</code> \u5bf9\u8c61\u3002\u8c03\u7528 <code>shared_from_this</code> \u5c31\u4f1a\u8c03\u7528\u5230\u8fd9\u4e2a <code>std::weak_ptr</code> \u5bf9\u8c61\uff0c\u4ece\u800c\u907f\u514d\u4e86\u53cc\u91cd\u91ca\u653e\u7684\u95ee\u9898\u3002</p> <p>\u4ece\u539f\u7406\u4e5f\u770b\u5f97\u51fa\u6765\uff0c<code>enable_shared_from_this</code> \u9700\u8981\u8fd9\u4e2a\u5bf9\u8c61\u5df2\u7ecf\u88ab\u4e00\u4e2a <code>std::shared_ptr</code> \u62e5\u6709\uff0c\u6240\u4ee5\u8981\u4f7f\u7528\u8fd9\u4e2a\u51fd\u6570\uff0c\u5fc5\u987b\u4f7f\u7528 <code>std::make_shared</code> \u6765\u6784\u9020\u5bf9\u8c61\uff0c\u5426\u5219\u7684\u8bdd\uff0c<code>shared_from_this</code> \u7684\u884c\u4e3a\u662f\u672a\u5b9a\u4e49\u7684\u3002</p>"},{"location":"memory/smart-pointer/#\u4f7f\u7528\u667a\u80fd\u6307\u9488\u7684\u5efa\u8bae","title":"\u4f7f\u7528\u667a\u80fd\u6307\u9488\u7684\u5efa\u8bae","text":"<p>\u6b63\u5982 <code>new</code> \u8981\u548c <code>delete</code> \u642d\u914d\uff0c\u5728\u4f7f\u7528\u667a\u80fd\u6307\u9488\u540e\uff0c\u6211\u4eec\u4e0d\u518d\u9700\u8981\u8c03\u7528 <code>delete</code>\uff0c\u6240\u4ee5\uff0c\u4e3a\u4e86\u914d\u5e73\uff0c\u6211\u4eec\u4e5f\u4e0d\u5e94\u8be5\u8c03\u7528 <code>new</code>\uff0c\u800c\u662f\u76f4\u63a5\u4f7f\u7528 <code>std::make_shared</code> \u548c <code>std::make_unique</code>\u3002</p> <p>\u628a\u667a\u80fd\u6307\u9488\u5f53\u6210\u548c\u666e\u901a\u6307\u9488\u4e00\u6837\uff0c\u76f4\u63a5\u4f20\u503c\u5373\u53ef\uff0c\u800c\u4e0d\u8981\u4f20\u9012\u5f15\u7528\u3002</p> <p>\u4e3a\u4e86\u907f\u514d\u51fd\u6570\u548c\u7279\u5b9a\u7684\u667a\u80fd\u6307\u9488\u7c7b\u578b\u7ed1\u5b9a\uff0c\u5728\u7f16\u5199\u51fd\u6570\u7684\u65f6\u5019\uff0c\u5efa\u8bae\u662f\u4f7f\u7528\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u4f8b\u5982 <code>void func(A&amp; a)</code>\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u8fd9\u6837\u8c03\u7528\u51fd\u6570\uff1a</p> <pre><code>std::shared_ptr&lt;A&gt; shared_a = std::make_shared&lt;A&gt;();\nstd::unique_ptr&lt;A&gt; unique_a = std::make_unique&lt;A&gt;();\nfunc(*shared_a);\nfunc(*unique_a);\n</code></pre>"},{"location":"memory/smart-pointer/#stdoptional","title":"<code>std::optional</code>","text":"<p>\u6709\u4e9b\u65f6\u5019\uff0c\u6211\u4eec\u9700\u8981\u4f7f\u7528\u7a7a\u6307\u9488\u6765\u8868\u793a\u201c\u6ca1\u6709\u6570\u636e\u8fd4\u56de\u201d\u7b49\u60c5\u51b5\uff0c\u4f8b\u5982\u53ef\u80fd\u6211\u4eec\u9700\u8981\u67e5\u627e\u4e00\u4e2a\u6570\uff0c\u627e\u4e0d\u5230\u5c31\u8fd4\u56de\u7a7a\u6307\u9488\uff1a <code>int* find(int target)</code> \u8fd9\u6837\u7684\u8bdd\uff0c\u4f7f\u7528\u6307\u9488\u7684\u4eba\u5f88\u53ef\u80fd\u610f\u8bc6\u4e0d\u5230\u8fd9\u4e2a\u6307\u9488\u53ef\u80fd\u4e3a\u7a7a\u3002\u4e3a\u4e86\u8fdb\u4e00\u6b65\u589e\u5f3a\u5b89\u5168\u6027\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 <code>std::optional</code> \u8fd9\u4e2a\u7c7b\u3002</p> <p>\u4f8b\u5982\uff0c<code>std::optional&lt;int&gt;</code> \u8868\u793a\u4e00\u4e2a\u53ef\u80fd\u4e3a\u7a7a\u7684\u6574\u6570\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u4e0d\u9700\u8981\u4f7f\u7528\u6307\u9488\u6765\u8868\u8fbe\u201c\u53ef\u80fd\u4e3a\u7a7a\u201d\u7684\u60c5\u51b5\uff0c\u4ece\u6839\u672c\u4e0a\u907f\u514d\u4e86\u8bbf\u95ee\u7a7a\u6307\u9488\u7684\u5185\u5b58\u5b89\u5168\u95ee\u9898\u3002</p>"},{"location":"memory/valgrind/","title":"\u4f7f\u7528 Valgrind \u68c0\u67e5\u5185\u5b58\u95ee\u9898","text":"<p>Valgrind \u662f\u5728\u8fd0\u884c\u65f6\u68c0\u67e5\u5185\u5b58\u95ee\u9898\u7684\u5de5\u5177\u3002\u5b83\u7684\u7279\u70b9\u662f\u4e0d\u9700\u8981\u91cd\u65b0\u7f16\u8bd1\u7a0b\u5e8f\uff0c\u53ea\u9700\u8981\u4f7f\u7528 Valgrind \u76f4\u63a5\u8fd0\u884c\u7a0b\u5e8f\u5373\u53ef\u3002\u4f46\u662f\u5b83\u7684\u6027\u80fd\u635f\u8017\u975e\u5e38\u5927\uff0c\u4f1a\u4f7f\u7a0b\u5e8f\u8fd0\u884c\u901f\u5ea6\u6162 10 \u500d\u4ee5\u4e0a\u3002</p>"},{"location":"meta-build-system/","title":"\u6982\u89c8","text":"<p>\u524d\u9762\u6211\u4eec\u5b66\u4e60\u4e86\u5982\u4f55\u4f7f\u7528\u6784\u5efa\u7cfb\u7edf\u6765\u6784\u5efa\u8f6f\u4ef6\u3002\u4f46\u662f\uff0cLinux \u4e0a\u5e38\u7528\u7684 <code>make</code> \u5728 Windows \u6bd4\u8f83\u5c11\u89c1\u3002\u800c\u6211\u4eec\u5728 Windows \u4e0a\u901a\u5e38\u90fd\u662f\u4f7f\u7528 Dev-C++ \u6216\u8005 Visual Studio \u7b49 IDE \u6765\u7f16\u5199\u7a0b\u5e8f\u3002\u800c\u4e14\uff0c<code>make</code> \u4e2d\u9700\u8981\u6211\u4eec\u624b\u52a8\u6307\u5b9a\u7f16\u8bd1\u5668\u7684\u8def\u5f84\u4ee5\u53ca\u5404\u79cd\u5b8f\u5b9a\u4e49\u7b49\uff0c\u5728\u8de8\u5e73\u53f0\u65f6\u7a0d\u663e\u9ebb\u70e6\u3002\u53e6\u5916\uff0c<code>make</code> \u63d0\u4f9b\u7684\u529f\u80fd\u592a\u8fc7\u7b80\u5355\uff0c\u5f80\u5f80\u9700\u8981\u6211\u4eec\u624b\u5199\u5927\u91cf\u7684\u4ee3\u7801\u6765\u5b8c\u6210\u6784\u5efa\u529f\u80fd\u3002</p> <p>\u4e3a\u4e86\u89e3\u51b3\u8de8\u5e73\u53f0\u95ee\u9898\u4ee5\u53ca\u624b\u5199 <code>Makefile</code> \u592a\u8fc7\u7e41\u7410\u7684\u95ee\u9898\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5143\u6784\u5efa\u7cfb\u7edf\u8fdb\u4e00\u6b65\u63d0\u5347\u6784\u5efa\u7684\u6548\u7387\u4ee5\u53ca\u8f6f\u4ef6\u7684\u901a\u7528\u6027\u3002</p>"},{"location":"meta-build-system/#\u5143\u6784\u5efa\u7cfb\u7edf\u548c\u6784\u5efa\u7cfb\u7edf\u7684\u533a\u522b","title":"\u5143\u6784\u5efa\u7cfb\u7edf\u548c\u6784\u5efa\u7cfb\u7edf\u7684\u533a\u522b\uff1f","text":"<p>\u5143\u6784\u5efa\u7cfb\u7edf\u548c\u6784\u5efa\u7cfb\u7edf\u4e0d\u540c\uff0c\u5b83\u5e76\u4e0d\u76f4\u63a5\u5e2e\u4f60\u6784\u5efa\u597d\u8f6f\u4ef6\uff0c\u800c\u662f\u6839\u636e\u5e73\u53f0\u7279\u6027\u7b49\u751f\u6210\u5176\u4ed6\u6784\u5efa\u7cfb\u7edf\u6240\u9700\u7684 DSL\uff0c\u4f8b\u5982\u751f\u6210 Makefile\u3002\u6240\u4ee5\uff0c\u4f7f\u7528\u5143\u6784\u5efa\u7cfb\u7edf\u5f80\u5f80\u5206\u4e3a\u4e24\u6b65\uff0c\u7b2c\u4e00\u6b65\u8c03\u7528\u5143\u6784\u5efa\u7cfb\u7edf\u6765\u751f\u6210\u6784\u5efa\u6587\u4ef6\uff0c\u7b2c\u4e8c\u6b65\u8c03\u7528\u5bf9\u5e94\u7684\u6784\u5efa\u7cfb\u7edf\u751f\u6210\u6700\u7ec8\u7684\u8f6f\u4ef6\u3002</p> <p>\u53e6\u5916\uff0c\u5143\u6784\u5efa\u7cfb\u7edf\u4e3a\u4e86\u505a\u5230\u8de8\u5e73\u53f0\u7279\u6027\uff0c\u53ef\u4ee5\u81ea\u52a8\u68c0\u6d4b\u5e73\u53f0\u5dee\u5f02\u5e76\u914d\u7f6e\u597d\u76f8\u5e94\u7684\u5b8f\uff0c\u4e0d\u9700\u8981\u6211\u4eec\u624b\u52a8\u4fee\u6539 <code>Makefile</code> \u7b49\u3002\u8fd9\u6837\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5728\u7f16\u5199\u4ee3\u7801\u7684\u65f6\u5019\u9002\u5f53\u5730\u4f7f\u7528\u5b8f\u8fdb\u884c\u6761\u4ef6\u7f16\u8bd1\uff0c\u5c31\u80fd\u505a\u5230\u4e00\u6b21\u7f16\u5199\uff0c\u5230\u5904\u7f16\u8bd1\u4e86\u3002</p>"},{"location":"meta-build-system/#\u4f9d\u8d56\u7ba1\u7406","title":"\u4f9d\u8d56\u7ba1\u7406","text":"<p>\u5728\u7f16\u5199\u9879\u76ee\u65f6\uff0c\u6211\u4eec\u7531\u4e8e\u65f6\u95f4\u548c\u7cbe\u529b\u539f\u56e0\uff0c\u4e0d\u53ef\u80fd\u4ec0\u4e48\u4ee3\u7801\u90fd\u662f\u81ea\u5df1\u5199\uff0c\u800c\u662f\u4f1a\u5f15\u5165\u5176\u4ed6\u4eba\u7f16\u5199\u597d\u7684\u4ee3\u7801\u5e93\u3002C++ \u8bde\u751f\u4e4b\u521d\u5e76\u6ca1\u6709\u81ea\u5e26\u4e00\u5957\u6807\u51c6\u7684\u4f9d\u8d56\u7ba1\u7406\u5de5\u5177\uff0c\u800c\u662f\u5c06\u7ba1\u7406\u65b9\u5f0f\u7684\u9009\u62e9\u6743\u4ea4\u7ed9\u4e86\u7a0b\u5e8f\u5458\u4eec\u3002\u800c\u8fd9\u4e5f\u5bfc\u81f4\u4e86\u5404\u79cd\u4f9d\u8d56\u7ba1\u7406\u65b9\u5f0f\u7684\u51fa\u73b0\uff0c\u4e00\u7247\u6df7\u4e71\u3002\u76ee\u524d\u6bd4\u8f83\u5e38\u89c1\u7684 C++ \u4f9d\u8d56\u7ba1\u7406\u529e\u6cd5\u6709\uff1a</p> <ul> <li>\u76f4\u63a5\u4e0b\u8f7d\u76f8\u5e94\u7684\u6e90\u4ee3\u7801\uff0c\u7f16\u8bd1\u5b89\u88c5\u6216\u8005\u590d\u5236\u5230\u81ea\u5df1\u7684\u4ee3\u7801\u4ed3\u5e93\u4e2d</li> <li>\u4f7f\u7528 Git Submodules \u529f\u80fd\uff0c\u5c06\u4f9d\u8d56\u5e93\u52a0\u5165\u5230\u81ea\u5df1\u7684\u4ee3\u7801\u4ed3\u5e93\u4e2d</li> <li>\u4f7f\u7528\u7cfb\u7edf\u81ea\u5e26\u7684\u5305\u7ba1\u7406\u5de5\u5177\uff0c\u4f8b\u5982 <code>apt</code> \u5168\u5c40\u5b89\u88c5\u4f9d\u8d56</li> <li>\u4f7f\u7528 <code>conan</code>\u3001<code>vcpkg</code> \u7b49\u5305\u7ba1\u7406\u5de5\u5177</li> <li>\u4f7f\u7528\u5143\u6784\u5efa\u7cfb\u7edf\u672c\u8eab\u7684\u4f9d\u8d56\u7ba1\u7406</li> </ul> <p>\u5143\u6784\u5efa\u7cfb\u7edf\u4e00\u822c\u90fd\u4f1a\u5185\u7f6e\u4ee5\u4e0a\u51e0\u79cd\u4f9d\u8d56\u7ba1\u7406\u7684\u65b9\u6cd5\u3002\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u5404\u4e2a C++ \u9879\u76ee\u90fd\u8fd8\u6ca1\u6709\u7edf\u4e00\u7684\u4f9d\u8d56\u7ba1\u7406\u529e\u6cd5\uff0c\u56e0\u6b64\uff0c\u5728\u6211\u4eec\u81ea\u5df1\u7f16\u5199\u9879\u76ee\uff0c\u4ee5\u53ca\u5f15\u7528\u4ed6\u4eba\u9879\u76ee\u7684\u65f6\u5019\uff0c\u9700\u8981\u7075\u6d3b\u5e94\u53d8\uff0c\u6839\u636e\u5bf9\u65b9\u9879\u76ee\u7684\u5b9e\u9645\u60c5\u51b5\u548c\u81ea\u5df1\u9879\u76ee\u7684\u60c5\u51b5\u6765\u9009\u62e9\u5408\u9002\u7684\u4f9d\u8d56\u7ba1\u7406\u65b9\u5f0f\u3002</p> <p>\u76ee\u524d\uff0c\u5f00\u6e90\u7684 C++ \u9879\u76ee\u901a\u5e38\u90fd\u4f1a\u63d0\u4f9b <code>CMakeLists.txt</code>\u3002</p>"},{"location":"meta-build-system/autotools/","title":"Autotools","text":"<p>Autotools \u662f GNU \u8f6f\u4ef6\u6807\u51c6\u7684\u5143\u6784\u5efa\u7cfb\u7edf\u3002</p> <p>\u5982\u679c\u4f60\u8bd5\u8fc7\u4ece\u6e90\u7801\u5b89\u88c5\u8f6f\u4ef6\uff0c\u90a3\u4e48\u4e00\u5b9a\u5bf9\u8fd9\u51e0\u884c\u547d\u4ee4\u975e\u5e38\u719f\u6089\uff1a</p> <pre><code>./configure\nmake\nmake install\n</code></pre> <p>\u8fd9\u4e2a <code>./configure</code> \u811a\u672c\u662f\u600e\u4e48\u6765\u7684\u5462\uff1f\u7b54\u6848\u5c31\u662f\u5b83\u662f\u7528 Autotools \u751f\u6210\u7684\u3002Autotools \u53d1\u5c55\u5386\u53f2\u60a0\u4e45\uff0c\u53ef\u4ee5\u4ece\u4e2d\u5b66\u4e60\u5230\u6784\u5efa\u7cfb\u7edf\u662f\u5982\u4f55\u4e00\u6b65\u6b65\u53d1\u5c55\u800c\u6765\u7684\u3002</p>"},{"location":"meta-build-system/autotools/#\u4ece\u53ef\u79fb\u690d\u6027\u8bf4\u8d77","title":"\u4ece\u53ef\u79fb\u690d\u6027\u8bf4\u8d77","text":"<p>\u5c3d\u7ba1 C \u8bed\u8a00\u53f7\u79f0\u662f\u53ef\u79fb\u690d\u7684\u7f16\u7a0b\u8bed\u8a00\uff0c\u4f46\u662f C \u8bed\u8a00\u662f\u9ad8\u7ea7\u8bed\u8a00\u4e2d\u6bd4\u8f83\u63a5\u8fd1\u5e95\u5c42\u7684\uff0c\u5728\u4f7f\u7528 C \u8bed\u8a00\u7f16\u7a0b\u65f6\uff0c\u603b\u4f1a\u6709\u4e00\u4e9b\u51fd\u6570\u4f1a\u5e26\u6765\u4e0d\u53ef\u79fb\u690d\u7684\u95ee\u9898\uff0c\u4f8b\u5982</p> <ul> <li>\u6709\u4e00\u4e9b\u51fd\u6570\u5e76\u4e0d\u662f\u6bcf\u4e2a\u5e73\u53f0\u90fd\u6709\u63d0\u4f9b\uff0c\u4f8b\u5982 <code>strtod</code></li> <li>\u6709\u4e00\u4e9b\u529f\u80fd\u4e00\u6837\u7684\u51fd\u6570\uff0c\u53ef\u80fd\u5728\u4e0d\u540c\u5e73\u53f0\u7684\u540d\u79f0\u4e0d\u4e00\u6837\uff0c\u4f8b\u5982 <code>strchr</code> \u6216\u8005 <code>index</code></li> <li>\u6709\u4e00\u4e9b\u529f\u80fd\u548c\u540d\u79f0\u90fd\u4e00\u6837\u7684\u51fd\u6570\uff0c\u53ef\u80fd\u51fd\u6570\u539f\u578b\u4e0d\u4e00\u6837\uff0c\u4f8b\u5982 <code>int setpgrp(void);</code> \u548c <code>int setpgrp(int, int);</code></li> <li>\u6709\u4e00\u4e9b\u51fd\u6570\u53ef\u80fd\u539f\u578b\u4e00\u6837\uff0c\u4f46\u662f\u884c\u4e3a\u4e0d\u4e00\u81f4\uff0c\u4f8b\u5982 <code>malloc(0)</code></li> <li>\u6709\u4e00\u4e9b\u51fd\u6570\u5b8c\u5168\u4e00\u6837\uff0c\u4f46\u662f\u5b9a\u4e49\u5728\u4e86\u4e0d\u540c\u7684\u5934\u6587\u4ef6\uff0c\u4f8b\u5982 <code>string.h</code>\u3001<code>strings.h</code> \u548c <code>memory.h</code></li> <li>\u6709\u4e00\u4e9b\u51fd\u6570\u53ef\u80fd\u58f0\u660e\u5b8c\u5168\u4e00\u81f4\uff0c\u4f46\u662f\u5b9a\u4e49\u5728\u4e86\u4e0d\u540c\u7684\u5e93\u6587\u4ef6\u91cc\uff0c\u4f8b\u5982 <code>pow</code> \u53ef\u80fd\u5b9a\u4e49\u5728 <code>libc.so</code> \u6216\u8005 <code>libm.so</code> \u91cc</li> </ul> <p>\u6ca1\u9519\uff0c\u5f53\u6709\u95ee\u9898\u7684\u65f6\u5019\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5f15\u5165\u4e00\u5c42\u95f4\u63a5\u6027\u6765\u89e3\u51b3\u5b83\u4eec\uff1a</p> <ul> <li>\u7528 <code>#if</code> \u548c <code>#else</code> \u6765\u66b4\u529b\u5224\u65ad\u5e73\u53f0\u7136\u540e\u7f16\u5199\u4e0d\u540c\u7684\u4ee3\u7801</li> <li>\u7528\u5b8f\u7684\u65b9\u5f0f\u6765\u5305\u88c5\u51fd\u6570\uff0c\u5e76\u5728\u7f16\u8bd1\u7684\u65f6\u5019\u5b9a\u4e49\u9002\u5408\u7684\u5b8f</li> <li>\u7528\u51fd\u6570\u7684\u65b9\u5f0f\u6765\u5305\u88c5\u51fd\u6570\uff0c\u5728\u7f16\u8bd1\u7684\u65f6\u5019\u94fe\u63a5\u5230\u4e0d\u540c\u7684\u6587\u4ef6</li> </ul> <p>\u5176\u4e2d\u7b2c\u4e00\u79cd\u65b9\u5f0f\u4f1a\u4f7f\u5f97\u6e90\u4ee3\u7801\u975e\u5e38\u6df7\u4e71\uff0c\u4e00\u822c\u4f7f\u7528\u540e\u4e24\u79cd\u65b9\u6cd5\u3002\u4f46\u662f\uff0c\u65e0\u8bba\u4f7f\u7528\u54ea\u4e00\u79cd\u65b9\u6cd5\uff0c\u90fd\u4e00\u822c\u4f1a\u9700\u8981\u7528\u6237\u81ea\u5df1\u4fee\u6539 Makefile \u4e2d\u7684\u5b8f\u5b9a\u4e49\uff0c\u6216\u8005\u624b\u52a8\u7f16\u8f91\u4f9d\u8d56\u7b49\u3002\u8fd9\u6837\u5b89\u88c5\u8f6f\u4ef6\u4f1a\u663e\u5f97\u5f88\u9ebb\u70e6\uff0c\u5982\u679c\u7528\u6237\u662f\u65b0\u624b\u7684\u8bdd\u53ef\u80fd\u5c31\u4e0d\u60f3\u7528\u4e86\u3002\u6240\u8c13\u5077\u61d2\u662f\u79d1\u6280\u8fdb\u6b65\u7684\u7b2c\u4e00\u52a8\u529b\uff0c\u7a0b\u5e8f\u5458\u4eec\u81ea\u7136\u4f1a\u60f3\uff1a\u80fd\u4e0d\u80fd\u5199\u4e2a\u7a0b\u5e8f\u5e2e\u7528\u6237\u81ea\u52a8\u751f\u6210\u5bf9\u5e94\u5e73\u53f0\u7684 Makefile\uff1f</p> <p>\u56e0\u6b64\uff0c\u5728\u5927\u7ea6 90 \u5e74\u4ee3\u521d\u671f\uff0c\u4eba\u4eec\u5f00\u59cb\u4e3a GNU \u5305\u4e2d\u7684\u4e00\u4e9b\u8f6f\u4ef6\u7f16\u5199\u811a\u672c\uff0c\u540d\u5b57\u5c31\u53eb <code>configure</code>\uff0c\u6765\u201c\u731c\u6d4b\u201d\u7528\u6237\u5e73\u53f0\u7684\u914d\u7f6e\uff0c\u7136\u540e\u81ea\u52a8\u751f\u6210\u4e00\u4e2a Makefile\uff0c\u8fd9\u6837\u7528\u6237\u53ea\u9700\u8981\u7b80\u5355\u5730\u8fd0\u884c\u51e0\u6761\u547d\u4ee4\uff0c\u5c31\u80fd\u5b89\u88c5\u597d\u8f6f\u4ef6\u4e86\u3002</p>"},{"location":"meta-build-system/autotools/#\u751f\u6210-configure-\u6587\u4ef6","title":"\u751f\u6210 configure \u6587\u4ef6","text":"<p>\u5f53\u7136\uff0c\u624b\u5199 <code>configure</code> \u811a\u672c\u5bf9\u7a0b\u5e8f\u5458\u6765\u8bf4\u4e5f\u5f88\u9ebb\u70e6\uff0c\u6240\u4ee5\uff0c\u6ca1\u9519\uff0c\u7a0b\u5e8f\u5458\u4eec\u53c8\u5199\u4e86\u4e00\u4e2a\u751f\u6210 <code>configure</code> \u811a\u672c\u7684\u5de5\u5177\uff0c\u53eb <code>autoconf</code>\uff0c\u5b83\u672c\u8d28\u4e0a\u662f\u4e00\u4e2a\u5b8f\u5904\u7406\u5668\u3002\u4e0d\u51fa\u610f\u6599\uff0c\u4eba\u4eec\u4e5f\u53d1\u660e\u4e86\u5bf9\u5e94\u7684 DSL\u3002\u5c31\u597d\u50cf CMake \u7684\u811a\u672c\u9ed8\u8ba4\u53eb <code>CMakeLists.txt</code>\uff0c<code>autoconf</code> \u9ed8\u8ba4\u4f1a\u53bb\u67e5\u627e <code>configure.ac</code> \u8fd9\u4e2a\u6587\u4ef6\uff08ac \u5c31\u662f autoconf \u7684\u7f29\u5199\uff09\uff0c\u6267\u884c\u91cc\u9762\u7684\u547d\u4ee4\uff0c\u751f\u6210 <code>configure</code> \u6587\u4ef6\u3002</p> <p>\u4e00\u4e2a\u7b80\u5355\u7684 <code>configure.ac</code> \u957f\u8fd9\u6837\uff1a</p> configure.ac <pre><code>AC_INIT([demo], [1.0], [bug-report@somewhere])\nAM_INIT_AUTOMAKE([foreign -Wall -Werror])\nAC_PROG_CC\nAC_CONFIG_HEADERS([config.h])\nAC_CONFIG_FILES([Makefile])\nAC_OUTPUT \n</code></pre> <p>\u7b2c\u4e00\u884c\u7c7b\u4f3c\u4e8e <code>CMakeLists.txt</code> \u7684 <code>project</code>\uff0c\u58f0\u660e\u4e86\u8fd9\u4e2a\u9879\u76ee\u7684\u540d\u79f0\u4ee5\u53ca\u7248\u672c\u3002\u7b2c\u4e8c\u884c\u5219\u8bbe\u7f6e\u4e86\u4e00\u4e9b\u7f16\u8bd1\u53c2\u6570\u3002\u7b2c\u4e09\u884c\u8868\u793a\u9700\u8981\u68c0\u67e5 C \u7f16\u8bd1\u5668\u3002\u7b2c\u56db\u7b2c\u4e94\u884c\u8868\u793a\u9700\u8981\u751f\u6210\u7684\u5934\u6587\u4ef6\u4ee5\u53ca Makefile \u6587\u4ef6\u540d\u3002\u7b2c\u516d\u884c\u5219\u8868\u793a\u6b63\u5f0f\u8f93\u51fa\u6240\u6709\u7684\u6587\u4ef6\u3002</p> <p>\u5176\u4e2d <code>config.h</code> \u6587\u4ef6\u4f1a\u5305\u542b\u4e00\u4e9b\u9884\u5b9a\u4e49\u7684\u5b8f\uff0c\u4f8b\u5982 <code>PACKAGE_NAME</code> \u7b49\u3002\u53ef\u4ee5\u770b\u5230 <code>configure.ac</code> \u6587\u4ef6\u4e2d\u5e76\u6ca1\u6709\u6307\u5b9a\u6e90\u4ee3\u7801\uff0c\u800c\u662f\u6307\u5b9a\u4e86 <code>Makefile</code>\u3002\u4e0d\u8fc7\u4f60\u53ef\u80fd\u4f1a\u597d\u5947\uff0c<code>configure</code> \u4e0d\u5c31\u662f\u4e3a\u4e86\u751f\u6210 <code>Makefile</code> \u5417\uff0c\u90a3\u8fd9\u4e2a <code>Makefile</code> \u53c8\u662f\u4ece\u54ea\u6765\u7684\uff1f\u7b2c\u4e8c\u884c\u7684 Automake \u53c8\u662f\u4ec0\u4e48\uff1f</p>"},{"location":"meta-build-system/autotools/#\u751f\u6210-makefile-\u6587\u4ef6","title":"\u751f\u6210 Makefile \u6587\u4ef6","text":"<p>\u6ca1\u9519\uff0c\u8fd9\u4e2a <code>Makefile</code> \u540c\u6837\u662f\u4ece\u5b8f\u6587\u4ef6\u751f\u6210\u51fa\u6765\u7684\uff0c\u751f\u6210\u7684\u5de5\u5177\u53eb <code>automake</code>\u3002\u8fd9\u4e2a\u5de5\u5177\u4f1a\u53bb\u67e5\u627e <code>Makefile.am</code>\uff08am \u662f automake \u7684\u7f29\u5199\uff09\u6587\u4ef6\uff0c\u91cc\u9762\u58f0\u660e\u4e86\u7a0b\u5e8f\u7684\u6e90\u6587\u4ef6\u4ee5\u53ca\u751f\u6210\u7684\u76ee\u6807\u3002\u4e0b\u9762\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u7a0b\u5e8f\u548c\u5bf9\u5e94\u7684 Makefile \u6a21\u677f\uff1a</p> Makefile.ammain.c <pre><code>bin_PROGRAMS = hello\nhello_SOURCES = main.c\n</code></pre> <pre><code>#include &lt;config.h&gt;\n#include &lt;stdio.h&gt;\n\nint main() {\n    puts(\"hello, world\");\n    puts(\"this is \" PACKAGE_NAME \".\");\n    return 0;\n}\n</code></pre> <p>\u4ece\u53d8\u91cf\u540d\u4e5f\u80fd\u731c\u51fa\u6765\uff0c<code>bin_PROGRAMS</code> \u6307\u5b9a\u4e86 <code>bin</code> \u6587\u4ef6\u5939\u4e0b\u9700\u8981\u751f\u6210\u7684\u76ee\u6807\uff0c\u800c <code>hello_SOURCES</code> \u5219\u6307\u5b9a\u4e86\u751f\u6210 <code>hello</code> \u8fd9\u4e2a\u76ee\u6807\u6240\u9700\u8981\u7684\u6e90\u4ee3\u7801\u3002\u5c31\u7c7b\u4f3c\u4e8e CMake \u4e2d\u7684 <code>add_executable(hello main.c)</code>\u3002</p> <p>\u6709\u4e86\u8fd9\u4e24\u4e2a\u6587\u4ef6\uff0c\u5c31\u8db3\u4ee5\u6784\u5efa\u8fd9\u4e2a\u7b80\u5355\u7684\u9879\u76ee\u4e86\u3002\u8fd0\u884c <code>autoreconf</code>\uff0c\u5c31\u53ef\u4ee5\u751f\u6210 Makefile \u7136\u540e\u8fdb\u884c\u7f16\u8bd1\u4e86\u3002</p> <pre><code>$ ls\nMakefile.am  configure.ac  main.c\n$ autoreconf --install\nconfigure.ac:3: installing './compile'\nconfigure.ac:2: installing './install-sh'\nconfigure.ac:2: installing './missing'\nMakefile.am: installing './depcomp'\n$ ./configure\nchecking for a BSD-compatible install... /usr/bin/install -c\nchecking whether build environment is sane... yes\nchecking for a thread-safe mkdir -p... /usr/bin/mkdir -p\n# ...\nconfigure: creating ./config.status\nconfig.status: creating Makefile\nconfig.status: creating config.h\nconfig.status: executing depfiles commands\n$ make              \nmake  all-am\nmake[1]: Entering directory '/home/howard/autoconfdemo'\ngcc -DHAVE_CONFIG_H -I.     -g -O2 -MT main.o -MD -MP -MF .deps/main.Tpo -c -o main.o main.c\nmv -f .deps/main.Tpo .deps/main.Po\ngcc  -g -O2   -o hello main.o  \nmake[1]: Leaving directory '/home/howard/autoconfdemo'\n$ ./hello    \nhello, world\nthis is demo.\n</code></pre> <p>\u4e0a\u9762\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u751f\u6210\u53ef\u6267\u884c\u6587\u4ef6\u7684\u793a\u4f8b\uff0c\u5982\u679c\u60f3\u7f16\u8bd1\u51fa\u9759\u6001\u5e93\uff0c\u5219\u9700\u8981\u6539\u52a8 <code>Makefile.am</code> \u4ee5\u53ca <code>configure.ac</code>\uff1a</p> Makefile.amconfigure.achello.chello.hmain.c <pre><code>lib_LIBRARIES = libhello.a\nlibhello_a_SOURCES = hello.c hello.c\n\nbin_PROGRAMS = hello\nhello_SOURCES = main.c\nhello_LDADD = libhello.a\n</code></pre> <pre><code>AC_INIT([demo], [1.0], [bug-report@somewhere])\nAM_INIT_AUTOMAKE([foreign -Wall -Werror])\nAC_PROG_CC\nAC_PROG_RANLIB\nAM_PROG_AR\nAC_CONFIG_HEADERS([config.h])\nAC_CONFIG_FILES([Makefile])\nAC_OUTPUT\n</code></pre> <pre><code>#include &lt;stdio.h&gt;\n#include &lt;config.h&gt;\n#include &lt;hello.h&gt;\n\nvoid sayhello() {\n    puts(\"hello, world\");\n    puts(\"this is \" PACKAGE_NAME \".\");\n}\n</code></pre> <pre><code>#ifndef _HELLO_H_\n#define _HELLO_H_\nvoid sayhello();\n#endif /* ifndef _HELLO_H_ */\n</code></pre> <pre><code>#include &lt;config.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;hello.h&gt;\n\nint main() {\n    sayhello();\n    return 0;\n}\n</code></pre> <p>\u540c\u6837\u6267\u884c <code>configure</code> \u91cd\u65b0\u751f\u6210 <code>Makefile</code> \u6587\u4ef6\uff0c\u7136\u540e\u7f16\u8bd1\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u9759\u6001\u5e93\u548c\u8fde\u63a5\u4e86\u9759\u6001\u5e93\u7684\u7a0b\u5e8f\u4e86\uff1a</p> <pre><code>$ autoreconf --install &amp;&amp; ./configure\n# ...\n$ make\nmake  all-am\nmake[1]: Entering directory '/home/howard/autoconfdemo'\ngcc -DHAVE_CONFIG_H -I.     -g -O2 -MT main.o -MD -MP -MF .deps/main.Tpo -c -o main.o main.c\nmv -f .deps/main.Tpo .deps/main.Po\ngcc -DHAVE_CONFIG_H -I.     -g -O2 -MT hello.o -MD -MP -MF .deps/hello.Tpo -c -o hello.o hello.c\nmv -f .deps/hello.Tpo .deps/hello.Po\nrm -f libhello.a\nar cru libhello.a hello.o hello.o \nar: `u' modifier ignored since `D' is the default (see `U')\nranlib libhello.a\ngcc  -g -O2   -o hello main.o libhello.a \nmake[1]: Leaving directory '/home/howard/autoconfdemo'\n$ ./hello\nhello, world\nthis is demo.\n</code></pre>"},{"location":"meta-build-system/autotools/#\u68c0\u67e5\u5e73\u53f0\u7279\u6027","title":"\u68c0\u67e5\u5e73\u53f0\u7279\u6027","text":"<p>\u5728\u8fd0\u884c <code>./configure</code> \u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u4f1a\u770b\u5230\u7c7b\u4f3c\u8fd9\u6837\u7684\u8f93\u51fa\uff1a</p> <pre><code>checking for mkdir... yes\nchecking for abcdefg... no\n</code></pre> <p>\u8fd9\u5c31\u662f <code>configure</code> \u811a\u672c\u5728\u68c0\u67e5\u7cfb\u7edf\u7684\u73af\u5883\u7279\u6027\u3002\u5b83\u7684\u5de5\u4f5c\u539f\u7406\u540c\u6837\u662f\u4f7f\u7528\u5b8f\uff0c\u7136\u540e\u5728\u6267\u884c\u8fc7\u7a0b\u4e2d\uff0c\u52a8\u6001\u751f\u6210\u4e00\u4e2a\u6e90\u7a0b\u5e8f\uff0c\u7136\u540e\u5c1d\u8bd5\u7f16\u8bd1\u7b49\u64cd\u4f5c\uff0c\u53bb\u68c0\u67e5\u67d0\u4e9b\u7c7b\u578b\u6216\u8005\u51fd\u6570\u662f\u5426\u88ab\u5b9a\u4e49\u3002\u5f53\u7136\u6211\u4eec\u4e5f\u53ef\u4ee5\u81ea\u5b9a\u4e49\u5b8f\u53bb\u68c0\u67e5\u66f4\u590d\u6742\u7684\u5e73\u53f0\u76f8\u5173\u7279\u6027\u3002</p> <p>\u4f8b\u5982\uff0c\u6211\u4eec\u60f3\u77e5\u9053\u7cfb\u7edf\u91cc\u6709\u6ca1\u6709 <code>mkdir</code> \u8fd9\u4e2a\u51fd\u6570\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528 <code>AC_CHECK_FUNCS([mkdir])</code>\u3002\u5982\u679c\u6709\u8fd9\u4e2a\u51fd\u6570\u7684\u8bdd\uff0c\u90a3\u4e48\u5728 <code>config.h</code> \u4e2d\uff0c\u5c31\u4f1a\u5b9a\u4e49 <code>#define HAVE_MKDIR 1</code>\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u5b8f\u5b9a\u4e49\u8fdb\u884c\u6761\u4ef6\u7f16\u8bd1\u4e86\u3002</p>"},{"location":"meta-build-system/autotools/#\u5206\u53d1\u6e90\u4ee3\u7801","title":"\u5206\u53d1\u6e90\u4ee3\u7801","text":"<p>\u90a3\u4e48\uff0c\u6211\u4eec\u5e73\u65f6\u4e0b\u8f7d\u7684 <code>xxx.tar.gz</code> \u662f\u600e\u4e48\u6765\u7684\u5462\uff1f\u6211\u4eec\u53ef\u4ee5\u624b\u52a8\u5c06\u751f\u6210\u7684 <code>configure</code> \u7b49\u5404\u79cd\u6587\u4ef6\u8fde\u540c\u6e90\u4ee3\u7801\u4e00\u8d77\u6253\u5305\u3002\u4e0d\u8fc7\uff0cAutotools \u751f\u6210\u7684 Makefile \u91cc\u9762\u5df2\u7ecf\u5185\u7f6e\u4e86\u8fd9\u6837\u7684\u811a\u672c\uff0c\u6211\u4eec\u53ea\u9700\u8981\u6267\u884c <code>make dist</code>\uff0c\u5c31\u53ef\u4ee5\u81ea\u52a8\u751f\u6210\u4e00\u4e2a <code>&lt;package&gt;-&lt;version&gt;.tar.gz</code> \u7684\u538b\u7f29\u5305\uff0c\u53ea\u9700\u8981\u5c06\u8fd9\u4e2a\u538b\u7f29\u5305\u5206\u53d1\u7ed9\u7528\u6237\uff0c\u7528\u6237\u89e3\u538b\u4e4b\u540e\u5c31\u80fd\u7528\u7ecf\u5178\u7684\u4e09\u90e8\u66f2\u7f16\u8bd1\u4f7f\u7528\u6211\u4eec\u7684\u7a0b\u5e8f\u4e86\u3002</p> <pre><code>$ make dist\n# ...\n$ ls *.tar.gz\ndemo-1.0.tar.gz\n</code></pre>"},{"location":"meta-build-system/autotools/#autoreconf-\u80cc\u540e\u7684\u6545\u4e8b","title":"autoreconf \u80cc\u540e\u7684\u6545\u4e8b","text":"<p>\u4e0a\u9762\u7528\u5230\u4e86 <code>autoreconf</code>\uff0c\u8fd9\u662f\u4e00\u4e2a\u5e2e\u52a9\u6211\u4eec\u8fd0\u884c\u5404\u79cd\u5de5\u5177\u751f\u6210\u6784\u5efa\u6240\u9700\u8981\u7684\u6587\u4ef6\u7684\u5305\u88c5\u5de5\u5177\u3002\u5c31\u8ddf <code>g++</code> \u662f\u5305\u88c5\u5668\u4e00\u6837\uff0c<code>autoreconf</code> \u80cc\u540e\u4f1a\u5e2e\u6211\u4eec\u8c03\u7528 <code>autoconf</code>\u3001<code>automake</code> \u7b49\u4e00\u7cfb\u5217\u5de5\u5177\u6765\u751f\u6210\u6784\u5efa\u6587\u4ef6\u3002\u4e0b\u9762\u7b80\u5355\u4ecb\u7ecd\u4e00\u4e0b\u5b9e\u9645\u751f\u6210\u6587\u4ef6\u7684\u7a0b\u5e8f\u3002</p> \u7a0b\u5e8f\u540d \u4f5c\u7528 aclocal \u626b\u63cf <code>configure.ac</code> \u4e2d\u4f7f\u7528\u7684\u7b2c\u4e09\u65b9\u5b8f\uff0c\u5e76\u5c06\u5b83\u4eec\u7684\u5b9a\u4e49\u6536\u96c6\u5230 <code>aclocal.m4</code> \u4e2d autoconf \u6839\u636e <code>configure.ac</code> \u751f\u6210 <code>configure</code> \u811a\u672c autoheader \u6839\u636e <code>configure.ac</code> \u751f\u6210 <code>config.h.in</code> \u6587\u4ef6 automake \u6839\u636e <code>configure.ac</code> \u4ee5\u53ca <code>Makefile.am</code> \u751f\u6210 <code>Makefile.in</code> \u6587\u4ef6 autom4te M4\uff08\u5b8f\u5904\u7406\u5668\uff09\u7684 autoconf \u9a71\u52a8\u7a0b\u5e8f\uff0c\u6240\u6709\u5904\u7406 <code>configure.ac</code> \u7684\u7a0b\u5e8f\u90fd\u662f\u7528\u8fd9\u4e2a\u7a0b\u5e8f\u6765\u5904\u7406\u5b8f\u7684"},{"location":"meta-build-system/cmake/","title":"\u4f7f\u7528 CMake \u7f16\u8bd1\u591a\u6587\u4ef6\u9879\u76ee","text":"<p>\u672c\u8282\u5c06\u5e26\u4f60\u5feb\u901f\u4e86\u89e3\u5982\u4f55\u4f7f\u7528 CMake \u6765\u7f16\u8bd1\u5e26\u6709\u5e93\u7684\u4e8c\u8fdb\u5236\u53ef\u6267\u884c\u6587\u4ef6\u3002\u5728\u9605\u8bfb\u672c\u8282\u4e4b\u524d\uff0c\u8bf7\u786e\u4fdd\u5df2\u7ecf\u5b8c\u5168\u7406\u89e3\u5e76\u638c\u63e1\u4e86\u7a0b\u5e8f\u7684\u7f16\u8bd1\u94fe\u63a5\u8fc7\u7a0b\u3002</p>"},{"location":"meta-build-system/cmake/#\u7ec4\u7ec7\u9879\u76ee\u76ee\u5f55","title":"\u7ec4\u7ec7\u9879\u76ee\u76ee\u5f55","text":"<p>\u4e00\u822c\u800c\u8a00\uff0cC++ \u7684\u9879\u76ee\u4f1a\u5c06 <code>.h</code> \u7b49\u5934\u6587\u4ef6\u5b58\u653e\u5230\u9879\u76ee\u6839\u76ee\u5f55\u91cc\u7684 <code>include</code> \u6587\u4ef6\u5939\uff0c\u800c\u5c06 <code>.cpp</code> \u6587\u4ef6\u5b58\u653e\u5230\u9879\u76ee\u6839\u76ee\u5f55\u91cc\u7684 <code>src</code> \u6587\u4ef6\u5939\u3002\u8fd9\u4e24\u4e2a\u6587\u4ef6\u5939\u91cc\uff0c\u518d\u6839\u636e\u4e0d\u540c\u7684\u6a21\u5757\u9700\u8981\u7ec4\u7ec7\u5b50\u6587\u4ef6\u5939\u3002\u800c\u6d4b\u8bd5\u5219\u5355\u72ec\u5b58\u653e\u5230 <code>test</code> \u6587\u4ef6\u5939\u3002</p> <p>\u800c\u6211\u4eec\u4f1a\u5c06\u7a0b\u5e8f\u7684\u5927\u90e8\u5206\u529f\u80fd\u7f16\u8bd1\u4e3a\u5e93\uff0c\u7136\u540e\u7f16\u5199\u4e00\u4e2a\u7b80\u5355\u7684\u4e3b\u51fd\u6570\u6587\u4ef6\uff0c\u6765\u5c06\u8fd9\u4e9b\u5e93\u6709\u673a\u5730\u7ec4\u5408\u5728\u4e00\u8d77\uff0c\u5e76\u9a71\u52a8\u7a0b\u5e8f\u7684\u8fd0\u884c\u3002\u8fd9\u6837\u505a\u7684\u597d\u5904\u5c31\u662f\u65b9\u4fbf\u7f16\u5199\u4e0d\u540c\u7684\u9a71\u52a8\u7a0b\u5e8f\u4ee5\u53ca\u6d4b\u8bd5\u7a0b\u5e8f\u53bb\u8c03\u7528\u6211\u4eec\u5199\u7684\u51fd\u6570\u3002\u5728\u66f4\u5927\u578b\u7684\u9879\u76ee\u5408\u4f5c\u4e2d\uff0c\u6709\u5229\u4e8e\u5176\u4ed6\u9879\u76ee\u5f00\u53d1\u8005\u590d\u7528\u6211\u4eec\u7684\u4ee3\u7801\u3002</p> <p>\u4e3b\u51fd\u6570\u6587\u4ef6\u53ef\u4ee5\u5355\u72ec\u5b58\u653e\u5230\u4e00\u4e2a <code>cmd</code> \u6587\u4ef6\u5939\u4e2d\uff0c\u4e5f\u53ef\u4ee5\u5728 <code>src</code> \u6587\u4ef6\u5939\u4e2d\u4ee5 <code>main.cpp</code> \u6216\u8005\u5176\u4ed6\u540d\u5b57\u5b58\u653e\u3002</p>"},{"location":"meta-build-system/cmake/#\u6307\u5b9a\u9879\u76ee\u5143\u4fe1\u606f","title":"\u6307\u5b9a\u9879\u76ee\u5143\u4fe1\u606f","text":"<p>\u9996\u5148\u5728\u9879\u76ee\u6839\u76ee\u5f55\u521b\u5efa\u4e00\u4e2a <code>CMakeLists.txt</code> \u6587\u4ef6\uff0c\u5e76\u6307\u5b9a\u7f16\u8bd1\u9879\u76ee\u6240\u9700\u8981\u7684 CMake \u7248\u672c\u4ee5\u53ca\u9879\u76ee\u540d\u3002\u8bf7\u8bb0\u4f4f\uff0c\u5728\u4efb\u4f55\u65f6\u5019\u90fd\u8981\u4fdd\u6301\u6307\u5b9a\u7248\u672c\u53f7\u7684\u597d\u4e60\u60ef\u3002</p> CMakeLists.txt <pre><code>cmake_minimum_required(VERSION 3.16)\nproject(my-server)\n</code></pre>"},{"location":"meta-build-system/cmake/#\u6dfb\u52a0\u5305\u542b\u6587\u4ef6","title":"\u6dfb\u52a0\u5305\u542b\u6587\u4ef6","text":"<p>\u4e3a\u4e86\u4f7f\u5f97\u6211\u4eec\u7f16\u5199\u7684 <code>.cpp</code> \u6e90\u6587\u4ef6\u80fd\u591f\u4f7f\u7528\u5728\u4e0d\u540c\u76ee\u5f55\u91cc\u7684\u5305\u542b\u6587\u4ef6\uff0c\u6211\u4eec\u9700\u8981\u5728 CMake \u4e2d\u901a\u8fc7 <code>include_directories</code> \u6307\u5b9a\u5305\u542b\u76ee\u5f55\u3002</p> CMakeLists.txt <pre><code>cmake_minimum_required(VERSION 3.16)\nproject(my-server)\n\ninclude_directories(\"${CMAKE_CURRENT_SOURCE_DIR}/include\")\n</code></pre>"},{"location":"meta-build-system/cmake/#\u751f\u6210\u5e93\u6587\u4ef6","title":"\u751f\u6210\u5e93\u6587\u4ef6","text":"<p>\u63a5\u4e0b\u6765\u6211\u4eec\u53ef\u4ee5\u5f00\u59cb\u6dfb\u52a0\u6e90\u4ee3\u7801\u6587\u4ef6\uff0c\u4f7f\u7528 <code>add_library</code> \u6765\u751f\u6210\u4e3b\u7a0b\u5e8f\u6240\u9700\u8981\u7684\u5e93\u6587\u4ef6\u4e86\u3002\u5176\u4e2d\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u6211\u4eec\u5e0c\u671b\u751f\u6210\u7684\u5e93\u7684\u540d\u5b57\uff0c\u540e\u7eed\u662f\u751f\u6210\u8fd9\u4e2a\u5e93\u6240\u9700\u8981\u7684\u6240\u6709\u6e90\u6587\u4ef6\u3002</p> CMakeLists.txt <pre><code>cmake_minimum_required(VERSION 3.16)\nproject(my-server)\n\ninclude_directories(\"${CMAKE_CURRENT_SOURCE_DIR}/include\")\n\nadd_library(mylib src/add.cpp src/sub.cpp)\n</code></pre> <p>\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528\u4e86\u624b\u5de5\u6307\u5b9a\u7684\u65b9\u5f0f\uff0c\u5728\u6587\u4ef6\u6bd4\u8f83\u591a\u7684\u65f6\u5019\u53ef\u80fd\u4f1a\u6bd4\u8f83\u9ebb\u70e6\u3002\u4e0d\u8fc7\uff0c\u5728\u4f9d\u8d56\u65b9\u9762\uff0c\u6700\u597d\u662f\u663e\u5f0f\u5730\u6307\u5b9a\u6240\u6709\u4f9d\u8d56\u6587\u4ef6\uff0c\u4e00\u662f\u65b9\u4fbf\u5de5\u5177\u5206\u6790\uff0c\u4e8c\u662f\u65b9\u4fbf\u63a5\u624b\u7684\u4eba\u5feb\u901f\u4e86\u89e3\u9879\u76ee\u7684\u4f9d\u8d56\u3002</p>"},{"location":"meta-build-system/cmake/#\u751f\u6210\u53ef\u6267\u884c\u4e8c\u8fdb\u5236","title":"\u751f\u6210\u53ef\u6267\u884c\u4e8c\u8fdb\u5236","text":"<p>\u6700\u540e\uff0c\u6211\u4eec\u9700\u8981\u901a\u8fc7 <code>add_executable</code> \u6765\u751f\u6210\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u5e76\u4f7f\u7528 <code>target_link_libraries</code> \u5c06\u8fd9\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\u94fe\u63a5\u5230\u6211\u4eec\u7684\u5e93\u3002</p> CMakeLists.txt <pre><code>cmake_minimum_required(VERSION 3.16)\nproject(my-server)\n\ninclude_directories(\"${CMAKE_CURRENT_SOURCE_DIR}/include\")\n\nadd_library(mylib src/add.cpp src/sub.cpp)\n\nadd_executable(main src/main.cpp)\ntarget_link_libraries(main mylib)\n</code></pre>"},{"location":"meta-build-system/cmake/#\u7f16\u8bd1","title":"\u7f16\u8bd1","text":"<p>\u901a\u5e38\uff0c\u6211\u4eec\u4f1a\u65b0\u5efa\u4e00\u4e2a\u53e6\u5916\u7684\u7f16\u8bd1\u6587\u4ef6\u5939\u8fdb\u884c\u6e90\u4ee3\u7801\u5916\u7f16\u8bd1\uff08Out-of-source build\uff09\u3002\u8fd9\u6837\u6709\u4e2a\u597d\u5904\u662f\u7f16\u8bd1\u7684\u4ea7\u7269\u4e0d\u4f1a\u548c\u6e90\u4ee3\u7801\u6df7\u5728\u4e00\u8d77\uff0c\u5982\u679c\u7f16\u8bd1\u51fa\u9519\u4e86\uff0c\u6211\u4eec\u76f4\u63a5\u628a\u6574\u4e2a\u7f16\u8bd1\u6587\u4ef6\u5939\u5220\u6389\u91cd\u6765\u5373\u53ef\u3002\u4f7f\u7528\u7248\u672c\u7ba1\u7406\u8f6f\u4ef6\u7684\u65f6\u5019\u4e5f\u53ef\u4ee5\u5c06\u6574\u4e2a\u6587\u4ef6\u5939\u6392\u9664\u6389\u3002\u4f7f\u7528 <code>cmake</code> \u547d\u4ee4\u5c31\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u751f\u6210\u6784\u5efa\u7cfb\u7edf\u6240\u9700\u8981\u7684\u9879\u76ee\u6587\u4ef6\u4e86\u3002</p> <pre><code>$ mkdir build &amp;&amp; cd build\n$ cmake ..\n-- The C compiler identification is GNU 10.3.0\n-- The CXX compiler identification is GNU 10.3.0\n-- Check for working C compiler: /usr/bin/cc\n-- Check for working C compiler: /usr/bin/cc -- works\n# ...\n-- Configuring done\n-- Generating done\n-- Build files have been written to: /home/howard/a/build\n$ make       \nmake[1]: Entering directory '/home/howard/a/build'\nmake[2]: Entering directory '/home/howard/a/build'\nScanning dependencies of target mylib\nmake[2]: Leaving directory '/home/howard/a/build'\nmake[2]: Entering directory '/home/howard/a/build'\n[ 20%] Building CXX object CMakeFiles/mylib.dir/src/add.cpp.o\n[ 40%] Building CXX object CMakeFiles/mylib.dir/src/sub.cpp.o\n[ 60%] Linking CXX static library libmylib.a\nmake[2]: Leaving directory '/home/howard/a/build'\n[ 60%] Built target mylib\nmake[2]: Entering directory '/home/howard/a/build'\nScanning dependencies of target main\nmake[2]: Leaving directory '/home/howard/a/build'\nmake[2]: Entering directory '/home/howard/a/build'\n[ 80%] Building CXX object CMakeFiles/main.dir/src/main.cpp.o\n[100%] Linking CXX executable main\nmake[2]: Leaving directory '/home/howard/a/build'\n[100%] Built target main\nmake[1]: Leaving directory '/home/howard/a/build'\n$ ./main\nadd(1, 2) = 3\nsub(1, 2) = -1\n</code></pre> \u4f7f\u7528 <code>-G</code> \u9009\u9879\u6307\u5b9a\u6784\u5efa\u7cfb\u7edf <p>CMake \u652f\u6301\u751f\u6210\u4e0d\u540c\u7684\u6784\u5efa\u7cfb\u7edf\u7684\u6587\u4ef6\uff0c\u4f7f\u7528 <code>cmake -G</code> \u53ef\u4ee5\u67e5\u770b\u53ef\u4ee5\u4f7f\u7528\u54ea\u4e9b\u751f\u6210\u5668\u3002 <pre><code>$ cmake -G\nCMake Error: No generator specified for -G\n\nGenerators\n    * Unix Makefiles             = Generates standard UNIX makefiles.\n    Green Hills MULTI            = Generates Green Hills MULTI files\n                                    (experimental, work-in-progress).\n    Ninja                        = Generates build.ninja files.\n    Watcom WMake                 = Generates Watcom WMake makefiles.\n    CodeBlocks - Ninja           = Generates CodeBlocks project files.\n    CodeBlocks - Unix Makefiles  = Generates CodeBlocks project files.\n    CodeLite - Ninja             = Generates CodeLite project files.\n    CodeLite - Unix Makefiles    = Generates CodeLite project files.\n    Sublime Text 2 - Ninja       = Generates Sublime Text 2 project files.\n    Sublime Text 2 - Unix Makefiles\n                                 = Generates Sublime Text 2 project files.\n    Kate - Ninja                 = Generates Kate project files.\n    Kate - Unix Makefiles        = Generates Kate project files.\n    Eclipse CDT4 - Ninja         = Generates Eclipse CDT 4.0 project files.\n    Eclipse CDT4 - Unix Makefiles= Generates Eclipse CDT 4.0 project files.\n</code></pre> \u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u4f7f\u7528 <code>ninja</code> \u6765\u7f16\u8bd1\u9879\u76ee\uff1a <pre><code>$ cd .. &amp;&amp; rm -rf build\n$ mkdir build &amp;&amp; cd build\n$ cmake .. -G\"Ninja\"\n-- The C compiler identification is GNU 10.3.0\n-- The CXX compiler identification is GNU 10.3.0\n-- Check for working C compiler: /usr/bin/cc\n-- Check for working C compiler: /usr/bin/cc -- works\n# ...\n-- Configuring done\n-- Generating done\n-- Build files have been written to: /home/howard/a/build    \n$ ninja\n[5/5] Linking CXX executable main\n$ ./main\nadd(1, 2) = 3\nsub(1, 2) = -1\n</code></pre></p>"},{"location":"meta-build-system/cmake/#\u4f7f\u7528\u5efa\u8bae","title":"\u4f7f\u7528\u5efa\u8bae","text":"<p>CMake \u5176\u5b9e\u5b58\u5728\u5f88\u591a\u8bbe\u8ba1\u4e0a\u7684\u7f3a\u9677\uff0c\u4f8b\u5982\u5927\u91cf\u4f7f\u7528\u5168\u5c40\u53d8\u91cf\u8fdb\u884c\u4f20\u53c2\uff0c\u8fd8\u6709\u6df7\u4e71\u7684\u8bed\u6cd5\uff0c\u90fd\u662f\u4f7f\u7528 CMake \u7684\u4e00\u9053\u95e8\u69db\uff0c\u800c\u4e14 CMake \u7684\u6307\u4ee4\u4e5f\u5f88\u96be\u8bb0\u5f97\u4f4f\uff0c\u5b83\u7684\u201c\u58f0\u660e\u5f0f\u547d\u4ee4\u201d\u4e5f\u662f\u51fa\u4e86\u540d\u7684\u96be\u8c03\u8bd5\u3002\u6240\u4ee5\uff0c\u5efa\u8bae\u5728\u4f7f\u7528 CMake \u7684\u65f6\u5019\uff0c\u5148\u627e\u51e0\u4e2a\u5bb9\u6613\u7406\u89e3\u7684 CMake \u9879\u76ee\uff0c\u7136\u540e\u590d\u5236\u7c98\u8d34\u9700\u8981\u7684\u90e8\u5206\uff0c\u800c\u4e0d\u662f\u6bcf\u6b21\u90fd\u4ece\u5934\u5199\u3002\u5f53\u7136\u4f60\u4e5f\u53ef\u4ee5\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\uff0c\u6574\u7406\u81ea\u5df1\u5e38\u7528\u7684 CMake \u4ee3\u7801\u7247\u6bb5\uff0c\u4ee5\u540e\u76f4\u63a5\u4ee5\u6b64\u4e3a\u6a21\u677f\u8fdb\u884c\u4fee\u6539\u5373\u53ef\u3002</p>"},{"location":"meta-build-system/gn/","title":"GN","text":"<p>GN \u662f Chromium \u6240\u4f7f\u7528\u7684\u6784\u5efa\u5de5\u5177\uff0c\u5168\u79f0\u662f Generate Ninja\uff0c\u4f7f\u7528\u4e86\u548c Bazel \u7c7b\u4f3c\u7684\u8bed\u6cd5\u6765\u63cf\u8ff0\u9879\u76ee\uff0c\u6bd4 Bazel \u8f7b\u91cf\uff0c\u4e0d\u9700\u8981\u542f\u52a8\u4e00\u4e2a\u672c\u5730\u670d\u52a1\u5668\uff0c\u8de8\u5e73\u53f0\u4e5f\u505a\u5f97\u66f4\u597d\u3002</p>"},{"location":"meta-build-system/third-party-library/","title":"\u5728\u9879\u76ee\u4e2d\u4f7f\u7528\u7b2c\u4e09\u65b9\u5e93","text":"<p>\u968f\u7740\u8ba1\u7b97\u673a\u6280\u672f\u7684\u53d1\u5c55\uff0c\u73b0\u5728\u57fa\u672c\u4e0d\u53ef\u80fd\u4ece\u5934\u5f00\u59cb\u7f16\u5199\u4e00\u4e2a\u590d\u6742\u7684\u9879\u76ee\uff0c\u5b83\u4eec\u591a\u5c11\u90fd\u9700\u8981\u4f9d\u8d56\u5176\u4ed6\u7684\u5e93\u3002\u7136\u800c\uff0cC++ \u793e\u533a\u5e76\u6ca1\u6709\u50cf Go\u3001Rust \u7b49\u8bed\u8a00\u63d0\u4f9b\u4e86\u7edf\u4e00\u7684\u5305\u7ba1\u7406\u7cfb\u7edf\uff0c\u6bcf\u4e2a\u9879\u76ee\u90fd\u6709\u81ea\u5df1\u504f\u597d\u7684\u7b2c\u4e09\u65b9\u4f9d\u8d56\u7ba1\u7406\u65b9\u5f0f\u3002\u56e0\u6b64\uff0c\u5982\u4f55\u7ba1\u7406\u4ee5\u53ca\u4f7f\u7528\u7b2c\u4e09\u65b9 C++ \u4f9d\u8d56\u662f\u4e00\u4ef6\u5341\u5206\u590d\u6742\u7684\u4e8b\u60c5\u3002\u6211\u4eec\u9700\u8981\u6839\u636e\u7b2c\u4e09\u65b9\u9879\u76ee\u63d0\u4f9b\u7684\u914d\u7f6e\u6587\u4ef6\u548c\u81ea\u5df1\u7684\u559c\u597d\uff0c\u6765\u786e\u5b9a\u5408\u9002\u7684\u5f15\u7528\u65b9\u5f0f\u3002</p> <p>\u4e3a\u4ec0\u4e48\u5927\u5bb6\u90fd\u89c9\u5f97 C++ \u7f16\u7a0b\u9ebb\u70e6\uff0c\u5176\u4e2d\u4e5f\u6709\u4e00\u70b9\u662f\u56e0\u4e3a C++ \u4e0d\u50cf Python \u7b49\u7f16\u7a0b\u8bed\u8a00\u6709\u6807\u51c6\u4ee5\u53ca\u5b8c\u5584\u7684\u5305\u7ba1\u7406\u5668\uff0c\u53ef\u4ee5\u5feb\u901f\u5730\u5728\u9879\u76ee\u4e2d\u5f15\u5165\u4f9d\u8d56\u3002C++ \u4e2d\u4f7f\u7528\u5176\u4ed6\u4eba\u7684\u4f9d\u8d56\u591a\u591a\u5c11\u5c11\u9700\u8981\u638c\u63e1\u7a0b\u5e8f\u7684\u7f16\u8bd1\u94fe\u63a5\u77e5\u8bc6\uff0c\u800c\u4e14\u9700\u8981\u81ea\u5df1\u624b\u52a8\u89e3\u51b3\u4f20\u9012\u4f9d\u8d56\u95ee\u9898\u3002\u5982\u679c\u80fd\u65b9\u4fbf\u5730\u5f15\u7528\u5176\u4ed6\u4eba\u7684\u4ee3\u7801\u4ee5\u53ca\u4f7f\u7528\u5e93\uff0cC++ \u7f16\u7a0b\u4f1a\u7b80\u5355\u5f88\u591a\u3002</p>"},{"location":"meta-build-system/third-party-library/#\u4f9d\u8d56\u7ba1\u7406\u65b9\u5f0f\u6982\u89c8","title":"\u4f9d\u8d56\u7ba1\u7406\u65b9\u5f0f\u6982\u89c8","text":"<p>\u603b\u7684\u6765\u8bf4\uff0c\u7b2c\u4e09\u65b9\u7684\u4f9d\u8d56\u7ba1\u7406\u6709\u51e0\u79cd\u65b9\u5f0f\uff0c\u6709\u7684\u65b9\u4fbf\u5f00\u53d1\u8005\u5f00\u7bb1\u5373\u7528\uff0c\u4f46\u662f\u4f1a\u5360\u7528\u66f4\u591a\u7a7a\u95f4\uff0c\u6709\u7684\u9700\u8981\u5f00\u53d1\u8005\u81ea\u884c\u5904\u7406\u4f9d\u8d56\uff0c\u597d\u5904\u662f\u591a\u4e2a\u9879\u76ee\u53ef\u4ee5\u5171\u4eab\u4f9d\u8d56\u8282\u7701\u7a7a\u95f4\u3002</p>"},{"location":"meta-build-system/third-party-library/#\u9879\u76ee\u81ea\u884c\u7ba1\u7406\u4f9d\u8d56","title":"\u9879\u76ee\u81ea\u884c\u7ba1\u7406\u4f9d\u8d56","text":"<p>\u9879\u76ee\u81ea\u884c\u7ba1\u7406\u4f9d\u8d56\u7684\u610f\u601d\u662f\uff0c\u9879\u76ee\u9700\u8981\u4ec0\u4e48\u4f9d\u8d56\uff0c\u90fd\u5728\u9879\u76ee\u81ea\u5df1\u5305\u542b\u4f9d\u8d56\u7684\u6e90\u4ee3\u7801\u7b49\uff0c\u505a\u5230\u5176\u4ed6\u5f00\u53d1\u8005\u514b\u9686\u4ee3\u7801\u540e\u4ec5\u9700\u8981\u5b89\u88c5\u57fa\u672c\u7684\u6784\u5efa\u5de5\u5177\u94fe\u5373\u53ef\u6784\u5efa\u3002\u8fd9\u79cd\u6a21\u5f0f\u4e5f\u79f0\u4e3a vendor \u6a21\u5f0f\u3002</p> <ol> <li> <p>\u76f4\u63a5\u5c06\u6e90\u4ee3\u7801\u62f7\u8d1d\u5230\u9879\u76ee\u76ee\u5f55\u4e0b\uff0c\u4e00\u822c\u8fd9\u4e2a\u76ee\u5f55\u4f1a\u53eb <code>third_party</code>\u3002\u4f8b\u5982\uff0c\u6211\u4eec\u9700\u8981\u4f9d\u8d56 Google Test\uff0c\u5c31\u5c06\u5b83\u7684\u6e90\u4ee3\u7801\u653e\u5728 <code>third_party/googletest-1.0</code> \u4e0b\u3002</p> </li> <li> <p>\u5c06\u7b2c\u4e09\u65b9\u9879\u76ee\u4f5c\u4e3a Git Submodule \u4fdd\u5b58\u5230\u9879\u76ee\u76ee\u5f55\u4e0b\u3002\u8fd9\u79cd\u65b9\u5f0f\u548c\u7b2c\u4e00\u79cd\u65b9\u5f0f\u7c7b\u4f3c\uff0c\u540c\u6837\u4e5f\u662f\u628a\u6e90\u4ee3\u7801\u4fdd\u5b58\u5728\u4e86\u9879\u76ee\u76ee\u5f55\u91cc\uff0c\u4e0d\u540c\u7684\u662f\u4f7f\u7528 Git Submodule \u7684\u8bdd\u53ef\u4ee5\u66f4\u65b9\u4fbf\u5730\u7ba1\u7406\u7248\u672c\u3002\u4f8b\u5982\uff0c\u6211\u4eec\u9700\u8981\u4f9d\u8d56 Google Test\uff0c\u5c31\u4f7f\u7528 <code>git submodule add https://github.com/google/googletest third_party/googletest</code> \u547d\u4ee4\uff0c\u5c06\u4f9d\u8d56\u4fdd\u5b58\u5230 <code>third_party</code> \u76ee\u5f55\u4e0b\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5982\u679c\u4f7f\u7528\u4e86 submodule\uff0c\u90a3\u4e48\u9700\u8981\u63d0\u9192\u5176\u4ed6\u5f00\u53d1\u8005\u8bb0\u5f97\u521d\u59cb\u5316 submodule\u3002\u4f8b\u5982\u4f7f\u7528 <code>git clone --recurse-submodules</code> \u514b\u9686\u9879\u76ee\u3002</p> </li> </ol> Git Subtree <p>Git Submodule \u4f1a\u5f15\u5165 <code>.gitmodule</code> \u6587\u4ef6\uff0c\u5728\u5f00\u53d1\u8005\u514b\u9686\u4ed3\u5e93\u7684\u65f6\u5019\u4e5f\u9700\u8981\u989d\u5916\u7684\u9009\u9879\u6216\u8005\u64cd\u4f5c\u624d\u80fd\u5c06\u5b50\u9879\u76ee\u5b8c\u6574\u4e0b\u8f7d\u4e0b\u6765\uff0c\u800c\u4e14 Git Submodule \u9700\u8981\u7684 Git \u7248\u672c\u6bd4\u8f83\u9ad8\u3002</p> <p>\u4f5c\u4e3a\u66ff\u4ee3\uff0c\u53ef\u4ee5\u4f7f\u7528 Git Subtree \u6307\u4ee4\u3002\u4e25\u683c\u6765\u8bf4\u5b83\u5176\u5b9e\u662f\u4e00\u4e2a Git \u811a\u672c\uff0c\u800c\u4e0d\u662f Git \u7684\u539f\u751f\u529f\u80fd\uff0c\u5b83\u4e0d\u521b\u5efa\u989d\u5916\u7684\u5143\u4fe1\u606f\u6587\u4ef6\uff0c\u800c\u662f\u5c06\u5143\u4fe1\u606f\u4fdd\u5b58\u5230 Commit \u8bb0\u5f55\u4e2d\u3002\u4f7f\u7528 Git Subtree \u7684\u597d\u5904\u548c\u76f4\u63a5\u5c06\u6e90\u4ee3\u7801\u62f7\u8d1d\u5230\u9879\u76ee\u76ee\u5f55\u91cc\u4e00\u6837\uff0c\u5176\u4ed6\u5f00\u53d1\u8005\u5f00\u7bb1\u5373\u7528\uff0c\u610f\u8bc6\u4e0d\u5230 Submodule \u7684\u5b58\u5728\u3002\u7f3a\u70b9\u5c31\u662f\u6bd4\u8f83\u6162\uff0c\u800c\u4e14\u9700\u8981\u6ce8\u610f\u4e0d\u8981\u5728\u540c\u4e00\u4e2a Commit \u4e2d\u63d0\u4ea4\u5b50\u9879\u76ee\u548c\u7236\u9879\u76ee\u7684\u4ee3\u7801\u4fee\u6539\u3002\u8003\u8651\u5230\u4f9d\u8d56\u5f88\u5c11\u4fee\u6539\uff0c\u8fd9\u4e9b\u4ee3\u4ef7\u4e5f\u53ef\u4ee5\u63a5\u53d7\u3002</p>"},{"location":"meta-build-system/third-party-library/#\u5f00\u53d1\u8005\u7ba1\u7406\u4f9d\u8d56","title":"\u5f00\u53d1\u8005\u7ba1\u7406\u4f9d\u8d56","text":"<p>\u4ec5\u5728\u6587\u6863\u4e2d\u8bf4\u660e\u9700\u8981\u4ec0\u4e48\u5e93\uff0c\u8ba9\u5f00\u53d1\u8005\u81ea\u884c\u5b89\u88c5\uff0c\u5e76\u63d0\u4f9b\u7f16\u8bd1\u9009\u9879\u8ba9\u5f00\u53d1\u8005\u6307\u5b9a\u8def\u5f84\u3002\u57fa\u672c\u4e0a\u4f7f\u7528 Autotools \u7684\u90fd\u662f\u8fd9\u79cd\u6a21\u5f0f\uff0c\u6bd4\u5982 <code>./configure</code> \u811a\u672c\u9ed8\u8ba4\u4f1a\u53bb\u67e5\u627e\u9879\u76ee\u6240\u9700\u7684\u5e93\uff0c\u627e\u4e0d\u5230\u5c31\u76f4\u63a5\u62a5\u9519\u3002\u5f00\u53d1\u8005\u8981\u4e48\u5c06\u5e93\u5b89\u88c5\u5230\u7cfb\u7edf\u76ee\u5f55\u91cc\uff0c\u8981\u4e48\u5728\u67e5\u627e\u8def\u5f84\u91cc\u6dfb\u52a0\u5e93\u7684\u76ee\u5f55\uff0c\u8981\u4e48\u5728 <code>./configure</code> \u65f6\u4f7f\u7528 <code>--with-***</code> \u9009\u9879\u6765\u6307\u5b9a\u9879\u76ee\u6240\u9700\u5e93\u7684\u8def\u5f84\u3002\u4e3a\u4e86\u65b9\u4fbf\u5f00\u53d1\uff0c\u8fd9\u79cd\u65b9\u5f0f\u4e00\u822c\u4f1a\u5728\u6587\u6863\u4e2d\u63d0\u4f9b\u4f9d\u8d56\u5b89\u88c5\u7684\u65b9\u5f0f\uff0c\u8ba9\u5f00\u53d1\u8005\u624b\u52a8\u5b89\u88c5\u3002</p> <ul> <li>\u4f7f\u7528\u7cfb\u7edf\u5305\u7ba1\u7406\u5668\u3002\u4f8b\u5982\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u9879\u76ee\u6587\u6863\u4e2d\u8bf4\u660e\u9700\u8981\u5b89\u88c5 <code>libgoogletest-dev</code> \u8fd9\u4e2a\u5305\u3002\u8fd9\u79cd\u65b9\u5f0f\u4f1a\u6c61\u67d3\u5168\u5c40\u73af\u5883\uff0c\u4e00\u822c\u4e0d\u5efa\u8bae\u4f7f\u7528\u3002</li> <li>\u4ec5\u8bf4\u660e\u4f9d\u8d56\u7248\u672c\uff0c\u8ba9\u5f00\u53d1\u8005\u81ea\u884c\u4e0b\u8f7d\u4f9d\u8d56\u7f16\u8bd1\u5b89\u88c5\u3002\u8fd9\u79cd\u65b9\u5f0f\u6bd4\u8f83\u9ebb\u70e6\uff0c\u5982\u679c\u5176\u4ed6\u4f9d\u8d56\u4e5f\u6709\u4f9d\u8d56\u7684\u8bdd\uff0c\u9700\u8981\u4eba\u624b\u5de5\u89e3\u51b3\u3002</li> <li>\u4f7f\u7528\u7b2c\u4e09\u65b9\u5305\u7ba1\u7406\u5668\u3002\u4f8b\u5982 <code>vcpkg</code>\u3001<code>conan</code>\u3001<code>pkg-config</code> \u7b49\uff0c\u8fd9\u79cd\u65e2\u4e0d\u4f1a\u6c61\u67d3\u5168\u5c40\u73af\u5883\uff0c\u4e5f\u80fd\u81ea\u52a8\u5904\u7406\u4f9d\u8d56\u5173\u7cfb\uff0c\u7f3a\u70b9\u662f\u53ef\u80fd\u5305\u5e76\u4e0d\u662f\u5f88\u5168\u6216\u8005\u6700\u65b0\u3002</li> </ul>"},{"location":"meta-build-system/third-party-library/#\u6df7\u5408\u7ba1\u7406","title":"\u6df7\u5408\u7ba1\u7406","text":"<p>\u5f53\u7136\uff0c\u7531\u4e8e C++ \u9879\u76ee\u7684\u590d\u6742\uff0c\u4e00\u822c\u4f1a\u51fa\u73b0\u591a\u79cd\u7ba1\u7406\u65b9\u5f0f\u6df7\u7528\u7684\u60c5\u51b5\u3002\u6bd4\u5982\u8bf4\uff0c\u50cf <code>boost</code> \u8fd9\u79cd\u5e9e\u5927\u800c\u5e38\u7528\u7684\u5e93\uff0c\u9879\u76ee\u5c31\u6ca1\u5fc5\u8981\u5c06\u5b83\u7684\u4ee3\u7801\u4e5f\u653e\u5230\u81ea\u5df1\u4ed3\u5e93\u4e2d\uff0c\u8ba9\u5f00\u53d1\u8005\u81ea\u5df1\u5b89\u88c5\u5373\u53ef\u3002\u800c\u6709\u4e9b\u7cfb\u7edf\u5e93\uff0c\u4f8b\u5982 <code>libcg</code>\uff0c\u5219\u6700\u597d\u662f\u4f7f\u7528\u5305\u7ba1\u7406\u5668\u5b89\u88c5\u9002\u5408\u7cfb\u7edf\u7684\u7248\u672c\u3002</p>"},{"location":"meta-build-system/third-party-library/#\u793a\u4f8b","title":"\u793a\u4f8b","text":"<p>\u4e0b\u9762\u63d0\u4f9b\u51e0\u79cd\u4e0d\u540c\u5f15\u7528\u9879\u76ee\u4f9d\u8d56\u7684\u65b9\u5f0f\uff0c\u6765\u8ba9\u4f60\u4f53\u9a8c\u4e00\u4e0b C++ \u4e2d\u5305\u7ba1\u7406\u7684\u590d\u6742\u548c\u591a\u6837\u3002</p>"},{"location":"meta-build-system/third-party-library/#cmake-\u6587\u4ef6","title":"<code>.cmake</code> \u6587\u4ef6","text":"<p>\u5982\u679c\u4f60\u662f\u7528\u7cfb\u7edf\u81ea\u5e26\u7684\u5305\u7ba1\u7406\u5668\u5b89\u88c5\u7684\u5f00\u53d1\u5e93\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5e93\u6709\u53ef\u80fd\u5df2\u7ecf\u63d0\u4f9b\u4e86 <code>.cmake</code> \u6587\u4ef6\uff0c\u91cc\u9762\u5185\u7f6e\u4e86\u4f7f\u7528\u8fd9\u4e2a\u5e93\u6240\u9700\u8981\u7684\u547d\u4ee4\u3002\u8fd9\u65f6\u5019\u53ef\u4ee5\u7b80\u5355\u5730\u4f7f\u7528 <code>find_package</code> \u6765\u8ba9 CMake \u5e2e\u6211\u4eec\u52a0\u8f7d\u914d\u7f6e\u6587\u4ef6\u3002\u6211\u4eec\u4ee5 <code>fmt</code> \u5e93\u4e3a\u4f8b\uff1a</p> <pre><code>$ sudo apt install libfmt-dev\n</code></pre> CMakeLists.txt <pre><code>find_package(fmt)\ntarget_link_libraries(my-server fmt)\n</code></pre>"},{"location":"meta-build-system/third-party-library/#cmakeliststxt","title":"CMakeLists.txt","text":"<p>\u6709\u4e00\u4e9b\u5f00\u6e90\u9879\u76ee\u53ef\u80fd\u63d0\u4f9b\u4e86 <code>CMakeLists.txt</code>\uff0c\u6216\u8005\u6211\u4eec\u60f3\u5f15\u7528\u6211\u4eec\u81ea\u5df1\u6216\u8005\u540c\u4e8b\u3001\u540c\u5b66\u5199\u7684 CMake \u9879\u76ee\uff0c\u8fd9\u65f6\u5019\u53ef\u4ee5\u7528 <code>add_subdirectory</code> \u6765\u6dfb\u52a0\u4f9d\u8d56\uff0c\u6839\u636e\u7b2c\u4e09\u65b9\u4f9d\u8d56\u4e0d\u540c\u7684\u653e\u7f6e\u4f4d\u7f6e\uff0c\u5f15\u7528\u7684\u65b9\u5f0f\u4e5f\u4e0d\u592a\u4e00\u6837\u3002</p>"},{"location":"meta-build-system/third-party-library/#\u4f9d\u8d56\u662f\u9879\u76ee\u7684\u5b50\u6587\u4ef6\u5939","title":"\u4f9d\u8d56\u662f\u9879\u76ee\u7684\u5b50\u6587\u4ef6\u5939","text":"<p>\u5047\u5982\u6211\u4eec\u7684\u9879\u76ee\u4f4d\u4e8e <code>my-server</code> \u6587\u4ef6\u5939\uff0c\u5982\u679c\u7b2c\u4e09\u65b9\u4f9d\u8d56\u653e\u5728\u4e86 <code>my-server/third_party</code>\uff0c\u662f\u9879\u76ee\u7684\u5b50\u6587\u4ef6\u5939\uff0c\u90a3\u4e48\u6211\u4eec\u76f4\u63a5\u4f7f\u7528 <code>add_subdirectory</code>\uff0c\u7136\u540e\u4f7f\u7528\u5bf9\u5e94\u7684 target \u540d\u79f0\u5373\u53ef\u3002\u4f8b\u5982\uff0c\u5047\u5982\u6211\u4eec\u4f7f\u7528\u4e86\u4e00\u4e2a\u53eb <code>cpr</code> \u7684 CMake \u9879\u76ee\uff0c\u653e\u5728\u4e86 <code>my-server/third_party/cpr</code> \u4e0b\uff0c\u6211\u4eec\u53ef\u4ee5\u8fd9\u4e48\u5f15\u7528\uff1a</p> CMakeLists.txt <pre><code>add_subdirectory(\"${CMAKE_CURRENT_SOURCE_DIR}/third_party/cpr\")\ntarget_link_libraries(my-server cpr)\n</code></pre>"},{"location":"meta-build-system/third-party-library/#\u4f9d\u8d56\u548c\u9879\u76ee\u653e\u5728\u540c\u4e00\u4e2a\u5c42\u7ea7","title":"\u4f9d\u8d56\u548c\u9879\u76ee\u653e\u5728\u540c\u4e00\u4e2a\u5c42\u7ea7","text":"<p>\u5047\u5982\u6211\u4eec\u7f16\u5199\u4e86\u51e0\u4e2a\u9879\u76ee <code>my-server</code>\u3001<code>another-server</code>\uff0c\u5982\u679c\u90fd\u7528\u5230\u4e86\u540c\u4e00\u4e2a\u4f9d\u8d56\uff0c\u90a3\u4e48\u5728\u6bcf\u4e2a\u9879\u76ee\u91cc\u90fd\u653e\u4e00\u4efd\u4ee3\u7801\u53ef\u80fd\u4f1a\u6d6a\u8d39\u7a7a\u95f4\uff0c\u800c\u4e14\u66f4\u65b0\u4f9d\u8d56\u4e5f\u9700\u8981\u5206\u522b\u66f4\u65b0\uff0c\u8fd9\u65f6\u5019\u6211\u4eec\u5e0c\u671b\u5c06\u7b2c\u4e09\u65b9\u4f9d\u8d56\u653e\u5230\u548c\u4ed6\u4eec\u540c\u4e00\u4e2a\u7ea7\u522b\u7684 <code>third_party</code> \u76ee\u5f55\u4e2d\uff0c\u8fd8\u662f\u4ee5 <code>cpr</code> \u9879\u76ee\u4e3a\u4f8b\uff0c\u5047\u5982\u6211\u4eec\u628a\u4f9d\u8d56\u653e\u5728\u4e86 <code>third_party/cpr</code> \u4e0b\uff0c\u90a3\u4e48\u5728 <code>my-server</code> \u4e2d\uff0c\u6211\u4eec\u9700\u8981\u8fd9\u4e48\u5199\uff1a</p> CMakeLists.txt <pre><code>add_subdirectory(\"${CMAKE_CURRENT_LIST_DIR}/../third_party/cpr\" cpr.build)\ntarget_link_libraries(my-server cpr)\n</code></pre> Try it <p>\u5c1d\u8bd5\u4e0d\u6307\u5b9a <code>add_subdirectory</code> \u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\uff0c\u770b\u770b CMake \u7684\u62a5\u9519\u3002</p> <p>\u548c\u524d\u9762\u7684\u5dee\u4e0d\u591a\uff0c\u6211\u4eec\u540c\u6837\u901a\u8fc7 <code>add_subdirectory</code> \u6307\u5b9a\u9879\u76ee\u7684\u8def\u5f84\uff0c\u4f46\u662f\uff0c\u7531\u4e8e\u73b0\u5728\u5305\u542b\u7684\u8def\u5f84\u4e0d\u662f\u9879\u76ee\u7684\u5b50\u6587\u4ef6\u5939\u4e86\uff0c\u9700\u8981\u6211\u4eec\u624b\u52a8\u6307\u5b9a\u4f9d\u8d56\u7f16\u8bd1\u5b58\u653e\u7684\u8def\u5f84\uff0c\u4e5f\u5c31\u662f <code>add_subdirectory</code> \u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\u3002</p>"},{"location":"meta-build-system/third-party-library/#\u6784\u5efa\u65f6\u518d\u4e0b\u8f7d","title":"\u6784\u5efa\u65f6\u518d\u4e0b\u8f7d","text":"<p>\u5982\u679c\u4e0d\u60f3\u5c06\u4ee3\u7801\u4e0b\u8f7d\u5230\u81ea\u5df1\u7684\u4ee3\u7801\u5e93\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>FetchContent</code> \u5728\u6784\u5efa\u7684\u65f6\u5019\u518d\u4e0b\u8f7d\uff0c\u4f8b\u5982\uff1a</p> CMakeLists.txt <pre><code>include(FetchContent)\nFetchContent_Declare(cpr GIT_REPOSITORY https://github.com/whoshuu/cpr.git GIT_TAG c8d33915dbd88ad6c92b258869b03aba06587ff9)\nFetchContent_MakeAvailable(cpr)\n\ntarget_link_libraries(my-server cpr)\n</code></pre>"},{"location":"meta-build-system/third-party-library/#pkg-config","title":"pkg-config","text":"<p>\u6709\u4e00\u4e9b\u5e93\u63d0\u4f9b\u4e86 <code>pkg-config</code> \u6587\u4ef6\uff0c\u540e\u7f00\u540d\u662f <code>.pc</code>\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 <code>pkg-config</code> \u547d\u4ee4\u6765\u5728\u7f16\u8bd1\u7684\u65f6\u5019\u8f93\u51fa\u5408\u9002\u7684\u7f16\u8bd1\u53c2\u6570\u3002\u4f8b\u5982\uff1a</p> <pre><code>$ sudo apt install libmysqlclient-dev\n$ pkg-config --libs --cflags mysqlclient\n-I/usr/include/mysql -lmysqlclient\n$ g++ main.cpp `pkg-config --libs --cflags mysqlclient`\n</code></pre> <p>\u5728 CMake \u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7 <code>PkgConfig</code> \u8fd9\u4e2a\u5305\u53ca\u5176\u63d0\u4f9b\u7684 <code>pkg_check_modules</code> \u547d\u4ee4\u65b9\u4fbf\u5730\u5f15\u7528\u5df2\u7ecf\u5b58\u5728\u7684 <code>pkg-config</code> \u6587\u4ef6\u3002\u4ee5 <code>mysqlclient</code> \u8fd9\u4e2a\u5e93\u4e3a\u4f8b\uff0c\u5b83\u6ca1\u6709\u63d0\u4f9b <code>.cmake</code> \u6587\u4ef6\uff0c\u4e5f\u6ca1\u6709 <code>CMakeLists.txt</code>\uff0c\u4f46\u662f\u63d0\u4f9b\u4e86 <code>pkg-config</code> \u6587\u4ef6\uff1a</p> CMakeLists.txt <pre><code>find_package(PkgConfig REQUIRED)\npkg_check_modules(MySQL REQUIRED IMPORTED_TARGET mysqlclient&gt;=21.0)\ntarget_link_libraries(my-server PkgConfig::MySQL)\n</code></pre> <p>\u5176\u4e2d <code>pkg_check_modules</code> \u7b2c\u4e00\u4e2a\u53c2\u6570\u4e3a\u5f15\u5165\u540e\u7684\u53d8\u91cf\u524d\u7f00\uff0c\u8fd9\u4e2a\u4f8b\u5b50\u91cc\uff0c\u4f1a\u5f15\u5165 <code>MySQL_LIBRARIES</code> \u7b49\u53d8\u91cf\u3002\u4e3a\u4e86\u65b9\u4fbf\u4f7f\u7528\uff0c\u8fd8\u53ef\u4ee5\u901a\u8fc7 <code>IMPORTED_TARGET</code> \u6765\u63d0\u4f9b <code>PkgConfig::MySQL</code> \u8fd9\u6837\u7684\u5f15\u5165\u5f62\u5f0f\uff0c\u6700\u540e\u4fbf\u662f\u6307\u5b9a\u5305\u540d\u4ee5\u53ca\u5305\u7248\u672c\u53f7\u3002</p>"},{"location":"meta-build-system/third-party-library/#vcpkg","title":"vcpkg","text":"<p>vcpkg \u662f\u5fae\u8f6f\u51fa\u54c1\u7684\u4e00\u6b3e\u8de8\u5e73\u53f0 C++ \u5305\u7ba1\u7406\u8f6f\u4ef6\uff0c\u4e3b\u8981\u670d\u52a1 CMake \u7528\u6237\u3002vcpkg \u548c\u7cfb\u7edf\u5305\u7ba1\u7406\u7cfb\u7edf\u7c7b\u4f3c\uff0c\u76f4\u63a5\u4f7f\u7528 <code>vcpkg install ***</code> \u5c31\u53ef\u4ee5\u5168\u81ea\u52a8\u5730\u5b89\u88c5\u4e00\u4e2a\u7b2c\u4e09\u65b9\u5e93\u3002\u4e0d\u540c\u7684\u662f\uff0cvcpkg \u793e\u533a\u4f1a\u7ef4\u62a4\u9879\u76ee\u7684 CMake \u6587\u4ef6\uff0c\u8fd9\u6837\u4f7f\u7528 vcpkg \u5b89\u88c5\u7684\u5305\u90fd\u53ea\u9700\u8981\u5728 <code>CMakeLists.txt</code> \u4e2d\u4f7f\u7528 <code>find_package</code> \u6307\u4ee4\u5373\u53ef\u8f7b\u677e\u4f7f\u7528\uff0c\u540c\u65f6 vcpkg \u4e5f\u4e0d\u4f1a\u5c06\u5e93\u5b89\u88c5\u5230\u7cfb\u7edf\u4e2d\uff0c\u5728\u4f7f\u7528 CMake \u7684\u65f6\u5019\u9700\u8981\u5148\u5bfc\u5165 vcpkg \u63d0\u4f9b\u7684 CMake \u6587\u4ef6\u3002</p> <p>\u4f7f\u7528 vcpkg \u9996\u5148\u9700\u8981\u4ece\u6e90\u7801\u7f16\u8bd1 vcpkg\uff1a</p> <pre><code>$ git clone https://github.com/Microsoft/vcpkg.git &amp;&amp; cd vcpkg\n$ ./vcpkg/bootstrap-vcpkg.sh\n$ ./vcpkg integrate install\nApplied user-wide integration for this vcpkg root.\n\nCMake projects should use: \"-DCMAKE_TOOLCHAIN_FILE=/home/howard/vcpkg/scripts/buildsystems/vcpkg.cmake\"\n</code></pre> <p>\u7136\u540e\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528 <code>vcpkg install</code> \u6307\u4ee4\u5b89\u88c5\u7b2c\u4e09\u65b9\u5305\uff1a</p> <pre><code>$ ./vcpkg install fmt\nComputing installation plan...\nThe following packages will be built and installed:\n    fmt[core]:x64-linux -&gt; 7.1.3#5\n  * vcpkg-cmake[core]:x64-linux -&gt; 2021-06-25#5\n  * vcpkg-cmake-config[core]:x64-linux -&gt; 2021-05-22#1\n# ...\nTotal elapsed time: 12.03 s\n\nThe package fmt provides CMake targets:\n\n    find_package(fmt CONFIG REQUIRED)\n    target_link_libraries(main PRIVATE fmt::fmt)\n\n    # Or use the header-only version\n    find_package(fmt CONFIG REQUIRED)\n    target_link_libraries(main PRIVATE fmt::fmt-header-only)\n</code></pre> <p>\u8fd9\u6837\uff0c\u6211\u4eec\u53ea\u9700\u8981\u6309\u7167\u6307\u793a\uff0c\u5728 <code>CMakeLists.txt</code> \u4e2d\u6dfb\u52a0 <code>find_package</code> \u6307\u4ee4\uff0c\u7136\u540e\u5728\u4f7f\u7528 CMake \u914d\u7f6e\u9879\u76ee\u7684\u65f6\u5019\uff0c\u6307\u5b9a <code>-DCMAKE_TOOLCHAIN_FILE</code> \u9009\u9879\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528 vcpkg \u63d0\u4f9b\u7684\u5305\u4e86\u3002</p> CMakeLists.txt <pre><code>find_package(fmt CONFIG REQUIRED)\ntarget_link_libraries(my-server fmt)\n</code></pre> <pre><code>$ mkdir build &amp;&amp; cd build\n$ cmake .. -DCMAKE_TOOLCHAIN_FILE=/home/howard/vcpkg/scripts/buildsystems/vcpkg.cmake\n</code></pre>"},{"location":"metrics/","title":"\u6982\u89c8","text":"<p>\u65e5\u5fd7\u7cfb\u7edf\u53ef\u4ee5\u7ed9\u6211\u4eec\u63d0\u4f9b\u8be6\u7ec6\u7684\u7a0b\u5e8f\u8fd0\u884c\u72b6\u6001\u4fe1\u606f\uff0c\u4f46\u662f\u5206\u6790\u8d77\u6765\u6bd4\u8f83\u9ebb\u70e6\u3002\u901a\u5e38\uff0c\u6211\u4eec\u8fd8\u4f1a\u5728\u65e5\u5fd7\u7cfb\u7edf\u4ee5\u5916\uff0c\u4f7f\u7528\u7b80\u5355\u7684\u6307\u6807\u7cfb\u7edf\u6765\u76d1\u63a7\u7a0b\u5e8f\u8fd0\u884c\u72b6\u6001\u3002\u4f8b\u5982\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u8ba1\u6570\u5668\u6765\u7edf\u8ba1\u7a0b\u5e8f\u5904\u7406\u4e86\u591a\u5c11\u8bf7\u6c42\uff0c\u5176\u4e2d\u591a\u5c11\u662f\u5931\u8d25\u7684\u3002\u53c8\u6216\u8005\u6211\u4eec\u53ef\u4ee5\u7edf\u8ba1\u7a0b\u5e8f\u5904\u7406\u8bf7\u6c42\u7684\u5e73\u5747\u65f6\u95f4\u3002\u901a\u5e38\u6307\u6807\u7cfb\u7edf\u5bf9\u5916\u8868\u73b0\u5c31\u662f\u4e00\u4e2a\u7b80\u5355\u7684 <code>map&lt;string, float&gt;</code>\uff0c\u7531\u4e13\u95e8\u7684\u7a0b\u5e8f\u8d1f\u8d23\u6536\u96c6\u4e0d\u540c\u7684\u670d\u52a1\u5668\u7a0b\u5e8f\u66b4\u9732\u7684\u6307\u6807\uff0c\u8fdb\u884c\u805a\u5408\u7edf\u8ba1\u3002</p> <p>\u6307\u6807\u7edf\u8ba1\u4ee5\u540e\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u8bbe\u7f6e\u62a5\u8b66\u7cfb\u7edf\uff0c\u4f7f\u5f97\u6211\u4eec\u53ef\u4ee5\u5feb\u901f\u53d1\u73b0\u7a0b\u5e8f\u8fd0\u884c\u7684\u5f02\u5e38\u72b6\u6001\u3002\u4f8b\u5982\uff0c\u5982\u679c\u6211\u4eec\u53d1\u73b0\u7a0b\u5e8f\u5728\u8fc7\u53bb\u7684\u4e00\u5206\u949f\u7684\u9519\u8bef\u7387\u66b4\u589e\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u53d1\u9001\u4e00\u5c01\u90ae\u4ef6\u6216\u8005\u4e00\u6761\u77ed\u4fe1\u544a\u8bc9\u8d1f\u8d23\u4eba\u53ca\u65f6\u4ecb\u5165\u5904\u7406\u3002</p> <p>\u672c\u7ae0\u5c06\u4ecb\u7ecd\u5982\u4f55\u5728\u670d\u52a1\u5668\u7a0b\u5e8f\u4e2d\u6574\u5408\u5df2\u6709\u7684\u6307\u6807\u7cfb\u7edf\u5e93\u3002</p>"},{"location":"metrics/prometheus/","title":"\u4f7f\u7528 Prometheus \u6307\u6807\u5e93","text":"<p>Prometheus \u662f\u5e38\u7528\u7684\u6307\u6807\u5e93\u4e4b\u4e00\uff0c\u5b83\u53ea\u9700\u8981\u5f00\u53d1\u8005\u63d0\u4f9b\u4e00\u4e2a HTTP \u63a5\u53e3\uff0c\u5728\u8fd9\u4e2a\u63a5\u53e3\u4f7f\u7528\u7eaf\u6587\u672c\u8fd4\u56de\u4e00\u7cfb\u5217\u6307\u6807\u503c\u5373\u53ef\uff0c\u4f8b\u5982\uff1a</p> <pre><code>requests_served 12345\nuptime 25.23\noperations{ops=\"GET\"} 234\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u8fd9\u5c31\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u5e26\u6807\u7b7e\u7684 Key \u5230 Float \u7684\u6620\u5c04\u3002\u6211\u4eec\u53ef\u4ee5\u81ea\u5df1\u6574\u5408 HTTP \u670d\u52a1\u5668\u6765\u63d0\u4f9b\u8fd9\u4e2a\u63a5\u53e3\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u73b0\u6210\u7684\u5e93\u6765\u63d0\u4f9b\u3002</p> <p>Prometheus \u5e76\u4e0d\u662f\u4e00\u4e2a\u57fa\u4e8e\u4e8b\u4ef6\u7684\u76d1\u63a7\u7cfb\u7edf\uff0c\u4e5f\u5c31\u662f\u8bf4\u4e0d\u80fd\u6765\u4e00\u4e2a\u8bf7\u6c42\u5c31\u4e0a\u62a5\u4e00\u6b21\u6307\u6807\uff0c\u800c\u662f\u8981\u5728\u8fdb\u7a0b\u5185\u90e8\u5148\u8ba1\u7b97\u597d\u6307\u6807\uff0c\u4f8b\u5982\u589e\u52a0\u4e00\u4e2a\u8ba1\u6570\u5668\u3002</p>"},{"location":"metrics/prometheus/#\u62c9pull\u6a21\u5f0f","title":"\u62c9\uff08Pull\uff09\u6a21\u5f0f","text":"<p>Prometheus \u5e38\u7528\u7684\u662f\u62c9\u6a21\u5f0f\u7684\u4e0a\u62a5\u6a21\u5f0f\u3002\u5728\u62c9\u6a21\u5f0f\u4e0b\uff0c\u670d\u52a1\u8fdb\u7a0b\u5e76\u4e0d\u4f1a\u4e3b\u52a8\u5411\u6307\u6807\u7cfb\u7edf\u6c47\u62a5\u6307\u6807\uff0c\u800c\u662f\u7531\u6307\u6807\u7cfb\u7edf\u6839\u636e\u91c7\u6837\u95f4\u9694\uff0c\u5b9a\u65f6\u5730\u53bb\u8bbf\u95ee\u670d\u52a1\u8fdb\u7a0b\u63d0\u4f9b\u7684\u6307\u6807\u63a5\u53e3\uff0c\u7136\u540e\u4fdd\u5b58\u5230\u65f6\u5e8f\u6570\u636e\u5e93\u4e2d\u3002</p> \u91c7\u6837\u95f4\u9694\u7684\u8bbe\u7f6e <p>\u4e00\u822c\u6765\u8bf4\uff0c\u91c7\u6837\u95f4\u9694\u4f1a\u8bbe\u7f6e\u5728 10s \u5de6\u53f3\uff0c\u91c7\u6837\u95f4\u9694\u8fc7\u957f\u4f1a\u5bfc\u81f4\u6570\u636e\u66f4\u65b0\u9891\u7387\u4f4e\uff0c\u4e0d\u80fd\u5f88\u597d\u5730\u53cd\u6620\u7cfb\u7edf\u72b6\u51b5\uff0c\u800c\u91c7\u6837\u95f4\u9694\u8fc7\u77ed\u4e00\u65b9\u9762\u4f1a\u5bfc\u81f4\u670d\u52a1\u8fdb\u7a0b\u9700\u8981\u6d88\u8017\u66f4\u591a\u7684\u8d44\u6e90\u751f\u6210\u6307\u6807\u6570\u636e\uff0c\u53e6\u4e00\u65b9\u9762\u9700\u8981\u5b58\u50a8\u7684\u6570\u636e\u70b9\u4e5f\u66f4\u591a\uff0c\u5728\u6307\u6807\u805a\u5408\u7684\u65f6\u5019\u8ba1\u7b97\u91cf\u4e5f\u66f4\u5927\u3002</p>"},{"location":"metrics/prometheus/#\u63a8push\u6a21\u5f0f","title":"\u63a8\uff08Push\uff09\u6a21\u5f0f","text":"<p>\u5728\u6781\u5c11\u6570\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u4f7f\u7528 Push Gateway \u6765\u4e3b\u52a8\u4e0a\u62a5\u6307\u6807\u6570\u636e\u3002\u6bd4\u5982\uff0c\u4f60\u6709\u4e00\u4e2a\u6279\u5904\u7406\u4efb\u52a1\uff0c\u8fd0\u884c\u5b8c\u4e4b\u540e\u8fdb\u7a0b\u5c31\u7ed3\u675f\u4e86\uff0c\u8fd9\u65f6\u5019\u6307\u6807\u7cfb\u7edf\u5c31\u6ca1\u6709\u529e\u6cd5\u62c9\u53d6\u5230\u6307\u6807\u6570\u636e\uff0c\u9700\u8981\u8fdb\u7a0b\u5728\u7ed3\u675f\u4e4b\u524d\u4e0a\u62a5\u4e00\u6b21\u6570\u636e\u5230\u957f\u65f6\u95f4\u8fd0\u884c\u7684\u670d\u52a1\u8fdb\u7a0b\u6682\u65f6\u4fdd\u5b58\u4e0b\u6765\uff0cPrometheus \u518d\u53bb\u4f7f\u7528\u62c9\u6a21\u5f0f\u4ece\u8fd9\u4e2a\u670d\u52a1\u8fdb\u7a0b\uff0c\u4e5f\u5c31\u662f Push Gateway \u53bb\u62c9\u53d6\u6570\u636e\u3002</p> \u63a8\u62c9\u6a21\u5f0f\u7684\u6bd4\u8f83 <p>\u4f60\u4f1a\u89c9\u5f97\uff0c\u62c9\u6a21\u5f0f\u9700\u8981\u6307\u6807\u7cfb\u7edf\u77e5\u9053\u6709\u54ea\u4e9b\u670d\u52a1\u8981\u62c9\u53d6\uff0c\u8fd9\u4e2a\u9700\u8981\u989d\u5916\u7684\u914d\u7f6e\uff0c\u800c\u4e14\u9700\u8981\u4e00\u4e2a\u4e2d\u5fc3\u8fdb\u7a0b\u6765\u8d1f\u8d23\u62c9\u53d6\u6570\u636e\uff0c\u53ef\u80fd\u4e0d\u80fd\u5f88\u597d\u7684\u6269\u5c55\u3002\u4f46\u662f\u63a8\u6a21\u5f0f\u4e0b\uff0c\u76d1\u63a7\u7cfb\u7edf\u6ca1\u6709\u529e\u6cd5\u77e5\u9053\u4e00\u4e2a\u8fdb\u7a0b\u5230\u5e95\u53ea\u662f\u957f\u65f6\u95f4\u6ca1\u6709\u6307\u6807\u4e0a\u62a5\uff0c\u8fd8\u662f\u8fdb\u7a0b\u6302\u6389\u4e86\uff0c\u5b9e\u9645\u4e0a\u76d1\u63a7\u7cfb\u7edf\u8fd8\u662f\u8981\u77e5\u9053\u9700\u8981\u76d1\u63a7\u54ea\u4e9b\u8fdb\u7a0b\u3002\u800c\u4e14\u5728\u62c9\u6a21\u5f0f\u4e0b\uff0c\u76d1\u63a7\u7cfb\u7edf\u6709\u7740\u7edf\u4e00\u7684\u63a7\u5236\uff0c\u53ef\u4ee5\u907f\u514d\u8fc7\u8f7d\u7684\u73b0\u8c61\u3002\u800c\u5728\u63a8\u6a21\u5f0f\u4e0b\uff0c\u5982\u679c\u4e0a\u62a5\u9891\u7387\u8fc7\u9ad8\uff0c\u4f1a\u5360\u7528\u5927\u91cf\u7f51\u7edc\u6d41\u91cf\uff0c\u53ef\u80fd\u5f71\u54cd\u6b63\u5e38\u670d\u52a1\uff0c\u5e76\u4e14\u5982\u679c\u76d1\u63a7\u7cfb\u7edf\u6ca1\u6709\u505a\u597d\u8fc7\u8f7d\u9650\u6d41\u4fdd\u62a4\uff0c\u53ef\u80fd\u5bfc\u81f4\u76d1\u63a7\u8fdb\u7a0b\u5d29\u6e83\u7b49\u4e25\u91cd\u540e\u679c\u3002\u5728\u91c7\u6837\u95f4\u9694\u6bd4\u8f83\u957f\u7684\u60c5\u51b5\u4e0b\uff0c\u62c9\u6a21\u5f0f\u5176\u5b9e\u5e76\u4e0d\u4f1a\u5bf9\u76d1\u63a7\u7cfb\u7edf\u9020\u6210\u8fc7\u5927\u7684\u5f71\u54cd\u3002</p>"},{"location":"paradigms/","title":"\u670d\u52a1\u5668\u7a0b\u5e8f\u5e38\u89c1\u8303\u5f0f","text":"<p>\u7ecf\u8fc7\u524d\u9762\u5927\u91cf\u57fa\u7840\u77e5\u8bc6\u7684\u4ecb\u7ecd\uff0c\u4f60\u5df2\u7ecf\u5bf9\u670d\u52a1\u5668\u7a0b\u5e8f\u4e2d\u5e38\u89c1\u7684\u7f16\u7a0b\u5de5\u5177\u6709\u4e86\u4e00\u5b9a\u4e86\u89e3\u3002\u672c\u7ae0\u5c06\u6574\u5408\u524d\u9762\u7684\u77e5\u8bc6\uff0c\u5e26\u4f60\u4e86\u89e3\u4e00\u4e2a\u670d\u52a1\u5668\u7a0b\u5e8f\u7684\u57fa\u672c\u7ed3\u6784\u4ee5\u53ca\u6a21\u677f\u4ee3\u7801\u3002</p> <p>\u901a\u5e38\uff0c\u4e00\u4e2a\u670d\u52a1\u5668\u7a0b\u5e8f\u7684\u8fd0\u884c\u8fc7\u7a0b\u6709\u4ee5\u4e0b\u51e0\u4e2a\u4e3b\u8981\u6b65\u9aa4\uff1a</p> <ul> <li>\u8bfb\u53d6\u914d\u7f6e</li> <li>\u9a8c\u8bc1\u914d\u7f6e</li> <li>\u6839\u636e\u914d\u7f6e\u521d\u59cb\u5316\u4e0d\u540c\u7684\u670d\u52a1\u7ec4\u4ef6</li> <li>\u542f\u52a8\u5fc5\u8981\u7684\u540e\u53f0\u670d\u52a1\u7ebf\u7a0b</li> <li>\u6ce8\u518c\u4fe1\u53f7\u5904\u7406\u51fd\u6570</li> <li>\u6ce8\u518c\u8bf7\u6c42\u5904\u7406\u5668</li> <li>\u5f00\u542f\u76d1\u542c\u7aef\u53e3</li> <li>\u8fdb\u5165\u4e3b\u5faa\u73af\uff0c\u5904\u7406\u5ba2\u6237\u7aef\u8fde\u63a5\uff0c\u4e0d\u65ad\u63a5\u6536\u5e76\u89e3\u6790\u8bf7\u6c42\uff0c\u5c06\u8bf7\u6c42\u6d3e\u53d1\u7ed9\u5bf9\u5e94\u7684\u8bf7\u6c42\u5904\u7406\u5668\u8fdb\u884c\u5904\u7406</li> <li>\u5982\u679c\u5728\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u6536\u5230\u9000\u51fa\u4fe1\u53f7\uff0c\u9000\u51fa\u5faa\u73af\uff0c\u8fdb\u884c\u5fc5\u8981\u7684\u6e05\u7406\u5e76\u7ed3\u675f\u8fdb\u7a0b</li> </ul> <p>\u800c\u5728\u4e3b\u5faa\u73af\u4e2d\uff0c\u4e00\u822c\u9075\u5faa\u4ee5\u4e0b\u51e0\u79cd\u4e0d\u540c\u7684\u8303\u5f0f\uff1a</p>"},{"location":"paradigms/#\u6bcf\u4e2a\u8bf7\u6c42\u521b\u5efa\u4e00\u4e2a\u7ebf\u7a0b","title":"\u6bcf\u4e2a\u8bf7\u6c42\u521b\u5efa\u4e00\u4e2a\u7ebf\u7a0b","text":"<ul> <li>\u6bcf\u5f53\u6709\u65b0\u7684\u5ba2\u6237\u7aef\u8fde\u63a5\u5230\u670d\u52a1\u5668\uff0c\u5c31\u521b\u5efa\u4e00\u4e2a\u7ebf\u7a0b\u8d1f\u8d23\u63a5\u53d7\u5e76\u5904\u7406\u8fd9\u4e2a\u8fde\u63a5</li> <li>\u65b0\u521b\u5efa\u7684\u7ebf\u7a0b\u540c\u6837\u8fdb\u5165\u5faa\u73af\uff0c\u4e0d\u65ad\u63a5\u6536\u89e3\u6790\u8bf7\u6c42\uff0c\u8c03\u7528\u5904\u7406\u51fd\u6570</li> <li>\u8fde\u63a5\u65ad\u5f00\u540e\uff0c\u7ebf\u7a0b\u9000\u51fa</li> </ul> <p>\u8fd9\u6837\u7684\u8303\u5f0f\u7f16\u5199\u8d77\u6765\u6bd4\u8f83\u7b80\u5355\uff0c\u4f46\u662f\u7531\u4e8e\u7ebf\u7a0b\u7684\u521b\u5efa\u4e0e\u9500\u6bc1\u662f\u5f00\u9500\u5f88\u5927\u7684\uff0c\u800c\u4e14\u5982\u679c\u8fde\u63a5\u6570\u8f83\u591a\uff0c\u5f00\u542f\u7684\u7ebf\u7a0b\u592a\u591a\uff0c\u4f1a\u7ed9\u64cd\u4f5c\u7cfb\u7edf\u5e26\u6765\u5de8\u5927\u7684\u8d44\u6e90\u6d88\u8017\u3002\u53e6\u5916\uff0c\u7531\u4e8e\u5207\u6362\u7ebf\u7a0b\u9700\u8981\u8fdb\u5165\u5185\u6838\u5207\u6362\u4e0a\u4e0b\u6587\uff0c\u5207\u6362\u7684\u5f00\u9500\u4e5f\u6bd4\u8f83\u5927\uff0c\u7ebf\u7a0b\u6570\u8fc7\u591a\u7684\u60c5\u51b5\u4e0b\u53ef\u80fd\u5927\u90e8\u5206 CPU \u65f6\u95f4\u90fd\u7528\u6765\u5904\u7406\u4e0a\u4e0b\u6587\u5207\u6362\u4e86\u3002</p> <p>\u6240\u4ee5\uff0c\u8fd9\u79cd\u65b9\u5f0f\u9002\u5408\u8fde\u63a5\u6570\u4e0d\u4f1a\u592a\u591a\u7684\u60c5\u51b5\uff0c\u6700\u597d\u662f\u8fde\u63a5\u4e0d\u4f1a\u9891\u7e41\u5efa\u7acb\u548c\u65ad\u5f00\u3002</p>"},{"location":"paradigms/#\u7f51\u7edc\u4e0e\u8ba1\u7b97\u5206\u79bb","title":"\u7f51\u7edc\u4e0e\u8ba1\u7b97\u5206\u79bb","text":"<ul> <li>\u9884\u5148\u542f\u52a8\u7f51\u7edc IO \u7ebf\u7a0b\uff0c\u8d1f\u8d23\u5904\u7406\u8fde\u63a5</li> <li>\u5f53\u6709\u65b0\u7684\u5ba2\u6237\u7aef\u8fde\u63a5\u5230\u670d\u52a1\u5668\u7684\u65f6\u5019\uff0c\u7531\u7f51\u7edc\u7ebf\u7a0b\u63a5\u53d7\u5e76\u5904\u7406\u8fd9\u4e2a\u8fde\u63a5</li> <li>\u7f51\u7edc IO \u7ebf\u7a0b\u8d1f\u8d23\u8bfb\u5199\u8fde\u63a5\u4e0a\u7684\u6570\u636e\uff0c\u7b49\u8bf7\u6c42\u5b8c\u6574\u5230\u8fbe\u540e\uff0c\u653e\u5165\u5de5\u4f5c\u961f\u5217</li> <li>\u5904\u7406\u7ebf\u7a0b\u4e0d\u65ad\u4ece\u5de5\u4f5c\u961f\u5217\u4e2d\u83b7\u53d6\u8bf7\u6c42\uff0c\u8fdb\u884c\u89e3\u6790\u5e76\u5904\u7406\uff0c\u54cd\u5e94\u4ea4\u7ed9\u7f51\u7edc\u7ebf\u7a0b\u5199\u5230\u5ba2\u6237\u7aef</li> </ul> <p>\u8fd9\u79cd\u7f16\u7a0b\u8303\u5f0f\u6bd4\u7b80\u5355\u4e00\u4e2a\u7ebf\u7a0b\u5bf9\u5e94\u4e00\u4e2a\u8fde\u63a5\u8981\u590d\u6742\u4e0d\u5c11\u3002\u4e00\u822c\u4f1a\u501f\u52a9\u5e93\u6765\u5b9e\u73b0\u8fd9\u79cd\u8303\u5f0f\u3002</p>"},{"location":"paradigms/background/","title":"\u542f\u52a8\u540e\u53f0\u670d\u52a1","text":""},{"location":"paradigms/config/","title":"\u7a0b\u5e8f\u7684\u8fd0\u884c\u914d\u7f6e","text":"<p>\u670d\u52a1\u5668\u7a0b\u5e8f\u901a\u5e38\u5e26\u6709\u5927\u91cf\u7684\u53c2\u6570\u9700\u8981\u7075\u6d3b\u914d\u7f6e\uff0c\u5c3d\u7ba1\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 <code>main</code> \u51fd\u6570\u7684 <code>argv</code> \u4f20\u53c2\uff0c\u8fd8\u662f\u7a0d\u663e\u9ebb\u70e6\u3002\u56e0\u6b64\uff0c\u670d\u52a1\u5668\u7a0b\u5e8f\u4e00\u822c\u9700\u8981\u652f\u6301\u4ece\u6587\u4ef6\u7b49\u591a\u79cd\u9014\u5f84\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\u542f\u52a8\u3002\u53e6\u5916\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u7ed9\u4e0d\u540c\u7684\u914d\u7f6e\u65b9\u6cd5\u8d4b\u4e88\u4e0d\u540c\u7684\u4f18\u5148\u7ea7\uff0c\u4ee5\u4fbf\u7075\u6d3b\u8986\u76d6\u3002\u901a\u5e38\u800c\u8a00\uff0c\u670d\u52a1\u5668\u7a0b\u5e8f\u8981\u652f\u6301\u4ee5\u4e0b\u51e0\u79cd\u914d\u7f6e\u65b9\u5f0f\uff08\u4f18\u5148\u7ea7\u4ece\u9ad8\u5230\u4f4e\uff09\uff0c\u4f18\u5148\u7ea7\u9ad8\u7684\u914d\u7f6e\u65b9\u5f0f\uff0c\u4f1a\u8986\u76d6\u6389\u4f18\u5148\u7ea7\u66f4\u4f4e\u7684\u914d\u7f6e\u65b9\u5f0f\u7684\u540c\u540d\u53c2\u6570\u3002</p> <ul> <li>\u547d\u4ee4\u884c\u4f20\u53c2</li> <li>\u73af\u5883\u53d8\u91cf\u914d\u7f6e</li> <li>\u6587\u4ef6\u914d\u7f6e</li> <li>\u8fdc\u7aef\u914d\u7f6e\u4e2d\u5fc3\u62c9\u53d6</li> <li>\u5199\u6b7b\u5728\u7a0b\u5e8f\u4e2d\u7684\u9ed8\u8ba4\u503c</li> </ul> <p>\u5176\u4e2d\uff0c\u547d\u4ee4\u884c\u4f20\u53c2\u4e00\u822c\u7528\u4e8e\u5728\u8c03\u8bd5\u7684\u65f6\u5019\u5feb\u901f\u8986\u76d6\u67d0\u4e9b\u53c2\u6570\u800c\u4e0d\u5fc5\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u3002</p> <p>\u73af\u5883\u53d8\u91cf\u540c\u6837\u7528\u4e8e\u5feb\u901f\u8986\u76d6\u67d0\u4e9b\u53c2\u6570\uff0c\u4f46\u53ef\u4ee5\u907f\u514d\u5197\u957f\u7684\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u53e6\u5916\uff0c\u901a\u8fc7\u73af\u5883\u53d8\u91cf\u914d\u7f6e\u7a0b\u5e8f\u4e5f\u662f\u5bb9\u5668\u5316\u90e8\u7f72\u670d\u52a1\u65f6\u5e38\u7528\u7684\u914d\u7f6e\u65b9\u6cd5\u3002</p> <p>\u6587\u4ef6\u914d\u7f6e\u901a\u5e38\u7528\u4e8e\u7a0b\u5e8f\u6b63\u5f0f\u4e0a\u7ebf\u540e\u7a33\u5b9a\u7684\u7a0b\u5e8f\u914d\u7f6e\u3002\u4e00\u822c\u9700\u8981\u652f\u6301\u5728\u591a\u4e2a\u76ee\u5f55\u4e2d\u641c\u7d22\u914d\u7f6e\u6587\u4ef6\uff0c\u4e0d\u540c\u76ee\u5f55\u540c\u6837\u5177\u6709\u4f18\u5148\u7ea7\uff0c\u4e0d\u540c\u7684\u662f\uff0c\u914d\u7f6e\u6587\u4ef6\u4e00\u822c\u53ea\u4f1a\u8bfb\u53d6\u4f18\u5148\u7ea7\u6700\u9ad8\u7684\u90a3\u4e2a\u6587\u4ef6\u3002\u4f7f\u7528\u6587\u4ef6\u7684\u597d\u5904\u4e00\u4e2a\u662f\u65b9\u4fbf\u67e5\u770b\u548c\u4fee\u6539\uff0c\u53e6\u4e00\u65b9\u9762\u7a0b\u5e8f\u53ef\u4ee5\u5728\u8fd0\u884c\u7684\u65f6\u5019\u68c0\u6d4b\u914d\u7f6e\u6587\u4ef6\u7684\u53d8\u5316\uff0c\u8fd9\u6837\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u540e\u4e0d\u9700\u8981\u91cd\u65b0\u542f\u52a8\u7a0b\u5e8f\u5c31\u80fd\u4f7f\u65b0\u7684\u914d\u7f6e\u751f\u6548\uff0c\u4f7f\u5f97\u914d\u7f6e\u4fee\u6539\u5bf9\u7ebf\u4e0a\u670d\u52a1\u5f71\u54cd\u6700\u5c0f\u3002\u4e00\u822c\u6765\u8bf4\u641c\u7d22\u914d\u7f6e\u76ee\u5f55\u7684\u4f18\u5148\u7ea7\u4ece\u9ad8\u5230\u4f4e\u662f\uff1a</p> <ul> <li>\u547d\u4ee4\u884c\u6307\u5b9a\u7684\u914d\u7f6e\u6587\u4ef6</li> <li>\u547d\u4ee4\u884c\u53c2\u6570\u6307\u5b9a\u7684\u591a\u4e2a\u641c\u7d22\u76ee\u5f55</li> <li>\u5f53\u524d\u7a0b\u5e8f\u8fd0\u884c\u7684\u76ee\u5f55</li> <li>\u6bcf\u4e2a\u7528\u6237\u72ec\u7acb\u7684\u914d\u7f6e\u76ee\u5f55\uff08\u4f8b\u5982 $HOME/.myserver/config\uff09</li> <li>\u7cfb\u7edf\u7ea7\u522b\u7684\u914d\u7f6e\u76ee\u5f55\uff08\u4f8b\u5982 /etc/myserver/config\uff09</li> </ul> <p>\u8fdc\u7aef\u914d\u7f6e\u4e2d\u5fc3\u62c9\u53d6\u5219\u662f\u5728\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\uff0c\u7531\u7edf\u4e00\u7684\u914d\u7f6e\u4e2d\u5fc3\u670d\u52a1\u8d1f\u8d23\u4e0b\u53d1\u914d\u7f6e\uff0c\u4fdd\u8bc1\u6bcf\u4e2a\u670d\u52a1\u5668\u7a0b\u5e8f\u4f7f\u7528\u7684\u90fd\u662f\u76f8\u540c\u7684\u914d\u7f6e\u3002\u548c\u6587\u4ef6\u914d\u7f6e\u4e00\u6837\uff0c\u6211\u4eec\u7684\u7a0b\u5e8f\u53ef\u4ee5\u76d1\u542c\u914d\u7f6e\u4e2d\u5fc3\u914d\u7f6e\u7684\u53d8\u5316\uff0c\u6216\u8005\u7531\u914d\u7f6e\u4e2d\u5fc3\u4e3b\u52a8\u4e0b\u53d1\u65b0\u914d\u7f6e\uff0c\u5b9e\u73b0\u914d\u7f6e\u7684\u91cd\u8f7d\u3002\u53e6\u5916\uff0c\u9664\u4e86\u670d\u52a1\u5668\u7a0b\u5e8f\u81ea\u5df1\u62c9\u53d6\u4ee5\u5916\uff0c\u8fd8\u6709\u4e00\u79cd\u65b9\u5f0f\u662f\u4f7f\u7528\u72ec\u7acb\u7684\u7a0b\u5e8f\u8d1f\u8d23\u4e0b\u8f7d\u914d\u7f6e\uff0c\u7136\u540e\u5199\u5165\u5230\u670d\u52a1\u5668\u7a0b\u5e8f\u914d\u7f6e\u6587\u4ef6\u7684\u641c\u7d22\u76ee\u5f55\u91cc\uff0c\u8fd9\u6837\u53ef\u4ee5\u66f4\u597d\u5730\u89e3\u8026\u3002</p> <p>\u4e3a\u4e86\u65b9\u4fbf\u4f7f\u7528\uff0c\u4e00\u822c\u8fd8\u4f1a\u5728\u7f16\u8bd1\u65f6\uff0c\u5c31\u628a\u4e00\u4e9b\u53c2\u6570\u7f16\u8bd1\u5230\u7a0b\u5e8f\u4e2d\u4f5c\u4e3a\u6700\u540e\u7684\u9ed8\u8ba4\u503c\u3002\u8fd9\u4e9b\u53c2\u6570\u901a\u5e38\u4f1a\u4ee5\u5b8f\u5b9a\u4e49\u6216\u5e38\u91cf\u65b9\u5f0f\u5199\u5728\u7a0b\u5e8f\u91cc\uff0c\u7528\u5b8f\u5b9a\u4e49\u7684\u53c2\u6570\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u5728\u7f16\u8bd1\u7684\u65f6\u5019\u8986\u76d6\u65b0\u7684\u503c\u3002</p>"},{"location":"paradigms/config/#\u8bfb\u53d6\u547d\u4ee4\u884c\u914d\u7f6e","title":"\u8bfb\u53d6\u547d\u4ee4\u884c\u914d\u7f6e","text":"<p>\u6211\u4eec\u5148\u4ece\u6700\u7b80\u5355\u7684\u505a\u8d77\u3002\u6211\u4eec\u90fd\u77e5\u9053 <code>main</code> \u51fd\u6570\u7684\u5b8c\u6574\u5f62\u5f0f\u662f <code>int main(int argc, char* argv[])</code>\uff0c\u6211\u4eec\u53ef\u4ee5\u4ece <code>argv</code> \u8fd9\u4e2a\u53c2\u6570\u83b7\u53d6\u5230\u542f\u52a8\u7a0b\u5e8f\u7684\u6240\u6709\u547d\u4ee4\u884c\u53c2\u6570\u3002\u6700\u7b80\u5355\u7684\u505a\u6cd5\u5c31\u662f\u6211\u4eec\u89c4\u5b9a\u4e0d\u540c\u7684\u53c2\u6570\u5e94\u8be5\u653e\u5728\u7b2c\u51e0\u4e2a\u4f4d\u7f6e\uff0c\u7136\u540e\u6211\u4eec\u76f4\u63a5\u8bfb\u53d6\u5373\u53ef\u3002\u4f46\u662f\u8fd9\u6837\u5f88\u4e0d\u7075\u6d3b\uff0c\u4e5f\u65e0\u6cd5\u5904\u7406\u53ef\u9009\u53c2\u6570\u7684\u60c5\u51b5\u3002</p> <p>\u6211\u4eec\u5e38\u89c1\u5230\u7684\u4f20\u53c2\u65b9\u6cd5\u662f <code>--arg val</code> \u6216\u8005\u4f7f\u7528\u7f29\u5199\u5f62\u5f0f <code>-a val</code>\uff0c\u6211\u4eec\u5e0c\u671b\u89e3\u6790\u5f97\u5230\u4e00\u4e2a <code>map&lt;string, string&gt;</code> \u65b9\u4fbf\u540e\u7eed\u7684\u4f7f\u7528\u3002\u53e6\u5916\uff0c\u4e0d\u540c\u53c2\u6570\u7684\u7c7b\u578b\u53ef\u80fd\u4e0d\u4e00\u6837\uff0c\u6709\u7684\u53c2\u6570\u662f\u6570\u5b57\u578b\uff0c\u6709\u7684\u53c2\u6570\u662f\u5b57\u7b26\u4e32\uff0c\u8fd8\u6709\u7684\u53ef\u80fd\u662f\u6570\u7ec4\u3002\u5c3d\u7ba1\u7f16\u5199\u4e00\u4e2a\u89e3\u6790\u547d\u4ee4\u884c\u7684\u51fd\u6570\u5e76\u4e0d\u56f0\u96be\uff0c\u4f46\u662f\u9700\u8981\u8003\u8651\u6bd4\u8f83\u591a\u7684\u7ec6\u8282\u3002\u4e00\u822c\u6765\u8bf4\uff0c\u89e3\u6790\u547d\u4ee4\u884c\u53c2\u6570\u53ef\u4ee5\u4f7f\u7528\u73b0\u6210\u7684\u5e93\u3002</p> <p>\u4e0b\u9762\u4ee5 <code>boost::program_options</code> \u4e3a\u4f8b\uff0c\u6f14\u793a\u5982\u4f55\u4f7f\u7528\u73b0\u6210\u7684\u5e93\u6765\u89e3\u6790\u547d\u4ee4\u884c\u53c2\u6570\u5e76\u4f7f\u7528\u3002</p> <pre><code>#include &lt;boost/program_options.hpp&gt;\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nusing namespace std;\n\nint main(int argc, char *argv[]) {\n  namespace po = boost::program_options;\n  po::options_description desc(\"MyServer 1.0\");\n  desc.add_options()(\"help\", \"Show usage\")\n      (\"id\", po::value&lt;string&gt;()-&gt;required(), \"id of this server\")\n      (\"port\", po::value&lt;int&gt;()-&gt;value_name(\"port\"),\n        \"listen on which port\")\n      (\"host\",\n        po::value&lt;string&gt;()-&gt;value_name(\"host\")-&gt;default_value(\n            \"127.0.0.1\"),\n        \"bind to which address\");\n\n  po::variables_map vm;\n  po::store(po::parse_command_line(argc, argv, desc), vm);\n  po::notify(vm);\n\n  if (vm.count(\"help\")) {\n    cout &lt;&lt; desc &lt;&lt; \"\\n\";\n    return 1;\n  }\n\n  if (vm.count(\"port\")) {\n    cout &lt;&lt; \"port was set to \" &lt;&lt; vm[\"port\"].as&lt;int&gt;() &lt;&lt; \".\\n\";\n  } else {\n    cout &lt;&lt; \"port was not set.\\n\";\n  }\n\n  return 0;\n}\n</code></pre> \u4e3a\u4ec0\u4e48\u4e0d\u4f7f\u7528 <code>getopt</code> <p><code>getopt</code> \u51fd\u6570\u540c\u6837\u63d0\u4f9b\u4e86\u4e00\u5b9a\u7684\u547d\u4ee4\u884c\u89e3\u6790\u529f\u80fd\uff0c\u4f46\u53ea\u5728 Linux \u4e0a\u53ef\u7528\uff0c\u4e3a\u4e86\u66f4\u597d\u7684\u8de8\u5e73\u53f0\u6027\uff0c\u5c3d\u91cf\u4f7f\u7528\u5176\u4ed6\u7684\u5e93\u51fd\u6570\u3002</p>"},{"location":"paradigms/config/#\u73af\u5883\u53d8\u91cf\u914d\u7f6e","title":"\u73af\u5883\u53d8\u91cf\u914d\u7f6e","text":"<p>\u9664\u4e86\u547d\u4ee4\u884c\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u4f7f\u7528\u73af\u5883\u53d8\u91cf\u6765\u914d\u7f6e\u7a0b\u5e8f\u3002<code>boost::program_options</code> \u540c\u6837\u63d0\u4f9b\u4e86\u89e3\u6790\u73af\u5883\u53d8\u91cf\u7684\u529f\u80fd\u3002</p> <pre><code>#include &lt;boost/program_options.hpp&gt;\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nusing namespace std;\n\nstd::string mapper(std::string env_var) {\n  std::transform(env_var.begin(), env_var.end(), env_var.begin(), ::toupper);\n\n  if (env_var == \"PORT\")\n    return \"port\";\n  return \"\";\n}\n\nint main(int argc, char *argv[]) {\n  namespace po = boost::program_options;\n  po::options_description desc(\"MyServer 1.0\");\n  desc.add_options()(\"help\", \"Show usage\")\n      (\"id\", po::value&lt;string&gt;()-&gt;required(), \"id of this server\")\n      (\"port\", po::value&lt;int&gt;()-&gt;value_name(\"port\"),\n        \"listen on which port\")\n      (\"host\",\n        po::value&lt;string&gt;()-&gt;value_name(\"host\")-&gt;default_value(\n            \"127.0.0.1\"),\n        \"bind to which address\");\n\n  po::variables_map vm;\n  po::store(po::parse_command_line(argc, argv, desc), vm);\n  po::store(po::parse_environment(desc, boost::function1&lt;std::string, std::string&gt;(mapper)), vm);\n  po::notify(vm);\n\n  if (vm.count(\"help\")) {\n    cout &lt;&lt; desc &lt;&lt; \"\\n\";\n    return 1;\n  }\n\n  if (vm.count(\"port\")) {\n    cout &lt;&lt; \"port was set to \" &lt;&lt; vm[\"port\"].as&lt;int&gt;() &lt;&lt; \".\\n\";\n  } else {\n    cout &lt;&lt; \"port was not set.\\n\";\n  }\n\n  return 0;\n}\n</code></pre> \u4f7f\u7528 <code>getenv</code> \u51fd\u6570 <p><code>getenv</code> \u51fd\u6570\u662f C \u6807\u51c6\u5e93 <code>stdlib.h</code> \u4e2d\u7684\u4e00\u4e2a\u51fd\u6570\uff0c\u662f\u8de8\u5e73\u53f0\u7684\uff0c\u5982\u679c\u4e0d\u60f3\u5f15\u5165\u5176\u4ed6\u5e93\uff0c\u4f7f\u7528\u8fd9\u4e2a\u51fd\u6570\u4e5f\u662f\u53ef\u4ee5\u7684\u3002</p>"},{"location":"paradigms/config/#\u6587\u4ef6\u914d\u7f6e","title":"\u6587\u4ef6\u914d\u7f6e","text":"<p>\u4ee5\u4e0a\u4e24\u79cd\u65b9\u5f0f\u53ef\u4ee5\u5b9e\u73b0\u7b80\u5355\u7684\u914d\u7f6e\u6548\u679c\uff0c\u4e0d\u8fc7\u7531\u4e8e\u53ea\u80fd\u4f7f\u7528 Key-Value \u7684\u5f62\u5f0f\uff0c\u5728\u9762\u5bf9\u6bd4\u8f83\u590d\u6742\u7684\u914d\u7f6e\u65f6\u96be\u514d\u4f1a\u6709\u4e9b\u9ebb\u70e6\u3002\u4f7f\u7528\u6587\u4ef6\u914d\u7f6e\u7684\u8bdd\uff0c\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u8868\u8fbe\u5d4c\u5957\u7b49\u590d\u6742\u7684\u7ed3\u6784\uff0c\u751a\u81f3\u5b9e\u73b0\u4e00\u5b9a\u7684\u9884\u5904\u7406\u6548\u679c\uff0c\u4f8b\u5982 <code>include</code> \u7b49\u3002</p> <p>\u4f7f\u7528\u914d\u7f6e\u6587\u4ef6\u7684\u8bdd\uff0c\u4e00\u822c\u6709\u51e0\u79cd\u9009\u62e9\u3002</p> <ul> <li>\u4f7f\u7528 <code>toml</code>\u3001<code>json</code>\u3001<code>yaml</code> \u7b49\u5e38\u89c1\u7684\u5d4c\u5957\u683c\u5f0f</li> <li>\u4f7f\u7528 <code>properties</code> \u683c\u5f0f\uff0c\u548c Key-Value \u683c\u5f0f\u5dee\u4e0d\u591a</li> <li>\u4f7f\u7528 <code>ini</code> \u683c\u5f0f\uff0c\u5728 Windows \u4e0a\u6bd4\u8f83\u5e38\u89c1</li> <li>\u50cf <code>nginx</code> \u4e00\u6837\uff0c\u81ea\u5df1\u62df\u5b9a\u4e00\u4e2a\u683c\u5f0f\uff0c\u5e76\u7f16\u5199\u89e3\u6790\u5668</li> </ul> <p>\u5982\u679c\u6ca1\u6709\u7279\u6b8a\u9700\u6c42\uff0c\u4e00\u822c\u91c7\u7528\u73b0\u6210\u7684\u683c\u5f0f\u5373\u53ef\u3002\u4f7f\u7528\u73b0\u6210\u7684\u683c\u5f0f\u8fd8\u6709\u4e00\u4e2a\u597d\u5904\uff0c\u90a3\u5c31\u662f\u4e0d\u9700\u8981\u81ea\u5df1\u7f16\u5199\u89e3\u6790\u5e93\uff0c\u53ef\u4ee5\u4f7f\u7528\u73b0\u6210\u7684\u89e3\u6790\u5e93\u3002\u4e0d\u540c\u751f\u6001\u4f7f\u7528\u7684\u914d\u7f6e\u6587\u4ef6\u683c\u5f0f\u6709\u4e0d\u540c\u504f\u597d\uff0c\u4f8b\u5982 <code>Go</code> \u8bed\u8a00\u548c <code>Rust</code> \u8bed\u8a00\u559c\u6b22\u7528 <code>toml</code> \u683c\u5f0f\u3002\u5bf9\u4e8e\u4eba\u7c7b\u800c\u8a00\uff0c<code>toml</code> \u4ee5\u53ca <code>ini</code> \u683c\u5f0f\u6bd4\u8f83\u5bb9\u6613\u5199\uff0c<code>yaml</code> \u901a\u8fc7\u7f29\u8fdb\u6765\u6307\u793a\u5d4c\u5957\u5bb9\u6613\u5728\u590d\u5236\u7c98\u8d34\u65f6\u51fa\u9519\uff0c\u800c <code>json</code> \u9700\u8981\u5339\u914d\u62ec\u53f7\u6bd4\u8f83\u9ebb\u70e6\u3002<code>boost::program_options</code> \u652f\u6301\u4ece\u6587\u4ef6\u8bfb\u53d6\u7c7b\u4f3c <code>ini</code> \u7684\u914d\u7f6e\u3002</p> <pre><code>#include &lt;boost/program_options.hpp&gt;\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nusing namespace std;\n\nstd::string mapper(std::string env_var) {\n  std::transform(env_var.begin(), env_var.end(), env_var.begin(), ::toupper);\n\n  if (env_var == \"PORT\")\n    return \"port\";\n  return \"\";\n}\n\nint main(int argc, char *argv[]) {\n  namespace po = boost::program_options;\n  po::options_description desc(\"MyServer 1.0\");\n  desc.add_options()(\"help\", \"Show usage\")\n      (\"id\", po::value&lt;string&gt;()-&gt;required(), \"id of this server\")\n      (\"port\", po::value&lt;int&gt;()-&gt;value_name(\"port\"),\n        \"listen on which port\")\n      (\"host\",\n        po::value&lt;string&gt;()-&gt;value_name(\"host\")-&gt;default_value(\n            \"127.0.0.1\"),\n        \"bind to which address\");\n\n  po::variables_map vm;\n  po::store(po::parse_command_line(argc, argv, desc), vm);\n  po::store(po::parse_environment(desc, boost::function1&lt;std::string, std::string&gt;(mapper)), vm);\n  po::store(po::parse_config_file(\"config.ini\", desc), vm);\n  po::notify(vm);\n\n  if (vm.count(\"help\")) {\n    cout &lt;&lt; desc &lt;&lt; \"\\n\";\n    return 1;\n  }\n\n  if (vm.count(\"port\")) {\n    cout &lt;&lt; \"port was set to \" &lt;&lt; vm[\"port\"].as&lt;int&gt;() &lt;&lt; \".\\n\";\n  } else {\n    cout &lt;&lt; \"port was not set.\\n\";\n  }\n\n  return 0;\n}\n</code></pre>"},{"location":"paradigms/handlers/","title":"\u6ce8\u518c\u8bf7\u6c42\u5904\u7406\u5668","text":"<p>\u5728\u670d\u52a1\u5668\u63a5\u6536\u8bf7\u6c42\u5e76\u89e3\u6790\u540e\uff0c\u9700\u8981\u6d3e\u53d1\u7ed9\u4e0d\u540c\u7684\u8bf7\u6c42\u5904\u7406\u5668\u5904\u7406\u3002\u4f8b\u5982\uff0cHTTP \u4e2d\uff0c\u6211\u4eec\u4f1a\u89e3\u6790 HTTP \u65b9\u6cd5\u4ee5\u53ca\u8bf7\u6c42\u7684\u8def\u5f84\uff0c\u7136\u540e\u5339\u914d\u5bf9\u5e94\u7684\u5904\u7406\u5668\u51fd\u6570\u3002\u800c RPC \u4e2d\uff0c\u6211\u4eec\u4f1a\u89e3\u6790\u547d\u4ee4\u53f7\uff0c\u7136\u540e\u8df3\u8f6c\u5230\u5bf9\u5e94\u7684\u5904\u7406\u51fd\u6570\u3002</p>"},{"location":"paradigms/ioc/","title":"\u63a7\u5236\u53cd\u8f6c","text":"<p>\u901a\u5e38\u6211\u4eec\u7684\u670d\u52a1\u5668\u4e2d\uff0c\u9700\u8981\u8c03\u7528\u8bb8\u591a\u5916\u90e8\u670d\u52a1\u3002\u4e3a\u4e86\u5b9e\u73b0\u66f4\u7075\u6d3b\u7684\u914d\u7f6e\u4ee5\u53ca\u66f4\u597d\u7684\u89e3\u8026\u6027\uff0c\u5728\u4f7f\u7528\u5916\u90e8\u670d\u52a1\u65f6\uff0c\u6211\u4eec\u4f1a\u4f7f\u7528\u63a7\u5236\u53cd\u8f6c\u7684\u601d\u60f3\u6765\u7f16\u5199\u4ee3\u7801\u3002\u63a7\u5236\u53cd\u8f6c\u7684\u4e00\u4e2a\u91cd\u8981\u601d\u60f3\u5c31\u662f\uff0c\u4f7f\u5f97\u7a0b\u5e8f\u5c3d\u53ef\u80fd\u4f9d\u8d56\u63a5\u53e3\uff0c\u800c\u4e0d\u662f\u5177\u4f53\u5b9e\u73b0\u3002</p> <p>\u90a3\u4e48\uff0c\u63a7\u5236\u53cd\u8f6c\u662f\u4ec0\u4e48\u610f\u601d\u5462\uff1f\u5047\u5982\u6211\u4eec\u7684\u7a0b\u5e8f A \u9700\u8981\u4f7f\u7528 B \u670d\u52a1\uff0c\u90a3\u4e48\u5728\u6ca1\u6709\u63a7\u5236\u53cd\u8f6c\u7684\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u4f1a\u5728\u7a0b\u5e8f\u91cc\u5199\u51fa\u4ee5\u4e0b\u4ee3\u7801\uff1a</p> <pre><code>// B.h \u4e2d\u63d0\u4f9b\u4e86\u670d\u52a1 B \u7684\u5b9e\u73b0\n#include \"B.h\"\n\nclass MyServer {\n    std::unique_ptr&lt;B&gt; serviceB;\npublic:\n    MyServer() {\n        serviceB = std::make_unique&lt;B&gt;();\n    }\n\n    void Work() {\n        serviceB-&gt;xxx();\n    }\n};\n</code></pre> <p>\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u9700\u8981\u7528\u5230\u4ec0\u4e48\u670d\u52a1\uff0c\u5c31\u81ea\u5df1\u521d\u59cb\u5316\u3002\u8fd9\u65f6\u5019\u6211\u4eec\u7684\u7a0b\u5e8f A \u9700\u8981\u4f9d\u8d56 B\u3002\u5f88\u663e\u7136\uff0c\u8fd9\u6837\u76f8\u5f53\u4e8e\u628a\u6211\u4eec\u7684\u670d\u52a1\u548c\u5176\u4ed6\u7a0b\u5e8f\u8026\u5408\u4e86\u3002\u53e6\u5916\uff0c\u6d4b\u8bd5\u4e5f\u6ca1\u6709\u90a3\u4e48\u65b9\u4fbf\uff0c\u6d4b\u8bd5\u7684\u65f6\u5019\u9700\u8981 B \u670d\u52a1\u6b63\u5e38\u8fd0\u884c\u624d\u53ef\u4ee5\u8fdb\u884c\u6d4b\u8bd5\u3002</p> <p>\u800c\u4f7f\u7528\u63a7\u5236\u53cd\u8f6c\uff0c\u6211\u4eec\u5c06\u501f\u52a9\u63a5\u53e3\uff0c\u4ece\u800c\u5b9e\u73b0\u4f7f\u7528\u8005\u4e0e\u670d\u52a1\u63d0\u4f9b\u8005\u7684\u89e3\u8026\u3002\u6211\u4eec\u9996\u5148\u9700\u8981\u5728\u7a0b\u5e8f A \u4e2d\u58f0\u660e\u6211\u4eec\u5e0c\u671b\u670d\u52a1\u63d0\u4f9b\u4ec0\u4e48\u6837\u7684\u63a5\u53e3\uff0c\u7136\u540e\uff0c\u5728\u6784\u9020\u7a0b\u5e8f A \u7684\u65f6\u5019\uff0c\u901a\u8fc7\u6784\u9020\u51fd\u6570\uff0c\u5c06\u5b9e\u73b0\u4e86\u63a5\u53e3\u7684\u5bf9\u8c61\u4f20\u9012\u8fdb\u6765\uff0c\u800c\u4e0d\u662f\u7531 A \u81ea\u5df1\u6784\u9020\u3002</p> BInterface.hB.cppServer.cpp <pre><code>class BInterface {\npublic:\n    virutal void xxx() = 0;\n};\n</code></pre> <pre><code>#include \"BInterface.h\"\n\nclass ServiceB : public BInterface {\npublic:\n    virtual void xxx() {\n        // ...\n    }\n};\n</code></pre> <pre><code>#include \"BInterface.h\"\n\nclass MyServer {\n    std::shared_ptr&lt;BInterface&gt; serviceB;\npublic:\n    MyServer(std::shared_ptr&lt;BInterface&gt; serviceBImpl) {\n        serviceB = serviceBImpl;\n    }\n\n    void Work() {\n        serviceB-&gt;xxx();\n    }\n};\n</code></pre> <p>\u6b64\u65f6\uff0c\u4f9d\u8d56\u7684\u65b9\u5411\u53d8\u4e3a\u4e86\u670d\u52a1 B \u4f9d\u8d56 A \u63d0\u4f9b\u7684\u63a5\u53e3\u5b9a\u4e49\uff0c\u8fd9\u6837\u5c31\u5b9e\u73b0\u4e86\u63a7\u5236\u7684\u53cd\u8f6c\u3002\u53e6\u5916\uff0c\u7531\u4e8e\u670d\u52a1\u5bf9\u8c61\u4e0d\u518d\u7531 A \u81ea\u5df1\u6784\u9020\uff0c\u6211\u4eec\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u5728\u6d4b\u8bd5\u6216\u8005\u4e0a\u7ebf\u7684\u65f6\u5019\uff0c\u7ed9 A \u7a0b\u5e8f\u63d0\u4f9b\u4e0d\u540c\u7684\u670d\u52a1\u5b9e\u73b0\u3002\u6bd4\u5982\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u6587\u4ef6\u6765\u5b9e\u73b0\u7075\u6d3b\u5207\u6362\u4e0d\u540c\u7684\u670d\u52a1\u5b9e\u73b0\u3002</p> <pre><code>#include \"BInterface.h\"\n#include \"ServiceBv1.h\"\n#include \"ServiceBv2.h\"\n\nstd::shared_ptr&lt;BInterface&gt; serviceB;\n\nif (config-&gt;useServiceBv1) {\n    serviceB = std::make_shared&lt;ServiceBv1&gt;();\n} else {\n    serviceB = std::make_shared&lt;ServiceBv2&gt;();\n}\n\nMyServer server(serviceB);\n</code></pre> <p>\u800c\u6d4b\u8bd5\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u63d0\u4f9b\u4e00\u4e2a\u6d4b\u8bd5\u7528\u7684\u670d\u52a1\u3002</p> <pre><code>#include \"BInterface.h\"\n\nclass MockServiceB : public BInterface {\npublic:\n    virtual void xxx() {\n        // ...\u4e00\u4e2a\u7b80\u5355\u7684\u7528\u4e8e\u6d4b\u8bd5\u7684\u5b9e\u73b0\n    }\n};\n\nvoid TestMyServer() {\n    MyServer server(std::make_shared&lt;MockServiceB&gt;());\n    // ...\u6d4b\u8bd5\u4ee3\u7801\n}\n</code></pre> <p>\u5728\u7f16\u7a0b\u65f6\uff0c\u5c3d\u91cf\u517b\u6210\u5148\u5b9a\u4e49\u63a5\u53e3\uff0c\u7136\u540e\u518d\u5177\u4f53\u5b9e\u73b0\u7684\u4e60\u60ef\u3002\u4f7f\u7528\u63a5\u53e3\u80fd\u5e2e\u52a9\u6211\u4eec\u89e3\u8026\u7a0b\u5e8f\u4e4b\u95f4\u7684\u4f9d\u8d56\u3002</p> <p>\u8fd9\u4e2a\u6982\u5ff5\u6bd4\u8f83\u62bd\u8c61\uff0c\u53ef\u4ee5\u4e3e\u51e0\u4e2a\u4f8b\u5b50\u6765\u65b9\u4fbf\u7406\u89e3\u3002</p>"},{"location":"paradigms/ioc/#\u4f8b\u5b50\u4f7f\u7528-kv-\u5b58\u50a8\u7684\u7528\u6237\u670d\u52a1","title":"\u4f8b\u5b50\uff1a\u4f7f\u7528 KV \u5b58\u50a8\u7684\u7528\u6237\u670d\u52a1","text":"<p>\u5047\u5982\u6211\u4eec\u73b0\u5728\u7f16\u5199\u4e86\u4e00\u4e2a\u7528\u6237\u670d\u52a1\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2a ID \u6765\u67e5\u8be2\u6216\u8005\u4fee\u6539\u7528\u6237\u7684\u5177\u4f53\u4fe1\u606f\uff0c\u4e3a\u4e86\u91cd\u542f\u4e4b\u540e\u4e0d\u4e22\u4fe1\u606f\uff0c\u6211\u4eec\u53ef\u80fd\u4f1a\u4f7f\u7528\u4e00\u4e2a\u53ef\u6301\u4e45\u5316\u7684\u6570\u636e\u5e93\u6765\u5b58\u50a8\u6570\u636e\u3002</p> <p>\u800c\u6211\u4eec\u6839\u636e\u4e0d\u540c\u7684\u9700\u8981\uff0c\u53ef\u80fd\u4f1a\u4f7f\u7528\u53ef\u6301\u4e45\u5316\u7684 KV \u5b58\u50a8\uff08\u53ef\u4ee5\u7406\u89e3\u6210\u6570\u636e\u4fdd\u5b58\u5728\u786c\u76d8\u4e0a\u7684 <code>std::map</code>\uff09\uff0c\u8fd9\u4e2a KV \u5b58\u50a8\u53ef\u80fd\u662f\u4fdd\u5b58\u5728\u672c\u5730\u6587\u4ef6\u7684\uff08\u4f8b\u5982 RocksDB\uff09\uff0c\u4e5f\u53ef\u80fd\u662f\u53e6\u5916\u6709\u670d\u52a1\u8fdb\u7a0b\u6765\u63d0\u4f9b\u670d\u52a1\uff08\u4f8b\u5982\u6211\u4eec\u7528 Redis\uff09\uff0c\u800c\u5728\u6d4b\u8bd5\u7684\u65f6\u5019\uff0c\u6211\u4eec\u4e0d\u60f3\u8fd9\u4e48\u9ebb\u70e6\uff0c\u53ef\u80fd\u5c31\u76f4\u63a5\u4f7f\u7528\u5185\u5b58\u91cc\u7684\u5199\u6b7b\u7684\u6d4b\u8bd5\u6570\u636e\u6765\u8fdb\u884c\u6d4b\u8bd5\u3002\u800c\u4e14\uff0c\u672a\u6765\u53ef\u80fd\u51fa\u73b0\u4e86\u66f4\u65b0\u66f4\u5f3a\u7684 KV \u5b58\u50a8\u3002\u90a3\u4e48\uff0c\u6211\u4eec\u7684\u670d\u52a1\u5c31\u4e0d\u5e94\u8be5\u5199\u6b7b\u5177\u4f53\u7684\u7c7b\uff0c\u800c\u662f\u4f7f\u7528\u63a5\u53e3\u7684\u65b9\u5f0f\u53bb\u89e3\u8026\u4f9d\u8d56\u3002</p> <p>\u90a3\u4e48\uff0c\u6b64\u65f6\u5e94\u8be5\u53bb\u62bd\u8c61\u51fa\u6211\u4eec\u670d\u52a1\u6240\u9700\u8981\u7684\u6700\u5c11\u7684\u529f\u80fd\uff0c\u4f5c\u4e3a\u6211\u4eec\u7684\u4f9d\u8d56\u63a5\u53e3\u3002\u4f8b\u5982\uff0c\u6211\u4eec\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u7684\u670d\u52a1\u5b9e\u9645\u4e0a\u4f9d\u8d56\u7684 KV \u63a5\u53e3\u662f <code>Get</code> \u548c <code>Put</code>\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e2a\u62bd\u8c61\u7684 KV \u63a5\u53e3\uff1a</p> kv.h <pre><code>class KV {\npublic:\n    virtual std::string Get(std::string key) = 0;\n    virtual void Put(std::string key, std::string value) = 0;\n    virtual ~KV() = 0;\n};\n</code></pre> <p>\u800c\u6211\u4eec\u7684\u7528\u6237\u670d\u52a1\uff0c\u5219\u53ea\u9700\u8981\u4f9d\u8d56\u8fd9\u4e2a\u63a5\u53e3\u5b9a\u4e49\u5373\u53ef\u3002</p> user_service.cppuser_service.h <pre><code>#include \"user_service.h\"\n#include \"kv.h\"\n\nUserService::UserService(std::shared_ptr&lt;KV&gt; kv) {\n    kv_ = kv;\n}\n\nstd::string UserService::SerializeUser(User const&amp; user) {\n    // ...\n}\n\nUser UserService::DeserializeUser(std::string serialized_user) {\n    // ...\n}\n\nUser UserService::GetUser(std::string id) {\n    std::string serialized_user = kv_-&gt;Get(id);\n    return DeserializeUser(serialized_user);\n}\n\nvoid UserService::UpdateUser(std::string id, User const&amp; user) {\n    std::string serialized_user = SerializeUser(user);\n    kv_-&gt;Put(id, serialized_user);\n}\n</code></pre> <pre><code>#include \"kv.h\"\n\nclass User {\n    std::string username_;\npublic:\n    User(std::string const&amp; username) : username_(username) {}\n    std::string GetUsername() { return username_; }\n};\n\nclass UserService {\n    std::shared_ptr&lt;KV&gt; kv_;\npublic:\n    UserService(std::shared_ptr&lt;KV&gt; kv);\n    User GetUser(std::string id);\n    void UpdateUser(std::string id, User const&amp; user);\n\n    static std::string SerializeUser(User const&amp; user);\n    static User DeserializeUser(std::string serialized_user);\n};\n</code></pre> <p>\u90a3\u4e48\uff0c\u6211\u4eec\u7684\u7528\u6237\u670d\u52a1\u5c31\u4e0d\u4f9d\u8d56\u4e8e\u7279\u5b9a\u7684 KV \u5b58\u50a8\u5b9e\u73b0\u4e86\u3002</p> <p>\u4f8b\u5982\uff0c\u6211\u4eec\u53ef\u4ee5\u5b9e\u73b0 RedisKV\u3001RocksDBKV\uff0c\u7136\u540e\u5728\u4e3b\u7a0b\u5e8f\u4e2d\u6309\u9700\u4f7f\u7528\u3002</p> redis_kv.hredis_kv.cpprocksdb_kv.hrocksdb_kv.cpp <pre><code>#include \"kv.h\"\n#include \"redis.h\"\n\nclass RedisKV : public KV {\n    std::shared_ptr&lt;RedisClient&gt; client_;\npublic:\n    RedisKV(std::shared_ptr&lt;RedisClient&gt; client);\n    ~RedisKV();      \n}\n</code></pre> <pre><code>#include \"redis_kv.h\"\n#include \"redis.h\"\n\nRedisKV::RedisKV(std::shared_ptr&lt;RedisClient&gt; client) {\n    client_ = client;\n}\n\nRedisKV::~RedisKV() {\n    client_-&gt;Close();\n}\n\nstd::string RedisKV::Get(std::string key) {\n    return client_-&gt;Get(key);\n}\n\nvoid RedisKV::Put(std::string key, std::string value) {\n    client_-&gt;Put(key, value);\n}\n</code></pre> <pre><code>#include \"kv.h\"\n#include \"rocksdb.h\"\n\nclass RocksDBKV : public KV {\n    std::shared_ptr&lt;RocksDBClient&gt; client_;\npublic:\n    RocksDBKV(std::shared_ptr&lt;RocksDBClient&gt; client);        \n    ~RocksDBKV();\n}\n</code></pre> <pre><code>#include \"rocksdb_kv.h\"\n#include \"rocksdb.h\"\n\nRocksDBKV::RocksDBKV(std::shared_ptr&lt;RocksDBClient&gt; client) {\n    client_ = client;\n}\n\nRocksDBKV::~RocksDBKV {\n    client_-&gt;Close();\n}\n\nstd::string RocksDBKV::Get(std::string key) {\n    return client_-&gt;Get(key);\n}\n\nvoid RocksDBKV::Put(std::string key, std::string value) {\n    client_-&gt;Put(key, value);\n}\n</code></pre> <p>\u5728\u4e3b\u7a0b\u5e8f\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u50cf\u8fd9\u6837\u4f7f\u7528\uff1a</p> user_service_main.cpp <pre><code>#include \"user_service.h\"\n#include \"rocksdb_kv.h\"\n#include \"redis_kv.h\"\n#include \"rocksdb.h\"\n#include \"redis.h\"\n\nint main() {\n    // ... \u8bfb\u53d6\u914d\u7f6e\n    std::shared_ptr&lt;KV&gt; kv;\n    if (config-&gt;use_rocksdb) {\n        kv = std::make_shared&lt;RocksDBKV&gt;(NewRocksDBClient(config-&gt;rocksdb_path));\n    } else if (config-&gt;use_redis) {\n        kv = std::make_shared&lt;RedisKV&gt;(NewRedisClient(config-&gt;redis_addr));\n    }\n    UserService user_service(kv);\n\n    server-&gt;OnHttpGet(\"/user/{id}\", [&amp;user_service](HttpRequest const&amp; req, HttpReponse&amp; resp) {\n        resp-&gt;data = \"Your username is: \" + user_service.GetUser(req-&gt;GetParam(\"id\")).GetUsername();\n    })-&gt;OnHttpPost(\"/user/{id}\", [&amp;user_service](HttpRequest const&amp; req, HttpReponse&amp; resp) {\n        std::string const&amp; id = req-&gt;GetParam(\"id\");\n        std::string username = req-&gt;GetBody();\n        user_service.UpdateUser(id, User(username));\n    });\n\n    return server-&gt;Serve();\n}\n</code></pre> <p>\u5982\u679c\u6211\u4eec\u60f3\u7ed9\u6211\u4eec\u7684\u670d\u52a1\u7f16\u5199\u6d4b\u8bd5\uff0c\u90a3\u4e48\u6211\u4eec\u53ea\u9700\u8981\u7f16\u5199\u4e00\u4e2a\u6d4b\u8bd5\u7528\u7684 KV\u3002</p> test_user_service.cpp <pre><code>#include \"kv.h\"\n#include \"user_service.h\"\n\nclass MockUserKV : public KV {\n    std::map&lt;string, string&gt; data_;\npublic:\n    MockUserKV() {\n        data_[\"1\"] = UserService::SerializeUser(User(\"a\"));\n        // ...\n    }\n\n    std::string Get(std::string key) {\n        return data_[key];\n    }\n\n    void Put(std::string key, std::string value) {\n        data_[key] = value;\n    }\n};\n\nTEST(UserServiceTest, GetUser) {\n    UserService user_service(std::make_shared&lt;MockUserKV&gt;());\n    EXPECT_EQ(user_service-&gt;GetUser(\"1\").GetUsername(), \"a\");\n}\n</code></pre>"},{"location":"paradigms/ioc/#\u4f8b\u5b50\u4f7f\u7528\u5173\u7cfb\u578b\u6570\u636e\u5e93\u7684\u7528\u6237\u670d\u52a1","title":"\u4f8b\u5b50\uff1a\u4f7f\u7528\u5173\u7cfb\u578b\u6570\u636e\u5e93\u7684\u7528\u6237\u670d\u52a1","text":"<p>\u5047\u5982\u6211\u4eec\u8fd8\u60f3\u6211\u4eec\u7684\u7528\u6237\u670d\u52a1\u53ef\u4ee5\u4f7f\u7528\u5173\u7cfb\u578b\u6570\u636e\u5e93\uff0c\u90a3\u4e48\u5355\u7eaf\u7684 KV \u62bd\u8c61\u5c31\u4e0d\u592a\u591f\u4e86\uff0c\u6211\u4eec\u9700\u8981\u4f7f\u7528\u4e07\u80fd\u529e\u6cd5\uff1a\u589e\u52a0\u4e00\u5c42\u95f4\u63a5\u6027\u3002</p> <p>\u5047\u5982\u6211\u4eec\u7684 SQL \u6570\u636e\u5e93\u63d0\u4f9b\u4e86\u8fd9\u6837\u4e00\u4e2a\u63a5\u53e3\u3002\u7bc7\u5e45\u9650\u5236\uff0c\u4e0d\u518d\u5199\u4e0d\u540c\u6570\u636e\u5e93\u7684\u793a\u4f8b\u4ee3\u7801\u4e86\uff0c\u53ef\u4ee5\u6309\u7167 KV \u7684\u4ee3\u7801\u5982\u6cd5\u70ae\u5236\u3002</p> sqldb.h <pre><code>class SQLDB {\npublic:\n    virtual QueryResult Query(std::string sql) = 0;\n    virtaul ~QueryResult() = 0;\n};\n</code></pre> <p>\u56e0\u4e3a\u63a5\u53e3\u4e0d\u4e00\u6837\u4e86\uff0c\u6211\u4eec\u73b0\u5728\u6709\u4e24\u79cd\u9009\u62e9\uff0c\u4e00\u79cd\u662f\u7528 KV \u63a5\u53e3\u5c06 SQL \u6570\u636e\u5e93\u518d\u5305\u88c5\u4e00\u6b21\uff0c\u4e5f\u5c31\u662f\u9002\u914d\u5668\u6a21\u5f0f\uff08Adaptor\uff09\u3002</p> sql_kv_adaptor.h <pre><code>#include \"kv.h\"\n#include \"sqldb.h\"\n\nclass SQLKVAdaptor : public KV {\n    std::shared_ptr&lt;SQLDB&gt; sqldb_;\npublic:\n    SQLKVAdaptor(std::shared_ptr&lt;SQLDB&gt; sqldb);\n\n    std::string Get(std::string key) {\n        // SELECT * FROM ... WHERE key = ...\n    }\n\n    void Put(std::string key, std::string value) {\n        // UPDATE ... SET ... WHERE key = ...\n    }\n};\n</code></pre> <p>\u53e6\u4e00\u79cd\u529e\u6cd5\u662f\uff0c\u6211\u4eec\u53ef\u4ee5\u62bd\u8c61\u51fa\u4e00\u4e2a <code>UserRepository</code> \u63a5\u53e3\uff0c\u6765\u5408\u5e76\u4e0d\u592a\u4e00\u6837\u7684\u5b58\u50a8\u670d\u52a1\u3002</p> user_repository.h <pre><code>class UserRepository {\npublic:\n    virtual User GetUser(std::string id);\n    virtual void UpdateUser(std::string id, User const&amp; user);\n    virtual ~UserRepository();\n}; \n</code></pre> <p>\u8fd9\u770b\u4e0a\u53bb\u548c <code>UserService</code> \u7684\u63a5\u53e3\u4f3c\u4e4e\u4e00\u6a21\u4e00\u6837\uff0c\u8fd9\u662f\u56e0\u4e3a\u6211\u4eec\u7684\u4f8b\u5b50\u6bd4\u8f83\u7b80\u5355\u3002\u5982\u679c\u50cf <code>UpdateUser</code> \u8fd9\u79cd\u51fd\u6570\uff0c\u53ef\u80fd\u9700\u8981\u5728\u4fee\u6539\u6570\u636e\u524d\u9a8c\u8bc1\u6570\u636e\u5408\u6cd5\u6027\u4ee5\u53ca\u552f\u4e00\u6027\uff0c\u5c31\u4e0d\u9002\u5408\u653e\u5728 <code>Repository</code> \u5c42\u53bb\u505a\u4e86\u3002\u6bcf\u4e00\u5c42\u90fd\u5e94\u8be5\u53ea\u6709\u5355\u4e00\u7684\u804c\u8d23\uff0c\u5173\u6ce8\u7a0b\u5e8f\u7684\u4e0d\u540c\u529f\u80fd\u65b9\u9762\u3002</p> <p>\u800c\u60f3\u7edf\u4e00\u63a5\u53e3\uff0c\u5c31\u9700\u8981\u4fee\u6539\u6211\u4eec\u7684 <code>UserService</code> \u53bb\u4f7f\u7528 <code>UserRepository</code> \u63a5\u53e3\uff0c\u5177\u4f53\u5b9e\u73b0\u4e5f\u4e0d\u518d\u5199\u51fa\u6765\uff0c\u53ef\u4ee5\u60f3\u8c61\u4e3a\u76f4\u63a5\u8c03\u7528 <code>UserRepository</code> \u7684\u5bf9\u5e94\u63a5\u53e3\uff1a</p> user_service.h <pre><code>#include \"user_repository.h\"\n\nclass UserService {\n    std::shared_ptr&lt;UserRepository&gt; repository_;\npublic:\n    UserService(std::shared_ptr&lt;UserRepository&gt; repository);\n// ...\n};\n</code></pre> <p>\u8fd9\u6837\uff0c\u6211\u4eec\u53ea\u9700\u8981\u7f16\u5199\u4e0d\u540c\u7684 <code>UserRepository</code> \u5b9e\u73b0\u5373\u53ef\uff1a</p> sql_user_repository.hkv_user_repository.h <pre><code>#include \"user_repository.h\"\n#include \"sqldb.h\"\n\nclass SQLUserRepository : public UserRepository {\n    std::shared_ptr&lt;SQLDB&gt; sqldb_;\npublic:\n    SQLUserRepository(std::shared_ptr&lt;SQLDB&gt; sqldb);\n    // ...\n};\n</code></pre> <pre><code>#include \"user_repository.h\"\n#include \"kv.h\"\n\nclass KVUserRepository : public UserRepository {\n    std::shared_ptr&lt;KV&gt; kv_;\npublic:\n    SQLUserRepository(std::shared_ptr&lt;KV&gt; kv);\n    // ...\n};\n</code></pre>"},{"location":"paradigms/ioc/#\u603b\u7ed3\u4e0e\u601d\u8003","title":"\u603b\u7ed3\u4e0e\u601d\u8003","text":"<p>\u63a7\u5236\u53cd\u8f6c\u662f\u6784\u5efa\u5927\u578b\u9879\u76ee\u65f6\u4fdd\u6301\u7ed3\u6784\u6574\u6d01\u7684\u91cd\u8981\u601d\u60f3\u3002\u8fd9\u4e2a\u601d\u60f3\u6307\u5bfc\u6211\u4eec\u5e94\u8be5\u9762\u5411\u63a5\u53e3\u7f16\u7a0b\uff0c\u5b9e\u73b0\u7684\u7ec6\u8282\u5e94\u5f53\u4f9d\u8d56\u4e8e\u63a5\u53e3\u3002</p> <p>\u4f46\u662f\uff0c\u5e94\u8be5\u5982\u4f55\u8bbe\u8ba1\u4ee5\u53ca\u4f7f\u7528\u63a5\u53e3\u5219\u6ca1\u6709\u7edf\u4e00\u7684\u6807\u51c6\u3002\u8fc7\u5ea6\u5730\u62bd\u8c61\u4f1a\u5bfc\u81f4\u4ee3\u7801\u7684\u5d4c\u5957\u5c42\u7ea7\u8fc7\u6df1\uff0c\u7ed9\u8fd0\u884c\u6027\u80fd\u548c\u9605\u8bfb\u8c03\u8bd5\u4ee3\u7801\u90fd\u5e26\u6765\u4e00\u5b9a\u5f71\u54cd\u3002\u4f8b\u5982\uff0c\u6211\u4eec\u4e0a\u9762\u7684 <code>UserService</code>\uff0c\u9700\u4e0d\u9700\u8981\u4e3a\u5b83\u518d\u5355\u72ec\u6dfb\u52a0\u4e00\u4e2a\u63a5\u53e3\u7c7b\u5462\uff1f\u8fd9\u662f\u9700\u8981\u6743\u8861\u7684\u3002\u5047\u5982\u8bf4\u4e00\u4e2a\u7c7b\u53ea\u6709\u4e00\u4e2a\u5b9e\u73b0\uff0c\u90a3\u4e48\u4e3a\u5b83\u5199\u4e00\u4e2a\u63a5\u53e3\u4f3c\u4e4e\u6709\u70b9\u753b\u86c7\u6dfb\u8db3\u4e86\u3002</p> <p>\u53e6\u5916\uff0c\u4e00\u4e2a\u62bd\u8c61\u7c7b\u5e94\u5f53\u5305\u542b\u54ea\u4e9b\u63a5\u53e3\u5462\uff1f\u6bd4\u5982\u8bf4\u4e0a\u9762\u7684 <code>KV</code>\uff0c\u6211\u4eec\u9700\u4e0d\u9700\u8981\u63d0\u4f9b\u4e00\u4e2a\u53ef\u4ee5\u76f4\u63a5\u5e2e\u6211\u4eec\u5904\u7406\u5e8f\u5217\u5316\u7684\u51fd\u6570\u5462\uff1f</p> <p>\u8f6f\u4ef6\u5de5\u7a0b\u4e2d\u6709 SOLID \u539f\u5219\u6765\u6307\u5bfc\u8bbe\u8ba1\u63a5\u53e3\uff0c\u4f46\u8fd9\u4e9b\u62bd\u8c61\u7684\u539f\u5219\u662f\u9700\u8981\u5927\u91cf\u7684\u5b9e\u8df5\u4e0e\u601d\u8003\u624d\u80fd\u771f\u6b63\u5185\u5316\u5230\u81ea\u5df1\u7684\u7f16\u7a0b\u601d\u7ef4\u4e2d\u3002\u5728\u5b9e\u8df5\u4e2d\uff0c\u5e76\u4e0d\u662f\u62bd\u8c61\u8d8a\u591a\u8d8a\u597d\uff0c\u8fc7\u5ea6\u8bbe\u8ba1\u53cd\u800c\u4f1a\u540c\u6837\u9020\u6210\u7a0b\u5e8f\u9605\u8bfb\u4ee5\u53ca\u4fee\u6539\u56f0\u96be\u7684\u95ee\u9898\u3002\u7c7b\u7684\u63a5\u53e3\u6709\u65f6\u4e5f\u4e0d\u4e00\u5b9a\u8d8a\u5c11\u8d8a\u597d\uff0c\u592a\u5c11\u53ef\u80fd\u4f1a\u5bfc\u81f4\u4f7f\u7528\u63a5\u53e3\u7684\u4eba\u4e0d\u5f97\u4e0d\u7f16\u5199\u5927\u91cf\u91cd\u590d\u7684\u4ee3\u7801\u6765\u7ec4\u5408\u63a5\u53e3\u3002\u53e6\u5916\uff0c\u4ec0\u4e48\u65f6\u5019\u5e94\u8be5\u4f7f\u7528\u9762\u5411\u5bf9\u8c61\uff0c\u4ec0\u4e48\u65f6\u5019\u5e94\u8be5\u4f7f\u7528\u51fd\u6570\u5f0f\uff0c\u4ec0\u4e48\u65f6\u5019\u5e94\u8be5\u4f7f\u7528\u8fc7\u7a0b\u5f0f\uff0c\u540c\u6837\u662f\u503c\u5f97\u6743\u8861\u7684\u95ee\u9898\u3002</p> <p>\u6211\u4eec\u8fd8\u53ef\u4ee5\u9605\u8bfb\u4f18\u79c0\u7684\u5f00\u6e90\u9879\u76ee\u6765\u5b66\u4e60\u4f18\u79c0\u7684\u5de5\u7a0b\u662f\u5982\u4f55\u7ec4\u7ec7\u4ee3\u7801\u4ee5\u53ca\u8bbe\u8ba1\u63a5\u53e3\u7684\u3002\u4e0d\u540c\u7c7b\u578b\u7684\u7a0b\u5e8f\u4e5f\u5f80\u5f80\u6709\u7740\u4e0d\u540c\u7684\u8bbe\u8ba1\u601d\u60f3\uff0c\u9002\u7528\u4e8e\u670d\u52a1\u5668\u7f16\u7a0b\u7684\u7ecf\u9a8c\u53ef\u80fd\u672a\u5fc5\u9002\u7528\u4e8e\u6e38\u620f\u6216\u8005\u5ba2\u6237\u7aef GUI \u7f16\u7a0b\u3002\u6709\u65f6\u5019\u4e3a\u4e86\u8ffd\u6c42\u6027\u80fd\uff0c\u6211\u4eec\u53ef\u80fd\u4e5f\u4f1a\u4f7f\u7528\u201c\u53cd\u8303\u5f0f\u201d\uff0c\u5c06\u7a0b\u5e8f\u8026\u5408\u5728\u4e00\u8d77\u3002\u4e0d\u8fc7\uff0c\u62bd\u8c61\u4ecd\u7136\u662f\u8ba1\u7b97\u673a\u9886\u57df\u4e00\u4e2a\u6781\u4e3a\u57fa\u7840\u548c\u91cd\u8981\u7684\u601d\u60f3\u3002</p>"},{"location":"paradigms/listen/","title":"\u521b\u5efa\u76d1\u542c\u7aef\u53e3\u76d1\u542c\u8bf7\u6c42","text":""},{"location":"paradigms/system-design/","title":"\u7cfb\u7edf\u8bbe\u8ba1\u8303\u5f0f","text":"<p>\u524d\u9762\u63d0\u5230\u7684\u662f\u5728\u7f16\u5199\u4e00\u4e2a\u670d\u52a1\u5668\u7a0b\u5e8f\u65f6\u7684\u5fae\u89c2\u7684\u8303\u5f0f\uff0c\u800c\u4e00\u4e2a\u771f\u6b63\u7684\u540e\u53f0\u7cfb\u7edf\u901a\u5e38\u8fd8\u6d89\u53ca\u66f4\u591a\u7684\u5b8f\u89c2\u7cfb\u7edf\u8bbe\u8ba1\u8303\u5f0f\u3002</p>"},{"location":"paradigms/system-design/#\u5206\u800c\u6cbb\u4e4b","title":"\u5206\u800c\u6cbb\u4e4b","text":"<p>\u5728\u6570\u636e\u91cf\u6bd4\u8f83\u5927\uff0c\u8d85\u8fc7\u5355\u673a\u627f\u8f7d\u91cf\u7684\u65f6\u5019\uff0c\u901a\u5e38\u4f1a\u91c7\u7528\u5206\u7247\uff08Sharding\uff09\u7684\u65b9\u6cd5\u6765\u5c06\u6570\u636e\u5212\u5206\u6210\u66f4\u5c0f\u7684\u4e92\u4e0d\u76f8\u4ea4\u7684\u5b50\u96c6\u65b9\u4fbf\u5904\u7406\u3002\u901a\u5e38\u6765\u8bf4\uff0c\u5206\u7247\u662f\u901a\u8fc7\u67d0\u4e00\u4e2a Key \u6765\u4f5c\u4e3a\u5207\u5206\u7684\u4f9d\u636e\uff0c\u5e76\u901a\u8fc7\u8303\u56f4\uff08Range\uff09\u6216\u8005\u54c8\u5e0c\uff08Hash\uff09\u8fdb\u884c\u5206\u7247\u3002</p> <p>\u4f8b\u5982\uff0c\u7528\u6237\u91cf\u592a\u5927\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u6839\u636e\u7528\u6237\u7684 ID\uff0c\u6765\u5bf9\u7528\u6237\u6570\u636e\u8fdb\u884c\u5206\u7247\u3002\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u5982\u679c\u91c7\u7528\u8303\u56f4\u5206\u7247\uff0c\u6211\u4eec\u53ef\u4ee5\u6307\u5b9a ID \u662f 1~10000 \u7684\u7528\u6237\u5206\u914d\u5230\u673a\u5668 A\uff0c10001~20000 \u7684\u7528\u6237\u5206\u914d\u5230\u673a\u5668 B \u7b49\u3002\u5982\u679c\u91c7\u7528\u54c8\u5e0c\u5206\u7247\uff0c\u53ef\u4ee5\u5c06\u7528\u6237\u7684 ID \u54c8\u5e0c\u540e\u53d6\u6a21\uff0c\u5206\u914d\u5230\u6307\u5b9a\u673a\u5668\u4e0a\u3002\u8303\u56f4\u5206\u7247\u53ef\u4ee5\u8fdb\u884c\u9ad8\u6548\u7684\u8303\u56f4\u626b\u63cf\uff0c\u800c\u54c8\u5e0c\u5206\u7247\u8fdb\u884c\u8303\u56f4\u626b\u63cf\u7684\u6548\u7387\u5c31\u5dee\u4e00\u4e9b\uff0c\u9700\u8981\u5230\u6bcf\u53f0\u673a\u5668\u4e0a\u53bb\u67e5\u8be2\u3002\u54c8\u5e0c\u5206\u7247\u5219\u6709\u52a9\u4e8e\u6253\u6563\u6570\u636e\uff0c\u907f\u514d\u6570\u636e\u70ed\u70b9\u96c6\u4e2d\u5728\u67d0\u53f0\u673a\u5668\u4e0a\u3002</p> <p>\u5728\u6839\u636e Key \u67e5\u8be2\u6570\u636e\u7684\u65f6\u5019\uff0c\u9700\u8981\u5148\u8ba1\u7b97\u51fa Key \u6240\u5728\u7684\u5206\u7247\uff0c\u5982\u679c\u662f\u9759\u6001\u5206\u7247\uff0c\u90a3\u4e48\u76f4\u63a5\u5c06\u4e0a\u9762\u63d0\u5230\u7684\u89c4\u5219\u5199\u5230\u4ee3\u7801\u91cc\u5373\u53ef\u3002</p> <p>\u5f53\u7136\uff0c\u9759\u6001\u7684\u5206\u7247\u5e76\u4e0d\u5b9e\u7528\uff0c\u56e0\u4e3a\u5b9e\u9645\u4e0a\u6211\u4eec\u7684\u6570\u636e\u4f1a\u4e0d\u65ad\u7684\u589e\u5220\uff0c\u800c\u96c6\u7fa4\u673a\u5668\u4e5f\u53ef\u80fd\u53d1\u751f\u53d8\u5316\uff0c\u9759\u6001\u5206\u7247\u5f88\u96be\u9002\u5e94\u52a8\u6001\u7684\u53d8\u5316\u3002\u6240\u4ee5\uff0c\u5206\u7247\u4e5f\u53ef\u4ee5\u662f\u52a8\u6001\u7684\uff0c\u5047\u5982\u6211\u4eec\u5f80\u96c6\u7fa4\u4e2d\u65b0\u589e\u4e86\u4e00\u53f0\u673a\u5668\uff0c\u90a3\u4e48\u6211\u4eec\u5f53\u7136\u5e0c\u671b\u4e00\u90e8\u5206\u7684\u6570\u636e\u53ef\u4ee5\u8fc1\u79fb\u5230\u8fd9\u53f0\u65b0\u673a\u5668\u4e0a\uff0c\u8fdb\u4e00\u6b65\u5747\u8861\u8d1f\u8f7d\u3002\u800c\u5f53\u67d0\u4e00\u53f0\u673a\u5668\u9700\u8981\u4e0b\u7ebf\u7684\u65f6\u5019\uff0c\u5219\u9700\u8981\u5c06\u5206\u7247\u6570\u636e\u5747\u5300\u5730\u8fc1\u79fb\u56de\u5176\u4ed6\u673a\u5668\u4e0a\u3002\u5982\u679c\u673a\u5668\u6ca1\u6709\u53d1\u751f\u53d8\u52a8\uff0c\u4f46\u662f\u968f\u7740\u6570\u636e\u7684\u589e\u5220\uff0c\u67d0\u4e2a\u673a\u5668\u4e0a\u7684\u5206\u7247\u6570\u636e\u91cf\u8fc7\u591a\u6216\u8005\u8fc7\u5c11\uff0c\u540c\u6837\u9700\u8981\u8fdb\u884c\u5e73\u8861\u3002</p> <p>\u5206\u7247\u6570\u636e\u7684\u52a8\u6001\u8fc1\u79fb\u662f\u4e00\u4e2a\u6bd4\u8f83\u590d\u6742\u7684\u95ee\u9898\uff0c\u96be\u70b9\u5728\u4e8e\u5982\u4f55\u4fdd\u8bc1\u8fc1\u79fb\u8fc7\u7a0b\u4e2d\u7684\u6570\u636e\u53ef\u7528\u4ee5\u53ca\u4e00\u81f4\u6027\u3002</p> <p>\u52a8\u6001\u5206\u7247\u901a\u5e38\u9700\u8981\u4e00\u4e2a\u67e5\u8be2\u8868\u6765\u8d1f\u8d23\u67e5\u8be2 Key \u5230\u5206\u7247\u7684\u529f\u80fd\u3002\u4f8b\u5982\uff0c\u8303\u56f4\u5206\u7247\u7684\u8bdd\uff0c\u9700\u8981\u4fdd\u5b58\u4ee5\u4e0b\u4fe1\u606f\uff1a</p> <pre><code>struct RangeInfo {\n    int start;\n    int end;\n    int serverID;\n};\n\nvector&lt;RangeInfo&gt; ranges;\n</code></pre> <p>\u5206\u7247\u4fe1\u606f\u4e00\u822c\u662f\u6709\u5e8f\u5b58\u50a8\u7684\uff0c\u8fd9\u6837\u53ef\u4ee5\u4f7f\u7528\u4e8c\u5206\u67e5\u627e\u5feb\u901f\u5b9a\u4f4d\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u641c\u7d22\u6811\u6765\u4fdd\u5b58\u6570\u636e\u3002</p>"},{"location":"paradigms/system-design/#\u907f\u514d\u5355\u70b9\u6545\u969c","title":"\u907f\u514d\u5355\u70b9\u6545\u969c","text":""},{"location":"paradigms/system-design/#\u4e3b\u5907\u6a21\u5f0f","title":"\u4e3b\u5907\u6a21\u5f0f","text":"<p>\u4e3b\u5907\u6a21\u5f0f\u901a\u5e38\u662f\u7531\u591a\u53f0\u673a\u5668\u540c\u65f6\u8fd0\u884c\u670d\u52a1\u8fdb\u7a0b\uff0c\u4f46\u540c\u4e00\u65f6\u523b\u6700\u591a\u53ea\u6709\u4e00\u4e2a\u8fdb\u7a0b\u6b63\u5e38\u5bf9\u5916\u670d\u52a1\uff0c\u5176\u4ed6\u8fdb\u7a0b\u4f5c\u4e3a\u5907\u4efd\u8fdb\u7a0b\uff0c\u53ea\u540c\u6b65\u4e3b\u8fdb\u7a0b\u7684\u72b6\u6001\uff0c\u800c\u4e0d\u54cd\u5e94\u8bf7\u6c42\u3002\u6216\u8005\uff0c\u4ece\u8282\u70b9\u53ea\u54cd\u5e94\u53ea\u8bfb\u8bf7\u6c42\u800c\u4e0d\u80fd\u5bf9\u6570\u636e\u4fee\u6539\uff0c\u4e5f\u5c31\u662f\u5355\u5199\u591a\u8bfb\u3002\u901a\u5e38\u8fd9\u79cd\u6a21\u5f0f\u7528\u4e8e\u91cd\u8981\u7684\u5c11\u91cf\u7684\u5143\u6570\u636e\u7684\u5b58\u50a8\uff0c\u4f8b\u5982\u4e0a\u9762\u63d0\u5230\u7684\u5206\u7247\u4fe1\u606f\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528\u4e3b\u5907\u6a21\u5f0f\u6765\u4fdd\u5b58\u3002\u4f7f\u7528\u4e86 raft \u7684 etcd \u4fbf\u53ef\u4ee5\u770b\u4f5c\u662f\u4e3b\u5907\u6a21\u5f0f\u7684\u4e00\u79cd\u3002</p>"},{"location":"paradigms/system-design/#\u5bf9\u7b49\u6a21\u5f0f","title":"\u5bf9\u7b49\u6a21\u5f0f","text":"<p>\u5bf9\u7b49\u6a21\u5f0f\u4e5f\u662f\u7531\u591a\u53f0\u673a\u5668\u540c\u65f6\u8fd0\u884c\u670d\u52a1\u8fdb\u7a0b\uff0c\u800c\u4e14\u6bcf\u4e00\u4e2a\u8fdb\u7a0b\u7684\u529f\u80fd\u90fd\u662f\u76f8\u540c\u7684\uff0c\u90fd\u53ef\u4ee5\u5bf9\u5916\u670d\u52a1\uff0c\u4e92\u76f8\u4e4b\u95f4\u4f1a\u540c\u6b65\u6570\u636e\u3002\u8fd9\u79cd\u6a21\u5f0f\u65e2\u80fd\u4fdd\u8bc1\u9ad8\u53ef\u7528\uff0c\u53c8\u53ef\u4ee5\u5b9e\u73b0\u8d1f\u8f7d\u5747\u8861\uff0c\u4e0d\u50cf\u4e3b\u5907\u6a21\u5f0f\u4e2d\u4e3b\u8282\u70b9\u627f\u62c5\u4e86\u6240\u6709\u529f\u80fd\u5bfc\u81f4\u8d1f\u8f7d\u96c6\u4e2d\u3002\u800c\u4e14\uff0c\u4e00\u822c\u5bf9\u7b49\u6a21\u5f0f\u4e2d\u5404\u4e2a\u8282\u70b9\u529f\u80fd\u76f8\u540c\uff0c\u53ef\u8bfb\u53ef\u5199\u3002\u4f46\u5bf9\u7b49\u6a21\u5f0f\u5e38\u5e38\u96be\u4ee5\u8bbe\u8ba1\uff0c\u5f00\u53d1\u590d\u6742\u5ea6\u76f8\u6bd4\u4e3b\u5907\u6a21\u5f0f\u4f1a\u9ad8\u5f88\u591a\u3002\u4e3b\u8981\u95ee\u9898\u6765\u81ea\u4e8e\u591a\u5199\u9020\u6210\u7684\u6570\u636e\u51b2\u7a81\u95ee\u9898\uff0c\u8fd9\u79cd\u7cfb\u7edf\u901a\u5e38\u4e5f\u4f1a\u63d0\u4f9b\u51b2\u7a81\u68c0\u6d4b\u529f\u80fd\uff0c\u5e76\u8fd4\u56de\u9519\u8bef\u7ed9\u5ba2\u6237\u7aef\u81ea\u884c\u5904\u7406\u3002\u4f8b\u5982 riak \u6570\u636e\u5e93\u3002</p>"},{"location":"paradigms/system-design/#\u8ba1\u7b97\u5b58\u50a8\u5206\u79bb","title":"\u8ba1\u7b97\u5b58\u50a8\u5206\u79bb","text":"<p>\u5728\u5b9e\u9645\u573a\u666f\u4e2d\uff0c\u6709\u65f6\u6211\u4eec\u5bf9\u8ba1\u7b97\u7684\u9700\u6c42\u4f1a\u5927\u4e8e\u5bf9\u5b58\u50a8\u7684\u9700\u6c42\uff0c\u4f8b\u5982\uff0c\u4e00\u4e2a\u8d2d\u7269\u7f51\u7ad9\u9996\u9875\uff0c\u53ef\u80fd\u4f1a\u4ece\u6570\u636e\u5e93\u91cc\u62c9\u53d6\u4e00\u6279\u5546\u54c1\u4fe1\u606f\uff0c\u7136\u540e\u6839\u636e\u7528\u6237\u7684\u559c\u597d\u6392\u5e8f\u3002\u5982\u679c\u6211\u4eec\u5c06\u5b58\u50a8\u548c\u8ba1\u7b97\u8026\u5408\u8d77\u6765\u7684\u8bdd\uff0c\u90a3\u4e48\u5c31\u4f1a\u51fa\u73b0\u7531\u4e8e\u8ba1\u7b97\u9700\u6c42\u91cf\u6bd4\u8f83\u5927\uff0c\u589e\u52a0\u4e86\u6bd4\u8f83\u591a\u7684\u8282\u70b9\uff0c\u4f46\u662f\u7531\u4e8e\u5b58\u50a8\u548c\u8ba1\u7b97\u8026\u5408\uff0c\u8fd9\u4e9b\u8282\u70b9\u8fd8\u8981\u6d88\u8017\u989d\u5916\u7684\u5b58\u50a8\u7a7a\u95f4\u3002\u53e6\u5916\u5982\u679c\u8ba1\u7b97\u8fc7\u7a0b\u5d29\u6e83\uff0c\u90a3\u4e48\u4e5f\u53ef\u80fd\u5bfc\u81f4\u5b58\u50a8\u4e00\u5e76\u906d\u6b83\u3002</p> <p>\u5f53\u7136\uff0c\u6700\u4e3b\u6d41\u7684\u505a\u6cd5\u8fd8\u662f\u5c06\u8ba1\u7b97\u548c\u5b58\u50a8\u5206\u79bb\u3002\u6bd4\u5982\u8bf4\uff0c\u6211\u4eec\u901a\u8fc7\u7f51\u7edc\u53bb\u8fde\u63a5 MySQL \u7b49\u6570\u636e\u5e93\uff0c\u7136\u540e\u6267\u884c SQL \u8bed\u53e5\u628a\u6570\u636e\u53d6\u56de\u6765\u540e\u518d\u505a\u4e1a\u52a1\u903b\u8f91\u8ba1\u7b97\uff0c\u8fd9\u5c31\u53ef\u4ee5\u7b97\u662f\u4e00\u79cd\u8ba1\u7b97\u5b58\u50a8\u5206\u79bb\u3002\u800c\u4e00\u4e9b\u5206\u5e03\u5f0f\u7684\u6570\u636e\u5e93\uff0c\u4f8b\u5982 TiDB\u3001YugabyteDB\uff0c\u5c31\u91c7\u7528\u4e86\u8ba1\u7b97\u4e0e\u5b58\u50a8\u76f8\u5206\u79bb\u7684\u7ed3\u6784\u3002\u8fd9\u6837\u7684\u597d\u5904\u5728\u4e8e\u8ba1\u7b97\u53ef\u4ee5\u5355\u72ec\u6269\u5bb9\uff0c\u4e5f\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u9694\u79bb\u4e86\u8ba1\u7b97\u53ef\u80fd\u5e26\u6765\u7684 bug\u3002</p>"},{"location":"paradigms/system-design/#\u8ba1\u7b97\u5b58\u50a8\u8026\u5408","title":"\u8ba1\u7b97\u5b58\u50a8\u8026\u5408","text":"<p>\u7531\u4e8e\u8ba1\u7b97\u5b58\u50a8\u5206\u79bb\u4e4b\u540e\u6570\u636e\u7684\u5b58\u53d6\u9700\u8981\u901a\u8fc7\u7f51\u7edc\u8fdb\u884c\uff0c\u800c\u5e38\u89c1\u7684\u4ee5\u592a\u7f51\u7edc\u6240\u80fd\u63d0\u4f9b\u7684\u5e26\u5bbd\u6709\u9650\uff0c\u800c\u4e14\u4e00\u65e6\u8ba1\u7b97\u670d\u52a1\u5668\u4e0e\u5b58\u50a8\u670d\u52a1\u5668\u7269\u7406\u8ddd\u79bb\u53d8\u5927\uff0c\u90a3\u4e48\u6570\u636e\u5b58\u53d6\u7684\u5ef6\u8fdf\u4e5f\u4f1a\u4e0a\u5347\u3002\u4e3a\u4e86\u8282\u7701\u5e26\u5bbd\u4ee5\u53ca\u51cf\u5c11\u5ef6\u8fdf\uff0c\u53ef\u4ee5\u91c7\u53d6\u5c06\u8ba1\u7b97\u7a0b\u5e8f\u5c3d\u53ef\u80fd\u9760\u8fd1\u5b58\u50a8\u7a0b\u5e8f\u7684\u7b56\u7565\u3002\u4e00\u4e2a\u5f88\u5e38\u89c1\u7684\u4f8b\u5b50\u5c31\u662f\uff0c\u6211\u4eec\u5728\u4f7f\u7528 SQL \u6570\u636e\u5e93\u7684\u65f6\u5019\uff0c\u65e2\u53ef\u4ee5\u4f7f\u7528\u7b80\u5355\u7684 SQL \u8bed\u53e5\u5c06\u5927\u91cf\u6570\u636e\u53d1\u9001\u5230\u5e94\u7528\u7a0b\u5e8f\u518d\u8fdb\u884c\u8ba1\u7b97\uff0c\u4e5f\u53ef\u4ee5\u7f16\u5199\u4e00\u4e9b\u590d\u6742\u7684 SQL \u751a\u81f3\u662f\u5b58\u50a8\u8fc7\u7a0b\uff0c\u5c06\u8ba1\u7b97\u4ea4\u7ed9\u6570\u636e\u5e93\u672c\u8eab\u53bb\u505a\u3002</p> <p>\u4e00\u4e9b\u5206\u5e03\u5f0f\u6570\u636e\u5e93\u4f8b\u5982 TiDB\uff0c\u5c3d\u7ba1\u91c7\u53d6\u4e86\u8ba1\u7b97\u8282\u70b9\u4e0e\u5b58\u50a8\u8282\u70b9\u5206\u79bb\u7684\u8bbe\u8ba1\uff0c\u4f46 TiKV \u672c\u8eab\u4ecd\u6709 Coprocessor \u529f\u80fd\uff0c\u4e5f\u53ef\u4ee5\u627f\u62c5\u4e00\u90e8\u5206\u7684\u8ba1\u7b97\u4efb\u52a1\uff0c\u964d\u4f4e\u7f51\u7edc\u5360\u7528\u4ee5\u53ca\u7f51\u7edc\u5ef6\u8fdf\u3002</p> <p>\u5f53\u7136\uff0c\u5f53\u8ba1\u7b97\u91cf\u4e0a\u5347\u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u5bf9\u5b58\u50a8\u8282\u70b9\u672c\u8eab\u9020\u6210\u8ba1\u7b97\u538b\u529b\uff0c\u800c\u5b58\u50a8\u8282\u70b9\u6269\u5bb9\u5219\u6ca1\u6709\u90a3\u4e48\u5bb9\u6613\uff0c\u7531\u6b64\u53ef\u80fd\u9020\u6210\u5b58\u50a8\u670d\u52a1\u5b95\u673a\u7b49\u4e25\u91cd\u540e\u679c\u3002\u800c\u5b58\u50a8\u670d\u52a1\u6269\u5bb9\u65f6\uff0c\u8fd8\u4f1a\u5360\u7528\u4e00\u5b9a\u8ba1\u7b97\u8d44\u6e90\u5bf9\u6570\u636e\u8fdb\u884c\u590d\u5236\u548c\u5e73\u8861\uff0c\u641e\u4e0d\u597d\u66f4\u52a0\u5267\u4e86\u60c5\u51b5\u7684\u6076\u5316\u3002\u56e0\u6b64\uff0c\u8ba1\u7b97\u4e0e\u5b58\u50a8\u5206\u79bb\u4e0e\u8026\u5408\u7684\u754c\u9650\u5e76\u4e0d\u662f\u90a3\u4e48\u6e05\u6670\uff0c\u9700\u8981\u6309\u7167\u5e94\u7528\u7684\u7279\u70b9\uff0c\u53bb\u8fdb\u884c\u5168\u65b9\u9762\u7684\u6743\u8861\uff0c\u5e73\u8861\u597d\u8ba1\u7b97\u8282\u70b9\u548c\u5b58\u50a8\u8282\u70b9\u7684\u538b\u529b\uff0c\u5fc5\u8981\u65f6\u505a\u597d\u9650\u6d41\u4ee5\u4fdd\u62a4\u670d\u52a1\u3002</p>"},{"location":"paradigms/system-design/#\u5b58\u50a8\u5206\u7ea7","title":"\u5b58\u50a8\u5206\u7ea7","text":"<p>\u5728\u8ba1\u7b97\u673a\u7ec4\u6210\u539f\u7406\u4e2d\uff0c\u6211\u4eec\u90fd\u5b66\u8fc7 CPU Cache\u3001\u4e3b\u5b58\u3001\u786c\u76d8\u7b49\u5206\u7ea7\u5b58\u50a8\u7ed3\u6784\uff0c\u5b83\u4eec\u5145\u5206\u5229\u7528\u4e86\u8bbf\u5b58\u7684\u65f6\u7a7a\u5c40\u90e8\u6027\u3002\u5728\u5b9e\u9645\u7684\u7cfb\u7edf\u4e2d\uff0c\u5b8f\u89c2\u5c42\u9762\u6765\u8bb2\uff0c\u540c\u6837\u5b58\u5728\u8fd9\u6837\u7684\u65f6\u7a7a\u5c40\u90e8\u6027\uff0c\u4f8b\u5982\uff0c\u4e00\u4e2a\u6b63\u5728\u901b\u8d2d\u7269\u7f51\u7ad9\u7684\u7528\u6237\uff0c\u77ed\u65f6\u95f4\u5185\u5b83\u7684\u7528\u6237\u4fe1\u606f\u80af\u5b9a\u4f1a\u88ab\u53cd\u590d\u5b58\u53d6\uff0c\u800c\u4ed6\u8d2d\u7269\u8f66\u91cc\u7684\u5546\u54c1\u4e5f\u4f1a\u5f88\u53ef\u80fd\u88ab\u53cd\u590d\u8bbf\u95ee\u3002\u6839\u636e\u5c40\u90e8\u6027\u539f\u7406\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u5728\u7cfb\u7edf\u4e2d\u8bbe\u8ba1\u7c7b\u4f3c\u7684\u5206\u7ea7\u5b58\u50a8\u7ed3\u6784\uff0c\u63d0\u9ad8\u7cfb\u7edf\u7684\u54cd\u5e94\u901f\u5ea6\u3002</p>"},{"location":"paradigms/system-design/#\u7f13\u5b58","title":"\u7f13\u5b58","text":"<p>\u7f13\u5b58\u7684\u601d\u60f3\u548c\u5206\u7ea7\u5b58\u50a8\u7684\u601d\u60f3\u5b8c\u5168\u4e00\u81f4\uff0c\u4e00\u822c\u6765\u8bf4\uff0c\u8fdc\u7a0b\u8bbf\u95ee\u4e00\u4e2a\u5206\u5e03\u5f0f\u7684\u5173\u7cfb\u578b\u6570\u636e\u5e93\uff0c\u53ef\u80fd\u4f1a\u6709\u6bd4\u8f83\u5927\u7684\u5ef6\u8fdf\uff0c\u4f46\u662f\u6570\u636e\u5e93\u5b58\u50a8\u4e86\u6700\u5168\u7684\u4fe1\u606f\u3002\u5982\u679c\u6211\u4eec\u89c9\u5f97\u4e00\u6761\u67e5\u8be2\u7ed3\u679c\u77ed\u65f6\u95f4\u5185\u4f1a\u53cd\u590d\u88ab\u8bbf\u95ee\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u5c06\u5b83\u4fdd\u5b58\u5728\u670d\u52a1\u7aef\u7684\u5185\u5b58\u4e2d\uff0c\u6216\u8005\u4f7f\u7528\u5185\u5b58\u6570\u636e\u5e93\uff0c\u52a0\u5feb\u54cd\u5e94\u901f\u5ea6\u3002\u5f53\u7136\uff0c\u5185\u5b58\u7684\u5bb9\u91cf\u4e0d\u5982\u5206\u5e03\u5f0f\u6570\u636e\u5e93\uff0c\u6240\u4ee5\u4e5f\u9700\u8981\u6307\u5b9a\u4e00\u4e2a\u7f13\u5b58\u6dd8\u6c70\u7b56\u7565\uff0c\u4f8b\u5982 LRU \u7b49\u3002</p> <p>\u53e6\u5916\uff0c\u5982\u679c\u77e5\u9053\u67d0\u4e9b\u4fe1\u606f\u53ef\u80fd\u4f1a\u88ab\u67e5\u8be2\u5230\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u9884\u5148\u62c9\u53d6\u8fd9\u4e9b\u4fe1\u606f\u5230\u7f13\u5b58\u4e2d\uff0c\u6bd4\u5982\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u628a\u8d2d\u7269\u8f66\u91cc\u7684\u5546\u54c1\u4fe1\u606f\u5148\u4ece\u6570\u636e\u5e93\u8bfb\u51fa\u6765\uff0c\u653e\u5230\u7f13\u5b58\u4e2d\u3002</p> <p>\u548c CPU Cache \u7b49\u4e00\u6837\uff0c\u7cfb\u7edf\u4e2d\u7684\u7f13\u5b58\u540c\u6837\u4f1a\u9762\u4e34\u4e00\u81f4\u6027\u7684\u95ee\u9898\u3002\u6bd4\u5982\uff0c\u7528\u6237\u4fee\u6539\u4e86\u6635\u79f0\u4e4b\u540e\uff0c\u8981\u5982\u4f55\u66f4\u65b0\u7f13\u5b58\u548c\u6570\u636e\u5e93\uff1f\u6709\u51e0\u4e2a\u7b80\u5355\u7684\u65b9\u6cd5\uff1a</p> <ol> <li>\u5148\u66f4\u65b0\u4e00\u6b21\u7f13\u5b58\uff0c\u518d\u5c06\u7ed3\u679c\u5199\u5230\u6570\u636e\u5e93\u91cc\u3002\u8fd9\u6837\u7684\u95ee\u9898\u5728\u4e8e\u5982\u679c\u7f13\u5b58\u66f4\u65b0\u4e86\uff0c\u4f46\u662f\u6570\u636e\u5e93\u6ca1\u66f4\u65b0\uff0c\u90a3\u4e48\u8fd9\u6b21\u4fee\u6539\u5b9e\u9645\u4e0a\u6ca1\u6210\u529f\uff0c\u4f46\u5374\u9020\u6210\u4e86\u66f4\u65b0\u6210\u529f\u7684\u5047\u8c61\u3002</li> <li>\u5148\u5c06\u7ed3\u679c\u5199\u5230\u6570\u636e\u5e93\uff0c\u518d\u66f4\u65b0\u4e00\u6b21\u7f13\u5b58\u3002\u8fd9\u6837\u7684\u95ee\u9898\u5728\u4e8e\u5982\u679c\u6570\u636e\u5e93\u66f4\u65b0\u4e86\uff0c\u4f46\u662f\u7f13\u5b58\u6ca1\u6709\u66f4\u65b0\uff0c\u90a3\u4e48\u7528\u6237\u4f1a\u4ee5\u4e3a\u8fd9\u6b21\u4fee\u6539\u6ca1\u6210\u529f\u3002</li> <li>\u5148\u6dd8\u6c70\u7f13\u5b58\uff0c\u518d\u5199\u6570\u636e\u5e93\u3002\u8fd9\u6837\u7684\u597d\u5904\u5728\u4e8e\uff0c\u5373\u4f7f\u6570\u636e\u5e93\u5199\u5931\u8d25\u4e86\uff0c\u7528\u6237\u770b\u5230\u7684\u8fd8\u662f\u65e7\u6570\u636e\u3002\u95ee\u9898\u5728\u4e8e\uff0c\u5982\u679c\u5728\u7f13\u5b58\u8bfb\u53d6\u65e7\u6570\u636e\u4e4b\u540e\uff0c\u624d\u66f4\u65b0\u4e86\u6570\u636e\u5e93\uff0c\u5c31\u4f1a\u9020\u6210\u4e0d\u4e00\u81f4\u3002</li> <li>\u5148\u5199\u6570\u636e\u5e93\uff0c\u518d\u6dd8\u6c70\u7f13\u5b58\u3002\u8fd9\u6837\u548c 2 \u4e00\u6837\uff0c\u5982\u679c\u6570\u636e\u5e93\u66f4\u65b0\u4e86\uff0c\u4f46\u662f\u7f13\u5b58\u7531\u4e8e\u67d0\u4e9b\u539f\u56e0\u6ca1\u80fd\u6dd8\u6c70\u6210\u529f\uff0c\u4e5f\u4f1a\u6709\u4e0d\u4e00\u81f4\u3002</li> </ol> <p>\u8fd8\u6709\u66f4\u591a\u66f4\u590d\u6742\u7684\u529e\u6cd5\uff0c\u4f8b\u5982\uff0c\u8ba9\u6570\u636e\u5e93\u63d0\u4f9b binlog \u7b49\u4fee\u6539\u6d41\uff0c\u901a\u8fc7\u76d1\u542c\u6570\u636e\u5e93\u6570\u636e\u53d8\u5316\u4e8b\u4ef6\uff0c\u6765\u66f4\u65b0\u7f13\u5b58\u3002</p>"},{"location":"paradigms/system-design/#\u51b7\u70ed\u5206\u79bb","title":"\u51b7\u70ed\u5206\u79bb","text":"<p>\u51b7\u70ed\u5206\u79bb\u548c\u5206\u7247\u7684\u60f3\u6cd5\u7c7b\u4f3c\uff0c\u90fd\u662f\u6309\u7167\u67d0\u79cd\u65b9\u6cd5\u6765\u5c06\u6570\u636e\u5212\u5206\u6210\u5b50\u96c6\u3002\u4e0d\u8fc7\uff0c\u6570\u636e\u5206\u7247\uff0c\u4e0d\u540c\u5206\u7247\u4e4b\u95f4\u5b58\u50a8\u7684\u673a\u5668\u914d\u7f6e\u901a\u5e38\u662f\u4e00\u6837\u7684\u3002\u800c\u51b7\u70ed\u5206\u79bb\uff0c\u5219\u76f8\u5f53\u4e8e\u7ed9\u67d0\u4e9b\u5206\u7247\u6253\u4e0a\u4e86\u4e0d\u540c\u5c5e\u6027\uff0c\u4e0d\u540c\u5c5e\u6027\u7684\u6570\u636e\u6839\u636e\u7279\u70b9\u5b58\u653e\u5230\u4e0d\u540c\u914d\u7f6e\u7684\u673a\u5668\u4e0a\u3002\u4f8b\u5982\uff0c\u6211\u4eec\u5237\u670b\u53cb\u5708\uff0c\u770b\u5230\u7684\u51e0\u4e4e\u90fd\u662f\u51e0\u5929\u4ee5\u5185\u7684\u7167\u7247\uff0c\u6700\u597d\u662f\u9a6c\u4e0a\u5c31\u80fd\u52a0\u8f7d\u51fa\u6765\uff0c\u8fd9\u90e8\u5206\u7167\u7247\u5360\u7684\u5bb9\u91cf\u6bd4\u8f83\u5c0f\uff1b\u51e0\u5929\u4ee5\u5916\u7684\u7167\u7247\u5219\u5f88\u5c11\u88ab\u8bbf\u95ee\u5230\uff0c\u800c\u4e14\u5bf9\u8bbf\u95ee\u901f\u5ea6\u8981\u6c42\u4e5f\u4e0d\u9ad8\uff0c\u4f46\u662f\u5b83\u4eec\u52a0\u8d77\u6765\u7684\u5360\u7528\u7a7a\u95f4\u975e\u5e38\u5927\u3002\u63d0\u4f9b\u9ad8\u901f\u8bbf\u95ee\u7684 SSD \u5bb9\u91cf\u5c0f\u3001\u4ef7\u683c\u9ad8\uff0c\u800c\u4fbf\u5b9c\u91cf\u5927\u7684 HDD \u8bbf\u95ee\u901f\u5ea6\u5219\u6bd4\u8f83\u6162\u3002\u6839\u636e\u8fd9\u79cd\u7279\u70b9\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5c06\u6bd4\u8f83\u201c\u65e7\u201d\u7684\u7167\u7247\u5b58\u653e\u5230 HDD \u5b58\u50a8\uff0c\u800c\u5c06\u6700\u8fd1\u7684\u7167\u7247\u5b58\u653e\u5230 SSD\u3002\u540c\u65f6\uff0c\u6bd4\u8f83\u201c\u65e7\u201d\u7684\u7167\u7247\u53ef\u4ee5\u4f7f\u7528\u538b\u7f29\u7b97\u6cd5\uff0c\u7528\u89e3\u538b\u65f6\u95f4\u6765\u6362\u53d6\u66f4\u5c11\u7684\u7a7a\u95f4\u5360\u7528\u3002</p>"},{"location":"paradigms/system-design/#\u9650\u6d41","title":"\u9650\u6d41","text":"<p>\u4e00\u4e9b\u6076\u610f\u7684\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5728\u77ed\u65f6\u95f4\u5185\u5927\u91cf\u53d1\u9001\u8bf7\u6c42\uff0c\u9020\u6210\u7cfb\u7edf\u6765\u4e0d\u53ca\u5904\u7406\u8fd9\u4e9b\u8bf7\u6c42\u800c\u6b7b\u673a\u7684\u540e\u679c\u3002\u53c8\u6216\u8005\u662f\u6240\u6709\u8bf7\u6c42\u90fd\u662f\u6b63\u5e38\u8bf7\u6c42\uff0c\u4f46\u662f\u5e94\u7528\u592a\u53d7\u6b22\u8fce\u4e86\uff0c\u5f88\u591a\u4eba\u53d1\u9001\u4e86\u8bf7\u6c42\uff0c\u7cfb\u7edf\u540c\u6837\u4f1a\u6765\u4e0d\u53ca\u5904\u7406\u8bf7\u6c42\u800c\u6b7b\u673a\u3002\u5728\u7cfb\u7edf\u5185\u90e8\uff0c\u4e5f\u53ef\u80fd\u56e0\u4e3a\u67d0\u4e9b\u670d\u52a1\u51fa\u73b0\u4e86 bug \u7b49\uff0c\u4e0d\u5c0f\u5fc3\u5411\u5176\u4ed6\u5185\u90e8\u670d\u52a1\u53d1\u9001\u4e86\u8fc7\u91cf\u7684\u8bf7\u6c42\u3002\u79cd\u79cd\u60c5\u51b5\u4e0b\uff0c\u4e3a\u4e86\u907f\u514d\u8ba1\u7b97\u8d44\u6e90\u8017\u5c3d\uff0c\u9700\u8981\u5bf9\u7cfb\u7edf\u8fdb\u884c\u9650\u6d41\u3002</p> <p>\u9650\u6d41\u7684\u601d\u60f3\u5c31\u662f\u7528\u8f83\u5c11\u7684\u8ba1\u7b97\u8d44\u6e90\u5148\u5224\u65ad\u4e00\u6b21\u7cfb\u7edf\u80fd\u4e0d\u80fd\u3001\u5e94\u4e0d\u5e94\u8be5\u5904\u7406\u4e00\u4e2a\u8bf7\u6c42\uff0c\u5982\u679c\u4e0d\u884c\uff0c\u5c31\u76f4\u63a5\u4e22\u5f03\u6216\u8005\u8fd4\u56de\u4e00\u4e2a\u9519\u8bef\uff0c\u4fdd\u62a4\u66f4\u591a\u7684\u8ba1\u7b97\u8d44\u6e90\u3002\u9650\u6d41\u9664\u4e86\u5728\u670d\u52a1\u7aef\u505a\uff0c\u8fd8\u53ef\u4ee5\u5728\u8bf7\u6c42\u53d1\u9001\u65b9\u505a\uff0c\u4f8b\u5982\u62a2\u7ea2\u5305\u7b49\u5e94\u7528\uff0c\u53ef\u4ee5\u5728 app \u91cc\u76f4\u63a5\u663e\u793a\u52a8\u753b\u8bf4\u6ca1\u62a2\u5230\uff0c\u8fde\u771f\u6b63\u7684\u8bf7\u6c42\u90fd\u4e0d\u4f1a\u6709\uff0c\u53c8\u6216\u8005\u662f\u8ba9\u5ba2\u6237\u7aef\u6536\u5230\u9650\u6d41\u9519\u8bef\u65f6\uff0c\u964d\u4f4e\u53d1\u9001\u8bf7\u6c42\u7684\u9891\u7387\u3002\u53e6\u5916\uff0c\u8fd8\u53ef\u4ee5\u8bf7\u4e00\u4e2a\u201c\u4ea4\u8b66\u201d\uff0c\u83b7\u53d6\u5168\u5c40\u7684\u6d41\u91cf\u4fe1\u606f\uff0c\u5e76\u76f4\u63a5\u53d1\u9001\u6307\u4ee4\u5230\u5ba2\u6237\u7aef\u9650\u6d41\u3002</p> <p>\u4e00\u822c\u6765\u8bf4\uff0c\u6211\u4eec\u4e0d\u4f1a\u8ba9\u7cfb\u7edf\u6ee1\u8f7d\uff0c\u4e00\u65b9\u9762\u540e\u53f0\u8fd0\u884c\u7684\u7ba1\u7406\u670d\u52a1\u9700\u8981\u4e00\u5b9a\u7684\u8ba1\u7b97\u8d44\u6e90\u6765\u5bf9\u7cfb\u7edf\u8fdb\u884c\u7ba1\u63a7\uff0c\u540c\u65f6\uff0c\u6839\u636e\u6392\u961f\u7406\u8bba\uff0c\u5047\u5982\u8bf7\u6c42\u5e73\u5747\u5230\u8fbe\u901f\u7387\u63a5\u8fd1\u7cfb\u7edf\u5904\u7406\u8bf7\u6c42\u6781\u9650\u901f\u7387\uff0c\u90a3\u4e48\u671f\u671b\u7684\u6392\u961f\u957f\u5ea6\u5c06\u8fbe\u5230\u65e0\u9650\u957f\uff0c\u4e5f\u5c31\u662f\u8fc7\u8f7d\u4e86\u3002</p>"},{"location":"parallel/multi-processing/","title":"\u591a\u8fdb\u7a0b\u7f16\u7a0b","text":"<p>\u76f8\u6bd4\u4e8e\u591a\u7ebf\u7a0b\u7f16\u7a0b\uff0c\u591a\u8fdb\u7a0b\u7f16\u7a0b\u6bcf\u4e2a\u8fdb\u7a0b\u4e4b\u95f4\u62e5\u6709\u66f4\u597d\u7684\u9694\u79bb\u6027\u3002\u4e00\u4e2a\u8fdb\u7a0b\u5d29\u6e83\u57fa\u672c\u4e0d\u4f1a\u5bfc\u81f4\u5176\u4ed6\u8fdb\u7a0b\u4e5f\u8ddf\u7740\u5d29\u6e83\u3002\u4f46\u662f\uff0c\u72ec\u7acb\u6027\u4e5f\u5e26\u6765\u4e86\u8fdb\u7a0b\u95f4\u5171\u4eab\u6570\u636e\u56f0\u96be\u7684\u95ee\u9898\u3002\u4f7f\u7528\u591a\u8fdb\u7a0b\u7f16\u7a0b\uff0c\u53ef\u4ee5\u50cf\u591a\u7ebf\u7a0b\u7f16\u7a0b\u4e00\u6837\uff0c\u4f7f\u7528\u5171\u4eab\u5185\u5b58\u6765\u5b8c\u6210\u8fdb\u7a0b\u95f4\u901a\u4fe1\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u7f51\u7edc\u6765\u8fdb\u884c\u901a\u4fe1\u3002\u4e00\u822c\u6765\u8bf4\uff0c\u5982\u679c\u9700\u8981\u7a0b\u5e8f\u8fd0\u884c\u5728\u4e0d\u540c\u7684\u673a\u5668\u4e0a\uff0c\u90a3\u4e48\u5c31\u53ea\u80fd\u91c7\u7528\u57fa\u4e8e\u7f51\u7edc\u901a\u4fe1\u7684\u591a\u8fdb\u7a0b\u7f16\u7a0b\u6a21\u578b\u4e86\uff0c\u8fd9\u4e5f\u662f\u5e38\u89c1\u7684\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u7f16\u7a0b\u6a21\u578b\u3002\u591a\u8fdb\u7a0b\u7a0b\u5e8f\u4e2d\uff0c\u6bcf\u4e2a\u7a0b\u5e8f\u81ea\u5df1\u4ecd\u7136\u53ef\u4ee5\u4f7f\u7528\u591a\u7ebf\u7a0b\u6a21\u578b\u6765\u63d0\u9ad8 CPU \u7684\u5229\u7528\u7387\u3002</p> \u591a\u7ebf\u7a0b\u548c\u591a\u8fdb\u7a0b <p>\u591a\u8fdb\u7a0b\u53ef\u4ee5\u7406\u89e3\u4e3a\u4e92\u4e0d\u5171\u4eab\u8d44\u6e90\u7684\u7ebf\u7a0b\uff0c\u53cd\u8fc7\u6765\u8bb2\uff0c\u7ebf\u7a0b\u4e5f\u53ef\u4ee5\u7406\u89e3\u4e3a\u5171\u4eab\u8d44\u6e90\u7684\u8fdb\u7a0b\uff0c\u5b83\u4eec\u7684\u754c\u9650\u6709\u65f6\u5019\u5e76\u4e0d\u662f\u90a3\u4e48\u6e05\u695a\u3002\u5728\u4e0d\u540c\u64cd\u4f5c\u7cfb\u7edf\u4e0a\uff0c\u6709\u7684\u4f1a\u5206\u5f00\u533a\u522b\uff0c\u521b\u5efa\u7ebf\u7a0b\u548c\u8fdb\u7a0b\u7684\u5f00\u9500\u4e5f\u6709\u533a\u522b\u3002\u4f8b\u5982\uff0cLinux \u4e2d\uff0c<code>clone</code> \u7cfb\u7edf\u8c03\u7528\u65e2\u53ef\u4ee5\u7528\u6765\u521b\u5efa\u8fdb\u7a0b\uff0c\u4e5f\u53ef\u4ee5\u7528\u6765\u521b\u5efa\u7ebf\u7a0b\uff0c\u65e0\u8bba\u662f <code>fork</code> \u8fd8\u662f <code>pthread_create</code>\uff0c\u6700\u7ec8\u90fd\u4f1a\u4f7f\u7528 <code>clone</code> \u6765\u521b\u5efa\u8fdb\u7a0b/\u7ebf\u7a0b\u3002\u7ebf\u7a0b\u5728 Linux \u4e2d\u4e5f\u53eb\u505a\u8f7b\u91cf\u8fdb\u7a0b\uff08Light-weight Process, LWP\uff09\u3002</p> <p>\u7ecf\u5178\u7684\u4f7f\u7528\u591a\u8fdb\u7a0b\u7684\u7a0b\u5e8f\u6709 nginx\u3001PostgreSQL \u7b49\uff0c\u5176\u4e2d nginx \u4f7f\u7528\u591a\u8fdb\u7a0b\u7684\u4e3b\u8981\u76ee\u7684\u662f\u8d1f\u8f7d\u5747\u8861\uff0c\u4e0d\u540c\u7684\u5ba2\u6237\u7aef\u8fde\u63a5\u5c06\u4f1a\u5206\u914d\u5230\u4e0d\u540c\u5de5\u4f5c\u8fdb\u7a0b\u8fdb\u884c\u5904\u7406\uff0c\u4e00\u4e2a\u5de5\u4f5c\u8fdb\u7a0b\u4f1a\u5904\u7406\u591a\u4e2a\u8fde\u63a5\uff0c\u800c PostgreSQL \u5219\u662f\u4e3a\u6bcf\u4e00\u4e2a\u5ba2\u6237\u7aef\u8fde\u63a5\u90fd\u5f00\u542f\u65b0\u7684\u8fdb\u7a0b\uff0c\u4e00\u4e2a\u8fdb\u7a0b\u53ea\u5904\u7406\u4e00\u4e2a\u8fde\u63a5\u3002</p> <p>\u5728\u591a\u7ebf\u7a0b\u7f16\u7a0b\u4e2d\uff0c\u7531\u4e8e\u7ebf\u7a0b\u4e4b\u95f4\u5171\u4eab\u8d44\u6e90\uff0c\u6240\u4ee5\u6211\u4eec\u5c06\u6ce8\u610f\u529b\u653e\u5230\u4e86\u5982\u4f55\u907f\u514d\u5171\u4eab\u8d44\u6e90\u51fa\u9519\uff0c\u4e5f\u5c31\u662f\u907f\u514d\u7ade\u6001\u6761\u4ef6\u4e0a\u3002\u800c\u5728\u591a\u8fdb\u7a0b\u7f16\u7a0b\u91cc\uff0c\u6211\u4eec\u9996\u5148\u9700\u8981\u89e3\u51b3\u5982\u4f55\u8ba9\u591a\u4e2a\u8fdb\u7a0b\u8fdb\u884c\u901a\u4fe1\u7684\u95ee\u9898\u3002</p>"},{"location":"parallel/multi-processing/#system-v-ipc","title":"System V IPC","text":"<p>\u5927\u591a\u6570\u64cd\u4f5c\u7cfb\u7edf\uff0c\u4f8b\u5982 Linux\u3001Solaris \u7b49\u90fd\u5b9e\u73b0\u4e86 System V \u4e2d\u5f15\u5165\u7684 IPC API\u3002\u800c\u5728 Windows \u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u901a\u5e38\u4e5f\u80fd\u627e\u5230\u529f\u80fd\u548c\u5b83\u4eec\u76f8\u4f3c\u7684\u51fd\u6570\u3002</p> <p>\u8fd9\u5957\u7ecf\u5178\u7684 API \u5305\u542b\u4ee5\u4e0b\u7ec4\u6210\u90e8\u5206\u3002\u5176\u4e2d\u524d\u4e09\u79cd\u662f\u652f\u6301\u6700\u5e7f\u6cdb\u7684\u3002</p> <ul> <li>\u4fe1\u53f7\u91cf\uff08Semaphore\uff09</li> <li>\u6d88\u606f\u961f\u5217\uff08Message queue\uff09</li> <li>\u5171\u4eab\u5185\u5b58\uff08Shared memory\uff09</li> <li>\u7ba1\u9053\uff08Pipe\uff09</li> </ul>"},{"location":"parallel/multi-processing/#\u4fe1\u53f7\u91cf","title":"\u4fe1\u53f7\u91cf","text":"<p>\u548c\u6211\u4eec\u5728\u591a\u7ebf\u7a0b\u7f16\u7a0b\u4e2d\u4ecb\u7ecd\u7684 POSIX \u4fe1\u53f7\u91cf\u4e0d\u540c\uff0cSystem V \u4fe1\u53f7\u91cf\u66f4\u52a0\u590d\u6742\u3002</p>"},{"location":"parallel/multi-processing/#\u6d88\u606f\u961f\u5217","title":"\u6d88\u606f\u961f\u5217","text":"<p>\u6d88\u606f\u961f\u5217\u548c\u591a\u7ebf\u7a0b\u7f16\u7a0b\u4e2d\u7684\u5171\u4eab\u961f\u5217\u7c7b\u4f3c\uff0c\u591a\u4e2a\u751f\u4ea7\u8005\u8fdb\u7a0b\u53ef\u4ee5\u5411\u961f\u5217\u4e2d\u653e\u5165\u6d88\u606f\uff0c\u6d88\u8d39\u8005\u8fdb\u7a0b\u5219\u53ef\u4ee5\u4ece\u961f\u5217\u4e2d\u83b7\u53d6\u6d88\u606f\u3002POSIX \u6d88\u606f\u961f\u5217\u8fd8\u652f\u6301\u4e8b\u4ef6\u901a\u77e5\uff0c\u914d\u5408 <code>poll</code> \u548c <code>epoll</code> \u7b49\u4e8b\u4ef6\u9a71\u52a8\u673a\u5236\uff0c\u53ef\u4ee5\u4e0d\u9700\u8981\u8f6e\u8be2\u961f\u5217\u72b6\u6001\u3002</p>"},{"location":"parallel/multi-processing/#\u5171\u4eab\u5185\u5b58","title":"\u5171\u4eab\u5185\u5b58","text":"<p>\u5728\u591a\u8fdb\u7a0b\u7f16\u7a0b\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528\u5171\u4eab\u5185\u5b58\u7684\u65b9\u6cd5\u6765\u89e3\u9664\u4e00\u7247\u5185\u5b58\u533a\u57df\u7684\u9694\u79bb\u6027\uff0c\u4ece\u800c\u4f7f\u591a\u4e2a\u8fdb\u7a0b\u80fd\u591f\u540c\u65f6\u8bfb\u5199\u540c\u4e00\u7247\u5185\u5b58\u7a7a\u95f4\uff0c\u5c31\u548c\u591a\u7ebf\u7a0b\u7f16\u7a0b\u4e00\u6837\u3002\u5171\u4eab\u5185\u5b58\u7684\u539f\u7406\u662f\uff0c\u64cd\u4f5c\u7cfb\u7edf\u5c06\u540c\u4e00\u7247\u7269\u7406\u5185\u5b58\u6620\u5c04\u5230\u4e0d\u540c\u8fdb\u7a0b\u4e2d\u7684\u865a\u62df\u5730\u5740\u7a7a\u95f4\u4e2d\uff0c\u5e76\u8bbe\u7f6e\u9875\u8868\u9879\u3002\u7136\u800c\uff0c\u4e0d\u540c\u8fdb\u7a0b\u88ab\u6620\u5c04\u5230\u7684\u865a\u62df\u5730\u5740\u53ef\u80fd\u4e0d\u540c\uff0c\u56e0\u6b64\u4e0d\u80fd\u50cf\u5728\u591a\u7ebf\u7a0b\u7f16\u7a0b\u4e2d\u4e00\u6837\uff0c\u5728\u4e0d\u540c\u8fdb\u7a0b\u4e4b\u95f4\u76f4\u63a5\u4f20\u9012\u88f8\u6307\u9488\u3002</p> <p>\u901a\u5e38\u6765\u8bf4\uff0c\u6211\u4eec\u9700\u8981\u4f20\u9012\u4e00\u4e2a\u95f4\u63a5\u6307\u9488\uff0c\u6216\u8005\u504f\u79fb\u91cf\u3002\u4f8b\u5982\u6211\u4eec\u53ef\u4ee5\u5c06\u4e00\u7247\u5185\u5b58\u7a7a\u95f4\u4f5c\u4e3a\u4e00\u4e2a\u6574\u5f62\u6570\u7ec4\u4f7f\u7528\uff0c\u90a3\u4e48\u6b64\u65f6\u53ef\u4ee5\u4f7f\u7528\u6570\u7ec4\u7d22\u5f15\u7684\u65b9\u6cd5\uff0c\u6765\u8bbf\u95ee\u8fd9\u7247\u5185\u5b58\u7684\u5355\u4e2a\u503c\u3002</p>"},{"location":"parallel/multi-processing/#\u7ba1\u9053","title":"\u7ba1\u9053","text":"<p>\u7ba1\u9053\u987e\u540d\u601d\u4e49\uff0c\u5c31\u662f\u5c06\u4e24\u4e2a\u8fdb\u7a0b\u8fde\u63a5\u8d77\u6765\uff0c\u5b83\u7c7b\u4f3c\u4e8e\u6ca1\u6709\u7f13\u51b2\u7a7a\u95f4\u7684\u6d88\u606f\u961f\u5217\uff0c\u5f53\u4e00\u4e2a\u8fdb\u7a0b\u5411\u7ba1\u9053\u5199\u5165\u6570\u636e\u65f6\uff0c\u5c06\u963b\u585e\u7b49\u5f85\uff0c\u76f4\u5230\u6709\u53e6\u4e00\u4e2a\u8fdb\u7a0b\u4ece\u7ba1\u9053\u4e2d\u8bfb\u53d6\u6570\u636e\u3002\u7ba1\u9053\u5206\u4e3a\u533f\u540d\u7ba1\u9053\u548c\u547d\u540d\u7ba1\u9053\uff0c\u533f\u540d\u7ba1\u9053\u901a\u5e38\u7528\u4e8e\u7236\u5b50\u8fdb\u7a0b\u4e4b\u95f4\u7684\u901a\u4fe1\uff0c\u800c\u547d\u540d\u7ba1\u9053\u5219\u65b9\u4fbf\u591a\u4e2a\u8fdb\u7a0b\u4e4b\u95f4\u901a\u4fe1\u3002</p>"},{"location":"parallel/multi-threading/","title":"\u6982\u89c8","text":"<p>\u5728\u670d\u52a1\u5668\u7a0b\u5e8f\u4e2d\uff0c\u4e3a\u4e86\u66f4\u5145\u5206\u5730\u5229\u7528\u73b0\u4ee3 CPU \u7684\u591a\u6838\u6027\u80fd\uff0c\u4e00\u822c\u4f1a\u4f7f\u7528\u591a\u7ebf\u7a0b\u7f16\u7a0b\u7684\u65b9\u5f0f\u6765\u4f7f\u6211\u4eec\u7684\u7a0b\u5e8f\u5c3d\u53ef\u80fd\u591a\u5730\u5904\u7406\u5e76\u884c\u8bf7\u6c42\u3002\u672c\u8282\u7b80\u5355\u4ecb\u7ecd C++ \u4e2d\u5e38\u7528\u7684\u591a\u7ebf\u7a0b\u7f16\u7a0b\u5e93\u4ee5\u53ca\u7f16\u7a0b\u8303\u5f0f\u3002</p>"},{"location":"parallel/multi-threading/#\u4f7f\u7528-stdthread-\u542f\u52a8\u591a\u4e2a\u7ebf\u7a0b","title":"\u4f7f\u7528 <code>std::thread</code> \u542f\u52a8\u591a\u4e2a\u7ebf\u7a0b","text":"<p>\u5728 C++ \u4e2d\uff0c\u8981\u542f\u52a8\u591a\u4e2a\u7ebf\u7a0b\uff0c\u53ea\u9700\u8981\u4f7f\u7528 <code>std::thread</code> \u8fd9\u4e2a\u7c7b\u3002\u7c7b\u7684\u6784\u9020\u51fd\u6570\u7b2c\u4e00\u4e2a\u53c2\u6570\u4e3a\u5e0c\u671b\u6267\u884c\u7684\u51fd\u6570\uff0c\u540e\u9762\u7684\u53c2\u6570\u5219\u662f\u9700\u8981\u4f20\u9012\u7ed9\u8fd9\u4e2a\u51fd\u6570\u7684\u53c2\u6570\u3002\u5f53 <code>std::thread</code> \u5bf9\u8c61\u88ab\u521b\u5efa\u7684\u65f6\u5019\uff0c\u7ebf\u7a0b\u5c31\u4f1a\u5f00\u59cb\u6267\u884c\u3002\u5982\u679c\u6211\u4eec\u9700\u8981\u7b49\u5f85\u7ebf\u7a0b\u6267\u884c\u5b8c\u6bd5\u624d\u9000\u51fa\uff0c\u90a3\u4e48\u9700\u8981\u8c03\u7528\u7ebf\u7a0b\u5bf9\u8c61\u7684 <code>join()</code> \u65b9\u6cd5\u3002</p> mt1.cpp <pre><code>#include &lt;thread&gt;\n#include &lt;iostream&gt;\n\nvoid thread_function(int a) {\n    std::cout &lt;&lt; \"a = \" &lt;&lt; a &lt;&lt; std::endl;\n}\n\nint main() {\n    std::thread t1(thread_function, 1); \n    std::thread t2(thread_function, 2); \n\n    t1.join();\n    t2.join();\n\n    return 0;\n}\n</code></pre> <p>\u5982\u679c\u6211\u4eec\u4e0d\u8c03\u7528\u7ebf\u7a0b\u7684 <code>join()</code> \u65b9\u6cd5\uff0c\u90a3\u4e48\u7a0b\u5e8f\u7ed3\u675f\u65f6\u5c06\u4f1a\u51fa\u9519\u3002</p> <pre><code>$ g++ mt1.cpp -lpthread\n$ ./a.out \nterminate called without an active exception\n[1]    1245899 abort (core dumped)  ./a.out\n</code></pre> <p>\u5982\u679c\u6211\u4eec\u5e0c\u671b\u542f\u52a8\u7ebf\u7a0b\u540e\u5c31\u4e0d\u9700\u8981\u5173\u5fc3\u7ebf\u7a0b\u7684\u72b6\u6001\uff0c\u53ef\u4ee5\u8c03\u7528 <code>detach()</code> \u65b9\u6cd5\u5c06\u7ebf\u7a0b\u72ec\u7acb\u51fa\u53bb\u3002</p> mt1.cpp <pre><code>#include &lt;thread&gt;\n#include &lt;iostream&gt;\n\nvoid thread_function(int a) {\n    std::cout &lt;&lt; \"a = \" &lt;&lt; a &lt;&lt; std::endl;\n}\n\nint main() {\n    std::thread t1(thread_function, 1); \n    std::thread t2(thread_function, 2); \n\n    t1.detach();\n    t2.detach();\n\n    return 0;\n}\n</code></pre> Info <p><code>std::thread</code> \u7684\u6784\u9020\u51fd\u6570\u9ed8\u8ba4\u4f7f\u7528\u62f7\u8d1d\u4f20\u503c\u3002\u8fd9\u610f\u5473\u7740\u5982\u679c\u4f60\u7684\u51fd\u6570\u671f\u671b\u6536\u5230\u4e00\u4e2a\u5f15\u7528\uff0c\u7b80\u5355\u5730\u5411\u7ebf\u7a0b\u6784\u9020\u51fd\u6570\u4f20\u5165\u53d8\u91cf\u662f\u4e0d\u884c\u7684\uff0c\u8fd9\u79cd\u884c\u4e3a\u5728\u73b0\u4ee3 C++ \u7f16\u8bd1\u5668\u4e2d\u4f1a\u88ab\u89c6\u4e3a\u7f16\u8bd1\u9519\u8bef\uff0c\u5c31\u50cf\u4e0b\u9762\u7684\u4ee3\u7801\u4e00\u6837\uff1a</p> mt.cpp <pre><code>#include &lt;thread&gt;\n#include &lt;iostream&gt;\n\nvoid thread_function(int &amp;value) {\n    // \u671f\u671b\u6536\u5230\u4e00\u4e2a\u5f15\u7528\uff0c\u8fd9\u6837\u5c31\u80fd\u6539\u53d8\u5b83\u7684\u503c\n    value++;\n}\n\nint main() {\n    int value = 0;\n    std::thread t(thread_function, value); // \u76f4\u63a5\u4f20\u5165 value\n    t.join();\n    std::cout &lt;&lt; value &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre> <p>\u6839\u636e cppreference.com\uff0c\u6211\u4eec\u9700\u8981\u5728\u4f20\u5165\u5f15\u7528\u65f6\u4f7f\u7528 <code>std::ref</code> \u6765\u5305\u88f9\u53d8\u91cf\u540d\uff0c\u5373\u5c06\u4e0a\u9762\u4ee3\u7801\u7684 <code>std::thread</code> \u6784\u9020\u51fd\u6570\u8c03\u7528\u4e2d\u7684\u53c2\u6570 <code>value</code> \u6539\u4e3a <code>std::ref(value)</code>\u3002</p> <p>\u5f53\u51fd\u6570\u9700\u8981\u5e38\u91cf\u5f15\u7528\u65f6\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u4f7f\u7528 <code>std::cref</code>\u3002</p>"},{"location":"parallel/multi-threading/#\u7ebf\u7a0b\u95f4\u540c\u6b65","title":"\u7ebf\u7a0b\u95f4\u540c\u6b65","text":"<p>\u5728\u5f88\u591a\u573a\u666f\u4e0b\uff0c\u4e0d\u540c\u7684\u7ebf\u7a0b\u4e4b\u95f4\u9700\u8981\u4f20\u9012\u4fe1\u606f\u4ee5\u8fbe\u6210\u67d0\u79cd\u534f\u4f5c\u5173\u7cfb\u3002</p> <p>\u4f8b\u5982\uff1a\u5728\u4e00\u4e2a\u57fa\u4e8e\u591a\u7ebf\u7a0b\u6280\u672f\u7684\u6570\u636e\u8ba1\u7b97\u8f6f\u4ef6\u91cc\uff0c\u6709\u4e00\u4e2a\u7ebf\u7a0b\u8d1f\u8d23\u8bfb\u53d6\u7528\u6237\u8f93\u5165\u7684\u6570\u636e\uff0c\u8fd8\u6709\u82e5\u5e72\u4e2a\u7ebf\u7a0b\u8d1f\u8d23\u6839\u636e\u8f93\u5165\u7684\u6570\u636e\u6267\u884c\u76f8\u5f53\u8d39\u65f6\u7684\u67e5\u8be2\u4efb\u52a1\u3002\u5728\u8fd9\u4e00\u573a\u666f\u4e0b\uff0c\u6211\u4eec\u901a\u5e38\u5c06\u524d\u4e00\u4e2a\u7ebf\u7a0b\u79f0\u4e3a\u751f\u4ea7\u8005\u7ebf\u7a0b\uff0c\u5c06\u540e\u4e00\u4e2a\u7ebf\u7a0b\u79f0\u4e3a\u6d88\u8d39\u8005\u7ebf\u7a0b\u3002\u5b83\u4eec\u4e4b\u95f4\u9700\u8981\u4f20\u9012\u7528\u6237\u8f93\u5165\u7684\u6570\u636e\u6765\u8ba9\u6574\u4e2a\u8f6f\u4ef6\u7684\u529f\u80fd\u5f97\u4ee5\u5b9e\u73b0\u3002</p> <p>\u4e3a\u4e86\u5b8c\u6210\u7ebf\u7a0b\u4e4b\u95f4\u7684\u4ea4\u6d41\uff0c\u6709\u4e00\u79cd\u529e\u6cd5\u662f\u5171\u4eab\u5185\u5b58\u3002\u5b83\u5229\u7528\u4e86\u4e00\u4e2a\u4e8b\u5b9e\uff1a\u7531\u540c\u4e00\u4e2a\u8fdb\u7a0b\u4ea7\u751f\u7684\u4e0d\u540c\u7ebf\u7a0b\uff0c\u5171\u4eab\u4e86\u539f\u8fdb\u7a0b\u7684\u5185\u5b58\u7a7a\u95f4\u3002\u8fd9\u610f\u5473\u7740\u4e00\u4e2a\u7ebf\u7a0b\u80fd\u591f\u8bbf\u95ee\u7684\u53d8\u91cf\uff0c\u5927\u90e8\u5206\u4e5f\u80fd\u591f\u88ab\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u6240\u8bbf\u95ee\u3002\u4e0b\u9762\u6211\u4eec\u5c55\u793a\u4e00\u6bb5\u5b9e\u73b0\u4e86\u4e0a\u8ff0\u8f6f\u4ef6\u529f\u80fd\u7684\u4ee3\u7801\uff1a</p> bad_case.cpp <pre><code>int list[100];  // \u7528\u6765\u5b58\u50a8\u7528\u6237\u8f93\u5165\u7684\u6570\u636e\uff0c\u6bcf\u4e00\u4efd\u6570\u636e\u7528 int \u8868\u793a\nint index = -1; // \u7528 index \u6307\u5411\u5f53\u524d\u8fd8\u6ca1\u6709\u88ab\u5904\u7406\u7684\u6570\u636e\n\nvoid producer() {\n    while (true) {\n        // \u8fd9\u91cc\u5ffd\u7565\u5bf9 list \u662f\u5426\u9971\u548c\u7684\u68c0\u67e5\n        // \u4e0b\u9762\u83b7\u53d6\u7528\u6237\u8f93\u5165\u7684\u6570\u636e\u5e76\u5199\u5165 list \u4e2d\uff0c\u5982\u679c\u7528\u6237\n        // \u6ca1\u6709\u8f93\u5165\u90a3\u4e48\u7ebf\u7a0b\u5c31\u4f1a\u5361\u5728 read_data() \u8c03\u7528\u5185\u90e8\u800c\u4e0d\u4f1a\u8fd4\u56de\n        list[index + 1] = read_data(); \n        index++;\n    }\n}\n\nvoid consumer() {\n    while (index &gt;= 0) {\n        int data = list[index--]; // \u4ece list \u4e2d\u62ff\u5230\u6570\u636e\n        do_calculate(data);\n    }\n}\n</code></pre> <p>\u4e0a\u8ff0\u4ee3\u7801\u770b\u4e0a\u53bb\u4f3c\u4e4e\u53ef\u4ee5\u6b63\u5e38\u5de5\u4f5c\uff0c\u7136\u800c\u771f\u6b63\u8fd0\u884c\u7684\u65f6\u5019\u6211\u4eec\u5f88\u53ef\u80fd\u770b\u5230\u4e00\u4e9b\u9519\u8bef\u7684\u73b0\u8c61\uff0c\u4f8b\u5982\u7528\u6237\u8f93\u5165\u4e86\u4e00\u4efd\u6570\u636e\uff0c\u7ed3\u679c\u4e24\u4e2a\u6d88\u8d39\u8005\u7ebf\u7a0b\u90fd\u62ff\u5230\u4e86\u8fd9\u4e2a\u6570\u636e\uff0c\u91cd\u590d\u5730\u5bf9\u6570\u636e\u8fdb\u884c\u4e86\u8ba1\u7b97\u3002\u53c8\u5982\uff0c\u7528\u6237\u8f93\u5165\u4e86\u65b0\u7684\u4e00\u4efd\u6570\u636e\u4e4b\u540e\uff0c\u59cb\u7ec8\u6ca1\u6709\u7b49\u5230\u6d88\u8d39\u8005\u7ebf\u7a0b\u7684\u8f93\u51fa\u3002\u8fd8\u6709\u53ef\u80fd\u6211\u4eec\u7684\u7a0b\u5e8f\u4f1a\u5728\u8f93\u5165\u6570\u636e\u540e\u76f4\u63a5\u5d29\u6e83\uff08\u8bbf\u95ee\u4e86\u65e0\u6548\u7684\u6570\u7ec4\u4e0b\u6807\uff09\u3002\u8fd9\u6bb5\u4ee3\u7801\u5145\u6ee1\u4e86\u95ee\u9898\uff01</p>"},{"location":"parallel/multi-threading/#\u7ade\u6001\u6761\u4ef6","title":"\u7ade\u6001\u6761\u4ef6","text":"<p>\u5bfc\u81f4\u4e0a\u8ff0\u73b0\u8c61\u7684\u539f\u56e0\u662f\uff1a\u591a\u4e2a\u7ebf\u7a0b\u5bf9 <code>index</code> \u53d8\u91cf\u7ade\u4e89\u8bbf\u95ee\u4e0e\u4fee\u6539\uff0c\u5bfc\u81f4\u4e86\u7ade\u6001\u6761\u4ef6\uff08race condition\uff09\u7684\u4ea7\u751f\u3002\u7b80\u5355\u6765\u8bf4\uff0c\u7ade\u6001\u6761\u4ef6\u7684\u53d1\u751f\u662f\u56e0\u4e3a\uff1a\u67d0\u79cd\u64cd\u4f5c\u7684\u7ed3\u679c\u4f9d\u8d56\u4e8e\u4e24\u4e2a\u6216\u591a\u4e2a\u7ebf\u7a0b\u8fdb\u884c\u7684\u64cd\u4f5c\u7684\u76f8\u5bf9\u987a\u5e8f\u3002</p> <p>\u6211\u4eec\u89e3\u91ca\u5176\u4e2d\u4e00\u4e2a\u73b0\u8c61\u2014\u2014\u91cd\u590d\u8fd0\u7b97\u7684\u539f\u56e0\u3002\u7531\u4e8e\u591a\u4e2a\u7ebf\u7a0b\u4e4b\u95f4\u5e76\u53d1\u8fd0\u884c\uff0c\u5b83\u4eec\u4e2d\u7684\u4ee3\u7801\u7684\u6267\u884c\u987a\u5e8f\u662f\u76f8\u4e92\u72ec\u7acb\u7684\u3002\u56e0\u6b64\u5f53\u751f\u4ea7\u8005\u7ebf\u7a0b\u5f97\u5230\u4e86\u7528\u6237\u7684\u8f93\u5165\uff0c\u5c06 <code>index</code> \u7f6e\u4e3a <code>1</code> \u4e4b\u540e\uff0c\u5047\u8bbe\u6709\u4e24\u4e2a\u6d88\u8d39\u8005\u7ebf\u7a0b A \u548c B\uff0c\u5b83\u4eec\u90fd\u5c1d\u8bd5\u8bfb\u53d6 <code>index</code> \u7684\u503c\u5e76\u53d1\u73b0\u5b83\u5df2\u7ecf\u5927\u4e8e\u7b49\u4e8e <code>0</code>\uff0c\u4e8e\u662f\u987a\u5229\u5730\u8fdb\u5165\u4e86\u5faa\u73af\u5185\u90e8\u3002\u8fd9\u79cd\u60c5\u51b5\u4e5f\u6709\u53ef\u80fd\u4e0d\u4f1a\u53d1\u751f\uff0c\u5f53 A \u7ebf\u7a0b\u52a8\u4f5c\u5feb\u4e00\u4e9b\u5728\u5b8c\u6210\u4e86 <code>index--</code> \u4e4b\u540e\uff0cB \u7ebf\u7a0b\u5c31\u4e0d\u4f1a\u8fdb\u5165\u5faa\u73af\u4e86\u3002</p> <p>\u6b63\u5982\u6211\u4eec\u524d\u9762\u63d0\u5230\u7684\uff0c\u5e76\u53d1\u7ebf\u7a0b\u7684\u4ee3\u7801\u6267\u884c\u987a\u5e8f\u76f8\u4e92\u72ec\u7acb\uff0c\u56e0\u6b64\u6211\u4eec\u4e0d\u80fd\u5bf9\u5b83\u4eec\u4f1a\u4ee5\u4f55\u79cd\u987a\u5e8f\u8bbf\u95ee\u5171\u4eab\u53d8\u91cf <code>index</code> \u4f5c\u51fa\u4efb\u4f55\u5047\u8bbe\uff0c\u8fd9\u548c\u7ade\u6001\u6761\u4ef6\u53d1\u751f\u7684\u539f\u56e0\u76f8\u547c\u5e94\u3002\u6709\u5174\u8da3\u7684\u8bfb\u8005\u53ef\u4ee5\u81ea\u884c\u63a8\u5bfc\u5176\u4ed6\u4e24\u79cd\u60c5\u666f\u4ea7\u751f\u7684\u539f\u56e0\uff0c\u5b83\u4eec\u90fd\u662f\u57fa\u4e8e\u67d0\u79cd\u6709\u95ee\u9898\u7684\u53d8\u91cf\u8bbf\u95ee\u987a\u5e8f\u3002</p> Info <p>\u4e0a\u8ff0\u7684\u4f8b\u5b50\u51c6\u786e\u6765\u8bf4\u5e94\u8be5\u53eb\u505a\u6570\u636e\u7ade\u4e89\uff08data race\uff09\uff0c\u5b83\u53ea\u662f\u7ade\u6001\u6761\u4ef6\u7684\u5176\u4e2d\u4e00\u79cd\uff0c\u5374\u4e5f\u662f\u8ba1\u7b97\u673a\u8f6f\u4ef6\u91cc\u6700\u5e38\u89c1\u7684\u79cd\u7c7b\u4e4b\u4e00\u3002\u672c\u6587\u4e2d\u7684\u7ade\u6001\u6761\u4ef6\u6307\u7684\u90fd\u662f\u6570\u636e\u7ade\u4e89\u3002</p> \u4f7f\u7528 ThreadSanitizer \u68c0\u67e5\u6570\u636e\u7ade\u4e89 <p>\u5728\u7f16\u8bd1\u65f6\u6253\u5f00 <code>-fsanitize=thread</code> \u9009\u9879\uff0c\u5373\u53ef\u5728\u7a0b\u5e8f\u8fd0\u884c\u7684\u65f6\u5019\u68c0\u67e5\u6570\u636e\u7ade\u4e89\u95ee\u9898\u3002</p>"},{"location":"parallel/multi-threading/#\u4e92\u65a5\u91cf","title":"\u4e92\u65a5\u91cf","text":"<p>\u4e3a\u4e86\u5728\u5171\u4eab\u5185\u5b58\u65f6\u907f\u514d\u7ade\u6001\u6761\u4ef6\u5bfc\u81f4\u7684\u9519\u8bef\u7ed3\u679c\uff0c\u4eba\u4eec\u53d1\u660e\u4e86\u8bb8\u591a\u624b\u6bb5\u3002\u5176\u4e2d\u6700\u7b80\u5355\u7684\u624b\u6bb5\u662f\u4f7f\u7528\u4e92\u65a5\u91cf\uff08mutex\uff09\u4fdd\u62a4\u5b58\u5728\u7ade\u6001\u6761\u4ef6\u7684\u53d8\u91cf\u3002\u5c06\u4e0a\u6587\u7684\u4ee3\u7801\u7247\u6bb5\u4fee\u6539\u4e3a\u5982\u4e0b\u6240\u793a\u5c31\u80fd\u89e3\u51b3\u7ade\u6001\u6761\u4ef6\u5bfc\u81f4\u7684\u95ee\u9898\uff1a</p> with_mutex.cpp <pre><code>int list[100];  // \u7528\u6765\u5b58\u50a8\u7528\u6237\u8f93\u5165\u7684\u6570\u636e\uff0c\u6bcf\u4e00\u4efd\u6570\u636e\u7528 `int` \u8868\u793a\nint index = -1; // \u7528 `index` \u6307\u5411\u5f53\u524d\u8fd8\u6ca1\u6709\u88ab\u5904\u7406\u7684\u6570\u636e\nstd::mutex m;\n\nvoid producer() {\n    while (true) {\n        // \u628a\u4f1a\u963b\u585e\u7ebf\u7a0b\u8fd0\u884c\u7684\u64cd\u4f5c\u5355\u72ec\u653e\u51fa\u6765\n        int data = read_data();\n        m.lock();\n        list[index + 1] = data; \n        index++;\n        m.unlock();\n    }\n}\n\nvoid consumer() {\n    while (true) {\n        m.lock();\n        if (index &lt; 0) {\n            m.unlock(); // \u5728\u4f7f\u7528 `continue` \u548c `break` \u8bed\u53e5\u65f6\u975e\u5e38\u5bb9\u6613\u5fd8\u8bb0\u8fdb\u884c `unlock()`\n            continue;   // \u6ca1\u6709\u65b0\u6570\u636e\u65f6\u76f4\u63a5\u8df3\u8fc7\u672c\u6b21\u5faa\u73af\n        }\n        int data = list[index--];\n        m.unlock();\n        // \u4e0b\u9762\u590d\u6742\u7684\u8ba1\u7b97\u4e0d\u9700\u8981\u8bbf\u95ee `index`\n        // \u56e0\u6b64\u4e0d\u4f1a\u51fa\u73b0\u7ade\u6001\u6761\u4ef6\n        do_calculate(data);\n    }\n}\n</code></pre> <p>\u5bf9\u4e92\u65a5\u91cf\u8fdb\u884c <code>lock()</code> \u64cd\u4f5c\u662f\u5728\u5c1d\u8bd5\u83b7\u5f97\u4e00\u4e2a\u201c\u72ec\u4eab\u6743\u201d\uff0c\u4e00\u65e6\u5f53\u524d\u7ebf\u7a0b\u83b7\u5f97\u4e86\u8fd9\u4e2a\u6743\u5229\uff0c\u5176\u4ed6\u7ebf\u7a0b\u5728\u8c03\u7528 <code>lock()</code> \u65f6\u5c31\u65e0\u6cd5\u83b7\u5f97\u8fd9\u79cd\u6743\u5229\uff0c\u4e00\u76f4\u88ab\u963b\u585e\u65e0\u6cd5\u8fdb\u884c\u4e0b\u4e00\u6b65\u64cd\u4f5c\u3002\u76f4\u5230\u62ff\u5230\u4e86\u6743\u5229\u7684\u7ebf\u7a0b\u901a\u8fc7 <code>unlock()</code> \u653e\u5f03\u6743\u5229\u4e4b\u540e\uff0c\u88ab\u963b\u585e\u7684\u7ebf\u7a0b\u4eec\u53c8\u4f1a\u8fdb\u5165\u4e0b\u4e00\u8f6e\u4e89\u593a\u3002\u7531\u6b64\uff0c\u6211\u4eec\u901a\u8fc7\u4f7f\u7528\u4e92\u65a5\u91cf\uff0c\u5728 <code>lock()</code> \u548c <code>unlock()</code> \u7684\u4ee3\u7801\u4e4b\u95f4\u786e\u4fdd\u4e86\uff1a\u5728\u4efb\u610f\u65f6\u95f4\u70b9\uff0c\u6700\u591a\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u4f1a\u8bbf\u95ee <code>list</code> \u548c <code>index</code>\uff0c\u7ade\u6001\u6761\u4ef6\u4e0d\u590d\u5b58\u5728\u3002</p> <p>\u6240\u8c13\u7684\u201c\u72ec\u4eab\u6743\u201d\u4e5f\u88ab\u6bd4\u55bb\u4e3a\u9501\uff0c\u5c31\u597d\u50cf\u4e0a\u9501\u4e4b\u540e\u522b\u4eba\u5c31\u65e0\u6cd5\u8fdb\u95e8\uff0c\u76f4\u5230\u81ea\u5df1\u89e3\u9501\u624d\u884c\uff0c\u8fd9\u4e5f\u662f\u4e0a\u8ff0\u4e24\u4e2a\u51fd\u6570\u540d\u5b57\u7684\u7531\u6765\u3002\u800c\u4e14\u4e5f\u7531\u4e8e\u4e0a\u9762\u8fd9\u79cd\u5e38\u89c1\u7684\u7528\u6cd5\uff0c\u4e92\u65a5\u91cf\u4e5f\u88ab\u79f0\u4e3a\u4e92\u65a5\u9501\u3002\u53e6\u5916\uff0c<code>lock()</code> \u548c <code>unlock()</code> \u5305\u88f9\u7684\u8fd9\u6bb5\u4ee3\u7801\u88ab\u79f0\u4e3a\u4e34\u754c\u533a\uff08critical section\uff09\uff0c\u56e0\u4e3a\u5b83\u4eec\u8bbf\u95ee\u4e86\u76f8\u540c\u7684\u5171\u4eab\u53d8\u91cf\u3002</p> \u5c3d\u91cf\u7f29\u77ed\u4e34\u754c\u533a <p>\u4e3a\u4e86\u63d0\u9ad8\u5e76\u53d1\u5ea6\u4ee5\u53ca\u6267\u884c\u6548\u7387\uff0c\u4e34\u754c\u533a\u5e94\u8be5\u5c3d\u53ef\u80fd\u77ed\uff0c\u53ea\u5305\u542b\u5bf9\u9700\u8981\u4fdd\u62a4\u7684\u6570\u636e\u7ed3\u6784\u7684\u64cd\u4f5c\u5373\u53ef\u3002</p> <p>\u4f8b\u5982\uff0c\u6211\u4eec\u9700\u8981\u628a <code>read_data()</code> \u653e\u5230 <code>lock()</code> \u524d\u9762\uff0c\u56e0\u4e3a\u6211\u4eec\u63d0\u5230\u8fd9\u4e2a\u51fd\u6570\u4f1a\u963b\u585e\u5f53\u524d\u51fd\u6570\u7684\u8fd0\u884c\uff0c\u76f4\u5230\u7528\u6237\u63d0\u4ea4\u65b0\u7684\u6570\u636e\u3002\u56e0\u6b64\u5047\u5982\u6211\u4eec\u653e\u5728 <code>lock()</code> \u4e4b\u540e\uff0c\u5f53\u7528\u6237\u8fdf\u8fdf\u4e0d\u63d0\u4ea4\u6570\u636e\u65f6\uff0c\u6211\u4eec\u7684\u6d88\u8d39\u8005\u7ebf\u7a0b\u4e5f\u4e0d\u80fd\u591f\u8bbf\u95ee\u4e34\u754c\u533a\uff0c\u5bfc\u81f4\u7a0b\u5e8f\u5de5\u4f5c\u7684\u4f4e\u6548\u7387\u3002</p> <p>\u540c\u7406\uff0c\u5c06 <code>do_calculate()</code> \u653e\u5230 <code>unlock()</code> \u4e4b\u540e\u4e5f\u662f\u4e3a\u4e86\u5c3d\u53ef\u80fd\u7f29\u77ed\u7ebf\u7a0b\u6301\u6709\u9501\u7684\u65f6\u95f4\uff0c\u63d0\u9ad8\u7ebf\u7a0b\u7684\u5e76\u53d1\u6548\u7387\u3002</p> \u4e92\u65a5\u9501\u4e0e\u64cd\u4f5c\u7cfb\u7edf <p>\u4e92\u65a5\u9501\u4f1a\u5728\u6ca1\u6709\u62ff\u5230\u9501\u4e4b\u540e\u963b\u585e\u5f53\u524d\u7ebf\u7a0b\u7684\u8fd0\u884c\uff0c\u5e76\u8ba9\u64cd\u4f5c\u7cfb\u7edf\u5c06 CPU \u7684\u6267\u884c\u5207\u6362\u5230\u5176\u4ed6\u7ebf\u7a0b\uff0c\u8fd9\u91cc\u4f1a\u53d1\u751f\u7ebf\u7a0b\u4e0a\u4e0b\u6587\u5207\u6362\uff0c\u9700\u8981\u6d88\u8017\u5f88\u591a CPU \u6307\u4ee4\u5468\u671f\uff0c\u6709\u65f6\u5019\u6d88\u8017\u7684\u65f6\u95f4\u751a\u81f3\u6bd4\u6301\u6709\u9501\u65f6\u4fee\u6539\u53d8\u91cf\u7684\u65f6\u95f4\u8fd8\u957f\u3002\u4e0d\u8fc7\uff0c\u73b0\u4ee3\u7684\u4e92\u65a5\u9501\u901a\u5e38\u4f1a\u5728\u6302\u8d77\u7ebf\u7a0b\u4e4b\u524d\u5c1d\u8bd5\u4f7f\u7528\u4e00\u6bb5\u6b7b\u5faa\u73af\u6765\u68c0\u67e5\u9501\u7684\u72b6\u6001\uff0c\u4e00\u6bb5\u65f6\u95f4\u540e\u8fd8\u62ff\u4e0d\u5230\u9501\u518d\u6302\u8d77\u3002\u66f4\u591a\u4fe1\u606f\u53ef\u4ee5\u53c2\u8003 futex\u3002 </p> \u914d\u5e73 <code>lock()</code> \u548c <code>unlock()</code> <p>\u548c <code>new</code> \u548c <code>delete</code> \u9700\u8981\u6210\u5bf9\u51fa\u73b0\u4e00\u6837\uff0c<code>lock()</code> \u548c <code>unlock()</code> \u4e5f\u9700\u8981\u6210\u5bf9\u8c03\u7528\uff0c\u800c\u4e14\u5fc5\u987b\u4ea4\u66ff\u8c03\u7528\uff0c\u4e0d\u80fd\u8fde\u7eed <code>lock()</code> \u4e24\u6b21\uff0c\u4e5f\u4e0d\u80fd\u8fde\u7eed <code>unlock()</code> \u4e24\u6b21\u3002\u7279\u522b\u662f\u5f53\u6211\u4eec\u5728\u5faa\u73af\u4e2d\u4f7f\u7528\u4e86 <code>continue</code> \u6216\u8005 <code>break</code> \u65f6\uff0c\u6211\u4eec\u5f88\u5bb9\u6613\u5fd8\u8bb0\u5728\u5176\u4e4b\u524d\u8fdb\u884c <code>unlock()</code>\u3002</p> <p>\u5047\u5982\u6211\u4eec\u5728\u4e0a\u9762\u7684 <code>consumer()</code> \u51fd\u6570\u91cc\u6f0f\u6389\u4e86 <code>m.unlock()</code>\uff0c\u90a3\u4e48\u6211\u4eec\u4f1a\u5728\u4e4b\u540e\u7684\u5faa\u73af\u91cc\u53c8\u4e00\u6b21\u8c03\u7528 <code>m.lock()</code>\uff0c\u8fd9\u5bf9 C++ \u6765\u8bf4\u662f\u672a\u5b9a\u4e49\u884c\u4e3a\uff08undefined behavior\uff09\uff0c\u4f1a\u5bfc\u81f4\u4e00\u4e9b\u65e0\u6cd5\u9884\u6599\u7684\u8d1f\u9762\u540e\u679c\uff0c\u6211\u4eec\u7684\u7a0b\u5e8f\u53ef\u80fd\u4f1a\u76f4\u63a5\u5d29\u6e83\u3002</p> <p>\u4e3a\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528 C++ RAII \u7684\u7279\u6027\uff0c\u6765\u5e2e\u6211\u4eec\u81ea\u52a8\u52a0\u9501\u548c\u89e3\u9501\u3002\u6807\u51c6\u5e93\u4e2d\u63d0\u4f9b\u4e86 <code>std::scoped_lock</code>\uff0c\u5b83\u5728\u6784\u9020\u51fd\u6570\u4e2d\u81ea\u52a8\u8c03\u7528 <code>lock()</code>\uff0c\u5e76\u5728\u6790\u6784\u51fd\u6570\u4e2d\u81ea\u52a8\u8c03\u7528 <code>unlock()</code>\u3002\u6211\u4eec\u53ef\u4ee5\u628a <code>consumer()</code> \u7684\u4ee3\u7801\u4fee\u6539\u4e3a\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code>void consumer() {\n    int data = -1;\n    while (true) {\n        {\n            std::scoped_lock lock(m); // \u6784\u9020\u51fd\u6570\u81ea\u52a8\u8c03\u7528 `m.lock()`\n            if (index &lt; 0) continue;  // \u79bb\u5f00\u672c\u6b21\u5faa\u73af\u65f6\uff0c`lock` \u7684\u6790\u6784\u51fd\u6570\u4f1a\u88ab\u6267\u884c\n            data = list[index--];\n        } // \u79bb\u5f00\u672c\u4ee3\u7801\u5757\u65f6\uff0c`lock` \u7684\u6790\u6784\u51fd\u6570\u4e5f\u4f1a\u88ab\u6267\u884c\n        do_calculate(data);\n    }\n}\n</code></pre> <p>\u4f7f\u7528 RAII\uff0c\u7279\u522b\u662f\u5e26\u6709\u9ed8\u8ba4\u6784\u9020\u51fd\u6570\u7684\u7c7b\u65f6\uff0c\u52a1\u5fc5\u9700\u8981\u6ce8\u610f\u662f\u5426\u7ed9\u53d8\u91cf\u8d77\u4e86\u540d\u5b57\u3002\u4f8b\u5982\uff1a</p> <pre><code>void func() {\n    std::scoped_lock(m);\n}\n</code></pre> <p>\u5982\u679c\u6ca1\u6709\u8d77\u540d\u5b57\uff0c\u90a3\u4e48\u8fd9\u4e2a\u8bed\u53e5\u53ef\u4ee5\u6709\u4e24\u79cd\u7406\u89e3\uff1a\u4e00\u662f\u8c03\u7528\u4e86 <code>std::scoped_lock</code> \u7684\u4ee5 <code>m</code> \u4e3a\u53c2\u6570\u7684\u6784\u9020\u51fd\u6570\uff0c\u7136\u540e\u5c06\u8fd9\u4e2a\u53d8\u91cf\u9500\u6bc1\u3002\u4e8c\u662f\u4f7f\u7528\u9ed8\u8ba4\u6784\u9020\u51fd\u6570\uff0c\u58f0\u660e\u4e86\u4e00\u4e2a\u540d\u5b57\u4e3a <code>m</code> \u7684 <code>std::scoped_lock</code> \u5bf9\u8c61\u3002\u4e5f\u5c31\u662f\u7b49\u4e8e</p> <pre><code>void func() {\n    std::scoped_lock m;\n}\n</code></pre> <p>\u5728\u8fd9\u79cd\u6709\u6b67\u4e49\u7684\u8bed\u6cd5\u4e0b\uff0cC++ \u4f1a\u9075\u5b88\u7684\u89c4\u5219\u662f\uff1a\u5982\u679c\u4e00\u6761\u8bed\u53e5\u770b\u4e0a\u53bb\u662f\u58f0\u660e\uff0c\u90a3\u4e48\u5b83\u5c31\u662f\u58f0\u660e\u3002\u4e5f\u5c31\u662f\u8bf4\u5b9e\u9645\u4e0a\u5982\u679c\u4e0d\u7ed9\u5bf9\u8c61\u8d77\u540d\u5b57\u7684\u8bdd\uff0c\u4e0a\u9762\u7684\u4ee3\u7801\u5b9e\u9645\u4e0a\u4f1a\u6309\u7167\u7b2c\u4e8c\u79cd\u7406\u89e3\u53bb\u7f16\u8bd1\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4e92\u65a5\u91cf\u6839\u672c\u6ca1\u6709\u4e0a\u9501\u3002</p>"},{"location":"parallel/multi-threading/#\u539f\u5b50\u91cf","title":"\u539f\u5b50\u91cf","text":"<p>\u6211\u4eec\u5728\u4e0a\u6587\u4ecb\u7ecd\u8fc7\u7ade\u6001\u6761\u4ef6\u7684\u4ea7\u751f\u6e90\u4e8e\u591a\u4e2a\u7ebf\u7a0b\u6267\u884c\u7684\u76f8\u5bf9\u987a\u5e8f\u65e0\u6cd5\u786e\u5b9a\uff0c\u4f7f\u7528\u4e92\u65a5\u91cf\u53ef\u4ee5\u786e\u4fdd\u5728\u4efb\u610f\u65f6\u5019\u4e34\u754c\u533a\u6700\u591a\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u5728\u8bbf\u95ee\uff0c\u4f7f\u5f97\u5bf9\u6570\u636e\u7684\u8bfb\u53d6\u4ee5\u53ca\u4fee\u6539\u987a\u5e8f\u6ee1\u8db3\u6211\u4eec\u7684\u8981\u6c42\uff0c\u4ee5\u6b64\u6765\u89e3\u51b3\u7ade\u6001\u6761\u4ef6\u95ee\u9898\u3002\u9664\u4e86\u4e92\u65a5\u91cf\uff0c\u8fd8\u53ef\u4ee5\u4f7f\u7528\u539f\u5b50\u91cf\uff08atomic variables\uff09\u6765\u89e3\u51b3\u4e00\u4e2a\u53d8\u91cf\u7684\u6570\u636e\u7ade\u4e89\u95ee\u9898\u3002</p> <p>\u539f\u5b50\u91cf\u4ece\u82f1\u6587\u540d\u5c31\u80fd\u770b\u51fa\uff0c\u5b83\u548c\u666e\u901a\u53d8\u91cf\u4e00\u6837\uff0c\u4f46\u5b83\u5374\u4fdd\u8bc1\u4e86\u539f\u5b50\u6027\u3002\u5728 C++ \u4e2d\uff0c\u539f\u5b50\u6027\u7684\u542b\u4e49\u662f\uff1a\u591a\u4e2a\u5e76\u53d1\u7ebf\u7a0b\u8bbf\u95ee\u5177\u6709\u539f\u5b50\u6027\u7684\u5bf9\u8c61\u65f6\u4e0d\u4f1a\u9020\u6210\u6570\u636e\u7ade\u4e89\uff0c\u4e5f\u4e0d\u4f1a\u5bfc\u81f4\u672a\u5b9a\u4e49\u884c\u4e3a\u3002\u539f\u5b50\u91cf\u53ef\u4ee5\u7406\u89e3\u4e3a\u4e00\u4e2a\u4ec5\u9650\u4e8e\u8bbf\u95ee\u548c\u4fee\u6539\u8fd9\u4e2a\u53d8\u91cf\u7684\u4e34\u754c\u533a\u3002\u548c\u4f7f\u7528\u4e92\u65a5\u91cf\u76f8\u6bd4\uff0c\u5728\u786c\u4ef6\u652f\u6301\u7684\u60c5\u51b5\u4e0b\uff0c\u539f\u5b50\u91cf\u4f1a\u76f4\u63a5\u7f16\u8bd1\u6210\u4e3a\u786c\u4ef6\u7684\u539f\u5b50\u6307\u4ee4\uff0c\u5f00\u9500\u4f1a\u66f4\u5c0f\uff0c\u800c\u4e92\u65a5\u91cf\u5219\u53ef\u80fd\u9700\u8981\u6d89\u53ca\u5230\u64cd\u4f5c\u7cfb\u7edf\u5bf9\u7ebf\u7a0b\u7684\u6302\u8d77\u548c\u8c03\u5ea6\u3002</p> <p>\u5982\u679c\u5c06\u4e0a\u8ff0\u4f7f\u7528\u4e92\u65a5\u91cf\u7684\u4f8b\u5b50\u6539\u4e3a\u4f7f\u7528\u539f\u5b50\u91cf\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u7ebf\u7a0b\u7ade\u4e89\u8bbf\u95ee\u7684 <code>index</code> \u53d8\u91cf\u6539\u4e3a\u539f\u5b50\u53d8\u91cf\uff1a</p> with_atomic.cpp <pre><code>int list[100];\nstd::atomic_int index = -1; // \u4f7f\u7528\u539f\u5b50\u91cf\u4f5c\u4e3a `index`\n\nvoid producer() {\n    while (true) {\n        int data = read_data();\n        list[1 + index.fetch_add(1)] = data; \n    }\n}\n\nvoid consumer() {\n    while (true) {\n        int i = index;\n        if (i &lt; 0) continue;\n        while (!index.compare_exchange_weak(i, i - 1)) {\n           if (i &lt; 0) break;\n        }\n        if (i &lt; 0) continue;\n        do_calculate(list[i]);\n    }\n}\n</code></pre> <p>\u4e0a\u9762\u7684\u4ee3\u7801\u770b\u4e0a\u53bb\u6bd4\u4e92\u65a5\u91cf\u8981\u7a0d\u5fae\u590d\u6742\u4e00\u4e9b\uff0c\u6211\u4eec\u5148\u6765\u770b\u770b\u5176\u4e2d <code>fetch_add()</code> \u51fd\u6570\u548c <code>compare_exchange_weak()</code> \u51fd\u6570\u7684\u4f7f\u7528\uff1a</p> <ul> <li><code>fetch_add()</code> \u51fd\u6570\u7684\u4f5c\u7528\u662f\uff1a\u539f\u5b50\u5730\u83b7\u53d6 <code>index</code> \u7684\u503c\uff0c\u7136\u540e\u5c06\u5b83\u52a0\u4e00\uff0c\u518d\u5b58\u5165 <code>index</code> \u4e2d\u3002\u8fd9\u6574\u4e2a\u8fc7\u7a0b\u662f\u539f\u5b50\u7684\uff0c\u4e0d\u4f1a\u6709\u5176\u5b83\u7ebf\u7a0b\u5bf9 <code>index</code> \u7684\u8bbf\u95ee\u7a7f\u63d2\u5728\u8fd9\u51e0\u6b65\u4e4b\u95f4\uff0c\u5bfc\u81f4\u6570\u636e\u7ade\u4e89\u7684\u51fa\u73b0\u3002\u4e0a\u9762\u4ee3\u7801\u4e2d\u7684 <code>index.fetch_add(1)</code> \u5176\u5b9e\u5c31\u662f\u666e\u901a\u53d8\u91cf\u91cc <code>i++</code> \u7684\u539f\u5b50\u91cf\u7248\u672c\u3002</li> <li><code>compare_exchange_weak()</code> \u51fd\u6570\u7684\u4f5c\u7528\u662f\uff1a\u6bd4\u8f83\u539f\u5b50\u91cf\u5f53\u524d\u7684\u503c\u548c\u7ed9\u5b9a\u7684\u503c\uff08\u7b2c\u4e00\u4e2a\u53c2\u6570\uff09\uff0c\u5982\u679c\u76f8\u7b49\u5219\u5c06\u539f\u5b50\u91cf\u7684\u503c\u8bbe\u4e3a\u7b2c\u4e8c\u4e2a\u53c2\u6570\u7684\u503c\u5e76\u8fd4\u56de <code>true</code>\uff1b\u5982\u679c\u4e0d\u76f8\u7b49\u5219\u5c06\u7b2c\u4e00\u4e2a\u53c2\u6570\u7684\u503c\u8bbe\u4e3a\u539f\u5b50\u91cf\u7684\u503c\uff0c\u5e76\u8fd4\u56de <code>false</code>\u3002\u6b64\u51fd\u6570\u505a\u7684\u4e8b\u60c5\u4e5f\u662f\u539f\u5b50\u7684\u3002   \u6211\u4eec\u9996\u5148\u4f7f\u7528 <code>int i = index;</code> \u5c06\u539f\u5b50\u91cf\u5f53\u524d\u7684\u503c\u8bfb\u5165\u672c\u5730\u53d8\u91cf <code>i</code> \u91cc\uff0c\u7136\u540e\u6211\u4eec\u51c6\u5907\u5bf9\u5b83\u8fdb\u884c\u51cf\u4e00\u64cd\u4f5c\uff0c\u7136\u540e\u6d88\u8d39\u65b0\u7684\u6570\u636e\u3002\u4e0d\u8fc7\u4e8b\u60c5\u5e76\u6ca1\u6709\u8fd9\u4e48\u7b80\u5355\u3002\u5728\u8bfb\u53d6 <code>index</code> \u5230\u4fee\u6539 <code>index</code> \u4e4b\u95f4\uff0c\u6709\u53ef\u80fd\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u4e5f\u505a\u4e86\u540c\u6837\u7684\u4e8b\u60c5\uff0c\u5bfc\u81f4\u6570\u636e\u7ade\u4e89\u7684\u51fa\u73b0\u3002\u4e3a\u6b64\uff0cC++ STL \u4e3a\u539f\u5b50\u91cf\u63d0\u4f9b\u4e86\u4e00\u4e2a\u529f\u80fd\u5f3a\u5927\u7684 <code>compare_exchange_weak()</code> \u51fd\u6570\uff0c\u7528\u6765\u7ed9\u5f53\u524d\u51fd\u6570\u68c0\u67e5\u662f\u5426\u6709\u5176\u4ed6\u7ebf\u7a0b\u5148\u4e8e\u81ea\u5df1\u4e00\u6b65\u5b8c\u6210\u4e86\u5bf9\u539f\u5b50\u91cf\u7684\u4fee\u6539\u3002   \u4e3e\u4e2a\u4f8b\u5b50\uff0c\u5047\u5982\u73b0\u5728 <code>producer()</code> \u5c06 <code>index</code> \u7684\u503c\u8bbe\u4e3a\u4e86 <code>0</code>\uff0c\u6709\u4e24\u4e2a\u6d88\u8d39\u8005\u7ebf\u7a0b A \u548c B \u90fd\u8fdb\u884c\u4e86 <code>int i = index</code>\uff0c\u8bfb\u5230\u4e86 <code>i</code> \u5747\u4e3a <code>0</code>\u3002\u6b64\u65f6\uff0cA \u8fdb\u884c <code>compare_exchange_weak()</code> \u51fd\u6570\uff0c\u5c06 <code>index</code> \u7684\u503c\u8bbe\u4e3a\u4e86 <code>i - 1</code> \u4e5f\u5c31\u662f <code>-1</code>\uff0c\u5e76\u8c03\u51fa\u4e86\u5faa\u73af\uff0c\u6210\u529f\u5730\u6d88\u8d39\u4e86\u6b64\u6570\u636e\u3002B \u5728\u8fdb\u884c\u76f8\u540c\u51fd\u6570\u65f6\uff0c\u53d1\u73b0 <code>index</code> \u5f53\u524d\u7684\u503c\u5df2\u7ecf\u4e0d\u518d\u7b49\u4e8e\u5b83\u5148\u524d\u62ff\u5230\u7684 <code>i</code> \u4e86\uff0c\u4e8e\u662f <code>i</code> \u88ab\u8bbe\u7f6e\u4e3a <code>i - 1</code>\uff0c\u4e5f\u5c31\u662f <code>-1</code>\uff0c\u5e76\u5148\u540e\u7ecf\u8fc7 <code>break</code> \u548c <code>continue</code> \u91cd\u65b0\u5f00\u59cb\u65b0\u4e00\u8f6e\u6d88\u8d39\u5faa\u73af\u3002\u50cf\u8fd9\u6837\u901a\u8fc7\u5f15\u5165\u539f\u5b50\u91cf\uff0c\u6211\u4eec\u5728\u591a\u4e2a\u5e76\u53d1\u7ebf\u7a0b\u5bf9 <code>index</code> \u7684\u8bbf\u95ee\u4e4b\u95f4\u5f15\u5165\u4e86\u5bf9\u8bbf\u95ee\u987a\u5e8f\u7684\u7ea6\u675f\uff0c\u907f\u514d\u4e86\u6570\u636e\u7ade\u4e89\u7684\u4ea7\u751f\u3002</li> </ul> <p>\u5728\u4f7f\u7528\u539f\u5b50\u91cf\u548c\u4e92\u65a5\u91cf\u89e3\u51b3\u591a\u7ebf\u7a0b\u5e76\u53d1\u8bbf\u95ee\u9020\u6210\u7684\u51b2\u7a81\u95ee\u9898\u65f6\uff0c\u901a\u5e38\u4f1a\u4f7f\u7528\u4e24\u79cd\u4e0d\u540c\u7684\u8303\u5f0f\u3002\u4f7f\u7528\u539f\u5b50\u91cf\u7684\u65f6\u5019\uff0c\u901a\u5e38\u662f\u5148\u5c1d\u8bd5\u4fee\u6539\u6570\u636e\uff0c\u4fee\u6539\u6570\u636e\u7684\u65f6\u5019\u53ef\u80fd\u6709\u591a\u4e2a\u7ebf\u7a0b\u540c\u65f6\u64cd\u4f5c\uff0c\u7136\u540e\u518d\u68c0\u67e5\u6570\u636e\u7ed3\u6784\u662f\u5426\u6709\u5199\u51b2\u7a81\uff0c\u53d1\u751f\u51b2\u7a81\u4e86\u5c31\u56de\u6eda\u64cd\u4f5c\uff0c\u7136\u540e\u91cd\u8bd5\uff0c\u8fd9\u4f53\u73b0\u4e3a\u4e00\u4e2a\u57fa\u4e8e CAS \u6761\u4ef6\u7684\u5faa\u73af\uff0c\u8fd9\u662f\u4e00\u79cd\u4e50\u89c2\u7684\uff08Optimistic\uff09\u65b9\u6cd5\uff0c\u56e0\u4e3a\u5b83\u8ba4\u4e3a\u8bbf\u95ee\u4e0d\u51b2\u7a81\u7684\u6982\u7387\u5927\u4e8e\u51b2\u7a81\u7684\u6982\u7387\u3002</p> <p>\u800c\u4f7f\u7528\u4e92\u65a5\u91cf\u7684\u65f6\u5019\uff0c\u5219\u662f\u76f4\u63a5\u5bf9\u6570\u636e\u7ed3\u6784\u52a0\u9501\uff0c\u540c\u65f6\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u5728\u4fee\u6539\u6570\u636e\uff0c\u4fee\u6539\u5b8c\u4e86\u518d\u89e3\u9501\uff0c\u5141\u8bb8\u4e0b\u4e00\u4e2a\u7ebf\u7a0b\u8fdb\u5165\u4e34\u754c\u533a\uff0c\u7b49\u4e8e\u5c06\u7ebf\u7a0b\u6392\u961f\u3002\u8fd9\u662f\u4e00\u79cd\u60b2\u89c2\u7684\uff08Pessimistic\uff09\u65b9\u6cd5\uff0c\u56e0\u4e3a\u5b83\u8ba4\u4e3a\u53d1\u751f\u51b2\u7a81\u7684\u6982\u7387\u5927\u4e8e\u4e0d\u51b2\u7a81\u7684\u6982\u7387\u3002</p> <p>\u539f\u5b50\u91cf\u548c\u4e92\u65a5\u91cf\u5404\u6709\u4f18\u52a3\uff0c\u539f\u5b50\u91cf\u7f29\u5c0f\u4e86\u4e34\u754c\u533a\uff0c\u589e\u5927\u4e86\u5e76\u53d1\u5ea6\uff0c\u4f46\u662f\u5728\u51b2\u7a81\u8f83\u591a\u7684\u65f6\u5019\u9700\u8981\u5927\u91cf\u5730\u56de\u9000\u548c\u91cd\u8bd5\uff0c\u800c\u4e14\u4e0d\u597d\u5199\u3002\u4e92\u65a5\u91cf\u7684\u4e34\u754c\u533a\u8f83\u5927\uff0c\u5e76\u53d1\u5ea6\u4f4e\uff0c\u5728\u4f7f\u7528\u4e0d\u5f53\u7684\u60c5\u51b5\u4e0b\u53ef\u80fd\u51fa\u73b0\u6b7b\u9501\u95ee\u9898\uff0c\u4f46\u662f\u7406\u89e3\u8d77\u6765\u6bd4\u8f83\u5bb9\u6613\uff0c\u4e5f\u4e0d\u9700\u8981\u56de\u9000\u548c\u91cd\u8bd5\u3002</p> <p>\u90a3\u4e48\u5e94\u8be5\u4ec0\u4e48\u65f6\u5019\u4f7f\u7528\u539f\u5b50\u91cf\uff0c\u4ec0\u4e48\u65f6\u5019\u4f7f\u7528\u4e92\u65a5\u91cf\uff1f\u4ece\u5f00\u53d1\u8005\u7684\u89d2\u5ea6\u6765\u8bb2\uff0c\u5728\u9879\u76ee\u5f00\u53d1\u7684\u521d\u671f\uff0c\u63a8\u8350\u4f7f\u7528\u4e92\u65a5\u91cf\uff0c\u56e0\u4e3a\u5b83\u7f16\u5199\u548c\u7406\u89e3\u8d77\u6765\u90fd\u6bd4\u8f83\u7b80\u5355\u3002\u800c\u5728\u9879\u76ee\u7a33\u5b9a\u540e\uff0c\u7ecf\u8fc7\u6027\u80fd\u5206\u6790\uff0c\u786e\u5b9a\u4e86\u4e92\u65a5\u91cf\u662f\u6027\u80fd\u74f6\u9888\u4e4b\u540e\uff0c\u518d\u60f3\u529e\u6cd5\u4fee\u6539\u4e3a\u4f7f\u7528\u539f\u5b50\u91cf\u7684\u5e76\u53d1\u63a7\u5236\u3002\u800c\u4e14\uff0c\u4f7f\u7528\u539f\u5b50\u91cf\u7f16\u5199\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\u5f88\u5bb9\u6613\uff0c\u4f46\u662f\u7f16\u5199\u4e00\u4e2a\u6b63\u786e\u7684\u6570\u636e\u7ed3\u6784\u662f\u4e00\u4e2a\u975e\u5e38\u56f0\u96be\u7684\u95ee\u9898\uff0c\u9700\u8981\u4e25\u82db\u7684\u6d4b\u8bd5\u751a\u81f3\u662f\u4e25\u683c\u7684\u6570\u5b66\u8bc1\u660e\u3002\u5728\u5de5\u7a0b\u5b9e\u8df5\u4e2d\uff0c\u5efa\u8bae\u4e5f\u662f\u76f4\u63a5\u4f7f\u7528\u7ecf\u8fc7\u5927\u91cf\u6d4b\u8bd5\u4ee5\u53ca\u9a8c\u8bc1\u7684\u6210\u719f\u7684\u6570\u636e\u7ed3\u6784\u5e93\u3002</p> \u539f\u5b50\u91cf\u7684\u7ec4\u5408\u4e0d\u662f\u539f\u5b50\u64cd\u4f5c <p>\u4e00\u79cd\u5bb9\u6613\u72af\u7684\u9519\u8bef\u662f\u4ee5\u4e3a\u591a\u4e2a\u539f\u5b50\u91cf\u7ed3\u5408\u5728\u4e00\u8d77\u662f\u4e00\u4e2a\u539f\u5b50\u64cd\u4f5c\u3002\u8bf7\u8bb0\u4f4f\uff0c\u6bcf\u4e2a\u539f\u5b50\u91cf\u90fd\u662f\u4e00\u4e2a\u5355\u72ec\u4e34\u754c\u533a\uff0c\u4e34\u754c\u533a\u4e4b\u95f4\u54ea\u6015\u6ca1\u6709\u5176\u4ed6\u6307\u4ee4\uff0c\u4e5f\u662f\u53ef\u4ee5\u7a7f\u63d2\u64cd\u4f5c\u7684\u3002</p> <code>compare_exchange_weak()</code> \u4e0e <code>compare_exchange_strong()</code> <p><code>compare_exchange_weak()</code> \u662f C++ 11 STL \u63d0\u4f9b\u7684 CAS\uff08compare and set\uff09\u64cd\u4f5c\u7684\u5b9e\u73b0\u4e4b\u4e00\uff0c\u53e6\u4e00\u4e2a\u5b9e\u73b0\u662f <code>compare_exchange_strong()</code>\uff0c\u4e8c\u8005\u7684\u533a\u522b\u5728\u4e8e\uff1a\u524d\u8005\u4e00\u822c\u4f1a\u7528\u5728 <code>while</code> \u5faa\u73af\u91cc\uff0c\u56e0\u4e3a\u6b64\u51fd\u6570\u6709\u53ef\u80fd\u4f1a\u51fa\u73b0\u201c\u5047\u9634\u6027\u201d\u73b0\u8c61\uff0c\u4e5f\u5c31\u662f\u7b2c\u4e00\u4e2a\u53c2\u6570\u7684\u503c\u548c\u539f\u5b50\u91cf\u7684\u503c\u660e\u660e\u4e00\u6837\uff0c\u51fd\u6570\u5374\u8fd4\u56de\u4e86 <code>false</code>\uff08\u4f46\u4e0d\u4f1a\u4fee\u6539\u7b2c\u4e00\u4e2a\u53c2\u6570\u7684\u503c\uff09\u3002\u4e4b\u6240\u4ee5\u6709\u8fd9\u79cd\u73b0\u8c61\u662f\u56e0\u4e3a\u5728\u4e00\u4e9b\u786c\u4ef6\u4e0a\uff0c\u539f\u5b50\u91cf\u662f\u4f7f\u7528\u6761\u4ef6\u5b58\u50a8\u7684\u65b9\u5f0f\u5b9e\u73b0\u7684\uff0c\u53ea\u8981\u539f\u5b50\u91cf\u53d1\u751f\u4e86\u5199\u5165\uff0c\u54ea\u6015\u503c\u662f\u4e00\u6837\u7684\uff0c\u4e5f\u4f1a\u8ba4\u4e3a\u8fd9\u4e2a\u539f\u5b50\u91cf\u88ab\u4fee\u6539\u4e86\u3002\u800c\u540e\u8005\u5219\u4e0d\u4f1a\u6709\u8fd9\u79cd\u73b0\u8c61\uff0c\u5b83\u603b\u662f\u4f1a\u6bd4\u8f83\u503c\u3002</p> <p>\u6ca1\u6709\u7279\u522b\u7684\u7406\u7531\u7684\u60c5\u51b5\u4e0b\uff0c\u4e00\u822c\u4f7f\u7528 <code>compare_exchange_weak()</code> \u5373\u53ef\u3002</p> \u5185\u5b58\u4e00\u81f4\u6027\u6a21\u578b <p>\u539f\u5b50\u91cf\u63d0\u4f9b\u7684\u8fd9\u4e9b\u51fd\u6570\u90fd\u53ef\u4ee5\u63a5\u6536\u989d\u5916\u7684 <code>memory_order</code> \u53c2\u6570\uff0c\u5b83\u662f C++ \u63d0\u4f9b\u7ed9\u7a0b\u5e8f\u5458\u6765\u6307\u793a\u7f16\u8bd1\u5668\u4ee5\u53ca CPU \u5bf9\u4ee3\u7801\u7684\u91cd\u6392\u7a0b\u5ea6\u7684\u6807\u8bc6\u3002\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u91cc\uff0c\u6211\u4eec\u5176\u5b9e\u53ef\u4ee5\u4f7f\u7528 <code>memory_order_consume</code> \u548c <code>memory_order_acquire</code> \u6765\u8fdb\u4e00\u6b65\u63d0\u5347\u539f\u5b50\u91cf\u8bbf\u95ee\u7684\u6027\u80fd\u3002\u7b80\u800c\u8a00\u4e4b\uff0c\u5728\u73b0\u4ee3\u7684 CPU \u4f53\u7cfb\u7ed3\u6784\u4e2d\uff0c\u8bbf\u5b58\u6307\u4ee4\u662f\u5141\u8bb8\u91cd\u6392\u7684\uff0c\u552f\u4e00\u7684\u9650\u5236\u662f\u5b83\u4eec\u5728\u4e00\u4e2a\u6838\u4e0a\u662f\u548c\u7a0b\u5e8f\u7684\u6307\u4ee4\u987a\u5e8f\u4e00\u6837\u7684\u3002\u800c\u5f53\u4e00\u4e2a\u6838\u8bd5\u56fe\u8bbf\u95ee\u53e6\u4e00\u4e2a\u6838\u8bfb\u5199\u7684\u5185\u5b58\u5730\u5740\u7684\u65f6\u5019\uff0c\u624d\u6709\u53ef\u80fd\u770b\u5230\u548c\u987a\u5e8f\u4e0d\u4e00\u81f4\u7684\u60c5\u51b5\u3002\u7b80\u800c\u8a00\u4e4b\uff0c<code>memory_order_relaxed</code> \u6807\u8bc6\u8be5\u539f\u5b50\u64cd\u4f5c\u7684\u4ee5\u53ca\u5176\u4ed6\u8bbf\u5b58\u64cd\u4f5c\u7684\u987a\u5e8f\u65e0\u5173\u7d27\u8981\uff0c\u5141\u8bb8\u6700\u5927\u7a0b\u5ea6\u7684\u4e71\u5e8f\uff1b<code>memory_order_release</code> \u6807\u8bc6\u8be5\u539f\u5b50\u6307\u4ee4\u524d\u7684\u8bbf\u5b58\u64cd\u4f5c\u4e0d\u53ef\u4ee5\u4e71\u5e8f\u5230\u8be5\u539f\u5b50\u6307\u4ee4\u540e\uff0c\u901a\u5e38\u7528\u4e8e\u201c\u53d1\u5e03\u201d\u4e00\u4e2a\u66f4\u6539\uff0c\u4f8b\u5982\u5c06\u6570\u7ec4\u957f\u5ea6\u52a0\u4e00\uff1b\u800c <code>memory_order_acquire</code> \u5219\u6807\u8bc6\u8be5\u539f\u5b50\u6307\u4ee4\u540e\u7684\u64cd\u4f5c\u4e0d\u80fd\u88ab\u4e71\u5e8f\u5230\u8be5\u539f\u5b50\u6307\u4ee4\u524d\uff0c\u901a\u5e38\u7528\u6765\u201c\u83b7\u53d6\u201d\u66f4\u6539\uff0c\u4f8b\u5982\u83b7\u53d6\u6700\u65b0\u7684\u6570\u7ec4\u957f\u5ea6\u3002<code>memory_order_seq_cst</code> \u662f\u6700\u4e3a\u4e25\u683c\uff0c\u4e5f\u662f\u9ed8\u8ba4\u7684\u6807\u8bc6\uff0c\u610f\u5473\u7740\u8be5\u539f\u5b50\u64cd\u4f5c\u524d\u540e\u7684\u8bbf\u5b58\u64cd\u4f5c\u90fd\u4e0d\u80fd\u7a7f\u8d8a\u8be5\u64cd\u4f5c\u4e71\u5e8f\uff0c\u800c\u4e14\u6240\u6709\u6838\u5fc3\u770b\u5230\u7684\u4fee\u6539\u987a\u5e8f\u662f\u4e00\u81f4\u7684\u3002</p> <p>\u66f4\u591a\u6709\u5173 Memory order \u7684\u8bdd\u9898\u5df2\u7ecf\u8d85\u51fa\u4e86\u672c\u6587\u7684\u8ba8\u8bba\u8303\u56f4\uff0c\u76f8\u5173\u8d44\u6599\u53ef\u4ee5\u67e5\u9605 cppreference.com\u3002</p>"},{"location":"parallel/multi-threading/#\u6761\u4ef6\u53d8\u91cf","title":"\u6761\u4ef6\u53d8\u91cf","text":"<p>\u524d\u9762\u4e24\u4e2a\u4f8b\u5b50\u5206\u522b\u4f7f\u7528\u4e92\u65a5\u91cf\u548c\u539f\u5b50\u91cf\u6765\u9632\u6b62\u6570\u636e\u7ade\u4e89\uff0c\u4f46\u662f\u5728\u751f\u4ea7\u8005\u8fd8\u6ca1\u6709\u4ea7\u751f\u65b0\u6570\u636e\uff0c\u4e14 <code>list</code> \u4e3a\u7a7a\u7684\u65f6\u5019\uff0c\u6240\u6709\u7684\u7ebf\u7a0b\u90fd\u5728\u4e0d\u505c\u5730\u901a\u8fc7\u5faa\u73af\u6765\u68c0\u67e5\u6709\u6ca1\u6709\u65b0\u7684\u6570\u636e\uff0c\u8fd9\u79cd\u884c\u4e3a\u88ab\u79f0\u4e3a\u5fd9\u7b49\uff08busy waiting\uff09\uff0c\u4e5f\u5c31\u662f\u8bf4\u5b83\u4eec\u7684 CPU \u65f6\u95f4\u5168\u90e8\u82b1\u5728\u68c0\u67e5\u6709\u6ca1\u6709\u65b0\u6570\u636e\u4e0a\u4e86\u3002\u8fd9\u5c31\u597d\u50cf\u4f60\u60f3\u4e70\u4e00\u4e2a\u4e1c\u897f\uff0c\u5230\u5546\u5bb6\u90a3\u53bb\u770b\u770b\u6709\u6ca1\u6709\u8d27\uff0c\u4f46\u662f\u5546\u5bb6\u8bf4\u6ca1\u6709\u8d27\u4e86\uff0c\u8fd9\u65f6\u5019\u4f60\u8fd8\u662f\u4e0d\u505c\u5730\u5237\u65b0\u9875\u9762\uff0c\u770b\u770b\u8d27\u5230\u4e86\u6ca1\uff0c\u8fd9\u5c31\u6709\u70b9\u6d6a\u8d39\u65f6\u95f4\u4e86\u3002</p> <p>\u5982\u679c\u6d88\u8d39\u8005\u7ebf\u7a0b\u80fd\u591f\u5728\u7b49\u5f85\u7684\u65f6\u5019\u4e0d\u518d\u6d88\u8017 CPU \u65f6\u95f4\uff08\u4f8b\u5982\u8fdb\u5165\u4f11\u7720\u6001\uff09\uff0c\u800c\u662f\u5728\u751f\u4ea7\u8005\u4ea7\u751f\u65b0\u6570\u636e\u65f6\u518d\u8fdb\u884c\u4e0b\u4e00\u6b65\u64cd\u4f5c\uff0c\u6211\u4eec\u5c31\u80fd\u591f\u8fdb\u4e00\u6b65\u63d0\u5347 CPU \u7684\u5229\u7528\u6548\u7387\u4e86\u3002\u9047\u5230\u8fd9\u79cd\u9700\u8981\u7b49\u5f85\u67d0\u4e2a\u6761\u4ef6\u53d1\u751f\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u4f7f\u7528\u6761\u4ef6\u53d8\u91cf\uff08condition variable\uff09\u3002\u8fd9\u5c31\u597d\u50cf\uff0c\u4f60\u7559\u4e2a\u7535\u8bdd\u7ed9\u5546\u5bb6\u6216\u8005\u70b9\u4e2a\u5230\u8d27\u63d0\u9192\u6309\u94ae\uff0c\u8ba9\u4ed6\u8bb0\u5f97\u5728\u5230\u8d27\u7684\u65f6\u5019\u6253\u4e2a\u7535\u8bdd\u7ed9\u4f60\uff0c\u8fd9\u65f6\u4f60\u5c31\u53ef\u4ee5\u53bb\u5e72\u522b\u7684\u4e8b\u60c5\uff0c\u4e0d\u7528\u6d6a\u8d39\u65f6\u95f4\u4e00\u76f4\u770b\u6709\u6ca1\u6709\u5230\u8d27\u4e86\u3002</p> <p>\u6761\u4ef6\u53d8\u91cf\u53ef\u4ee5\u7406\u89e3\u4e3a\u4e00\u4e2a\u961f\u5217\uff0c\u961f\u5217\u4e2d\u5b58\u50a8\u7684\u662f\u7b49\u5f85\u7684\u7ebf\u7a0b\u3002\u6d88\u8d39\u8005\u7ebf\u7a0b\u901a\u8fc7 <code>wait()</code> \u5c06\u81ea\u5df1\u6dfb\u52a0\u5230\u961f\u5217\u4e2d\uff1b\u751f\u4ea7\u8005\u7ebf\u7a0b\u901a\u8fc7 <code>notify_one()</code> \u51fd\u6570\u6765\u5524\u9192\u961f\u5934\u7684\u7ebf\u7a0b\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7 <code>notify_all()</code> \u51fd\u6570\u6765\u5524\u9192\u6240\u6709\u7ebf\u7a0b\u3002</p> <p>\u6211\u4eec\u4f7f\u7528\u6761\u4ef6\u53d8\u91cf\u6765\u6539\u5584\u4e0a\u6587\u4e2d\u57fa\u4e8e\u4e92\u65a5\u91cf\u7684\u4f8b\u5b50\uff1a</p> with_cv.cpp <pre><code>int list[100];\nint index = -1;\nstd::mutex m;\nstd::condition_variable cv; // \u58f0\u660e\u6761\u4ef6\u53d8\u91cf\n\nvoid producer() {\n    while (true) {\n        int data = read_data();\n        {   // \u4f7f\u7528 scoped_lock \u6765\u81ea\u52a8\u7ba1\u7406\u4e92\u65a5\u91cf\n            std::scoped_lock lk(m);\n            list[index + 1] = data; \n            index++;\n        }\n        cv.notify_one(); // \u5524\u9192\u7b49\u5f85\u961f\u5217\u91cc\u7684\u4e00\u4e2a\u6d88\u8d39\u8005\u7ebf\u7a0b\n    }\n}\n\nvoid consumer() {\n    while (true) {\n        int data;\n        {\n            std::unique_lock&lt;std::mutex&gt; lk(m);\n            cv.wait(lk, [] { return index &gt;= 0; });\n            // \u4ece\u8fd9\u91cc\u5f00\u59cb\uff0c\u6761\u4ef6\u53d8\u91cf\u4fdd\u8bc1\uff1a\u6b64\u65f6\u6ee1\u8db3 index &gt;= 0 \u4e14\u6301\u6709\u4e92\u65a5\u91cf\n            data = list[index--];\n        }   // \u79bb\u5f00\u6b64\u4f5c\u7528\u57df\u65f6\uff0c\u4e92\u65a5\u91cf\u81ea\u52a8\u88ab\u91ca\u653e\n        do_calculate(data);\n    }\n}\n</code></pre> <p>\u6ce8\u610f <code>consumer()</code> \u4e2d\u7684 <code>cv.wait()</code> \u8c03\u7528\u3002\u5b83\u7684\u4f5c\u7528\u662f\uff1a\u5c06\u5f53\u524d\u7ebf\u7a0b\u52a0\u5165\u7b49\u5f85\u961f\u5217\uff0c\u7136\u540e\u91ca\u653e\u4e92\u65a5\u9501\uff0c\u8ba9\u5176\u4ed6\u7ebf\u7a0b\u6709\u4fee\u6539\u5171\u4eab\u72b6\u6001\u7684\u673a\u4f1a\u3002\u5f53\u7ebf\u7a0b\u88ab\u5524\u9192\u540e\uff0c\u4f7f\u7528\u7ed9\u5b9a\u7684 <code>unique_lock</code> \u91cd\u65b0\u4fdd\u62a4\u4e34\u754c\u533a\uff0c\u7136\u540e\u68c0\u6d4b\u51fd\u6570\u7684\u8fd4\u56de\u503c\uff0c\u5f53\u8fd4\u56de\u503c\u4e3a <code>true</code> \u65f6\u51fd\u6570\u8fd4\u56de\uff0c\u7a0b\u5e8f\u7ee7\u7eed\u6267\u884c\uff1b\u5426\u5219\uff0c\u91ca\u653e\u9501\u5e76\u518d\u6b21\u963b\u585e\u5f53\u524d\u7ebf\u7a0b\u3002\u56e0\u6b64\uff0cC++ \u4e2d\u7684\u4e92\u65a5\u91cf\u603b\u662f\u4f1a\u642d\u914d\u4e00\u4e2a\u4e92\u65a5\u91cf\u8fdb\u884c\u4f7f\u7528\u3002</p> Spurious Wakeup <p>\u7531\u4e8e\u5404\u79cd\u539f\u56e0\uff0c\u901a\u8fc7 <code>wait()</code> \u800c\u88ab\u963b\u585e\u7684\u7ebf\u7a0b\u6709\u53ef\u80fd\u4f1a\u5728\u6761\u4ef6\u53d8\u91cf\u5e76\u6ca1\u6709\u88ab\u8c03\u7528 <code>notify()</code> \u7b49\u51fd\u6570\u65f6\u88ab\u5524\u9192\uff0c\u8fd9\u79cd\u73b0\u8c61\u88ab\u79f0\u4e3a spurious wakeup\u3002\u6b64\u65f6\u7b49\u5f85\u7ebf\u7a0b\u4f1a\u62ff\u9501\uff0c\u7136\u540e\u68c0\u67e5\u8f93\u5165\u7684\u51fd\u6570\u7684\u8fd4\u56de\u503c\uff0c\u6b64\u65f6\u8fd4\u56de\u503c\u4e00\u822c\u4e3a <code>false</code>\uff08\u56e0\u4e3a\u6b64\u65f6\u786e\u5b9e\u6ca1\u6709\u65b0\u6570\u636e\uff09\uff0c\u7136\u540e\u518d\u4e00\u6b21\u8fdb\u5165\u963b\u585e\u72b6\u6001\u3002\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u6ca1\u6709\u53d1\u751f\u6570\u636e\u7ade\u4e89\u3002</p> <p>\u6211\u4eec\u8fd8\u53ef\u4ee5\u5c1d\u8bd5\u5c06 <code>producer()</code> \u4e2d\u7684 <code>cv.notify_one()</code> \u6539\u4e3a <code>cv.notify_all()</code>\uff0c\u5b83\u4f1a\u5524\u9192\u6240\u6709\u7b49\u5f85\u7ebf\u7a0b\uff0c\u4f46\u4e0e\u6b64\u540c\u65f6\u6211\u4eec\u53ea\u8f93\u51fa\u4e86\u4e00\u4e2a\u65b0\u6570\u636e\u3002\u7ed3\u679c\u662f\uff1a\u7b49\u5f85\u7ebf\u7a0b\u53ea\u4f1a\u6709\u4e00\u4e2a\u62ff\u5230\u8fd9\u4e2a\u65b0\u6570\u636e\uff0c\u5176\u4ed6\u7ebf\u7a0b\u4f1a\u518d\u4e00\u6b21\u8fdb\u5165\u963b\u585e\u72b6\u6001\uff0c\u4ecd\u7136\u6ca1\u6709\u6570\u636e\u7ade\u4e89\u7684\u51fa\u73b0\u3002</p> \u8f6e\u8be2\u4e0e\u7b49\u5f85\u961f\u5217 <p>\u5728\u7e41\u5fd9\u7684\u7a0b\u5e8f\u4e2d\uff0c\u961f\u5217\u53ef\u80fd\u51e0\u4e4e\u6bcf\u65f6\u6bcf\u523b\u90fd\u6709\u6570\u636e\u4ea7\u751f\uff0c\u6b64\u65f6\u76f4\u63a5\u4f7f\u7528\u5faa\u73af\u8f6e\u8be2\uff0c\u907f\u514d\u4f7f\u7528\u4e92\u65a5\u91cf\u4ee5\u53ca\u6761\u4ef6\u53d8\u91cf\uff0c\u53ef\u80fd\u4f1a\u53d6\u5f97\u66f4\u9ad8\u7684\u6027\u80fd\uff0c\u66f4\u52a0\u5145\u5206\u5229\u7528 CPU\u3002</p>"},{"location":"parallel/multi-threading/#\u4fe1\u53f7\u91cf","title":"\u4fe1\u53f7\u91cf","text":"<p>\u4fe1\u53f7\u91cf\uff08Semaphore\uff09\u662f\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u7684\u53e6\u5916\u4e00\u79cd\u63d0\u4f9b\u7ebf\u7a0b\u95f4\u540c\u6b65\u80fd\u529b\u7684\u5de5\u5177\u3002\u5b83\u672c\u8d28\u4e0a\u662f\u4e00\u4e2a\u5b58\u50a8\u4e86\u6570\u5b57\u7684\u53d8\u91cf\u3002\u7ebf\u7a0b\u53ef\u4ee5\u5bf9\u4fe1\u53f7\u91cf\u8fdb\u884c P \u64cd\u4f5c\u548c V \u64cd\u4f5c\uff0c\u5b83\u4eec\u5177\u4f53\u505a\u7684\u4e8b\u60c5\u5982\u4e0b\uff1a</p> <ul> <li>P \u64cd\u4f5c\uff1a\u5c06\u5b58\u50a8\u7684\u6570\u5b57\u51cf\u53bb 1\u3002\u5982\u679c\u51cf\u53bb 1 \u4e4b\u540e\u6570\u5b57\u5927\u4e8e 0\uff0c\u90a3\u4e48\u64cd\u4f5c\u5b8c\u6210\uff1b\u5982\u679c\u7b49\u4e8e 0\uff0c\u901a\u8fc7\u7cfb\u7edf\u8c03\u7528\u963b\u585e\u5f53\u524d\u7ebf\u7a0b\u3002</li> <li>V \u64cd\u4f5c\uff1a\u5c06\u5b58\u50a8\u7684\u6570\u5b57\u52a0\u4e0a 1\u3002\u5982\u679c\u52a0\u4e0a 1 \u4e4b\u540e\u6570\u5b57\u5927\u4e8e 0\uff0c\u90a3\u4e48\u901a\u8fc7\u7cfb\u7edf\u8c03\u7528\u5524\u9192\u4e00\u4e2a\u88ab P \u64cd\u4f5c\u963b\u585e\u4e86\u7684\u7ebf\u7a0b\u3002</li> </ul> <p>\u64cd\u4f5c\u7cfb\u7edf\u4fdd\u8bc1 P \u64cd\u4f5c\u548c V \u64cd\u4f5c\u90fd\u662f\u539f\u5b50\u7684\uff0c\u4e0d\u4f1a\u51fa\u73b0\u7ade\u6001\u6761\u4ef6\u3002\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u653e\u5fc3\u5730\u5728\u591a\u7ebf\u7a0b\u5e76\u53d1\u73af\u5883\u4e0b\u4f7f\u7528\u4fe1\u53f7\u91cf\u3002</p> <p>\u5173\u4e8e\u4fe1\u53f7\u91cf\uff0c\u4e00\u4e2a\u5f62\u8c61\u7684\u6bd4\u55bb\u662f\u9910\u5385\u91cc\u7684\u5ea7\u4f4d\u603b\u6570\u3002\u5f53\u987e\u5ba2\u5c1d\u8bd5\u5360\u7528\u4e00\u4e2a\u5ea7\u4f4d\u65f6\uff0c\u8fdb\u884c\u4e86 P \u64cd\u4f5c\u3002\u6b64\u65f6\u5b58\u50a8\u7684\u6570\u5b57\u5c31\u662f\u7a7a\u95f2\u7684\u5ea7\u4f4d\u6570\u91cf\uff0c\u5f53\u5ea7\u4f4d\u6570\u91cf\u5927\u4e8e 0 \u65f6\uff0c\u5360\u5ea7\u6210\u529f\uff1b\u5426\u5219\uff0c\u987e\u5ba2\u9700\u8981\u5728\u5e97\u95e8\u5916\u7b49\u5f85\u3002\u5f53\u5176\u4ed6\u987e\u5ba2\u79bb\u5f00\u65f6\uff0c\u8fdb\u884c\u4e86 V \u64cd\u4f5c\uff0c\u6709\u4e86\u65b0\u7684\u7a7a\u95f2\u5ea7\u4f4d\uff0c\u8fd9\u65f6\u5e97\u95e8\u5916\u7b49\u5f85\u7684\u987e\u5ba2\u5c31\u80fd\u8fdb\u6765\u3002</p> Info <p>\u5bb9\u6613\u53d1\u73b0\uff0c\u5982\u679c\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u521d\u59cb\u503c\u4e3a 1 \u7684\u4fe1\u53f7\u91cf\uff0c\u90a3\u4e48\u5b83\u5728\u529f\u80fd\u4e0a\u5c31\u7b49\u540c\u4e8e\u4e00\u4e2a\u4e92\u65a5\u91cf\u4e86\u3002\u8fdb\u884c P \u64cd\u4f5c\u76f8\u5f53\u4e8e\u4e0a\u9501\uff0c\u8fdb\u884c V \u64cd\u4f5c\u76f8\u5f53\u4e8e\u89e3\u9501\u3002</p> P \u64cd\u4f5c\u548c V \u64cd\u4f5c\u540d\u5b57\u7684\u7531\u6765 <p>\u4fe1\u53f7\u91cf\u7684\u6982\u5ff5\u5176\u5b9e\u662f\u7531\u8377\u5170\u8ba1\u7b97\u673a\u5bb6 Dijkstra \u63d0\u51fa\u7684\uff0c\u4ed6\u5728\u8bba\u6587\u91cc\u7528\u8377\u5170\u8bed Passering \u548c Vrijgave \u4e24\u4e2a\u5355\u8bcd\u6765\u5206\u522b\u5f62\u5bb9\u4e0a\u8ff0\u7684\u4e24\u4e2a\u64cd\u4f5c\u3002</p> <p>Dijkstra \u4e3a\u8ba1\u7b97\u673a\u5e76\u884c\u7f16\u7a0b\u505a\u51fa\u4e86\u5353\u8d8a\u8d21\u732e\uff0c\u6211\u4eec\u5f88\u5feb\u5c31\u4f1a\u5728\u540e\u6587\u770b\u5230\u4ed6\u63d0\u51fa\u7684\u5173\u4e8e\u5e76\u53d1\u7684\u4e00\u4e2a\u7ecf\u5178\u7684\u95ee\u9898\u3002</p> <p>\u5728 Linux \u4e2d\uff0c\u4fe1\u53f7\u91cf\u4e3b\u8981\u6709\u4e24\u79cd\u5b9e\u73b0\uff1aSystem V Semaphore \u548c POSIX Semaphore\u3002\u5176\u4e2d\u540e\u8005\u8f83\u4e3a\u5e38\u7528\uff0c\u56e0\u6b64\u63a5\u4e0b\u6765\u7b80\u5355\u4ecb\u7ecd\u540e\u8005\u3002</p> <p>POSIX Semaphore \u76f8\u5173\u7684 API \u4f4d\u4e8e\u5934\u6587\u4ef6 <code>semaphore.h</code> \u4e2d\uff0cP \u64cd\u4f5c\u5bf9\u5e94 <code>sem_wait</code> \u51fd\u6570\uff0cV \u64cd\u4f5c\u5bf9\u5e94 <code>sem_post</code> \u51fd\u6570\u3002</p> \u4fe1\u53f7\u91cf\u4e0e\u5f02\u5e38 <p>POSIX \u4fe1\u53f7\u91cf\u7684 <code>sem_post</code> \u53ef\u80fd\u51fa\u73b0\u5f02\u5e38\uff0c\u5bfc\u81f4\u51fd\u6570\u8fd4\u56de <code>-1</code>\uff0c\u539f\u56e0\u4e3a\u4ee5\u4e0b\u5176\u4e2d\u4e00\u79cd\uff1a</p> <ol> <li>\u4fe1\u53f7\u91cf\u65e0\u6548\uff0c\u4f8b\u5982\u4e3a <code>NULL</code>\u3002</li> <li>\u4fe1\u53f7\u91cf\u5b58\u50a8\u7684\u6570\u5b57\u5927\u5c0f\u5df2\u7ecf\u8fbe\u5230\u4e0a\u9650\u3002</li> </ol> <p><code>sem_wait</code> \u4e5f\u53ef\u80fd\u51fa\u73b0\u5f02\u5e38\u800c\u5bfc\u81f4\u7ebf\u7a0b\u4ece\u963b\u585e\u4e2d\u6062\u590d\uff0c\u4f46\u6b64\u65f6\u4fe1\u53f7\u91cf\u672a\u88ab\u51cf 1\u3002\u4f8b\u5982\u5f53\u524d\u7ebf\u7a0b\u6536\u5230\u4e86\u4fe1\u53f7\u65f6\uff0c\u5bf9 <code>sem_wait</code> \u7684\u8c03\u7528\u5c31\u4f1a\u88ab\u6253\u65ad\u800c\u8fd4\u56de\u3002</p> C++ 20 \u4e2d\u7684\u4fe1\u53f7\u91cf <p>C++ 20 \u6807\u51c6\u5411 STL \u5f15\u5165\u4e86\u4e00\u5957\u4fe1\u53f7\u91cf\u5de5\u5177\uff0c\u57fa\u672c\u7684\u7528\u6cd5\u4f9d\u7136\u662f P \u64cd\u4f5c\u548c V \u64cd\u4f5c\u3002\u5177\u4f53\u8bf7\u53c2\u9605\u76f8\u5173\u6587\u6863\u3002</p>"},{"location":"parallel/multi-threading/#\u6b7b\u9501\u4e0e\u6d3b\u9501","title":"\u6b7b\u9501\u4e0e\u6d3b\u9501","text":"<p>\u5728\u4f7f\u7528\u4e92\u65a5\u91cf\u6216\u539f\u5b50\u91cf\u65f6\uff0c\u9664\u4e86\u6ce8\u610f\u5206\u6790\u4e34\u754c\u533a\u7684\u8303\u56f4\u6216\u8005\u9009\u7528\u6b63\u786e\u7684\u539f\u5b50\u64cd\u4f5c\u4ee5\u5916\uff0c\u6211\u4eec\u8fd8\u5fc5\u987b\u6ce8\u610f\u6b7b\u9501\uff08Dead lock\uff09\u4e0e\u6d3b\u9501\uff08Live lock\uff09\u7684\u95ee\u9898\u3002</p>"},{"location":"parallel/multi-threading/#\u6b7b\u9501","title":"\u6b7b\u9501","text":"<p>\u6b7b\u9501\u4e00\u822c\u6307\u7684\u662f\uff1a\u7ade\u4e89\u8bbf\u95ee\u67d0\u4e9b\u8d44\u6e90\u7684\u4e00\u4e9b\u7ebf\u7a0b\u56e0\u4e3a\u4e92\u65a5\u91cf\u7684\u4f7f\u7528\u4e0d\u5f53\uff0c\u5bfc\u81f4\u5b83\u4eec\u5904\u4e8e\u6c38\u4e45\u963b\u585e\u7684\u72b6\u6001\u3002\u5728\u8fd9\u79cd\u72b6\u6001\u4e0b\uff0c\u7a0b\u5e8f\u4e00\u822c\u4f1a\u76f4\u63a5\u5931\u53bb\u54cd\u5e94\u4e0d\u518d\u53ef\u7528\u3002\u6bd4\u8f83\u5178\u578b\u7684\u4f1a\u53d1\u751f\u6b7b\u9501\u7684\u60c5\u51b5\u662f\uff1a</p> <ol> <li>\u7532\u7ebf\u7a0b\u4e3a\u4e86\u62ff\u5230 X \u8d44\u6e90\uff0c\u8bd5\u56fe\u62ff\u5230 X \u8d44\u6e90\u7684\u4e92\u65a5\u91cf\uff0c\u4f46\u662f\u8fd9\u4e2a\u4e92\u65a5\u91cf\u5df2\u7ecf\u88ab\u4e59\u7ebf\u7a0b\u52a0\u9501\u3002</li> <li>\u4e59\u7ebf\u7a0b\u4e3a\u4e86\u62ff\u5230 Y \u8d44\u6e90\uff0c\u8bd5\u56fe\u62ff\u5230 Y \u8d44\u6e90\u7684\u4e92\u65a5\u91cf\uff0c\u4f46\u662f\u8fd9\u4e2a\u4e92\u65a5\u91cf\u5df2\u7ecf\u88ab\u7532\u7ebf\u7a0b\u52a0\u9501\u3002</li> </ol> <p>\u6b64\u65f6\u4e24\u4e2a\u7ebf\u7a0b\u90fd\u5728\u7b49\u5f85\u5bf9\u65b9\u653e\u5f03\u9501\uff0c\u9677\u5165\u4e86\u4e00\u79cd\u6c38\u4e45\u963b\u585e\u7684\u6b7b\u9501\u72b6\u6001\u3002\u524d\u6587\u4e2d\u6211\u4eec\u5fd8\u8bb0\u5728\u5faa\u73af\u4e2d\u914d\u5e73 <code>lock()</code> \u548c <code>unlock()</code> \u65f6\u53ef\u80fd\u5c31\u4f1a\u5bfc\u81f4\u8fd9\u79cd\u6b7b\u9501\uff0c\u6b64\u65f6\u7532\u7ebf\u7a0b\u548c\u4e59\u7ebf\u7a0b\u90fd\u6307\u540c\u4e00\u4e2a\u7ebf\u7a0b\uff0cX \u548c Y \u8d44\u6e90\u4e5f\u6307\u540c\u4e00\u4e2a\u8d44\u6e90\u3002</p> <p>\u53e6\u4e00\u4e9b\u4f8b\u5b50\u548c\u8981\u5b9e\u73b0\u7684\u6570\u636e\u7ed3\u6784\u6709\u5173\uff0c\u8fd9\u79cd\u6b7b\u9501\u95ee\u9898\u4e00\u822c\u5f88\u96be\u53d1\u73b0\u3002\u4e00\u4e2a\u6bd4\u8f83\u8457\u540d\u7684\u4f8b\u5b50\u662f\u54f2\u5b66\u5bb6\u5c31\u9910\u95ee\u9898\uff08Dining philosophers problem\uff09\u3002\u6211\u4eec\u5728\u8bbe\u8ba1\u94fe\u8868\u7ed3\u6784\u7684\u65f6\u5019\u5c31\u5bb9\u6613\u51fa\u73b0\u548c\u5b83\u7c7b\u4f3c\u7684\u95ee\u9898\u3002</p> \u54f2\u5b66\u5bb6\u5c31\u9910\u95ee\u9898 <p>\u54f2\u5b66\u5bb6\u5c31\u9910\u95ee\u9898\u4e8e 1965 \u5e74\u88ab Dijkstra \u63d0\u51fa\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff08\u56fe\u7247\u6765\u81ea\u7ef4\u57fa\u767e\u79d1\uff09\uff1a</p> <p></p> <p>\u6709\u4e94\u4e2a\u54f2\u5b66\u5bb6\u5728\u684c\u5b50\u4e0a\u51c6\u5907\u5403\u9762\uff0c\u684c\u5b50\u4e0a\u53ea\u6709\u4e94\u4e2a\u53c9\u5b50\u3002\u5047\u8bbe\u9762\u662f\u65e0\u9650\u591a\u7684\uff0c\u54f2\u5b66\u5bb6\u7684\u80c3\u53e3\u4e5f\u662f\u65e0\u9650\u7684\u3002\u5e76\u4e14\u6bcf\u4e2a\u54f2\u5b66\u5bb6\u4f1a\u4f9d\u6b21\u505a\u4ee5\u4e0b\u7684\u4e8b\u60c5\uff1a</p> <ol> <li>\u601d\u8003\uff0c\u76f4\u5230\u4ed6\u62ff\u5230\u4e86\u5de6\u8fb9\u7684\u53c9\u5b50\u3002</li> <li>\u7ee7\u7eed\u601d\u8003\uff0c\u76f4\u5230\u4ed6\u62ff\u5230\u4e86\u53f3\u8fb9\u7684\u53c9\u5b50\u3002</li> <li>\u73b0\u5728\u624b\u4e0a\u6709\u4e24\u4e2a\u53c9\u5b50\u4e86\uff0c\u5403\u9762\u3002</li> <li>\u5403\u5b8c\u4e4b\u540e\u653e\u4e0b\u53f3\u8fb9\u7684\u53c9\u5b50\u3002</li> <li>\u653e\u4e0b\u5de6\u8fb9\u7684\u53c9\u5b50\u3002</li> <li>\u601d\u8003\u4e00\u4f1a\uff0c\u7136\u540e\u91cd\u590d 1\u3002</li> </ol> <p>\u5982\u679c\u6211\u4eec\u4f7f\u7528\u4e92\u65a5\u91cf\u53bb\u6a21\u62df\u4e94\u4e2a\u54f2\u5b66\u5bb6\u7684\u8fd9\u79cd\u8fc7\u7a0b\uff0c\u50cf\u4e0b\u9762\u8fd9\u6837\uff1a</p> <pre><code>void do_loop() {\n    while (true) {\n        { \n            std::scoped_lock lock(left_fork.mutex);\n            { \n                std::scoped_lock lock(right_fork.mutex);\n                std::cout &lt;&lt; \"i eat\" &lt;&lt; std::endl;\n                sleep(1); // \u6a21\u62df\u5403\u9762\u4e00\u79d2\uff0c\u54f2\u5b66\u5bb6\u5403\u9762\u90fd\u662f\u5f88\u5feb\u7684\n            }\n        }\n        std::cout &lt;&lt; \"i think\" &lt;&lt; std::endl;\n        sleep(1); // \u5403\u9762\u7ed3\u675f\u540e\u601d\u8003\u4e00\u4f1a\uff0c\u54f2\u5b66\u5bb6\u601d\u8003\u4e00\u79d2\u76f8\u5f53\u4e8e\u5e73\u5e38\u4eba\u601d\u8003\u4e00\u5929\n    }\n}\n</code></pre> <p>\u7136\u800c\u7a0b\u5e8f\u5f00\u59cb\u8fd0\u884c\u4e4b\u540e\uff0c\u6211\u4eec\u6ca1\u6709\u770b\u5230\u7a0b\u5e8f\u6709\u4efb\u4f55\u8f93\u51fa\uff01\u8fd9\u662f\u56e0\u4e3a\u4e94\u4f4d\u54f2\u5b66\u5bb6\u90fd\u5bf9\u5404\u81ea\u5de6\u8fb9\u7684\u53c9\u5b50\u4e0a\u9501\u4e86\uff0c\u7136\u540e\u5c1d\u8bd5\u62ff\u5230\u53f3\u8fb9\u7684\u53c9\u5b50\uff0c\u800c\u6b64\u65f6\u53f3\u8fb9\u7684\u53c9\u5b50\u5df2\u7ecf\u88ab\u53e6\u4e00\u4f4d\u54f2\u5b66\u5bb6\u4e0a\u9501\u3002</p> <p>\u5728\u534a\u4e2a\u591a\u4e16\u7eaa\u4ee5\u6765\uff0c\u89e3\u51b3\u8fd9\u4e2a\u6b7b\u9501\u95ee\u9898\u7684\u65b9\u6cd5\u5c42\u51fa\u4e0d\u7a77\u3002\u8bf7\u8bfb\u8005\u81ea\u884c\u67e5\u9605\u76f8\u5173\u8d44\u6599\u3002</p> <p>\u603b\u4f53\u800c\u8a00\uff0c\u907f\u514d\u6b7b\u9501\u7684\u4e00\u4e9b\u7ecf\u9a8c\u5982\u4e0b\uff1a</p> <ul> <li>\u6ce8\u610f\u51fd\u6570\u7684\u8c03\u7528\u987a\u5e8f\u3002</li> <li>\u4e0d\u8981\u5728\u6301\u6709\u9501\u7684\u65f6\u5019\u8c03\u7528\u53ef\u80fd\u4f1a\u963b\u585e\u7ebf\u7a0b\u7684\u5916\u90e8\u51fd\u6570\uff0c\u4f8b\u5982 <code>read()</code> \u6216\u8005 <code>recv()</code> \u7b49\u9700\u8981\u8fdb\u884c\u5916\u90e8 IO \u64cd\u4f5c\u7684\u51fd\u6570\u3002\u4e00\u65e6\u4e00\u4e2a\u7ebf\u7a0b\u6301\u6709\u9501\u5e76\u6302\u8d77\u540e\uff0c\u53ea\u6709\u7b49\u5230\u8fd9\u4e2a\u7ebf\u7a0b\u88ab\u5524\u9192\u540e\u624d\u80fd\u89e3\u9501\u3002\u5982\u679c\u8fd9\u4e2a\u963b\u585e\u7ebf\u7a0b\u7684\u5916\u90e8\u51fd\u6570\u9700\u8981\u5176\u4ed6\u6301\u6709\u8fd9\u4e2a\u9501\u7684\u7ebf\u7a0b\u53bb\u5524\u9192\uff0c\u90a3\u4e48\u5c31\u4f1a\u6b7b\u9501\u4e86\u3002</li> <li>\u5982\u679c\u9700\u8981\u540c\u65f6\u4f7f\u7528\u591a\u4e2a\u9501\uff0c\u52a1\u5fc5\u4fdd\u8bc1\u6240\u6709\u7ebf\u7a0b\u90fd\u4ee5\u76f8\u540c\u7684\u987a\u5e8f\u7ed9\u4ed6\u4eec\u4e0a\u9501\u6216\u89e3\u9501\u3002</li> <li>\u5f00\u542f\u7f16\u8bd1\u5668\u7684\u6b7b\u9501\u68c0\u6d4b\u529f\u80fd\u8fdb\u884c\u8c03\u8bd5\u3002</li> </ul> std::scoped_lock <p>\u5982\u679c\u8981\u540c\u65f6\u4f7f\u7528\u591a\u4e2a\u9501\uff0c\u800c\u4e14\u53c8\u60f3\u907f\u514d\u6b7b\u9501\u95ee\u9898\uff0c\u5efa\u8bae\u4f7f\u7528 <code>std::scoped_lock</code>\uff0c\u5b83\u7684\u6784\u9020\u51fd\u6570\u5176\u5b9e\u53ef\u4ee5\u63a5\u6536\u82e5\u5e72\u4e2a\u4e92\u65a5\u91cf\u4f5c\u4e3a\u53c2\u6570\uff1a</p> <pre><code>void foo() {\n    std::scoped_lock lock(mutex_a, mutex_b, mutex_c);\n}\n</code></pre> <p>\u5f53\u7ed9\u5b9a\u591a\u4e2a\u4e92\u65a5\u91cf\u4f5c\u4e3a\u53c2\u6570\u65f6\uff0c\u6784\u9020\u51fd\u6570\u5185\u90e8\u4f1a\u4f7f\u7528 <code>std::lock()</code> \u51fd\u6570\u6765\u7ed9\u8f93\u5165\u7684\u4e92\u65a5\u91cf\u4e0a\u9501\u3002\u5b83\u7684\u5185\u90e8\u4f1a\u4f7f\u7528\u6b7b\u9501\u907f\u514d\u7b97\u6cd5\u6765\u9632\u6b62\u6b7b\u9501\u7684\u4ea7\u751f\u3002\u8be6\u60c5\u8bf7\u53c2\u9605\u76f8\u5173\u6587\u6863\u3002</p>"},{"location":"parallel/multi-threading/#\u6d3b\u9501","title":"\u6d3b\u9501","text":"<p>\u6d3b\u9501\u662f\u5e76\u53d1\u7f16\u7a0b\u91cc\u9965\u997f\uff08Starvation\uff09\u95ee\u9898\u7684\u4e00\u79cd\u7279\u4f8b\u3002\u7b80\u5355\u6765\u8bf4\uff0c\u9965\u997f\u95ee\u9898\u6307\u7684\u662f\uff1a\u7ebf\u7a0b\u603b\u662f\u65e0\u6cd5\u83b7\u5f97\u6240\u9700\u7684\u8d44\u6e90\u4ee5\u7ee7\u7eed\u8fd0\u884c\u540e\u7eed\u7b97\u6cd5\u3002</p> <p>\u800c\u6d3b\u9501\u5177\u4f53\u6307\u7684\u662f\uff1a\u4e00\u4e9b\u7ebf\u7a0b\u603b\u80fd\u591f\u5e76\u53d1\u6267\u884c\uff08\u6d88\u8017 CPU \u65f6\u95f4\uff09\uff0c\u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u80fd\u5bf9\u5c40\u90e8\u72b6\u6001\u8fdb\u884c\u4fee\u6539\uff0c\u4f46\u662f\u7cfb\u7edf\u7684\u6574\u4f53\u72b6\u6001\u5374\u6ca1\u6709\u63a8\u8fdb\u3002\u5173\u4e8e\u6d3b\u9501\u4e00\u4e2a\u6bd4\u8f83\u5f62\u8c61\u7684\u6bd4\u55bb\u662f\uff1a\u4f60\u548c\u4e00\u4e2a\u4eba\u72ed\u8def\u76f8\u9022\uff0c\u53cc\u65b9\u9700\u8981\u9760\u8fb9\u907f\u8ba9\u624d\u80fd\u7ee7\u7eed\u8d70\u4e0b\u53bb\uff0c\u4f46\u662f\u4f60\u548c\u4ed6\u603b\u662f\u5f80\u540c\u4e00\u4e2a\u65b9\u5411\u907f\u8ba9\uff0c\u867d\u7136\u4e24\u4e2a\u4eba\u5404\u81ea\u90fd\u4e0d\u505c\u5730\u53d8\u6362\u7740\u65b9\u5411\uff0c\u4f46\u5728\u5927\u5bb6\u770b\u6765\u5c31\u662f\u4e24\u4e2a\u4eba\u7ad9\u5728\u90a3\u518d\u4e5f\u6ca1\u6709\u5411\u524d\u8d70\u51fa\u4e00\u6b65\uff0c\u5835\u4f4f\u4e86\u6574\u6761\u8d70\u9053\u3002</p>"},{"location":"parallel/practice/callback/","title":"\u56de\u8c03\u6a21\u578b","text":"<p>\u6709\u65f6\u5019\u6211\u4eec\u5e0c\u671b\u5f00\u4e00\u4e2a\u7ebf\u7a0b\u53bb\u6267\u884c\u4e00\u4e9b\u8017\u65f6\u7684\u64cd\u4f5c\uff0c\u4f8b\u5982\u6267\u884c\u4e00\u4e2a\u5f88\u590d\u6742\u7684\u8ba1\u7b97\uff0c\u6216\u8005\u53d1\u9001\u4e00\u4e2a\u7f51\u7edc\u8bf7\u6c42\uff0c\u5e76\u4e14\u60f3\u5f97\u5230\u51fd\u6570\u6267\u884c\u7684\u7ed3\u679c\u3002\u4e00\u79cd\u529e\u6cd5\u662f\u4f7f\u7528\u4e00\u4e2a\u56de\u8c03\u51fd\u6570\u63a5\u53d7\u7ed3\u679c\u3002\u4f8b\u5982\uff1a</p> <pre><code>#include &lt;iostream&gt;\n#include &lt;chrono&gt;\n#include &lt;thread&gt;\n#include &lt;functional&gt;\n\nint calculate(int arg) {\n    std::this_thread::sleep_for(std::chrono::seconds(1));\n    return arg + 42;\n}\n\nvoid do_work(int arg, std::function&lt;void(int)&gt; callback) {    \n    int result = calculate(arg);\n    callback(result);\n}\n\nint main() {\n    std::thread t(do_work, 1, [](int result) {\n        std::cout &lt;&lt; result &lt;&lt; std::endl;\n    });\n    std::cout &lt;&lt; \"Continue main\" &lt;&lt; std::endl;\n    t.join();\n    return 0;\n}\n</code></pre> <p>\u5bf9\u4e8e\u666e\u901a\u7684\u51fd\u6570\uff0c\u6211\u4eec\u53ea\u9700\u8981\u7528\u4e00\u4e2a\u5305\u88c5\u51fd\u6570\u6765\u8d1f\u8d23\u5c06\u7ed3\u679c\u4f20\u9012\u7ed9\u56de\u8c03\u51fd\u6570\uff0c\u7136\u540e\u5f00\u542f\u4e00\u4e2a\u65b0\u7684\u7ebf\u7a0b\u53bb\u8c03\u7528\u8fd9\u4e2a\u5305\u88c5\u51fd\u6570\u5373\u53ef\u3002\u4e0d\u8fc7\uff0c\u56de\u8c03\u51fd\u6570\u5bb9\u6613\u9677\u5165\u56de\u8c03\u5730\u72f1\u4e2d\uff0c\u5f53\u6267\u884c\u7684\u64cd\u4f5c\u4e00\u591a\u8d77\u6765\u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u4ea7\u751f\u975e\u5e38\u6df1\u7684\u56de\u8c03\u5d4c\u5957\u3002</p>"},{"location":"parallel/practice/cancellation/","title":"\u53d6\u6d88\u64cd\u4f5c","text":"<p>\u901a\u5e38\uff0c\u6211\u4eec\u5e0c\u671b\u4e00\u4e9b\u8017\u65f6\u6bd4\u8f83\u957f\u4e14\u8017\u8d39\u8d44\u6e90\u7684\u64cd\u4f5c\u53ef\u4ee5\u63d0\u4f9b\u53d6\u6d88\u7684\u65b9\u6cd5\uff0c\u6bd4\u5982\u8bf4\u67d0\u4e2a\u6570\u636e\u5e93\u64cd\u4f5c\u7279\u522b\u82b1\u65f6\u95f4\uff0c\u53ef\u4ee5\u8ba9\u7528\u6237\u76f4\u63a5\u53d6\u6d88\u6267\u884c\u91ca\u653e\u8d44\u6e90\u3002\u53d6\u6d88\u4e00\u4e2a\u64cd\u4f5c\u6ca1\u6709\u60f3\u8c61\u4e2d\u90a3\u4e48\u7b80\u5355\uff0c\u5047\u5982\u6211\u4eec\u5df2\u7ecf\u542f\u52a8\u4e86\u4e00\u4e2a\u7ebf\u7a0b\u6267\u884c\u5f02\u6b65\u7684\u64cd\u4f5c\uff0c\u90a3\u4e48\u60f3\u8981\u53d6\u6d88\u5b83\u6709\u4ee5\u4e0b\u51e0\u79cd\u65b9\u6cd5\uff1a</p> <ul> <li>\u76f4\u63a5\u7ec8\u6b62\u7ebf\u7a0b\u3002\u8fd9\u79cd\u65b9\u6cd5\u6700\u7b80\u5355\u7c97\u66b4\uff0c\u4f46\u662f\u4e5f\u6700\u4e0d\u53ef\u7528\u3002\u76f4\u63a5\u7ec8\u6b62\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u5e76\u4e0d\u4f1a\u89e6\u53d1\u6808\u5c55\u5f00\u4ee5\u53ca\u8c03\u7528\u6790\u6784\u51fd\u6570\u3002\u6b64\u65f6\u7ebf\u7a0b\u53ef\u80fd\u6301\u6709\u4e00\u4e2a\u9501\uff0c\u76f4\u63a5\u7ec8\u6b62\u4f1a\u5bfc\u81f4\u8fd9\u4e2a\u9501\u6c38\u8fdc\u4e0d\u4f1a\u91ca\u653e\uff0c\u6216\u8005\u7533\u8bf7\u4e86\u4e00\u4e9b RAII \u8d44\u6e90\uff0c\u76f4\u63a5\u7ec8\u6b62\u4e0d\u4f1a\u89e6\u53d1\u56de\u6536\uff0c\u9020\u6210\u8d44\u6e90\u6cc4\u9732\u3002\u800c\u4e14\uff0cC++ \u6807\u51c6\u5e76\u6ca1\u6709\u63d0\u4f9b\u7ec8\u6b62\u7ebf\u7a0b\u7684 API\uff0c\u9700\u8981\u76f4\u63a5\u8c03\u7528\u64cd\u4f5c\u7cfb\u7edf\u7684 API \u6765\u7ec8\u6b62\u7ebf\u7a0b\uff0c\u964d\u4f4e\u4e86\u7a0b\u5e8f\u7684\u53ef\u79fb\u690d\u6027\u3002</li> <li>\u8bbe\u7f6e\u5f3a\u5236\u7ec8\u6b62\u70b9\u3002\u8fd9\u79cd\u65b9\u6cd5\u5728\u53d6\u6d88\u4e00\u4e2a\u7ebf\u7a0b\u7684\u64cd\u4f5c\u7684\u65f6\u5019\uff0c\u4f1a\u8bbe\u7f6e\u4e00\u4e9b\u5185\u90e8\u6807\u5fd7\uff0c\u5e76\u5728\u4e0b\u4e00\u6b21\u7684\u7279\u5b9a\u8c03\u7528\uff0c\u4f8b\u5982 <code>read()</code>\u3001<code>open()</code> \u53d1\u751f\u7684\u65f6\u5019\u8fd4\u56de\u9519\u8bef\u6216\u8005\u629b\u51fa\u5f02\u5e38\uff0c\u5e76\u8fdb\u884c\u6808\u5c55\u5f00\uff0c\u8fbe\u5230\u53d6\u6d88\u64cd\u4f5c\u7684\u76ee\u7684\u3002\u8fd9\u4e9b\u51fd\u6570\u4e5f\u53eb\u53d6\u6d88\u70b9\uff08Cancellation Point\uff09\u3002\u8fd9\u79cd\u65b9\u5f0f\u80fd\u907f\u514d\u8d44\u6e90\u6cc4\u9732\uff0c\u4f46\u662f\u8fd9\u79cd\u65b9\u5f0f\u6709\u5f88\u591a\u6f5c\u5728\u7684\u95ee\u9898\uff0c\u5f88\u96be\u5b9e\u73b0\u4e00\u4e2a\u5b8c\u5168\u6b63\u786e\u7684\u6a21\u578b\u3002\u540c\u65f6\uff0c\u7ebf\u7a0b\u53ef\u80fd\u4f1a\u5728\u4ec0\u4e48\u65f6\u5019\u4e2d\u6b62\u4e5f\u5e76\u4e0d\u663e\u7136\u3002</li> <li>\u8bbe\u7f6e\u81ea\u613f\u7ec8\u6b62\u70b9\u3002\u8fd9\u79cd\u65b9\u6cd5\u9700\u8981\u51fd\u6570\u989d\u5916\u63a5\u6536\u4e00\u4e2a\u53d6\u6d88\u4ee4\u724c\uff08Cancellation Token\uff09\uff0c\u5e76\u6839\u636e\u9700\u8981\u5728\u4e0d\u540c\u7684\u5730\u65b9\u68c0\u6d4b\u4ee4\u724c\u662f\u4e0d\u662f\u5df2\u7ecf\u89e6\u53d1\uff0c\u68c0\u6d4b\u5230\u64cd\u4f5c\u5df2\u7ecf\u88ab\u53d6\u6d88\u7684\u65f6\u5019\uff0c\u5c31\u63d0\u524d\u8fdb\u884c\u6e05\u7406\u64cd\u4f5c\u5e76\u7ec8\u6b62\u51fd\u6570\u3002\u8fd9\u79cd\u65b9\u5f0f\u9700\u8981\u5728\u6bcf\u6b21\u8c03\u7528\u51fd\u6570\u7684\u65f6\u5019\u90fd\u4f20\u9012\u4e00\u4e2a\u53d6\u6d88\u4ee4\u724c\uff0c\u76f8\u5f53\u4e8e\u591a\u4e86\u4e00\u4e2a\u53c2\u6570\u3002\u6b63\u662f\u56e0\u4e3a\u8fd9\u6837\uff0c\u4f7f\u7528\u53d6\u6d88\u4ee4\u724c\u5177\u6709\u4f20\u67d3\u6027\uff0c\u4f1a\u7ed9\u6539\u53d8\u5927\u90e8\u5206\u7684\u51fd\u6570\u7b7e\u540d\u3002\u4f46\u662f\u8fd9\u79cd\u65b9\u5f0f\u6700\u4e3a\u53ef\u9760\u3001\u53ef\u63a7\u4ee5\u53ca\u5b89\u5168\uff0c\u80fd\u4e00\u76ee\u4e86\u7136\u51fd\u6570\u53ef\u80fd\u5728\u54ea\u91cc\u88ab\u4e2d\u6b62\uff0c\u50cf Go \u4e2d\u7684 <code>context</code> \u5c31\u76f8\u5f53\u4e8e\u4e00\u4e2a\u53d6\u6d88\u4ee4\u724c\u3002</li> </ul> <p>\u4e00\u822c\u6765\u8bf4\uff0c\u8981\u60f3\u53d6\u6d88\u4e00\u4e2a\u64cd\u4f5c\uff0c\u9700\u8981\u5148\u4ee5\u67d0\u79cd\u65b9\u5f0f\u6765\u6807\u8bc6\u4e00\u4e2a\u64cd\u4f5c\uff0c\u4f8b\u5982\u53ef\u4ee5\u7ed9\u64cd\u4f5c\u5206\u914d\u4e00\u4e2a\u552f\u4e00\u7684 ID\uff0c\u6216\u8005\u76f4\u63a5\u4f7f\u7528\u7f51\u7edc\u94fe\u63a5\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002\u5728\u64cd\u4f5c\u9700\u8981\u53d6\u6d88\u7684\u65f6\u5019\uff0c\u5c31\u901a\u8fc7\u6807\u8bc6\u7b26\u627e\u5230\u8fd9\u4e2a\u64cd\u4f5c\u5bf9\u5e94\u7684\u7ebf\u7a0b\u6216\u8005\u53d6\u6d88\u4ee4\u724c\u5e76\u53d1\u9001\u53d6\u6d88\u6307\u4ee4\u3002\u64cd\u4f5c\u7684\u53d6\u6d88\u53ef\u80fd\u6709\u591a\u79cd\u539f\u56e0\uff0c\u6bd4\u5982\u7528\u6237\u4f7f\u7528\u53e6\u5916\u7684 API \u660e\u786e\u5730\u53d6\u6d88\uff0c\u6216\u8005\u7528\u6237\u76f4\u63a5\u5173\u95ed\u7f51\u7edc\u94fe\u63a5\u6765\u8868\u793a\u9700\u8981\u53d6\u6d88\u8fd9\u4e2a\u64cd\u4f5c\u3002</p>"},{"location":"parallel/practice/future/","title":"Future \u6a21\u5f0f","text":"<p>Future \u662f\u201c\u672a\u6765\u201d\u7684\u610f\u601d\uff0c\u4e5f\u5c31\u662f\u8bf4\u8fd9\u4e2a\u503c\u4e0d\u662f\u9a6c\u4e0a\u5c31\u80fd\u83b7\u5f97\uff0c\u800c\u662f\u8981\u5728\u201c\u672a\u6765\u201d\u67d0\u4e2a\u65f6\u5019\u624d\u80fd\u5f97\u5230\u503c\u3002<code>std::future</code> \u9664\u4e86\u5b58\u50a8\u5177\u4f53\u7684\u503c\u4ee5\u5916\uff0c\u8fd8\u5b58\u50a8\u4e86\u8fd9\u4e2a\u503c\u7684\u72b6\u6001\uff0c\u4f7f\u7528\u8005\u65e2\u53ef\u4ee5\u8f6e\u8be2 <code>std::future</code> \u7684\u72b6\u6001\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u963b\u585e\u8c03\u7528\u6765\u8ba9 <code>std::future</code> \u7684\u503c\u786e\u5b9a\u4e4b\u540e\u518d\u8fd4\u56de\u3002\u524d\u9762\u5c31\u76f8\u5f53\u4e8e\u4e00\u4e2a\u7b80\u5355\u7684 <code>while</code> \u5faa\u73af\uff0c\u800c\u540e\u8005\u5219\u53ef\u4ee5\u7406\u89e3\u4e3a\u6761\u4ef6\u53d8\u91cf\u7684 <code>wait</code>\u3002</p> <p>\u800c\u5728\u6ca1\u6709\u8bbe\u7f6e\u503c\u7684\u65f6\u5019\uff0c\u8c03\u7528 <code>future</code> \u7684 <code>get()</code> \u4f1a\u963b\u585e\u5e76\u6302\u8d77\u7ebf\u7a0b\uff0c\u4e00\u65e6\u6709\u503c\u5219\u5524\u9192\u7ebf\u7a0b\u5e76\u8fd4\u56de\u503c\u3002\u53ef\u4ee5\u7406\u89e3\u4e3a\uff1a</p> <pre><code>template&lt;typename T&gt;\nclass future&lt;T&gt; {\n    std::mutex mu;\n    std::condition_variable cv;\n    State state;\n    T value;\nprotected:\n    void set(T const&amp; v) {\n        std::scoped_lock lk(mu);\n        state = READY;\n        value = v;\n        cv.notify_all();\n    }\npublic:\n    T get() {\n        std::unique_lock lk(mu);\n        cv.wait(lk, []() { state == READY });\n        return value;\n    }\n\n    bool try_get(T&amp; v) {\n        std::scoped_lock lk(mu);\n        if (state == READY) {\n            v = value;\n            return true;\n        }\n        return false;\n    }\n}\n</code></pre>"},{"location":"parallel/practice/future/#stdpromise","title":"<code>std::promise</code>","text":"<p><code>std::future</code> \u5e76\u4e0d\u80fd\u76f4\u63a5\u8bbe\u7f6e\u503c\uff0c\u800c\u662f\u9700\u8981\u5176\u4ed6\u7684\u5305\u88c5\u7c7b\u6765\u6539\u53d8\u5b83\u7684\u5185\u90e8\u72b6\u6001\uff0c\u6301\u6709 <code>std::future</code> \u7684\u7ebf\u7a0b\u53ea\u80fd\u4ece\u4e2d\u83b7\u53d6\u503c\u3002\u4f8b\u5982\uff1a</p> <pre><code>#include &lt;iostream&gt;\n#include &lt;chrono&gt;\n#include &lt;thread&gt;\n#include &lt;functional&gt;\n#include &lt;future&gt;\n\nint calculate(int arg) {\n    std::this_thread::sleep_for(std::chrono::seconds(1));\n    return arg + 42;\n}\n\nvoid do_work(int arg, std::promise&lt;int&gt; p) {    \n    int result = calculate(arg);\n    p.set_value(result);\n}\n\nint main() {\n    std::promise&lt;int&gt; p;\n    std::future&lt;int&gt; fut = p.get_future();\n    std::thread t(do_work, 1, std::move(p));\n    t.detach();\n    std::cout &lt;&lt; \"Continue main\" &lt;&lt; std::endl;\n    std::cout &lt;&lt; fut.get() &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c<code>std::promise</code> \u7684\u4f7f\u7528\u65b9\u6cd5\u4e5f\u4e0d\u592a\u76f4\u89c2\uff0c\u6709\u70b9\u50cf\u56de\u8c03\u6a21\u5f0f\uff0c\u4f46\u53c8\u4e0d\u5b8c\u5168\u50cf\uff0c\u8fd8\u9700\u8981\u901a\u8fc7\u4e00\u4e2a <code>std::future</code> \u624d\u80fd\u62ff\u5230\u8fd4\u56de\u503c\u3002\u901a\u8fc7\u6587\u6863\u53ef\u4ee5\u770b\u5230\uff0c<code>future</code> \u53ea\u6709 <code>get_value()</code>\uff0c\u800c <code>promise</code> \u53ea\u6709 <code>set_value()</code> \u64cd\u4f5c\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u7ed9 <code>std::promise</code> \u8bbe\u7f6e\u503c\u4e4b\u540e\uff0c\u751a\u81f3\u4e0d\u80fd\u76f4\u63a5\u4ece\u91cc\u9762\u5c06\u503c\u83b7\u53d6\u56de\u6765\uff0c\u800c <code>future</code> \u53ea\u80fd\u901a\u8fc7\u5176\u4ed6\u7c7b\u6765\u8bbe\u7f6e\u503c\uff0c\u4f5c\u4e3a\u4f7f\u7528\u8005\u53ea\u80fd\u4ece\u4e2d\u83b7\u53d6\u503c\u3002</p> <p>\u8fd9\u79cd\u8bbe\u8ba1\u7684\u903b\u8f91\u662f\uff0c\u901a\u8fc7\u7c7b\u578b\u6765\u533a\u5206\u503c\u7684\u63d0\u4f9b\u8005\u548c\u4f7f\u7528\u8005\uff0c\u63d0\u4f9b\u8005\u4e0d\u5e94\u8be5\u4f7f\u7528\u503c\u800c\u4f7f\u7528\u8005\u4e0d\u5e94\u8be5\u8bbe\u7f6e\u503c\uff0c\u5e76\u901a\u8fc7 API \u4fdd\u8bc1\u5171\u4eab\u72b6\u6001\u4e0d\u4f1a\u88ab\u9519\u8bef\u5730\u4fee\u6539\u3002</p> <p>\u4f7f\u7528 Promise \u53ef\u4ee5\u907f\u514d\u56de\u8c03\u5730\u72f1\uff0c\u7528\u66f4\u81ea\u7136\u5730\u65b9\u6cd5\u7f16\u5199\u7a0b\u5e8f\u3002</p>"},{"location":"parallel/practice/future/#stdpackaged_task","title":"<code>std::packaged_task</code>","text":"<p>\u5982\u679c\u6bcf\u6b21\u60f3\u542f\u52a8\u7ebf\u7a0b\u6267\u884c\u522b\u7684\u4efb\u52a1\u7684\u65f6\u5019\u90fd\u8981\u50cf\u4e0a\u9762\u4e00\u6837\u5148\u5305\u88c5\u51fd\u6570\u7136\u540e\u521b\u5efa promise \u518d\u542f\u52a8\u7ebf\u7a0b\u5c31\u663e\u5f97\u592a\u8fc7\u9ebb\u70e6\u3002C++ \u4e2d\u63d0\u4f9b\u4e86 <code>std::packaged_task</code> \u6765\u5b8c\u6210\u5305\u88c5\u51fd\u6570\u548c promise \u7684\u90e8\u5206\u3002</p> <pre><code>#include &lt;iostream&gt;\n#include &lt;chrono&gt;\n#include &lt;thread&gt;\n#include &lt;functional&gt;\n#include &lt;future&gt;\n\nint calculate(int arg) {\n    std::this_thread::sleep_for(std::chrono::seconds(1));\n    return arg + 42;\n}\n\nint main() {\n    std::packaged_task&lt;int(int)&gt; task(calculate);\n    std::future&lt;int&gt; fut = task.get_future();\n    std::thread t(std::move(task), 1);\n    t.detach();\n    std::cout &lt;&lt; \"Continue main\" &lt;&lt; std::endl;\n    std::cout &lt;&lt; fut.get() &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre> <p>\u5305\u88c5\u540e\u7684\u4efb\u52a1\u5e76\u4e0d\u4f1a\u81ea\u52a8\u6267\u884c\uff0c\u4f46\u6267\u884c\u4e4b\u540e\u4f1a\u81ea\u52a8\u8bbe\u7f6e future \u7684\u503c\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5728\u6267\u884c\u4efb\u52a1\u4e4b\u524d\u83b7\u5f97 future\uff0c\u7136\u540e\u4f7f\u7528\u8fd9\u4e2a future \u6765\u83b7\u53d6\u8fd4\u56de\u503c\u5373\u53ef\u3002</p>"},{"location":"parallel/practice/future/#stdasync","title":"<code>std::async</code>","text":"<p>\u5982\u679c\u4e0d\u60f3\u624b\u52a8\u5f00\u7ebf\u7a0b\u53bb\u6267\u884c\u4efb\u52a1\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>std::async</code> \u6765\u76f4\u63a5\u542f\u52a8\u5f02\u6b65\u4efb\u52a1\uff0c\u53ea\u9700\u8981\u53bb\u83b7\u5f97 <code>future</code> \u7684\u503c\u5373\u53ef\u3002</p> <pre><code>#include &lt;iostream&gt;\n#include &lt;chrono&gt;\n#include &lt;thread&gt;\n#include &lt;functional&gt;\n#include &lt;future&gt;\n\nint calculate(int arg) {\n    std::this_thread::sleep_for(std::chrono::seconds(1));\n    return arg + 42;\n}\n\nint main() {\n    std::future&lt;int&gt; fut = std::async(calculate, 1);\n    std::cout &lt;&lt; \"Continue main\" &lt;&lt; std::endl;\n    std::cout &lt;&lt; fut.get() &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre> <p>\u8fd9\u79cd\u65b9\u5f0f\u4f7f\u7528\u6700\u7b80\u5355\uff0c\u4f46\u662f\u5bf9\u4e8e\u6267\u884c\u7684\u7ec6\u8282\u63a7\u5236\u6bd4\u8f83\u5c11\u3002\u6211\u4eec\u53ef\u4ee5\u7f16\u5199\u81ea\u5df1\u7684\u7ebf\u7a0b\u6c60\u6765\u5b9e\u73b0\u7c7b\u4f3c\u7684 API\uff0c\u540c\u65f6\u80fd\u591f\u628a\u63a7\u66f4\u591a\u7ec6\u8282\u3002</p>"},{"location":"parallel/practice/multi-threading-queue/","title":"\u6982\u89c8","text":"<p>\u652f\u6301\u591a\u7ebf\u7a0b\u5171\u4eab\u7684\u961f\u5217\u662f\u4e00\u79cd\u76f8\u5f53\u5e38\u89c1\u4e14\u91cd\u8981\u7684\u6570\u636e\u7ed3\u6784\u3002\u6b63\u5982\u6211\u4eec\u5728\u591a\u7ebf\u7a0b\u7f16\u7a0b\u4e2d\u770b\u5230\u7684\u90a3\u6837\uff0c\u9700\u8981\u591a\u7ebf\u7a0b\u7684\u573a\u666f\u5f88\u591a\u90fd\u4f1a\u8868\u73b0\u4e3a\u4e00\u79cd\u751f\u4ea7\u8005\u548c\u6d88\u8d39\u8005\u4e4b\u95f4\u7684\u534f\u4f5c\u5173\u7cfb\u3002\u4e3a\u4e86\u8ba9\u751f\u4ea7\u8005\u5f97\u4ee5\u5c06\u6570\u636e\u4f20\u9012\u7ed9\u6d88\u8d39\u8005\uff0c\u6211\u4eec\u5f80\u5f80\u5c31\u9700\u8981\u4e00\u4e2a\u5148\u8fdb\u5148\u51fa\uff08FIFO\uff09\u7684\u6570\u636e\u7ed3\u6784\uff1a\u961f\u5217\u3002</p> <p>\u5728\u4f20\u7edf\u7684\u5355\u7ebf\u7a0b\u7a0b\u5e8f\u91cc\uff0c\u5b9e\u73b0\u4e00\u4e2a\u961f\u5217\u76f8\u5f53\u7b80\u5355\u3002\u4e0d\u8fc7\u5728\u591a\u7ebf\u7a0b\u7684\u73af\u5883\u4e0b\uff0c\u9664\u4e86\u65e0\u6b7b\u9501\uff08deadlock-free\uff09\u7b49\u57fa\u672c\u6761\u4ef6\u4e4b\u5916\uff0c\u6211\u4eec\u7684\u961f\u5217\u8fd8\u5fc5\u987b\u6ee1\u8db3\u4ee5\u4e0b\u989d\u5916\u7684\u6761\u4ef6\uff1a</p> <ul> <li>\u7ebf\u7a0b\u5b89\u5168\uff08thread-safe\uff09</li> </ul> <p>\u591a\u4e2a\u7ebf\u7a0b\u5728\u5e76\u53d1\u8bbf\u95ee\u6570\u636e\u7ed3\u6784\u65f6\uff0c\u4e0d\u4f1a\u51fa\u73b0\u7ade\u6001\u6761\u4ef6\uff0c\u4e5f\u4e0d\u4f1a\u9020\u6210\u6570\u636e\u7ed3\u6784\u5185\u90e8\u72b6\u6001\u7684\u635f\u574f\u3002</p> <ul> <li>\u5f02\u5e38\u5b89\u5168\uff08exception-safe\uff09</li> </ul> <p>\u5f53\u4e00\u4e2a\u7ebf\u7a0b\u8c03\u7528\u6570\u636e\u7ed3\u6784\u63d0\u4f9b\u7684\u51fd\u6570\u4e2d\u9014\u51fa\u73b0\u5f02\u5e38\u65f6\uff0c\u6570\u636e\u7ed3\u6784\u5185\u90e8\u72b6\u6001\u4e0d\u4f1a\u635f\u574f\uff0c\u5176\u4ed6\u7ebf\u7a0b\u4f9d\u7136\u53ef\u4ee5\u6b63\u5e38\u8bbf\u95ee\u5e76\u5f97\u5230\u6b63\u786e\u7684\u7ed3\u679c\u3002\u5e76\u4e14\u4e5f\u4e0d\u4f1a\u51fa\u73b0\u5185\u5b58\u6cc4\u9732\u3002</p> <p>\u867d\u7136\u5f02\u5e38\u5b89\u5168\u5728\u5355\u7ebf\u7a0b\u573a\u666f\u4e0b\u4e5f\u5f88\u91cd\u8981\uff0c\u4f46\u5b83\u503c\u5f97\u5728\u591a\u7ebf\u7a0b\u573a\u666f\u4e2d\u88ab\u518d\u6b21\u5f3a\u8c03\u3002\u56e0\u4e3a\u591a\u7ebf\u7a0b\u4e0b\u56e0\u5f02\u5e38\u5b89\u5168\u9020\u6210\u7684 bug \u5f80\u5f80\u66f4\u52a0\u96be\u4ee5\u590d\u73b0\u3001\u6392\u67e5\uff0c\u6709\u65f6\u751a\u81f3\u4f1a\u9020\u6210\u6574\u4e2a\u8f6f\u4ef6\u7684\u5d29\u6e83\u3002</p> <p>\u5728 C++ \u4e2d\u5b9e\u73b0\u8fd9\u6837\u7684\u4e00\u4e2a\u961f\u5217\uff0c\u81f3\u5c11\u5b58\u5728\u4e24\u79cd\u65b9\u6cd5\uff1a\u57fa\u4e8e\u4e92\u65a5\u91cf\u7684\u65b9\u6cd5\u548c\u57fa\u4e8e\u539f\u5b50\u91cf\u7684\u65b9\u6cd5\u3002\u4e3a\u4e86\u7b80\u5355\u8d77\u89c1\uff0c\u6211\u4eec\u5728\u672c\u8282\u4e2d\u53ea\u4ecb\u7ecd\u57fa\u4e8e\u4e92\u65a5\u91cf\u7684\u65b9\u6cd5\u3002</p> <p>\u800c\u6839\u636e\u751f\u4ea7\u8005\u548c\u6d88\u8d39\u8005\u7684\u6570\u91cf\u4e0d\u540c\uff0c\u53ef\u4ee5\u5206\u4e3a\u56db\u79cd\u961f\u5217\uff1a</p> <ul> <li>\u5355\u751f\u4ea7\u8005\u5355\u6d88\u8d39\u8005\uff08SPSC\uff09\u961f\u5217</li> <li>\u5355\u751f\u4ea7\u8005\u591a\u6d88\u8d39\u8005\uff08SPMC\uff09\u961f\u5217</li> <li>\u591a\u751f\u4ea7\u8005\u5355\u6d88\u8d39\u8005\uff08MPSC\uff09\u961f\u5217</li> <li>\u591a\u751f\u4ea7\u8005\u591a\u6d88\u8d39\u8005\uff08MPMC\uff09\u961f\u5217</li> </ul> <p>\u591a\u7ebf\u7a0b\u4e2d\u4f7f\u7528\u5f97\u6bd4\u8f83\u591a\u7684\u662f MPSC \u961f\u5217\u4ee5\u53ca MPMC \u961f\u5217\u3002\u533a\u5206\u8fd9\u4e48\u591a\u79cd\u961f\u5217\u662f\u56e0\u4e3a\u5728\u6d88\u8d39\u8005\u6216\u8005\u751f\u4ea7\u8005\u53ea\u6709\u4e00\u4e2a\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u7f16\u5199\u51fa\u5e76\u53d1\u5ea6\u548c\u6027\u80fd\u66f4\u9ad8\u7684\u961f\u5217\u3002\u672c\u8282\u4ecb\u7ecd\u7684\u662f MPMC \u961f\u5217\u3002</p>"},{"location":"parallel/practice/multi-threading-queue/#\u7b80\u5355\u7684\u7c97\u7c92\u5ea6\u9501\u5b9e\u73b0","title":"\u7b80\u5355\u7684\u7c97\u7c92\u5ea6\u9501\u5b9e\u73b0","text":"<p>C++ \u7684 STL \u4e2d\u5df2\u7ecf\u63d0\u4f9b\u4e86\u4e00\u4e2a\u961f\u5217\uff1a<code>std::queue</code>\uff0c\u867d\u7136\u5b83\u63d0\u4f9b\u4e86\u4e00\u5b9a\u7684\u5f02\u5e38\u5b89\u5168\u4fdd\u8bc1\uff0c\u4f46\u5b83\u4e0d\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\u3002\u8981\u4f7f\u7528\u4e92\u65a5\u91cf\u6765\u8ba9\u5b83\u53d8\u5f97\u7ebf\u7a0b\u5b89\u5168\uff0c\u4e00\u4e2a\u7b80\u5355\u7684\u65b9\u5f0f\u662f\u4f7f\u7528\u4e92\u65a5\u91cf\u4fdd\u62a4\u6240\u6709\u7684\u51fd\u6570\uff1a</p> <pre><code>template&lt;typename T&gt;\nclass threadsafe_queue {\n    std::queue&lt;T&gt; q;\n    mutable std::mutex m;\n\npublic:\n    threadsafe_queue() {}\n\n    bool empty() const {\n        std::scoped_lock lock(m);\n        return q.empty();\n    }\n\n    void push(T element) {\n        std::scoped_lock lock(m);\n        q.push(std::move(element));\n    }\n\n    bool pop(T&amp; element) {\n        std::scoped_lock lock(m);\n        if (!q.empty()) {\n            element = std::move(q.front());\n            q.pop();\n            return true;\n        }\n        return false;\n    }\n};\n</code></pre> <p>\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u5728\u5404\u4e2a\u51fd\u6570\u4e2d\u8bbf\u95ee <code>std::queue</code> \u5bf9\u8c61\u4e4b\u524d\u90fd\u4f7f\u7528\u4e92\u65a5\u91cf\u6765\u786e\u4fdd\u7ade\u6001\u6761\u4ef6\u4e0d\u4f1a\u53d1\u751f\uff0c\u5b9e\u73b0\u4e86\u4e00\u4e2a\u7ebf\u7a0b\u5b89\u5168\u961f\u5217\u3002</p> Note <p>\u5bf9\u4e8e\u4e0d\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\u6570\u636e\u7ed3\u6784\uff0c\u6211\u4eec\u90fd\u53ef\u4ee5\u7b80\u5355\u5730\u4f7f\u7528\u4e92\u65a5\u91cf\u5c06\u5e76\u884c\u8bbf\u95ee\u8f6c\u53d8\u4e3a\u4e32\u884c\u8bbf\u95ee\uff0c\u4ece\u800c\u5b9e\u73b0\u7ebf\u7a0b\u5b89\u5168\u3002\u867d\u7136\u8fd9\u79cd\u65b9\u5f0f\u5e76\u53d1\u5ea6\u4e0d\u9ad8\uff0c\u4f46\u662f\u5bb9\u6613\u8c03\u8bd5\uff0c\u5728\u5f00\u53d1\u65f6\u95f4\u4e0d\u591f\u6216\u8005\u5f00\u53d1\u4eba\u5458\u8fd8\u4e0d\u719f\u7ec3\u7684\u60c5\u51b5\u4e0b\uff0c\u4e5f\u662f\u4e00\u79cd\u53ef\u884c\u7684\u65b9\u6cd5\u3002</p> \u5f02\u5e38\u5b89\u5168\u7684\u5206\u6790 <p>\u867d\u7136\u6211\u4eec\u7684\u5b9e\u73b0\u57fa\u4e8e\u5177\u6709\u4e00\u5b9a\u5f02\u5e38\u5b89\u5168\u6027\u7684 <code>std::queue</code>\uff0c\u4f46\u662f\u5728\u5305\u88c5\u7684\u8fc7\u7a0b\u4e2d\u6709\u53ef\u80fd\u4f1a\u5f15\u5165\u4e00\u4e9b\u65b0\u7684\u7834\u574f\u4e86\u5f02\u5e38\u5b89\u5168\u6027\u7684\u5730\u65b9\u3002\u6211\u4eec\u4e0d\u59a8\u5bf9\u4e09\u4e2a\u51fd\u6570\u7a0d\u4f5c\u68c0\u67e5\u3002</p> <ul> <li> <p><code>empty()</code> \u51fd\u6570\u662f\u5f02\u5e38\u5b89\u5168\u7684\u3002<code>std::scoped_lock</code> \u548c <code>std::mutex</code> \u7684 <code>lock()</code> \u51fd\u6570\u90fd\u63d0\u4f9b\u4e86\u57fa\u672c\u7684\u5f02\u5e38\u5b89\u5168\u4fdd\u8bc1\uff0c\u5373\u5728\u51fa\u73b0\u5f02\u5e38\u65f6\u4e92\u65a5\u91cf\u4ecd\u5904\u4e8e\u6709\u6548\u72b6\u6001\uff0c\u5176\u4ed6\u7ebf\u7a0b\u53ef\u4ee5\u6b63\u5e38\u4f7f\u7528\u3002</p> </li> <li> <p><code>push()</code> \u51fd\u6570\u4e2d\u8c03\u7528\u7684 <code>q.push()</code> \u5728\u5e95\u5c42\u4f1a\u8c03\u7528\u5185\u90e8\u5bb9\u5668\uff08\u901a\u5e38\u662f <code>std::deque</code> \u6216 <code>std::list</code>\uff09\u7684 <code>push_back()</code> \u51fd\u6570\u3002</p> </li> </ul> <p>\u8fd9\u91cc\uff0cSTL \u4fdd\u8bc1 <code>push_back()</code> \u5728\u56e0\u4e3a\u5185\u5b58\u5206\u914d\u51fa\u9519\u6216\u8005\u5143\u7d20\u62f7\u8d1d\u6216\u79fb\u52a8\u51fa\u9519\u65f6\uff0c\u4f1a\u8868\u73b0\u5f97\u5c31\u50cf\u51fd\u6570\u6ca1\u6709\u88ab\u8c03\u7528\u8fc7\u4e00\u6837\u3002\u5728\u51fa\u73b0\u5f02\u5e38\u540e\uff0cC++ \u4f1a\u81ea\u52a8\u8fdb\u884c\u6808\u5c55\u5f00\uff08stack unwinding\uff09\uff0c<code>lock</code> \u7684\u6790\u6784\u51fd\u6570\u88ab\u8c03\u7528\uff0c\u6211\u4eec\u7684\u9501\u56e0\u6b64\u88ab\u89e3\u5f00\u3002</p> <p>\u56e0\u6b64\uff0c\u6211\u4eec\u7684 <code>push()</code> \u51fd\u6570\u662f\u5f02\u5e38\u5b89\u5168\u7684\u3002</p> <ul> <li><code>pop()</code> \u51fd\u6570\u4e2d\uff0c\u6ce8\u610f\u5230 <code>pop</code> \u51fd\u6570\u4e2d\u7684 <code>element = q.front()</code> \u8bed\u53e5\uff0c\u5728\u8fd9\u91cc\u6211\u4eec\u5bf9 <code>T</code> \u7c7b\u578b\u7684\u5b9e\u4f8b\u8fdb\u884c\u4e86\u62f7\u8d1d\u590d\u5236\u64cd\u4f5c\u3002</li> </ul> <p>\u8fd9\u91cc\u7684 <code>T</code> \u662f\u7531\u7528\u6237\u6307\u5b9a\u7684\u7c7b\u578b\uff0c\u5e76\u6ca1\u6709\u4fdd\u8bc1\u62f7\u8d1d\u590d\u5236\u64cd\u4f5c\u7684\u8fc7\u7a0b\u4e0d\u4f1a\u51fa\u73b0\u5f02\u5e38\u3002\u5f53\u8d4b\u503c\u64cd\u4f5c\u4e0d\u5e78\u5730\u51fa\u9519\u65f6\uff0cC++ \u81ea\u52a8\u8fdb\u884c\u6808\u5c55\u5f00\uff0c<code>lock</code> \u6790\u6784\u51fd\u6570\u88ab\u8c03\u7528\uff0c\u9501\u88ab\u89e3\u5f00\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u7684 <code>pop()</code> \u51fd\u6570\u5f02\u5e38\u5b89\u5168\u3002</p> <p>\u4e0a\u8ff0\u4ee3\u7801\u4e2d\u5b9e\u73b0\u7684 <code>threadsafe_queue</code> \u662f\u4e00\u4e2a\u57fa\u672c\u5b9e\u73b0\u4e86\u7ebf\u7a0b\u5b89\u5168\u548c\u5f02\u5e38\u5b89\u5168\u7684\u961f\u5217\u6570\u636e\u7ed3\u6784\u3002\u4f46\u662f\u5b83\u7684\u9501\u7c92\u5ea6\u8fc7\u7c97\uff0c\u4e34\u754c\u533a\u6bd4\u8f83\u5927\uff0c\u5e76\u53d1\u5ea6\u6bd4\u8f83\u4f4e\u3002\u5728\u7279\u5b9a\u573a\u666f\u4e0b\u6211\u4eec\u53ef\u4ee5\u5141\u8bb8\u66f4\u591a\u7684\u5e76\u53d1\u6027\uff0c\u800c\u4e0d\u662f\u9650\u5236\u540c\u4e00\u65f6\u523b\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u8bbf\u95ee\u6570\u636e\u7ed3\u6784\u3002\u8981\u60f3\u63d0\u9ad8\u5e76\u53d1\u5ea6\uff0c\u5c31\u8981\u60f3\u529e\u6cd5\u5c06\u4e92\u65a5\u9501\u62c6\u5206\u4e3a\u66f4\u7ec6\u7c92\u5ea6\u7684\u9501\uff0c\u4e5f\u5c31\u662f\u5c3d\u91cf\u7f29\u5c0f\u4e34\u754c\u533a\u3002</p> <p>\u5047\u8bbe\u6211\u4eec\u7684 <code>std::queue</code> \u5e95\u5c42\u4f7f\u7528\u4e86 <code>std::list</code> \u4f5c\u4e3a\u5185\u90e8\u5bb9\u5668\uff0c\u5728\u961f\u5217\u5185\u90e8\u62e5\u6709\u4e00\u4e2a\u5177\u6709\u4e00\u5b9a\u6570\u91cf\u8282\u70b9\u7684\u94fe\u8868\u65f6\uff0c\u4e00\u5bf9\u5e76\u53d1\u7684 <code>push()</code> \u548c <code>pop()</code> \u8c03\u7528\u5e76\u4e0d\u4f1a\u8ba9\u961f\u5217\u64cd\u4f5c\u540c\u4e00\u4e2a\u94fe\u8868\u8282\u70b9\uff0c\u56e0\u6b64\u4e0d\u4f1a\u51fa\u73b0\u7ade\u6001\u6761\u4ef6\u3002\u5982\u679c\u80fd\u8ba9\u961f\u5217\u5c3d\u53ef\u80fd\u7ec6\u81f4\u5730\u77e5\u9053\u4f55\u65f6\u5e94\u8be5\u4f7f\u7528\u4e92\u65a5\u91cf\u3001\u4f55\u65f6\u4e0d\u5e94\u8be5\u4f7f\u7528\uff0c\u90a3\u4e48\u5c31\u80fd\u8fdb\u4e00\u6b65\u63d0\u5347\u5e76\u53d1\u8bbf\u95ee\u6027\u80fd\u4e86\u3002\u540c\u65f6\uff0c\u6bcf\u6b21\u6301\u6709\u9501\u7684\u65f6\u95f4\u8d8a\u77ed\uff0c\u4e5f\u80fd\u8fdb\u4e00\u6b65\u63d0\u5347\u6027\u80fd\u3002</p> <p>\u4e3a\u4e86\u7f16\u5199\u4f7f\u7528\u7ec6\u7c92\u5ea6\u9501\u7684\u961f\u5217\uff0c\u6211\u4eec\u9700\u8981\u653e\u5f03\u7b80\u5355\u5305\u88c5 <code>std::queue</code> \u7684\u65b9\u6cd5\uff0c\u81ea\u884c\u5b9e\u73b0\u4e00\u4e2a\u94fe\u8868\u6570\u636e\u7ed3\u6784\uff0c\u5728\u5b83\u7684\u57fa\u7840\u4e0a\u4f7f\u7528\u7ec6\u7c92\u5ea6\u9501\u6765\u5b9e\u73b0\u5c3d\u53ef\u80fd\u9ad8\u7684\u5e76\u53d1\u8bbf\u95ee\u6027\u80fd\u3002</p>"},{"location":"parallel/practice/multi-threading-queue/#\u57fa\u4e8e\u94fe\u8868\u7684\u7ec6\u7c92\u5ea6\u9501\u5b9e\u73b0","title":"\u57fa\u4e8e\u94fe\u8868\u7684\u7ec6\u7c92\u5ea6\u9501\u5b9e\u73b0","text":"<p>\u4e3a\u4e86\u65b9\u4fbf\u7406\u89e3\uff0c\u6211\u4eec\u63a5\u4e0b\u6765\u4f1a\u4e00\u6b65\u4e00\u6b65\u5730\u6784\u5efa\u51fa\u4e00\u4e2a\u6ee1\u8db3\u4e0a\u8ff0\u8981\u6c42\u7684\u961f\u5217\u3002\u6211\u4eec\u5148\u6765\u8003\u8651\u4e00\u4e2a\u975e\u7ebf\u7a0b\u5b89\u5168\u7684\u5b9e\u73b0\uff1a</p> <pre><code>template&lt;typename T&gt;\nclass queue {\n    struct node {\n        T element;\n        std::unique_ptr&lt;node&gt; next;\n\n        node(T element) : element(std::move(element)) {}\n    };\n\n    std::unique_ptr&lt;node&gt; head;\n    node* tail;\n\npublic:\n    queue() : tail(nullptr) {}\n    // \u4e3a\u4e86\u7b80\u4fbf\uff0c\u6211\u4eec\u6682\u65f6\u4e0d\u8003\u8651\u62f7\u8d1d\u6784\u9020\u548c\u8d4b\u503c\n    queue(const queue&amp; other) = delete;\n    queue&amp; operator=(const queue&amp; other) = delete;\n\n    void push(T element) {\n        auto ptr = std::make_unique(std::move(element));\n        auto new_tail = ptr.get();\n        if (tail == nullptr)\n            head = std::move(ptr);\n        else\n            tail-&gt;next = std::move(ptr);\n        tail = new_tail;\n    }\n\n    std::shared_ptr&lt;T&gt; pop() {\n        if (!head)\n            return std::shared_ptr&lt;T&gt;();\n        auto res = std::make_shared(std::move(head-&gt;data));\n        auto old_head = std::move(head);\n        head = std::move(old_head-&gt;next);\n        if (!head)\n            tail = nullptr;\n        return res;\n    }\n};\n</code></pre> <p>\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u91cc\uff0c\u6211\u4eec\u4f7f\u7528 <code>std::unique_ptr</code> \u6765\u7ba1\u7406\u94fe\u8868\u7684\u8282\u70b9\u5b58\u50a8\uff0c\u4f7f\u7528\u88f8\u6307\u9488 <code>tail</code> \u6765\u6307\u5411\u5c3e\u8282\u70b9\u3002\u4f7f\u7528\u667a\u80fd\u6307\u9488\u53ef\u4ee5\u6709\u6548\u9632\u6b62\u5185\u5b58\u6cc4\u9732\u7684\u95ee\u9898\u3002\u8fd9\u4e2a\u4f8b\u5b50\u5e76\u4e0d\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\uff0c\u56e0\u4e3a\u5728\u961f\u5217\u91cc\u53ea\u6709\u4e00\u4e2a\u8282\u70b9\u7684\u65f6\u5019\uff0c\u5e76\u53d1\u8c03\u7528\u7684 <code>push()</code> \u548c <code>pop()</code> \u6709\u53ef\u80fd\u540c\u65f6\u8bbf\u95ee\u540c\u4e00\u4e2a\u8282\u70b9\u7684 <code>next</code> \u6307\u9488\uff0c\u4ece\u800c\u51fa\u73b0\u7ade\u6001\u6761\u4ef6\u3002\u4f60\u53ef\u80fd\u4f1a\u8ba4\u4e3a\u5982\u679c\u5728\u4e24\u4e2a\u51fd\u6570\u91cc\u5224\u65ad\u4e00\u4e0b\u8fd9\u79cd\u60c5\u51b5\u5e76\u52a0\u9501\u5c31\u80fd\u89e3\u51b3\u95ee\u9898\uff0c\u5c31\u50cf\u4e0b\u9762\u8fd9\u6837\uff1a</p> <pre><code>auto has_single_item = !empty() &amp;&amp; head-&gt;get() == tail;\nauto lock = has_single_item ? std::scoped_lock(m) : std::scoped_lock();\n</code></pre> <p>\u4e0d\u5e78\u7684\u662f\uff0c\u8fd9\u79cd\u89e3\u51b3\u65b9\u6cd5\u662f\u9519\u8bef\u7684\u3002\u6211\u4eec\u968f\u4fbf\u5c31\u80fd\u4e3e\u4e00\u4e2a\u80fd\u591f\u7ed5\u8fc7\u8fd9\u79cd\u4fdd\u62a4\u63aa\u65bd\u7684\u4f8b\u5b50\uff1a\u5b58\u5728\u4e09\u4e2a\u7ebf\u7a0b\uff0c\u5176\u4e2d\u4e24\u4e2a\u8fdb\u884c <code>pop()</code>\uff0c\u53e6\u4e00\u4e2a\u8fdb\u884c <code>push()</code>\u3002\u5047\u5982\u961f\u5217\u91cc\u6709\u4e24\u4e2a\u5143\u7d20\uff0c\u5f53\u4e09\u4e2a\u7ebf\u7a0b\u90fd\u6267\u884c\u5b8c <code>has_single_item</code> \u7684\u8fd0\u7b97\u65f6\u5f97\u5230\u4e86 <code>false</code>\uff0c\u4e8e\u662f\u4e09\u4e2a\u7ebf\u7a0b\u90fd\u4e0d\u4f1a\u53bb\u83b7\u5f97\u9501\u4ece\u800c\u7ee7\u7eed\u8bbf\u95ee\uff0c\u7ade\u6001\u6761\u4ef6\u56e0\u6b64\u51fa\u73b0\u3002</p> <p>\u9664\u4e86\u5bf9\u540c\u4e00\u4e2a\u8282\u70b9\u8fdb\u884c <code>push()</code> \u548c <code>pop()</code> \u53ef\u80fd\u5bfc\u81f4\u7684\u7ade\u6001\u6761\u4ef6\uff0c\u6211\u4eec\u8fd8\u8981\u8003\u8651\u5e76\u53d1\u8bbf\u95ee\u540c\u4e00\u4e2a\u51fd\u6570\uff08<code>push()</code> \u6216\u8005 <code>pop()</code>\uff09\u7684\u60c5\u51b5\u3002\u8fd9\u4e48\u8003\u8651\u4e0b\u6765\uff0c\u6211\u4eec\u6700\u540e\u5199\u51fa\u7684\u4ee3\u7801\u53ef\u80fd\u8fd8\u4e0d\u5982\u4e00\u5f00\u59cb\u5c31\u5bf9 <code>std::queue</code> \u4f7f\u7528\u4e92\u65a5\u91cf\u5305\u88c5\u3002</p> <p>\u8981\u60f3\u771f\u6b63\u5730\u89e3\u51b3\u4e0a\u8ff0\u95ee\u9898\uff0c\u6211\u4eec\u9700\u8981\u8f6c\u53d8\u601d\u7ef4\u3002\u65e2\u7136\u5728\u8282\u70b9\u6570\u91cf\u4e3a\u4e00\u7684\u65f6\u5019\uff0c\u5e76\u53d1\u7684 <code>push()</code> \u548c <code>pop()</code> \u8c03\u7528\u4f1a\u9020\u6210\u7ade\u6001\u6761\u4ef6\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5f15\u5165\u4e00\u4e2a\u7a7a\u8282\u70b9\u6765\u8ba9\u94fe\u8868\u8282\u70b9\u6570\u91cf\u603b\u662f\u5927\u4e8e\u7b49\u4e8e\u4e00\u3002\u8fd9\u6837\u5728\u961f\u5217\u91cc\u53ea\u6709\u4e00\u4e2a\u6570\u636e\u65f6\uff0c\u94fe\u8868\u4f1a\u542b\u6709\u4e24\u4e2a\u8282\u70b9\uff0c\u6b64\u65f6\u5e76\u53d1\u7684 <code>push()</code> \u548c <code>pop()</code> \u8c03\u7528\u5c31\u4e0d\u4f1a\u9020\u6210\u7ade\u6001\u6761\u4ef6\u4e86\u3002\u8bf7\u770b\u4e0b\u9762\u7684\u4ee3\u7801\uff1a</p> <pre><code>template&lt;typename T&gt;\nclass queue {\n    struct node {\n        std::shared_ptr&lt;T&gt; element;\n        std::unique_ptr&lt;node&gt; next;\n    };\n\n    std::unique_ptr&lt;node&gt; head;\n    node* tail;\n\npublic:\n    queue() : head(std::make_unique&lt;T&gt;()), tail(head.get()) {}\n    // \u4e3a\u4e86\u7b80\u4fbf\uff0c\u6211\u4eec\u6682\u65f6\u4e0d\u8003\u8651\u62f7\u8d1d\u6784\u9020\u548c\u8d4b\u503c\n    queue(const queue&amp; other) = delete;\n    queue&amp; operator=(const queue&amp; other) = delete;\n\n    void push(T element) {\n        auto element_ptr = std::make_shared(std::move(element));\n        auto node_ptr = std::make_unique&lt;T&gt;();\n        auto new_tail = node_ptr.get();\n        // \u5c06\u5f53\u524d\u5c3e\u8282\u70b9\u7684\u503c\u8bbe\u4e3a `element_ptr`\uff0c\u800c\u65b0\u5efa\u7684\u7a7a\u8282\u70b9 `node_ptr` \u4f5c\u4e3a\u65b0\u7684\u5c3e\u8282\u70b9\n        tail-&gt;data = element_ptr;\n        tail-&gt;next = std::move(node_ptr);\n        tail = new_tail;\n    }\n\n    std::shared_ptr&lt;T&gt; pop() {\n        if (head.get() == tail)\n            return std::shared_ptr&lt;T&gt;();\n        auto res = head-&gt;data;\n        auto old_head = std::move(head);\n        head = std::move(old_head-&gt;next);\n        return res;\n    }\n};\n</code></pre> <p>\u4e3a\u4e86\u5f15\u5165\u7a7a\u8282\u70b9\u7684\u8bbe\u5b9a\uff0c\u6211\u4eec\u5c06 <code>struct node</code> \u91cc\u7684 <code>element</code> \u6539\u4e3a\u4e86 <code>std::shared_ptr</code>\u3002\u8fd9\u6837\u5bf9\u4e8e\u7a7a\u8282\u70b9\u6765\u8bf4\uff0c\u667a\u80fd\u6307\u9488\u5185\u5bb9\u5c31\u4e3a\u7a7a\u3002\u7136\u540e\uff0c<code>empty()</code> \u7684\u5224\u65ad\u4f9d\u636e\u6539\u4e3a\u4e86 <code>head.get() == tail</code>\uff0c\u56e0\u4e3a\u5728\u94fe\u8868\u53ea\u6709\u4e00\u4e2a\u8282\u70b9\uff08\u4e5f\u5c31\u662f\u7a7a\u8282\u70b9\uff09\u65f6\u6211\u4eec\u8ba4\u4e3a\u961f\u5217\u4e3a\u7a7a\u3002<code>pop()</code> \u51fd\u6570\u7684\u6539\u52a8\u4e0d\u5927\uff0c\u56e0\u4e3a\u73b0\u5728\u94fe\u8868\u5728 <code>pop()</code> \u4e4b\u540e\u4e0d\u53ef\u80fd\u4e3a\u7a7a\uff0c\u6240\u4ee5\u4e0d\u9700\u8981\u989d\u5916\u7684\u5224\u65ad\u4e86\u3002</p> <p>\u6700\u503c\u5f97\u8ba8\u8bba\u7684\u662f <code>push()</code> \u7684\u4fee\u6539\u3002\u6211\u4eec\u5728\u8fd9\u91cc\u7684\u7b56\u7565\u662f\uff1a\u5c06\u7528\u6237\u8f93\u5165\u7684\u503c\u5b58\u5230\u5f53\u524d\u4f5c\u4e3a\u5c3e\u8282\u70b9\u7684\u7a7a\u8282\u70b9\uff0c\u7136\u540e\u518d\u65b0\u5efa\u4e00\u4e2a\u7a7a\u8282\u70b9\u9644\u52a0\u5230\u94fe\u8868\u5c3e\u90e8\u3002\u8fd9\u6837\u4e00\u6765\uff0c\u6211\u4eec\u53d1\u73b0\u5373\u4f7f\u961f\u5217\u91cc\u53ea\u6709\u4e00\u4e2a\u6570\u636e\uff0c\u94fe\u8868\u91cc\u4ecd\u4f1a\u6709\u4e24\u4e2a\u8282\u70b9\uff0c\u6b64\u65f6\u5e76\u53d1\u7684 <code>pop()</code> \u548c <code>push()</code> \u8c03\u7528\u518d\u4e5f\u4e0d\u4f1a\u8bbf\u95ee\u540c\u4e00\u4e2a\u8282\u70b9\u4e86\u3002</p> <p>\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u5728\u8fd9\u79cd\u8bbe\u8ba1\u7684\u57fa\u7840\u4e0a\u653e\u7f6e\u4e92\u65a5\u91cf\u3002\u548c\u7b80\u5355\u7684\u5b9e\u73b0\u4e0d\u540c\uff0c\u6211\u4eec\u8ffd\u6c42\u5c3d\u53ef\u80fd\u5927\u7684\u5e76\u53d1\u8bbf\u95ee\u6027\u3002\u7ecf\u8fc7\u5206\u6790\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u8fd9\u4e9b\u53ef\u80fd\u9020\u6210\u7ade\u6001\u6761\u4ef6\u7684\u60c5\u51b5\uff1a</p> <ol> <li>\u591a\u4e2a\u7ebf\u7a0b\u5e76\u53d1\u8c03\u7528 <code>push()</code></li> <li>\u591a\u4e2a\u7ebf\u7a0b\u5e76\u53d1\u8c03\u7528 <code>pop()</code></li> <li>\u591a\u4e2a\u7ebf\u7a0b\u5e76\u53d1\u8c03\u7528 <code>push()</code> \u548c <code>pop()</code></li> </ol> <p>\u8fd9\u51e0\u79cd\u60c5\u51b5\u7684\u7ade\u4e89\u7126\u70b9\u90fd\u662f <code>head</code> \u548c <code>tail</code>\uff0c\u6211\u4eec\u53ef\u4ee5\u5206\u522b\u7ed9\u5b83\u4eec\u5f15\u5165\u4e00\u4e2a\u4e92\u65a5\u91cf\u8fdb\u884c\u4fdd\u62a4\u3002\u6700\u540e\u7684\u4ee3\u7801\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code>template&lt;typename T&gt;\nclass queue {\n    struct node {\n        std::shared_ptr&lt;T&gt; element;\n        std::unique_ptr&lt;node&gt; next;\n    };\n\n    std::unique_ptr&lt;node&gt; head;\n    node* tail;\n    std::mutex head_mutex;\n    std::mutex tail_mutex;\n\n    node* get_tail() {\n        std::scoped_lock lock(tail_mutex);\n        return tail;\n    }\n\n    std::unique_ptr&lt;node&gt; pop_head() {\n        // \u7ed9 `head` \u52a0\u9501\uff0c\u9632\u6b62\u5e76\u53d1\u7684 `pop()` \u5bfc\u81f4\u7ade\u6001\u6761\u4ef6\n        std::scoped_lock lock(head_mutex);\n        // `get_tail()` \u4f1a\u7ed9 `tail` \u52a0\u9501\uff0c\u4ece\u800c\u907f\u514d\u4e86\u5e76\u53d1\u7684 `pop()` \u548c `push()` \u53ef\u80fd\u5bfc\u81f4\u7684\u7ade\u6001\u6761\u4ef6\n        if (head.get() == get_tail())\n            return std::unique_ptr&lt;node&gt;();\n        auto old_head = std::move(head);\n        head = std::move(old_head-&gt;next);\n        return old_head;\n    }\n\npublic:\n    queue() : head(std::make_unique&lt;T&gt;()), tail(head.get()) {}\n    // \u4e3a\u4e86\u7b80\u4fbf\uff0c\u6211\u4eec\u6682\u65f6\u4e0d\u8003\u8651\u62f7\u8d1d\u6784\u9020\u548c\u8d4b\u503c\n    queue(const queue&amp; other) = delete;\n    queue&amp; operator=(const queue&amp; other) = delete;\n\n    void push(T element) {\n        auto element_ptr = std::make_shared(std::move(element));\n        auto node_ptr = std::make_unique&lt;T&gt;();\n        auto new_tail = node_ptr.get();\n        // \u4ec5\u5728\u9700\u8981\u8bbf\u95ee tail \u65f6\u624d\u52a0\u9501\uff0c\u8fd9\u91cc\u7684\u9501\u53ef\u4ee5\u907f\u514d\u5e76\u53d1\u7684 `push()` \u5bfc\u81f4\u7684\u7ade\u6001\u6761\u4ef6\n        std::scoped_lock lock(tail_mutex);\n        tail-&gt;data = element_ptr;\n        tail-&gt;next = std::move(node_ptr);\n        tail = new_tail;\n    }\n\n    std::shared_ptr&lt;T&gt; pop() {\n        auto old_head = pop_head();\n        if (old_head)\n            return old_head-&gt;data;\n        else\n            return std::shared_ptr&lt;T&gt;();\n    }\n};\n</code></pre> <p>\u4ece\u4e0a\u9762\u7684\u4ee3\u7801\u6765\u770b\uff0c\u6211\u4eec\u901a\u8fc7\u5f15\u5165\u4e24\u4e2a\u4e92\u65a5\u91cf\uff0c\u6210\u529f\u5730\u89e3\u51b3\u4e86\u53ef\u80fd\u51fa\u73b0\u7684\u7ade\u6001\u6761\u4ef6\u3002\u867d\u7136\u6211\u4eec\u6700\u7ec8\u8fd8\u662f\u5f15\u5165\u4e86\u4e92\u65a5\u91cf\uff0c\u4f46\u662f\u5bf9\u6bd4\u4e0a\u9762\u7684\u4f8b\u5b50\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff1a<code>push()</code> \u548c <code>pop()</code> \u53ea\u5728\u6070\u5f53\u7684\u65f6\u5019\u624d\u7ed9\u4e92\u65a5\u91cf\u4e0a\u9501\uff0c\u4e34\u754c\u533a\u53d8\u5c0f\u4e86\uff0c\u5e76\u53d1\u6027\u80fd\u5f97\u5230\u4e86\u63d0\u5347\u3002\u4e0a\u9762\u7684\u5b9e\u73b0\u4f9d\u7136\u662f\u5f02\u5e38\u5b89\u5168\u7684\uff0c\u81f3\u4e8e\u5177\u4f53\u7684\u5206\u6790\u5219\u7559\u7ed9\u8bfb\u8005\u3002</p>"},{"location":"parallel/practice/multi-threading-queue/#\u5c0f\u7ed3","title":"\u5c0f\u7ed3","text":"<p>\u5728\u672c\u8282\u4e2d\u6211\u4eec\u4e86\u89e3\u5230\u4e86\u600e\u6837\u7f16\u5199\u4ee5\u53ca\u5206\u6790\u4e00\u4e2a\u7ebf\u7a0b\u5b89\u5168\u7684\u540c\u6b65\u961f\u5217\u3002\u540c\u6b65\u961f\u5217\u662f\u7ebf\u7a0b\u95f4\u901a\u4fe1\u7684\u57fa\u672c\u6570\u636e\u7ed3\u6784\uff0c\u4f60\u80fd\u5728\u51e0\u4e4e\u6240\u6709\u591a\u7ebf\u7a0b\u7a0b\u5e8f\u4e2d\u89c1\u5230\u540c\u6b65\u961f\u5217\u7684\u5b9e\u73b0\u3002\u4e5f\u56e0\u4e3a\u540c\u6b65\u961f\u5217\u662f\u6700\u57fa\u7840\u7684\u6570\u636e\u7ed3\u6784\u4e4b\u4e00\uff0c\u5927\u91cf\u5f00\u53d1\u8005\u6295\u5165\u4e86\u5927\u91cf\u7cbe\u529b\u6765\u4f18\u5316\u540c\u6b65\u961f\u5217\u7684\u6027\u80fd\uff0c\u672c\u8282\u4ecb\u7ecd\u7684\u662f\u4f7f\u7528\u4e92\u65a5\u91cf\u5b9e\u73b0\u7684\u540c\u6b65\u961f\u5217\uff0c\u8fd8\u6709\u8bb8\u591a\u53ea\u4f7f\u7528\u539f\u5b50\u64cd\u4f5c\u5b9e\u73b0\u7684\u65e0\u9501\u961f\u5217\uff0c\u5728\u5bf9\u6027\u80fd\u6781\u5ea6\u654f\u611f\u7684\u573a\u666f\u4e0b\u53ef\u4ee5\u4f7f\u7528\u3002</p> Info <p>\u4f60\u53ef\u80fd\u4f1a\u4e86\u89e3\u5230\u5176\u4ed6\u8bed\u8a00\u4e2d\u6709\u7740\u5176\u4ed6\u7684\u540c\u6b65\u65b9\u6cd5\uff0c\u4f8b\u5982 Go \u8bed\u8a00\u4e2d\u7684 Channel\u3001Erlang \u8bed\u8a00\u4e2d\u7684 Mailbox\uff0c\u4f46\u5176\u80cc\u540e\u7684\u5b9e\u73b0\u539f\u7406\u4ecd\u7136\u662f\u540c\u6b65\u961f\u5217\uff0c\u56e0\u6b64\uff0c\u5728\u7f16\u5199\u591a\u7ebf\u7a0b\u4ee5\u53ca\u591a\u8fdb\u7a0b\u7a0b\u5e8f\u7684\u65f6\u5019\uff0c\u5fc5\u987b\u719f\u7ec3\u638c\u63e1\u961f\u5217\u8fd9\u4e00\u57fa\u672c\u800c\u91cd\u8981\u7684\u6570\u636e\u7ed3\u6784\u3002</p>"},{"location":"parallel/practice/multi-threading-queue/#\u53c2\u8003\u5b9e\u73b0","title":"\u53c2\u8003\u5b9e\u73b0","text":"<p>\u4ee5\u4e0b\u662f\u4e00\u4e9b\u5065\u58ee\u7684\u9ad8\u6027\u80fd\u7684\u591a\u7ebf\u7a0b\u961f\u5217\u5b9e\u73b0\u53c2\u8003\uff1a</p> <ul> <li>Boost \u7684\u65e0\u9501\u961f\u5217</li> <li>Intel Thread Building Blocks</li> <li>moodycamel</li> </ul>"},{"location":"parallel/practice/process-pool/","title":"\u8fdb\u7a0b\u6c60","text":"<p>\u8fdb\u7a0b\u6c60\u548c\u7ebf\u7a0b\u6c60\u7c7b\u4f3c\uff0c\u53ea\u662f\u5de5\u4f5c\u7ebf\u7a0b\u53d8\u6210\u4e86\u5de5\u4f5c\u8fdb\u7a0b\u3002</p>"},{"location":"parallel/practice/thread-pool/","title":"\u7ebf\u7a0b\u6c60","text":"<p>\u5728\u5b9e\u9645\u7f16\u7a0b\u4e2d\uff0c\u5982\u679c\u9891\u7e41\u542f\u52a8\u548c\u9500\u6bc1\u7ebf\u7a0b\uff0c\u5e26\u6765\u7684\u5f00\u9500\u4e5f\u4e0d\u53ef\u5ffd\u89c6\u3002\u4e00\u822c\u6765\u8bf4\uff0c\u6211\u4eec\u4f1a\u4f7f\u7528\u7ebf\u7a0b\u6c60\u7684\u65b9\u6cd5\u6765\u9ad8\u6548\u5730\u5229\u7528\u786c\u4ef6\u7684\u5e76\u53d1\u5ea6\u3002\u7ebf\u7a0b\u6c60\u7684\u601d\u60f3\u5f88\u7b80\u5355\uff1a\u9884\u5148\u542f\u52a8\u597d\u7ebf\u7a0b\uff0c\u7136\u540e\u4e0d\u505c\u5730\u4ece\u4efb\u52a1\u961f\u5217\u91cc\u83b7\u53d6\u4efb\u52a1\u6267\u884c\uff0c\u7a0b\u5e8f\u7ed3\u675f\u65f6\u518d\u4e00\u8d77\u9500\u6bc1\u3002\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u4e0d\u9700\u8981\u64cd\u5fc3\u7ebf\u7a0b\u7684\u542f\u52a8\u9500\u6bc1\u95ee\u9898\uff0c\u53ea\u9700\u8981\u4e0d\u505c\u5730\u5411\u7ebf\u7a0b\u6c60\u63d0\u4ea4\u4efb\u52a1\u5373\u53ef\u3002</p> \u6c60\u5316\u6280\u672f <p>\u4e00\u822c\u6765\u8bf4\uff0c\u521b\u5efa\u548c\u9500\u6bc1\u4ee3\u4ef7\u6bd4\u8f83\u9ad8\u7684\u5bf9\u8c61\u90fd\u53ef\u4ee5\u5c1d\u8bd5\u4f7f\u7528\u6c60\u5316\u7684\u65b9\u6cd5\u6765\u5c3d\u53ef\u80fd\u590d\u7528\u5df2\u6709\u8d44\u6e90\uff0c\u51cf\u5c11\u521b\u5efa\u548c\u9500\u6bc1\u7684\u4ee3\u4ef7\u3002\u4f8b\u5982\uff0c\u7f51\u7edc TCP \u8fde\u63a5\u901a\u5e38\u4e5f\u662f\u4ee5\u8fde\u63a5\u6c60\u7684\u65b9\u5f0f\u4f7f\u7528\u3002\u5185\u5b58\u7684\u5206\u914d\u548c\u91ca\u653e\u53ef\u80fd\u6d89\u53ca\u5230\u7cfb\u7edf\u8c03\u7528\uff0c\u5728\u5bf9\u6027\u80fd\u654f\u611f\u7684\u7a0b\u5e8f\u4e2d\uff0c\u8fd8\u4f1a\u6709\u5185\u5b58\u6c60\u7684\u6280\u672f\uff0c\u5c3d\u53ef\u80fd\u51cf\u5c11\u8017\u65f6\u7684\u7cfb\u7edf\u8c03\u7528\u3002</p> <p>\u53e6\u5916\uff0c\u50cf\u5e38\u91cf\u5bf9\u8c61\u8fd9\u79cd\u4f7f\u7528\u9891\u7e41\u7684\u5bf9\u8c61\uff0c\u4e5f\u53ef\u4ee5\u7528\u6c60\u5316\u7684\u6280\u672f\u907f\u514d\u521b\u5efa\u5927\u91cf\u7684\u91cd\u590d\u5bf9\u8c61\u3002</p>"},{"location":"parallel/practice/timeout/","title":"\u64cd\u4f5c\u8d85\u65f6","text":"<p>\u7ed3\u5408\u53d6\u6d88\u673a\u5236\uff0c\u6211\u4eec\u53ef\u4ee5\u542f\u7528\u4e00\u4e2a\u5b9a\u65f6\u5668\uff0c\u5e76\u5728\u5b9a\u65f6\u5668\u89e6\u53d1\u4e4b\u540e\uff0c\u89e6\u53d1\u53d6\u6d88\u64cd\u4f5c\u3002\u64cd\u4f5c\u8d85\u65f6\u4e00\u822c\u7528\u6765\u4fdd\u62a4\u8ba1\u7b97\u8d44\u6e90\u4e0d\u88ab\u8fc7\u5ea6\u4f7f\u7528\uff0c\u4f8b\u5982\u4e00\u4e2a\u51fd\u6570\u8c03\u7528\u53ef\u80fd\u5728\u67d0\u4e9b\u8f93\u5165\u4e0b\u4f1a\u5927\u91cf\u8017\u8d39\u8d44\u6e90\u4f7f\u5f97\u5176\u4ed6\u8bf7\u6c42\u65e0\u6cd5\u5b8c\u6210\uff0c\u8fd9\u65f6\u8d85\u65f6\u673a\u5236\u53ef\u4ee5\u9650\u5236\u8fd9\u7c7b\u64cd\u4f5c\u3002\u540c\u65f6\u8d85\u65f6\u673a\u5236\u4e5f\u80fd\u7ed9\u4e88\u7528\u6237\u53ca\u65f6\u7684\u53cd\u9988\uff0c\u907f\u514d\u7528\u6237\u957f\u65f6\u95f4\u7b49\u5f85\u3002</p>"},{"location":"rpc/","title":"\u6982\u89c8","text":"<p>RPC \u662f\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u91cd\u8981\u57fa\u77f3\uff0c\u8ba9\u670d\u52a1\u8fdb\u7a0b\u53ef\u4ee5\u5206\u5e03\u5728\u4e0d\u540c\u7684\u673a\u5668\u4e0a\u3002\u672c\u8282\u5c06\u4ecb\u7ecd\u7f16\u5199\u670d\u52a1\u5668\u7a0b\u5e8f\u4e2d\uff0c\u5b9e\u73b0 RPC \u7684\u91cd\u8981\u6982\u5ff5\u4ee5\u53ca\u8303\u5f0f\u3002</p>"},{"location":"rpc/client/","title":"\u7f16\u5199\u5ba2\u6237\u7aef","text":"<p>RPC \u5ba2\u6237\u7aef\u4e3b\u8981\u7684\u529f\u80fd\u662f\u8fde\u63a5\u5230\u670d\u52a1\u7aef\uff0c\u53d1\u9001\u8bf7\u6c42\u5e76\u63a5\u6536\u54cd\u5e94\u3002\u5ba2\u6237\u7aef\u9700\u8981\u5b9e\u73b0\u7684\u903b\u8f91\u51e0\u4e4e\u6ca1\u6709\uff0c\u53ea\u9700\u8981\u6839\u636e IDL \u5b9a\u4e49\u7684\u51fd\u6570\u7b7e\u540d\u6784\u9020\u597d\u8bf7\u6c42\u5c31\u53ef\u4ee5\u4e86\u3002\u590d\u6742\u5ea6\u4e3b\u8981\u5728\u4e8e\u5ba2\u6237\u7aef\u9700\u8981\u8d1f\u8d23\u8d85\u65f6\u91cd\u8bd5\uff0c\u4ee5\u53ca\u8fde\u63a5\u590d\u7528\u907f\u514d\u5927\u91cf\u521b\u5efa\u8fde\u63a5\u7684\u5f00\u9500\u3002\u5176\u4e2d\uff0c\u8fde\u63a5\u590d\u7528\u901a\u5e38\u662f\u901a\u8fc7\u8fde\u63a5\u6c60\u7684\u65b9\u6cd5\u6765\u5b9e\u73b0\u7684\u3002</p> <p>\u603b\u4f53\u6765\u8bf4\uff0c\u5ba2\u6237\u7aef\u7684\u4f2a\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>class RPCClient {\n  ConnectionPool pool_;\n  Response do_request(Request const&amp; req) {\n    auto conn = pool_.get();\n    conn.send_request(req);\n    auto resp = conn.recv_response();\n    pool_.put(conn);\n    return resp;\n  }\npublic:\n  RPCClient(string const &amp;host, string const &amp;port) : pool_(host, port) {}\n  PingResponse ping(PingRequest const&amp; req) {\n    return do_request(req);\n  }\n};\n</code></pre> <p>\u8fde\u63a5\u6c60\u9884\u5148\u5efa\u7acb\u5e76\u7ef4\u62a4\u4e86\u4e00\u4e9b\u7a7a\u95f2\u8fde\u63a5\uff0c\u5728\u53d1\u9001\u8bf7\u6c42\u7684\u65f6\u5019\uff0c\u76f4\u63a5\u4ece\u8fde\u63a5\u6c60\u4e2d\u53d6\u51fa\u4e00\u4e2a\u8fde\u63a5\uff0c\u5728\u8fd9\u4e2a\u8fde\u63a5\u5b8c\u6210\u4e00\u6b21 RPC \u4e4b\u540e\uff0c\u5c06\u8fde\u63a5\u91cd\u65b0\u653e\u5165\u8fde\u63a5\u6c60\uff0c\u7b49\u5f85\u4e0b\u4e00\u6b21 RPC \u8c03\u7528\u3002\u4e3a\u4e86\u907f\u514d\u5360\u7528\u8fc7\u591a\u7684\u670d\u52a1\u5668\u8d44\u6e90\uff0c\u8fde\u63a5\u6c60\u901a\u5e38\u4f1a\u8bbe\u5b9a\u4e00\u4e2a\u7a7a\u95f2\u8d85\u65f6\uff0c\u5c06\u7a7a\u95f2\u65f6\u95f4\u592a\u4e45\u7684\u8fde\u63a5\u5173\u95ed\u3002\u540c\u65f6\uff0c\u8fde\u63a5\u6c60\u4f1a\u8bbe\u5b9a\u4e00\u4e2a\u6700\u5927\u8fde\u63a5\u6570\uff0c\u5982\u679c\u8fde\u63a5\u6570\u8d85\u8fc7\u4e86\u8fd9\u4e2a\u6570\uff0c\u540e\u7eed\u7684 RPC \u8c03\u7528\u5219\u9700\u8981\u7b49\u5f85\u76f4\u5230\u6709\u53ef\u7528\u8fde\u63a5\u4e3a\u6b62\u3002\u5bf9\u4e8e\u8fde\u63a5\u51fa\u9519\u7684\u60c5\u51b5\uff0c\u901a\u5e38\u662f\u76f4\u63a5\u5173\u95ed\u8fde\u63a5\uff0c\u5e76\u5c1d\u8bd5\u91cd\u65b0\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u8fde\u63a5\u3002\u5f53\u7136\uff0c\u91cd\u8bd5\u4e5f\u6709\u8d85\u65f6\u548c\u6b21\u6570\u4e0a\u9650\uff0c\u5982\u679c\u8d85\u65f6\u6216\u8005\u6b21\u6570\u8d85\u8fc7\u4e86\u4e0a\u9650\uff0c\u5219\u76f4\u63a5\u629b\u51fa\u5f02\u5e38\u3002</p>"},{"location":"rpc/framework/","title":"RPC \u6846\u67b6","text":"<p>RPC \u6846\u67b6\u5c01\u88c5\u4e86 RPC \u7684\u7ec6\u8282\uff0c\u4f7f\u5f97\u5f00\u53d1\u8005\u53ef\u4ee5\u548c\u50cf\u8c03\u7528\u4e00\u4e2a\u672c\u5730\u51fd\u6570\u4e00\u6837\u8c03\u7528 RPC \u65b9\u6cd5\uff0c\u63d0\u9ad8\u5f00\u53d1\u6548\u7387\u3002\u603b\u7684\u6765\u8bf4\uff0c\u4e00\u4e2a\u57fa\u672c\u7684 RPC \u6846\u67b6\u901a\u5e38\u9700\u8981\u63d0\u4f9b\u4ee5\u4e0b\u529f\u80fd\uff1a</p> <ul> <li>\u63d0\u4f9b RPC Stub</li> <li>\u7ba1\u7406\u8fdb\u7a0b\u4e4b\u95f4\u7684\u7f51\u7edc\u8fde\u63a5</li> <li>\u5c06\u8bf7\u6c42\u6839\u636e\u534f\u8bae\u7f16\u7801\u53d1\u9001\u51fa\u53bb\uff0c\u5e76\u63a5\u6536\u54cd\u5e94</li> </ul> <p>\u4e00\u4e9b\u9ad8\u7ea7\u7684\u529f\u80fd\u8fd8\u5305\u62ec\uff1a</p> <ul> <li>\u8d1f\u8f7d\u5747\u8861</li> <li>\u670d\u52a1\u53d1\u73b0</li> <li>\u540d\u5b57\u670d\u52a1</li> <li>\u6545\u969c\u5c4f\u853d</li> <li>\u8fc7\u8f7d\u4fdd\u62a4</li> <li>\u5b89\u5168\u9274\u6743</li> <li>\u670d\u52a1\u8d28\u91cf\u63a7\u5236\uff08QoS\uff09</li> </ul> <p>\u7b80\u5355\u7684 RPC \u6846\u67b6\u53ef\u4ee5\u5f88\u7b80\u5355\uff0c\u53ea\u9700\u8981\u5957\u7528\u73b0\u6709\u7684\u5e8f\u5217\u5316\u534f\u8bae\uff0c\u518d\u5305\u88c5\u4e00\u4e0b\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u7684\u7f51\u7edc\u63a5\u53e3\uff0c\u5c31\u80fd\u57fa\u672c\u5b9e\u73b0\u4e00\u4e2a\u6781\u7b80\u7684 RPC \u6846\u67b6\u3002\u4f46\u662f\uff0c\u51fa\u4e8e\u6027\u80fd\u3001\u53ef\u9760\u6027\u4ee5\u53ca\u53ef\u6269\u5c55\u6027\u7684\u8003\u8651\uff0cRPC \u6846\u67b6\u5f80\u5f80\u662f\u5f88\u590d\u6742\u7684\uff0c\u6d89\u53ca\u5230\u65e0\u9501\u7f16\u7a0b\u3001\u5f02\u6b65\u7f16\u7a0b\u3001Cache \u4f18\u5316\u3001\u591a\u6838\u4f18\u5316\u3001\u81ea\u5b9a\u4e49\u5185\u5b58\u7ba1\u7406\u3001\u5b9e\u73b0\u53ef\u6269\u5c55\u7684\u63d2\u4ef6\u63a5\u53e3\u7b49\u7b49\u9ad8\u7ea7\u7684\u7f16\u7a0b\u6280\u672f\u3002</p> <p>\u8bb8\u591a\u516c\u53f8\u90fd\u63a8\u51fa\u4e86\u81ea\u5df1\u7684 RPC \u6846\u67b6\uff0c\u4f8b\u5982\u767e\u5ea6\u7684 brpc\uff0cGoogle \u7684 gRPC\u3002\u800c\u4e00\u4e9b\u516c\u53f8\u4e5f\u4f1a\u81ea\u884c\u5f00\u53d1\u5185\u90e8\u7684 RPC \u6846\u67b6\uff0c\u4e0e\u516c\u53f8\u5185\u90e8\u670d\u52a1\u4e0e\u5de5\u5177\u66f4\u7d27\u5bc6\u5730\u7ed3\u5408\u8d77\u6765\uff0c\u66f4\u52a0\u7b80\u5316\u5f00\u53d1\u8005\u5f00\u53d1\u6d41\u7a0b\u3002\u4f8b\u5982\uff0c\u53ef\u4ee5\u5bf9 RPC \u7684\u670d\u52a1\u53d1\u73b0\u4ee5\u53ca\u8fde\u63a5\u521d\u59cb\u5316\u7b49\u8fdb\u884c\u6539\u9020\uff0c\u4f7f\u5f97\u5f00\u53d1\u8005\u53ef\u4ee5\u4e0d\u7528\u624b\u52a8\u586b\u5199\u5bf9\u65b9\u670d\u52a1\u7684 RPC \u5730\u5740\uff0c\u53ea\u9700\u8981\u5bfc\u5165\u94fe\u63a5\u9700\u8981\u8c03\u7528\u670d\u52a1\u7684 RPC \u5ba2\u6237\u7aef\u5e93\uff0c\u5c31\u80fd\u76f4\u63a5\u8c03\u7528\uff0c\u66f4\u63a5\u8fd1\u76f4\u63a5\u8c03\u5e93\u7684\u4f53\u9a8c\u3002</p>"},{"location":"rpc/serialization/","title":"\u5e8f\u5217\u5316\u4e0e\u53cd\u5e8f\u5217\u5316","text":"<p>\u5728\u5c06\u5185\u5b58\u7684\u6570\u636e\u53d1\u9001\u5230\u7f51\u7edc\u4e2d\u524d\uff0c\u9700\u8981\u8fdb\u884c\u5e8f\u5217\u5316\u64cd\u4f5c\uff1b\u800c\u5728\u63a5\u6536\u5230\u7f51\u7edc\u6570\u636e\u540e\uff0c\u9700\u8981\u8fdb\u884c\u53cd\u5e8f\u5217\u5316\u64cd\u4f5c\u3002\u6570\u636e\u5728\u5185\u5b58\u4e2d\u4e5f\u662f\u4ee5\u5b57\u8282\u5f62\u5f0f\u8868\u73b0\uff0c\u53d1\u9001\u5230\u7f51\u7edc\u4e5f\u662f\u4e00\u4e32\u5b57\u8282\uff0c\u4e3a\u4ec0\u4e48\u8fd8\u8981\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316\u5462\uff1f\u4f8b\u5982\u6709\u8fd9\u4e48\u4e00\u4e2a\u7ed3\u6784\u4f53\uff1a</p> <pre><code>struct MyData {\n    int id;\n    std::unique_ptr&lt;Object&gt; pointer_to_some_object;\n    std::vector&lt;int&gt; numbers;\n};\n</code></pre> <p>\u5176\u4e2d\uff0c<code>id</code> \u662f <code>int</code> \u7c7b\u578b\uff0c\u4f46\u662f\u5728\u5185\u5b58\u4e2d\uff0c\u5b83\u6709\u7279\u5b9a\u7684\u5b57\u8282\u5e8f\uff0c\u53ef\u80fd\u548c\u5bf9\u65b9\u7684\u5b57\u8282\u5e8f\u662f\u76f8\u53cd\u7684\u3002\u800c\u50cf <code>pointer_to_some_object</code> \u662f\u4e00\u4e2a\u6307\u5411\u522b\u7684\u5bf9\u8c61\u7684\u6307\u9488\uff0c\u6211\u4eec\u76f4\u63a5\u628a\u6307\u9488\u53d1\u9001\u51fa\u53bb\u80af\u5b9a\u662f\u4e0d\u884c\u7684\u3002\u800c <code>std::vector</code> \u5219\u66f4\u590d\u6742\uff0c\u5b83\u7684\u5927\u5c0f\u662f\u4e0d\u56fa\u5b9a\u7684\uff0c\u800c\u4e14\u91cc\u9762\u4e5f\u6709\u6307\u5411\u5b58\u50a8\u7684\u6307\u9488\uff0c\u53c8\u8be5\u600e\u4e48\u53d1\u9001\u5462\uff1f</p> <p>\u4e3a\u4e86\u89e3\u51b3\u673a\u5668\u95f4\u7684\u5dee\u5f02\u4ee5\u53ca\u6307\u9488\u95ee\u9898\uff0c\u9700\u8981\u6307\u5b9a\u5e8f\u5217\u5316\u534f\u8bae\uff0c\u786e\u4fdd\u6536\u53d1\u53cc\u65b9\u90fd\u80fd\u7406\u89e3\u7f51\u7edc\u4e0a\u4f20\u8f93\u7684\u5b57\u8282\u6570\u636e\u3002\u5e8f\u5217\u5316\u534f\u8bae\u4e00\u822c\u53ef\u4ee5\u5206\u4e3a\u4e24\u7c7b\uff1a\u7eaf\u6587\u672c\u548c\u4e8c\u8fdb\u5236\u3002</p>"},{"location":"rpc/serialization/#\u7eaf\u6587\u672c","title":"\u7eaf\u6587\u672c","text":"<p>\u7eaf\u6587\u672c\u534f\u8bae\u5f88\u597d\u7406\u89e3\uff0c\u5c31\u662f\u5c06\u5bf9\u8c61\u8f6c\u6362\u6210\u4e00\u6bb5\u6587\u672c\uff0c\u4f8b\u5982\uff0c\u4e00\u4e2a\u6574\u6570\uff0c\u6211\u4eec\u5c31\u5c06\u5b83\u8f6c\u6362\u6210\u5341\u8fdb\u5236\u8868\u793a <code>123</code>\uff0c\u5982\u679c\u662f\u6570\u7ec4\uff0c\u6211\u4eec\u5c31\u7528\u67d0\u79cd\u7b26\u53f7\u6807\u8bc6\u5f00\u59cb\u548c\u7ed3\u675f\uff0c\u81f3\u4e8e\u5bf9\u8c61\uff0c\u6211\u4eec\u5c31\u9012\u5f52\u5730\u8fdb\u884c\u5e8f\u5217\u5316\u3002\u4e3a\u4e86\u5bf9\u5e94\u4e0a\u5bf9\u8c61\u7684\u5b57\u6bb5\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u5b57\u6bb5\u540d\u79f0\u4e5f\u7f16\u7801\u6210\u5b57\u7b26\u4e32\uff0c\u548c\u5177\u4f53\u7684\u503c\u4e00\u4e00\u5bf9\u5e94\u3002</p> <p>\u5f53\u7136\uff0c\u6211\u4eec\u4e0d\u9700\u8981\u81ea\u5df1\u8bbe\u8ba1\u534f\u8bae\uff0c\u53ef\u4ee5\u4f7f\u7528\u73b0\u6709\u7684\u901a\u7528\u534f\u8bae\u3002\u4f8b\u5982 JSON\u3001XML \u7b49\u3002</p> <p>\u7eaf\u6587\u672c\u534f\u8bae\u65b9\u4fbf\u4eba\u7c7b\u8c03\u8bd5\uff0c\u6211\u4eec\u53ea\u9700\u8981\u6587\u672c\u7f16\u8f91\u5668\u5c31\u80fd\u7f16\u5199\u4e00\u4e2a\u5bf9\u8c61\uff0c\u5728\u7f51\u7edc\u6293\u5305\u65f6\uff0c\u4e5f\u4e0d\u9700\u8981\u5176\u4ed6\u5de5\u5177\u5c31\u80fd\u7406\u89e3\u6570\u636e\u7684\u5185\u5bb9\u3002\u4f46\u662f\u7eaf\u6587\u672c\u534f\u8bae\u5bf9\u4e8e\u8ba1\u7b97\u673a\u6765\u8bf4\u89e3\u6790\u8d77\u6765\u6bd4\u8f83\u590d\u6742\uff0c\u8017\u8d39\u8ba1\u7b97\u8d44\u6e90\u3002\u5b83\u7684\u7f16\u7801\u6548\u7387\u4e5f\u4e0d\u9ad8\uff0c\u6d6a\u8d39\u5e26\u5bbd\uff0c\u800c\u4e14\u7ed3\u6784\u5f80\u5f80\u4e0d\u786e\u5b9a\uff0c\u5bf9\u4e8e\u9759\u6001\u7c7b\u578b\u8bed\u8a00\u4e0d\u592a\u53cb\u597d\u3002</p>"},{"location":"rpc/serialization/#\u4e8c\u8fdb\u5236","title":"\u4e8c\u8fdb\u5236","text":"<p>\u4e8c\u8fdb\u5236\u534f\u8bae\u5219\u7c7b\u4f3c\u4e8e\u628a\u5185\u5b58\u4e2d\u7684\u6570\u636e\u76f4\u63a5\u53d1\u9001\u51fa\u53bb\uff0c\u4e0d\u8fc7\u53d1\u9001\u524d\u7edf\u4e00\u5904\u7406\u597d\u517c\u5bb9\u6027\u95ee\u9898\u3002\u4f8b\u5982\uff0c\u6574\u6570\u6765\u8bf4\uff0c\u5c31\u5148\u7edf\u4e00\u8f6c\u6362\u6210\u5927\u7aef\u5e8f\uff0c\u5bf9\u4e8e\u6570\u7ec4\uff0c\u540c\u6837\u4ee5\u67d0\u79cd\u5b57\u8282\u6765\u6807\u8bc6\u5f00\u59cb\u548c\u7ed3\u675f\uff0c\u800c\u5bf9\u8c61\u5219\u8fdb\u884c\u9012\u5f52\u7684\u5e8f\u5217\u5316\u3002</p> <p>\u4e8c\u8fdb\u5236\u534f\u8bae\u4e00\u822c\u7528\u4e8e\u5bf9\u6027\u80fd\u6709\u6bd4\u8f83\u9ad8\u8981\u6c42\u7684\u573a\u5408\uff0c\u4e00\u822c\u4f1a\u4f7f\u7528\u5355\u72ec\u7684\u8bed\u8a00\u6765\u63cf\u8ff0\u4e00\u4e2a\u4e8c\u8fdb\u5236\u5bf9\u8c61\u7684\u7ed3\u6784\uff0c\u7136\u540e\u4f7f\u7528\u5de5\u5177\u751f\u6210\u4ee3\u7801\u3002\u8ba1\u7b97\u673a\u89e3\u6790\u4e8c\u8fdb\u5236\u534f\u8bae\u6bd4\u8f83\u65b9\u4fbf\uff0c\u5927\u591a\u6570\u65f6\u5019\u4ec5\u9700\u8981\u505a\u7b80\u5355\u7684\u8f6c\u6362\u5373\u53ef\u3002\u4f46\u662f\u5bf9\u5e94\u7684\u7f3a\u70b9\u5c31\u662f\u4eba\u7c7b\u60f3\u8981\u8c03\u8bd5\u6216\u8005\u7f16\u8f91\u7684\u65f6\u5019\u5fc5\u987b\u501f\u52a9\u5de5\u5177\uff0c\u7f51\u7edc\u6293\u5305\u7684\u65f6\u5019\u4e5f\u9700\u8981\u89e3\u7801\u5de5\u5177\u624d\u80fd\u89e3\u6790\u4f20\u8f93\u7684\u4fe1\u606f\u3002</p> <p>\u5f53\u7136\uff0c\u4e8c\u8fdb\u5236\u534f\u8bae\u4e5f\u4e0d\u9700\u8981\u6211\u4eec\u81ea\u5df1\u8bbe\u8ba1\uff0c\u540c\u6837\u6709\u73b0\u6709\u7684\u901a\u7528\u534f\u8bae\u3002\u4f8b\u5982 Protocol Buffers\u3001Flat Buffers \u7b49\u3002\u5176\u4e2d Protocol Buffers \u4e5f\u63d0\u4f9b\u4e86\u7f16\u7801\u4e3a JSON \u7684\u529f\u80fd\u3002</p>"},{"location":"rpc/serialization/#\u603b\u7ed3","title":"\u603b\u7ed3","text":"<p>\u4e00\u822c\u6765\u8bf4\uff0c\u76f4\u63a5\u9009\u62e9 Protocol Buffers \u4f5c\u4e3a\u5e8f\u5217\u5316\u534f\u8bae\u5373\u53ef\uff0c\u5b83\u8bed\u8a00\u65e0\u5173\uff0c\u80fd\u751f\u6210\u591a\u79cd\u8bed\u8a00\u7684\u4ee3\u7801\uff0c\u8282\u7701\u5de5\u4f5c\u91cf\u3002\u4e5f\u540c\u65f6\u652f\u6301\u4e8c\u8fdb\u5236\u548c JSON \u7f16\u7801\uff0c\u65b9\u4fbf\u5207\u6362\u3002</p>"},{"location":"rpc/server/","title":"\u7f16\u5199\u670d\u52a1\u7aef","text":"<p>RPC \u670d\u52a1\u7aef\u548c\u666e\u901a\u7684\u670d\u52a1\u5668\u7a0b\u5e8f\u4e00\u6837\uff0c\u76d1\u542c\u4e00\u4e2a\u670d\u52a1\u7aef\u53e3\uff0c\u63a5\u6536\u5e76\u54cd\u5e94\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u3002\u5e38\u7528\u7684 RPC \u534f\u8bae\u6709 JSON-RPC \u548c gRPC\u3002\u5bf9\u4e8e\u540e\u53f0\u670d\u52a1\u4e4b\u95f4\u7684\u901a\u4fe1\uff0c\u4f7f\u7528\u57fa\u4e8e\u4e8c\u8fdb\u5236\u683c\u5f0f\u7684\u901a\u4fe1\u534f\u8bae\u6548\u7387\u66f4\u9ad8\uff0c\u800c\u5982\u679c\u670d\u52a1\u5668\u9700\u8981\u9762\u5411\u6d4f\u89c8\u5668\u63d0\u4f9b API \u670d\u52a1\u7684\u8bdd\uff0c\u4f7f\u7528 JSON \u683c\u5f0f\u7684\u901a\u4fe1\u534f\u8bae\u4f1a\u63d0\u9ad8\u524d\u7aef\u7684\u5f00\u53d1\u6548\u7387\u3002</p> <p>\u901a\u5e38\u6765\u8bf4\uff0c\u4e00\u4e2a RPC \u670d\u52a1\u5668\u7684\u4f2a\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>class RPCServer {\n  std::vector&lt;Middleware&gt; middlewares_;\npublic:\n  response ping(request &amp;req) {\n    return response(req.body);\n  }\n  response handle_request(request &amp;req) {\n    switch (req.method) {\n    case kMethodPing:\n      return ping(req);\n    // ...\n    }\n  }\n  task handle_connection(connection &amp;conn) {\n    while (conn.alive()) {\n      auto req = conn.read_request();\n      for (auto &amp;m : middlewares_) {\n        req = m.handle_request(conn, req);\n      }\n      auto resp = handle_request(req);\n      conn.write_response(resp);\n    }\n  }\n  void serve(int port) {\n    auto listener = listen_on(port);\n    while (!stopped) {\n      auto conn = listener.accept();\n      handle_connection(conn).detach();\n    }\n  }\n};\n</code></pre> <p>\u5176\u4e2d\uff0c\u670d\u52a1\u7aef\u5148\u542f\u52a8\u4e00\u4e2a\u76d1\u542c\u7aef\u53e3\uff0c\u7136\u540e\u4e0d\u65ad\u63a5\u53d7\u8fde\u63a5\u3002\u6211\u4eec\u5c06\u6bcf\u4e00\u4e2a\u63a5\u53d7\u5230\u7684\u8fde\u63a5\u653e\u5230\u540e\u53f0\u53bb\u5904\u7406\uff0c\u5728\u8fde\u63a5\u8fd8\u6ca1\u65ad\u5f00\u7684\u65f6\u5019\uff0c\u63a5\u53d7\u5e76\u54cd\u5e94\u8bf7\u6c42\u3002\u800c\u54cd\u5e94\u8bf7\u6c42\u7684\u903b\u8f91\u4e5f\u5f88\u76f4\u63a5\uff0c\u6211\u4eec\u6839\u636e\u8bf7\u6c42\u4e2d\u7684\u5934\u90e8\u4fe1\u606f\uff0c\u83b7\u53d6\u8bf7\u6c42\u5bf9\u5e94\u7684\u65b9\u6cd5\uff0c\u7136\u540e\u8c03\u7528\u5bf9\u5e94\u7684\u5904\u7406\u51fd\u6570\u83b7\u5f97\u54cd\u5e94\u540e\uff0c\u5c06\u54cd\u5e94\u53d1\u9001\u56de\u53bb\u3002\u5bf9\u4e8e\u4e00\u4e9b\u901a\u7528\u7684\u903b\u8f91\uff0c\u4f8b\u5982\u53c2\u6570\u6821\u9a8c\u3001\u9274\u6743\u3001\u9650\u6d41\u7b49\u53ef\u4ee5\u62bd\u8c61\u6210\u4e3a\u4e2d\u95f4\u4ef6\uff0c\u5bf9\u8bf7\u6c42\u8fdb\u884c\u4e00\u4e9b\u9884\u5904\u7406\u4e4b\u540e\u518d\u8c03\u7528\u771f\u6b63\u7684\u5904\u7406\u51fd\u6570\u3002\u54cd\u5e94\u7684\u56de\u590d\u4e5f\u53ef\u4ee5\u7528\u7c7b\u4f3c\u7684\u601d\u60f3\uff0c\u5bf9\u54cd\u5e94\u8fdb\u884c\u4e00\u4e9b\u7edf\u4e00\u7684\u5904\u7406\u3002</p> <p>\u7531\u4e8e\u7f16\u5199\u6846\u67b6\u4ee3\u7801\u6bd4\u8f83\u7e41\u7410\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4ee3\u7801\u751f\u6210\u7684\u65b9\u5f0f\u8ba9\u5de5\u5177\u6765\u5e2e\u52a9\u6211\u4eec\u751f\u6210\u8fd9\u4e9b\u6a21\u677f\u4ee3\u7801\u3002\u4f8b\u5982 Protobuf \u5c31\u652f\u6301\u6839\u636e IDL \u5b9a\u4e49\u751f\u6210 RPC \u670d\u52a1\u7aef\u548c\u5ba2\u6237\u7aef\u7684\u6846\u67b6\u4ee3\u7801\uff0c\u7a0b\u5e8f\u5458\u53ea\u9700\u8981\u5b9e\u73b0\u9884\u5b9a\u4e49\u597d\u7684\u63a5\u53e3\uff0c\u5c31\u5b8c\u6210\u4e86 RPC \u7a0b\u5e8f\u7684\u7f16\u5199\u3002</p>"},{"location":"static-analysis/","title":"\u6982\u89c8","text":"<p>\u4eba\u65e0\u5b8c\u4eba\uff0c\u5728\u7f16\u5199\u7a0b\u5e8f\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u96be\u514d\u4f1a\u72af\u9519\u8bef\u3002\u800c\u5982\u679c\u5f00\u53d1\u65f6\u95f4\u6bd4\u8f83\u7d27\u5f20\uff0c\u53ef\u80fd\u5c31\u66f4\u5bb9\u6613\u201c\u4e0d\u62d8\u5c0f\u8282\u201d\u4e86\u3002\u53e6\u5916\uff0c\u901a\u5e38\u56e2\u961f\u90fd\u4f1a\u9075\u5faa\u4e00\u5b9a\u7684\u5f00\u53d1\u89c4\u8303\uff0c\u4f8b\u5982 Google C++ Style Guide\uff0c\u8ba9\u4eba\u65f6\u65f6\u523b\u523b\u4e25\u683c\u9075\u5b88\u8fd9\u4e9b\u89c4\u5219\u4e5f\u662f\u6bd4\u8f83\u56f0\u96be\u7684\u4e8b\u60c5\u3002\u4e3a\u6b64\uff0c\u6211\u4eec\u901a\u5e38\u90fd\u4f1a\u5f15\u5165\u9759\u6001\u5206\u6790\u5de5\u5177\uff0c\u8ba9\u7535\u8111\u6765\u5206\u6790\u6211\u4eec\u7684\u4ee3\u7801\u4e2d\u53ef\u80fd\u5b58\u5728\u7684\u95ee\u9898\uff0c\u5e76\u5c1d\u8bd5\u81ea\u52a8\u4fee\u590d\u3002</p> <p>\u9759\u6001\u5206\u6790\u901a\u5e38\u4e0d\u9700\u8981\u5b8c\u6574\u5730\u7f16\u8bd1\u4ee3\u7801\uff0c\u800c\u53ea\u4f1a\u5bf9\u6e90\u4ee3\u7801\u6587\u672c\u8fdb\u884c\u5206\u6790\u3002\u901a\u5e38\u9759\u6001\u5206\u6790\u4f1a\u68c0\u67e5\u4ee5\u4e0b\u51e0\u4e2a\u65b9\u9762\uff1a</p> <ul> <li>\u4ee3\u7801\u683c\u5f0f\uff0c\u4f8b\u5982\u7f29\u8fdb\u3001\u7a7a\u683c\u7b49</li> <li>\u4ee3\u7801\u590d\u6742\u5ea6\uff0c\u4f8b\u5982 <code>if</code> \u7b49\u5d4c\u5957\u8fc7\u6df1\u6216\u8005\u4e00\u4e2a\u51fd\u6570\u5199\u592a\u957f</li> <li>\u5e38\u89c1\u7684\u4ee3\u7801\u9519\u8bef\uff0c\u4f8b\u5982\u4f7f\u7528\u4e86\u672a\u521d\u59cb\u5316\u53d8\u91cf\u6216\u8005\u9012\u5f52\u6ca1\u6709\u9000\u51fa\u6761\u4ef6</li> <li>\u4e00\u4e9b\u56e2\u961f\u4e2d\u81ea\u5df1\u5b9a\u4e49\u7684\u89c4\u8303\uff0c\u4f8b\u5982 <code>public</code> \u63a5\u53e3\u51fd\u6570\u9700\u8981\u4f7f\u7528\u5927\u5199\u5b57\u6bcd\u5f00\u5934</li> </ul> <p>\u901a\u5e38\uff0c\u4ee3\u7801\u683c\u5f0f\u95ee\u9898\u53ef\u4ee5\u7531\u5de5\u5177\u81ea\u52a8\u4e3a\u6211\u4eec\u4fee\u590d\uff0cIDE \u6216\u8005\u7f16\u8f91\u5668\u7684\u63d2\u4ef6\u4e5f\u4f1a\u63d0\u4f9b\u683c\u5f0f\u5316\u529f\u80fd\u3002\u800c\u5176\u4f59\u7684\u4ee3\u7801\u9519\u8bef\u901a\u5e38\u9700\u8981\u4eba\u5de5\u4fee\u590d\u3002\u9759\u6001\u5206\u6790\u4e00\u822c\u4f1a\u4f5c\u4e3a\u524d\u63d0\u6761\u4ef6\u52a0\u5165\u5230\u6301\u7eed\u96c6\u6210\u4e2d\uff0c\u5982\u679c\u9759\u6001\u5206\u6790\u4e0d\u901a\u8fc7\uff0c\u5c31\u4e0d\u4f1a\u7ee7\u7eed\u7f16\u8bd1\u7b49\u6d41\u7a0b\u3002</p>"},{"location":"static-analysis/format/","title":"\u4ee3\u7801\u683c\u5f0f\u5316","text":"<p>\u4fdd\u6301\u4ee3\u7801\u98ce\u683c\u7684\u7edf\u4e00\u4ee5\u53ca\u6574\u6d01\u53ef\u4ee5\u51cf\u5c11\u4ed6\u4eba\u9605\u8bfb\u4ee3\u7801\u7684\u6210\u672c\u3002\u4ee3\u7801\u683c\u5f0f\u5316\u5de5\u5177\u53ef\u4ee5\u6839\u636e\u914d\u7f6e\u6765\u5bf9\u4ee3\u7801\u8fdb\u884c\u683c\u5f0f\u68c0\u67e5\u4ee5\u53ca\u81ea\u52a8\u4fee\u6b63\uff0c\u4f8b\u5982\u7f29\u8fdb\u5bf9\u9f50\u3001\u7f29\u8fdb\u7528\u7a7a\u683c\u8fd8\u662f Tab\u3001\u4ee3\u7801\u6362\u884c\u7684\u7410\u788e\u7684\u7ec6\u8282\u3002\u4ee3\u7801\u683c\u5f0f\u5316\u5de5\u5177\u7684\u539f\u7406\u662f\u5c06\u4ee3\u7801\u89e3\u6790\u4e00\u904d\uff0c\u6784\u9020\u597d\u8bed\u6cd5\u6811\uff0c\u7136\u540e\u6309\u7167\u6307\u5b9a\u683c\u5f0f\u5c06\u8fd9\u4e2a\u8bed\u6cd5\u6811\u91cd\u65b0\u8f93\u51fa\u51fa\u6765\u3002</p> <p>\u4f7f\u7528\u4ee3\u7801\u683c\u5f0f\u5316\u8f6f\u4ef6\u7684\u65f6\u5019\uff0c\u4e00\u822c\u662f\u5c06\u683c\u5f0f\u8981\u6c42\u4fdd\u5b58\u5728\u4e00\u4e2a\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u5e76\u4e14\u5c06\u8fd9\u4e2a\u6587\u4ef6\u4e5f\u4fdd\u5b58\u5230\u4ee3\u7801\u4ed3\u5e93\u91cc\uff0c\u8fd9\u6837\u5176\u4ed6\u4eba\u53ea\u9700\u8981\u4e0b\u8f7d\u76f8\u540c\u7684\u683c\u5f0f\u5316\u5de5\u5177\u8fd0\u884c\uff0c\u5c31\u80fd\u5f97\u5230\u98ce\u683c\u7edf\u4e00\u7684\u4ee3\u7801\u4e86\u3002\u6709\u65f6\u5019\u6709\u4e9b\u4eba\u53ef\u80fd\u6ca1\u6709\u8fd0\u884c\u683c\u5f0f\u5316\u5de5\u5177\u5c31\u63d0\u4ea4\u4e86\u4ee3\u7801\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u81ea\u52a8\u5316\u5de5\u5177\u6765\u8fd0\u884c\u683c\u5f0f\u5316\u68c0\u67e5\uff0c\u963b\u6b62\u8fd9\u6b21\u63d0\u4ea4\u3002</p> <p>\u4e0d\u540c\u8bed\u8a00\u6709\u4e0d\u540c\u7684\u4ee3\u7801\u683c\u5f0f\u5316\u5de5\u5177\uff0c\u8fd9\u91cc\u4ee5 C++ \u4f7f\u7528\u7684 <code>clang-format</code> \u4e3a\u4f8b\u3002</p> Note <p>Ubuntu \u4e0a\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 <code>apt</code> \u5de5\u5177\u5b89\u88c5 <code>clang-format</code> \u5305\u3002</p>"},{"location":"static-analysis/format/#\u7f16\u5199\u914d\u7f6e\u6587\u4ef6","title":"\u7f16\u5199\u914d\u7f6e\u6587\u4ef6","text":"<p>\u901a\u5e38\u4ee3\u7801\u683c\u5f0f\u5316\u5de5\u5177\u90fd\u4f1a\u63d0\u4f9b\u6570\u5341\u4e0a\u767e\u7684\u914d\u7f6e\u9009\u9879\uff0c\u5982\u679c\u6211\u4eec\u4e00\u4e2a\u4e2a\u914d\u7f6e\u7684\u8bdd\u4f1a\u6bd4\u8f83\u9ebb\u70e6\uff0c\u6240\u4ee5\u6211\u4eec\u4f7f\u7528\u683c\u5f0f\u5316\u5de5\u5177\u7684\u65f6\u5019\uff0c\u4e00\u822c\u662f\u76f4\u63a5\u4f7f\u7528\u4e00\u4e2a\u770b\u4e0a\u53bb\u6bd4\u8f83\u9002\u5408\u9700\u6c42\u7684\u914d\u7f6e\uff0c\u7136\u540e\u518d\u5bf9\u5176\u505a\u7565\u5fae\u4fee\u6539\u3002\u4f8b\u5982\uff0c<code>clang-format</code> \u5185\u7f6e\u4e86 <code>LLVM</code>\u3001<code>Google</code>\u3001<code>Microsoft</code> \u7b49\u5e38\u7528\u7684\u914d\u7f6e\uff0c\u53ef\u4ee5\u4f7f\u7528\u547d\u4ee4\u884c\u5c06\u5176\u5199\u5230\u6587\u4ef6\u4e2d\uff1a</p> <pre><code>$ clang-format -style=llvm -dump-config &gt; .clang-format\n</code></pre> Note <p>\u4e0d\u540c\u7684\u4ee3\u7801\u683c\u5f0f\u5316\u5de5\u5177\u7684\u914d\u7f6e\u6587\u4ef6\u540d\u79f0\u4e0d\u4e00\u6837\uff0c\u5177\u4f53\u53ef\u4ee5\u53c2\u8003\u5bf9\u5e94\u7684\u5de5\u5177\u6587\u6863\u3002\u540c\u65f6\uff0c\u76ee\u524d\u7684 IDE \u6216\u8005\u6587\u672c\u7f16\u8f91\u5668\u63d2\u4ef6\uff0c\u4e5f\u652f\u6301\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\u5e76\u8fd0\u884c\u683c\u5f0f\u5316\u5de5\u5177\u3002</p> <p>\u4f7f\u7528\u6587\u672c\u7f16\u8f91\u5668\u6253\u5f00 <code>.clang-format</code> \u6587\u4ef6\uff0c\u53ef\u4ee5\u770b\u5230\u8fd9\u662f\u4e00\u4e2a YAML \u683c\u5f0f\u7684\u6587\u4ef6\uff1a</p> <pre><code>---\nLanguage:        Cpp\n# BasedOnStyle:  LLVM\nAccessModifierOffset: -2\nAlignAfterOpenBracket: Align\nAlignConsecutiveMacros: false\nAlignConsecutiveAssignments: false\nAlignConsecutiveDeclarations: false\nAlignEscapedNewlines: Right\nAlignOperands:   true\nAlignTrailingComments: true\nAllowAllArgumentsOnNextLine: true\nAllowAllConstructorInitializersOnNextLine: true\n# ...\n</code></pre> <p>\u5177\u4f53\u7684\u914d\u7f6e\u9009\u9879\uff0c\u53ef\u4ee5\u53c2\u8003 <code>clang-format</code> \u7684\u5b98\u65b9\u6587\u6863\u3002</p>"},{"location":"static-analysis/format/#\u8fd0\u884c\u4ee3\u7801\u683c\u5f0f\u5316\u5de5\u5177","title":"\u8fd0\u884c\u4ee3\u7801\u683c\u5f0f\u5316\u5de5\u5177","text":"<p>\u4e0b\u9762\u4ee5\u4e00\u4e2a\u683c\u5f0f\u6df7\u4e71\u7684\u4ee3\u7801\u4f5c\u4e3a\u4f8b\u5b50\uff0c\u6f14\u793a\u4e0b\u4ee3\u7801\u683c\u5f0f\u5316\u5de5\u5177\u7684\u4f5c\u7528\uff1a</p> hello.cpp <pre><code>#include&lt;iostream&gt;\n#include &lt;string&gt;\nclass Greeter{\npublic:\n Greeter():message(\"hello, world\"){};\n        void SayHello(){std::cout&lt;&lt;message&lt;&lt;std::endl;}private:\n  std::string message;\n};int main(){Greeter().SayHello();return 0;}\n</code></pre> <p>\u8fd0\u884c <code>clang-format</code>\uff0c\u53ef\u4ee5\u5f97\u5230\u683c\u5f0f\u6574\u6d01\u7684\u4ee3\u7801\u8f93\u51fa\uff1a</p> <pre><code>$ clang-format hello.cpp\n#include &lt;iostream&gt;\n#include &lt;string&gt;\nclass Greeter {\npublic:\n  Greeter() : message(\"hello, world\"){};\n  void SayHello() { std::cout &lt;&lt; message &lt;&lt; std::endl; }\nprivate:\n  std::string message;\n};\nint main() {\n  Greeter().SayHello();\n  return 0;\n}\n</code></pre> <p>\u5982\u679c\u5e0c\u671b\u683c\u5f0f\u5316\u5de5\u5177\u76f4\u63a5\u4fee\u6539\u6587\u4ef6\uff0c\u800c\u4e0d\u662f\u8f93\u51fa\u5230\u6807\u51c6\u8f93\u51fa\uff0c\u901a\u5e38\u5de5\u5177\u4e5f\u4f1a\u63d0\u4f9b\u5bf9\u5e94\u7684\u53c2\u6570\u6765\u539f\u5730\u4fee\u6539\u6587\u4ef6\uff0c\u4f8b\u5982\uff0c<code>clang-format</code> \u63d0\u4f9b\u4e86 <code>-i</code> \u9009\u9879\uff1a</p> <pre><code>$ clang-format hello.cpp\n$ cat hello.cpp\n#include &lt;iostream&gt;\n#include &lt;string&gt;\nclass Greeter {\npublic:\n  Greeter() : message(\"hello, world\"){};\n  void SayHello() { std::cout &lt;&lt; message &lt;&lt; std::endl; }\nprivate:\n  std::string message;\n};\nint main() {\n  Greeter().SayHello();\n  return 0;\n}\n</code></pre> <p>\u4e0d\u8fc7\uff0c<code>clang-format</code> \u5e76\u6ca1\u6709\u63d0\u4f9b\u4e00\u6b21\u683c\u5f0f\u5316\u76ee\u5f55\u4e0b\u6240\u6709\u6587\u4ef6\u7684\u65b9\u6cd5\uff0c\u9700\u8981\u6211\u4eec\u81ea\u884c\u7f16\u5199\u811a\u672c\u6765\u6279\u91cf\u683c\u5f0f\u5316\u4ee3\u7801\u3002\u4f8b\u5982\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u8fd9\u6837\u7684\u547d\u4ee4\uff0c\u6bcf\u6b21\u63d0\u4ea4\u4ee3\u7801\u524d\u8fd0\u884c\u4e00\u6b21\uff1a</p> <pre><code>$ find my-server/ -iname *.h -o -iname *.cpp | xargs clang-format -i\n</code></pre>"},{"location":"static-analysis/format/#\u914d\u7f6e\u7f16\u8f91\u5668","title":"\u914d\u7f6e\u7f16\u8f91\u5668","text":"<p>\u5f53\u7136\u5982\u679c\u6bcf\u6b21\u90fd\u624b\u52a8\u6267\u884c\u547d\u4ee4\u5c31\u592a\u9ebb\u70e6\u4e86\uff0c\u6240\u4ee5\u6211\u4eec\u8fd8\u9700\u8981\u914d\u7f6e\u6587\u672c\u7f16\u8f91\u5668\u6765\u81ea\u52a8\u683c\u5f0f\u5316\u6211\u4eec\u7684\u4ee3\u7801\uff0c\u5728 Visual Studio Code \u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 clang-format \u63d2\u4ef6\uff0c\u5728 CLion \u91cc\uff0c\u5219\u5df2\u7ecf\u5185\u7f6e\u4e86\u652f\u6301\u3002</p> <p>\u4e3a\u4e86\u907f\u514d\u5fd8\u8bb0\u683c\u5f0f\u5316\u4ee3\u7801\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u914d\u7f6e\u7f16\u8f91\u5668\u4e2d\u7c7b\u4f3c <code>Format On Save</code> \u7b49\u9009\u9879\uff0c\u5728\u4fdd\u5b58\u6587\u4ef6\u7684\u65f6\u5019\u5c31\u8fd0\u884c\u4e00\u6b21\u683c\u5f0f\u5316\u5de5\u5177\u3002</p>"},{"location":"static-analysis/lint/","title":"\u9759\u6001\u68c0\u67e5","text":"<p>\u9664\u4e86\u4ee3\u7801\u7684\u683c\u5f0f\u95ee\u9898\u4ee5\u5916\uff0c\u9759\u6001\u68c0\u67e5\u8fd8\u53ef\u4ee5\u68c0\u67e5\u51fa\u4e00\u4e9b\u903b\u8f91\u9519\u8bef\u3002\u4f8b\u5982\uff0c\u5fd8\u8bb0\u5728\u57fa\u7c7b\u7684\u865a\u6784\u51fd\u6570\u6dfb\u52a0 <code>virtual</code> \u5173\u952e\u8bcd\uff0c\u53c8\u6216\u8005\u662f\u4f7f\u7528\u4e86 <code>using namespace std</code> \u8fd9\u79cd\u4f1a\u6c61\u67d3\u547d\u540d\u7a7a\u95f4\u7684\u6307\u4ee4\u3002\u8fd9\u4e00\u6b65\u901a\u5e38\u79f0\u4e3a lint\u3002\u5e38\u7528\u7684 C++ \u9759\u6001\u68c0\u67e5\u5de5\u5177\u6709\u8c37\u6b4c\u5f00\u53d1\u7684 <code>cpplint.py</code> \u4ee5\u53ca <code>clang-tidy</code>\uff0c\u5176\u4e2d <code>cpplint.py</code> \u662f\u57fa\u4e8e\u7eaf\u6587\u672c\u5206\u6790\uff0c\u800c\u4e14\u53ea\u68c0\u67e5 Google C++ Style Guide \u4e2d\u7684\u89c4\u5219\u3002\u800c <code>clang-tidy</code> \u5219\u4f1a\u8c03\u7528 <code>clang</code> \u5de5\u5177\u94fe\u5bf9\u4ee3\u7801\u8fdb\u884c\u89e3\u6790\u7b49\uff0c\u652f\u6301\u66f4\u591a\u5185\u7f6e\u89c4\u5219\uff0c\u529f\u80fd\u4e0a\u4f1a\u66f4\u5f3a\u5927\u3002</p>"},{"location":"static-analysis/lint/#cpplintpy","title":"<code>cpplint.py</code>","text":"<p>\u4f7f\u7528 <code>cpplint.py</code> \u524d\u9700\u8981\u5b89\u88c5 Python 3 \u4ee5\u53ca pip \u5de5\u5177\uff0c\u7136\u540e\u4f7f\u7528 pip \u5de5\u5177\u5b89\u88c5\u5373\u53ef\u3002</p> <pre><code>$ sudo apt install python3 python3-pip\n$ pip install --user cpplint\n</code></pre> <p>\u4f7f\u7528\u65b9\u6cd5\u4e5f\u6bd4\u8f83\u7b80\u5355\uff0c\u76f4\u63a5 <code>cpplint &lt;\u6587\u4ef6\u540d&gt;</code> \u5373\u53ef\u3002\u4f8b\u5982\uff0c\u6211\u4eec\u6709\u8fd9\u6837\u7684\u4ee3\u7801\uff1a</p> src/main.cpp <pre><code>#include &lt;iostream&gt;\n#include \"mylib.h\"\nusing namespace std;\n\nint main() {\n    cout &lt;&lt; \"add(1, 2) = \" &lt;&lt; add(1, 2) &lt;&lt; endl;\n    cout &lt;&lt; \"sub(1, 2) = \" &lt;&lt; sub(1, 2) &lt;&lt; endl;\n    return 0;\n}\n</code></pre> <p>\u8fd0\u884c <code>cpplint</code> \u5de5\u5177\uff0c\u53ef\u4ee5\u5f97\u5230\u8fd9\u6837\u7684\u8f93\u51fa\uff1a</p> <pre><code>$ cpplint src/main.cpp\nsrc/main.cpp:0:  No copyright message found.  You should have a line: \"Copyright [year] &lt;Copyright Owner&gt;\"  [legal/copyright] [5]\nsrc/main.cpp:2:  Include the directory when naming .h files  [build/include_subdir] [4]\nsrc/main.cpp:3:  Do not use namespace using-directives.  Use using-declarations instead.  [build/namespaces] [5]\nDone processing src/main.cpp\nTotal errors found: 3\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u77ed\u77ed\u7684\u4e00\u6bb5\u4ee3\u7801\u5c31\u6709\u4e09\u4e2a\u4e0d\u89c4\u8303\u7684\u5730\u65b9\uff0c\u5f53\u7136\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u6839\u636e\u81ea\u5df1\u9700\u8981\uff0c\u53bb\u9664\u4e0d\u9700\u8981\u7684\u89c4\u5219\uff0c\u6bd4\u5982\u6211\u4eec\u9009\u62e9\u4e0d\u9075\u5b88\u5173\u4e8e copyright \u7684\u89c4\u5219\uff1a</p> <pre><code>$ cpplint --filter=-legal/copyright src/main.cpp\nsrc/main.cpp:2:  Include the directory when naming .h files  [build/include_subdir] [4]\nsrc/main.cpp:3:  Do not use namespace using-directives.  Use using-declarations instead.  [build/namespaces] [5]\nDone processing src/main.cpp\nTotal errors found: 2\n</code></pre> <p>\u90a3\u4e48\u6700\u540e\u7684\u9519\u8bef\u62a5\u544a\u5c31\u4e0d\u4f1a\u62a5\u544a\u5173\u4e8e copyright \u7684\u89c4\u5219\u3002</p>"},{"location":"static-analysis/lint/#clang-tidy","title":"<code>clang-tidy</code>","text":"<p><code>clang-tidy</code> \u662f\u57fa\u4e8e clang \u5de5\u5177\u94fe\u7684\u9759\u6001\u5206\u6790\u5de5\u5177\uff0c\u6bd4\u8d77 <code>cpplint.py</code> \u529f\u80fd\u66f4\u5168\u9762\uff0c\u5185\u7f6e\u7684\u89c4\u5219\u4e5f\u66f4\u591a\uff0c\u68c0\u67e5\u4e5f\u66f4\u51c6\u786e\u3002\u4e0d\u8fc7\u56e0\u4e3a\u662f\u57fa\u4e8e\u4ee3\u7801\u5206\u6790\u7684\uff0c\u6240\u4ee5\u9700\u8981\u63d0\u4f9b\u7f16\u8bd1\u6307\u4ee4\u4fe1\u606f\uff0c\u5728\u4ee3\u7801\u53ef\u4ee5\u6b63\u5e38\u7f16\u8bd1\u7684\u60c5\u51b5\u4e0b\u624d\u80fd\u8fdb\u884c\u5206\u6790\uff0c\u800c\u4e14\u5360\u7528\u8d44\u6e90\u66f4\u591a\uff0c\u901f\u5ea6\u6bd4\u8d77\u6587\u672c\u5206\u6790\u7684\u5de5\u5177\u4e5f\u66f4\u6162\u3002</p> <p>\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 <code>apt</code> \u5305\u7ba1\u7406\u5668\u5b89\u88c5 <code>clang-tidy</code>\uff1a</p> <pre><code>$ sudo apt install clang-tidy\n</code></pre> src/main.cppinclude/mylib.h <pre><code>#include &lt;iostream&gt;\n#include \"mylib.h\"\nusing namespace std;\n\nint main() {\n    cout &lt;&lt; \"add(1, 2) = \" &lt;&lt; add(1, 2) &lt;&lt; endl;\n    cout &lt;&lt; \"sub(1, 2) = \" &lt;&lt; sub(1, 2) &lt;&lt; endl;\n    return 0;\n}\n</code></pre> <pre><code>int add(int a, int b);\nint sub(int a, int b);\n</code></pre> <p>\u5982\u679c\u6211\u4eec\u76f4\u63a5\u8fd0\u884c <code>clang-tidy</code> \u5219\u4f1a\u5f97\u5230\u62a5\u9519\uff1a</p> <pre><code>$ clang-tidy -checks=google* src/main.cpp\nError while trying to load a compilation database:\nCould not auto-detect compilation database for file \"src/main.cpp\"\nNo compilation database found in /home/howard/lint/src or any parent directory\nfixed-compilation-database: Error while opening fixed database: No such file or directory\njson-compilation-database: Error while opening JSON database: No such file or directory\nRunning without flags.\n1 error generated.\nError while processing /home/howard/lint/src/main.cpp.\n/home/howard/lint/src/main.cpp:2:10: error: 'mylib.h' file not found [clang-diagnostic-error]\n#include \"mylib.h\"\n         ^\nFound compiler error(s).\n</code></pre> <p>\u548c <code>cpplint.py</code> \u4e0d\u540c\uff0c<code>clang-tidy</code> \u9700\u8981\u5c1d\u8bd5\u7f16\u8bd1\u6587\u4ef6\uff0c\u800c <code>mylib.h</code> \u4e0d\u5728\u540c\u4e00\u4e2a\u6587\u4ef6\u5939\uff0c\u5b83\u627e\u4e0d\u5230\uff0c\u6240\u4ee5\u62a5\u9519\u4e86\u3002\u6211\u4eec\u9700\u8981\u63d0\u4f9b\u7f16\u8bd1\u7684\u4e00\u4e9b\u9009\u9879\u7ed9 <code>clang-tidy</code>\u3002</p> <p>\u4e00\u79cd\u65b9\u5f0f\u662f\u9519\u8bef\u4e2d\u63d0\u5230\u7684 Compilation Database\uff0c\u4e00\u822c\u4fdd\u5b58\u5728 <code>compile_commands.json</code> \u6587\u4ef6\u4e2d\uff0c\u91cc\u9762\u4fdd\u5b58\u4e86\u9488\u5bf9\u6bcf\u4e2a\u6587\u4ef6\u7684\u7f16\u8bd1\u6307\u4ee4\u3002\u8fd9\u4e2a\u6587\u4ef6\u53ef\u4ee5\u901a\u8fc7\u5c06 CMake \u7684 <code>CMAKE_EXPORT_COMPILE_COMMANDS</code> \u9009\u9879\u8bbe\u4e3a <code>1</code> \u751f\u6210\u3002</p> <p>\u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u5728\u547d\u4ee4\u884c\u6307\u5b9a\u7f16\u8bd1\u9009\u9879\uff1a</p> <pre><code>$ clang-tidy -checks=google* src/main.cpp -- -Iinclude\n1205 warnings generated.\n/home/howard/lint/src/main.cpp:3:1: warning: do not use namespace using-directives; use using-declarations instead [google-build-using-namespace]\nusing namespace std;\n^\n</code></pre> <p>\u548c <code>clang-format</code> \u7c7b\u4f3c\uff0c<code>clang-tidy</code> \u652f\u6301\u628a\u914d\u7f6e\u4ee5 yaml \u683c\u5f0f\u4fdd\u5b58\u5230\u6587\u4ef6\u4e2d\uff0c\u540d\u79f0\u662f <code>.clang-tidy</code>\u3002</p> <pre><code>---\nChecks:     '\n            bugprone-*,\n            clang-analyzer-*,\n            google-*,\n            modernize-*,\n            performance-*,\n            portability-*,\n            readability-*,\n            -bugprone-too-small-loop-variable,\n            -clang-analyzer-cplusplus.NewDelete,\n            -clang-analyzer-cplusplus.NewDeleteLeaks,\n            -modernize-use-nodiscard,\n            -modernize-avoid-c-arrays,\n            -readability-magic-numbers,\n            -bugprone-branch-clone,\n            -bugprone-signed-char-misuse,\n            -bugprone-unhandled-self-assignment,\n            -clang-diagnostic-implicit-int-float-conversion,\n            -modernize-use-auto,\n            -modernize-use-trailing-return-type,\n            -readability-convert-member-functions-to-static,\n            -readability-make-member-function-const,\n            -readability-qualified-auto,\n            -readability-redundant-access-specifiers,\n            '\nCheckOptions:\n - { key: readability-identifier-naming.ClassCase,           value: CamelCase  }\n - { key: readability-identifier-naming.EnumCase,            value: CamelCase  }\n - { key: readability-identifier-naming.FunctionCase,        value: CamelCase  }\n - { key: readability-identifier-naming.GlobalConstantCase,  value: UPPER_CASE }\n - { key: readability-identifier-naming.MemberCase,          value: lower_case }\nWarningsAsErrors: '*'\nHeaderFilterRegex: '/(src|test)/include'\nAnalyzeTemporaryDtors: true\n</code></pre>"},{"location":"storage/","title":"\u6982\u8bba","text":"<p>\u5b58\u50a8\u5f80\u5f80\u4e5f\u662f\u670d\u52a1\u5668\u7a0b\u5e8f\u5fc5\u5907\u7684\u4e00\u4e2a\u529f\u80fd\u3002\u4f8b\u5982\uff0c\u5982\u679c\u7f16\u5199\u4e00\u4e2a\u6559\u52a1\u7cfb\u7edf\uff0c\u90a3\u4e48\u5c31\u8981\u5b58\u653e\u5b66\u751f\u7684\u4fe1\u606f\u3001\u8bfe\u8868\u3001\u6210\u7ee9\u7b49\uff0c\u800c\u4e0d\u80fd\u91cd\u542f\u7a0b\u5e8f\u4e4b\u540e\u4fe1\u606f\u90fd\u4e22\u5931\u4e86\u3002\u4e5f\u8bb8\u4f60\u5df2\u7ecf\u77e5\u9053\u5982\u4f55\u4f7f\u7528\u6587\u4ef6\u64cd\u4f5c\u51fd\u6570\u6765\u8bfb\u53d6\u548c\u5199\u5165\u6587\u4ef6\uff0c\u4f46\u662f\u4ec5\u4ec5\u64cd\u4f5c\u6587\u4ef6\u662f\u4e0d\u591f\u7684\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u8003\u8651\u8bb8\u591a\u60c5\u51b5\uff1a</p> <ul> <li>\u5e94\u8be5\u4f7f\u7528\u4ec0\u4e48\u683c\u5f0f\u5c06\u6570\u636e\u4fdd\u5b58\u5230\u6587\u4ef6\u91cc\uff1f\u8981\u8003\u8651\u5b58\u53d6\u901f\u5ea6\u8fd8\u662f\u5360\u7528\u7a7a\u95f4\uff1f</li> <li>\u7a0b\u5e8f\u5347\u7ea7\u4e4b\u540e\uff0c\u8981\u600e\u4e48\u5904\u7406\u5df2\u7ecf\u5b58\u5728\u7684\u6570\u636e\uff1f</li> <li>\u5347\u7ea7\u5931\u8d25\u540e\uff0c\u6709\u6ca1\u6709\u529e\u6cd5\u6062\u590d\u6570\u636e\uff1f</li> <li>\u5982\u4f55\u5904\u7406\u591a\u7ebf\u7a0b\u540c\u65f6\u4fee\u6539\u6216\u8bfb\u53d6\u6570\u636e\uff1f</li> <li>\u5728\u8bfb\u5199\u6570\u636e\u65f6\u7a0b\u5e8f\u610f\u5916\u5d29\u6e83\u4e86\uff0c\u8981\u5982\u4f55\u6062\u590d\u6570\u636e\uff1f</li> <li>\u8981\u7f16\u5199\u4ec0\u4e48\u6837\u7684\u63a5\u53e3\u65b9\u4fbf\u5b58\u53d6\u6570\u636e\uff1f</li> </ul> <p>\u8981\u5904\u7406\u4ee5\u4e0a\u5404\u79cd\u5404\u6837\u590d\u6742\u7684\u60c5\u51b5\uff0c\u5176\u5b9e\u5c31\u662f\u8981\u7f16\u5199\u4e00\u4e2a\u5b58\u50a8\u5f15\u64ce\u3002\u5f53\u7136\uff0c\u7ecf\u8fc7\u51e0\u5341\u5e74\u7684\u53d1\u5c55\uff0c\u7f51\u4e0a\u5df2\u7ecf\u6709\u5927\u91cf\u73b0\u6210\u7684\u5b58\u50a8\u5f15\u64ce\u53ef\u4ee5\u4f7f\u7528\uff0c\u6211\u4eec\u53ea\u9700\u8981\u6839\u636e\u81ea\u5df1\u7684\u9700\u8981\u53bb\u9009\u62e9\u4e00\u4e2a\u5408\u9002\u7684\u5b58\u50a8\u5f15\u64ce\u6574\u5408\u5230\u670d\u52a1\u5668\u7a0b\u5e8f\u4e2d\u5373\u53ef\u3002</p> <p>\u6839\u636e\u5b58\u50a8\u5f15\u64ce\u5b58\u653e\u6570\u636e\u4f4d\u7f6e\u7684\u4e0d\u540c\uff0c\u6709\u672c\u5730\u5b58\u50a8\u548c\u8fdc\u7a0b\u5b58\u50a8\uff0c\u672c\u5730\u5b58\u50a8\u7ea6\u7b49\u4e8e\u76f4\u63a5\u8bfb\u5199\u6587\u4ef6\uff0c\u5ef6\u8fdf\u4f4e\uff0c\u4f46\u662f\u5982\u679c\u670d\u52a1\u7a0b\u5e8f\u79fb\u52a8\u5230\u5176\u4ed6\u673a\u5668\u4e0a\u8fd0\u884c\uff0c\u5219\u4f1a\u4e22\u5931\u6570\u636e\uff0c\u8fdc\u7a0b\u5b58\u50a8\u5219\u662f\u5229\u7528 RPC \u6765\u5411\u5176\u4ed6\u670d\u52a1\u7a0b\u5e8f\u8bf7\u6c42\u6570\u636e\uff0c\u5c06\u8ba1\u7b97\u548c\u5b58\u50a8\u5206\u79bb\uff0c\u4f1a\u5e26\u6765\u66f4\u9ad8\u7684\u5ef6\u8fdf\u4ee5\u53ca\u66f4\u590d\u6742\u7684\u5206\u5e03\u5f0f\u901a\u4fe1\u95ee\u9898\uff0c\u4f46\u662f\u53ef\u4ee5\u66f4\u597d\u7684\u5bb9\u707e\u3002</p> <p>\u800c\u6839\u636e\u63d0\u4f9b\u7684\u5b58\u50a8\u63a5\u53e3\u4e0d\u540c\uff0c\u53c8\u53ef\u4ee5\u5206\u4e3a\u952e\u503c\u5bf9\uff08KV\uff09\u5b58\u50a8\u3001\u5173\u7cfb\u578b\u6570\u636e\u5e93\uff08RDBMS\uff09\u3001\u6587\u6863\u6570\u636e\u5e93\uff08Document\uff09\u3001\u5411\u91cf\u6570\u636e\u5e93\uff08Vector\uff09\u7b49\u3002\u7b3c\u7edf\u5730\u8bb2\uff0c\u5176\u5b9e\u5c31\u662f\u5b58\u50a8\u7cfb\u7edf\u672c\u8eab\u5bf9\u4e8e\u6570\u636e\u7c7b\u578b\u6709\u7740\u591a\u5c11\u4e86\u89e3\uff0c\u5e76\u4e14\u5185\u5d4c\u4e86\u5404\u79cd\u7a0b\u5ea6\u7684\u8ba1\u7b97\u5f15\u64ce\u3002\u4f8b\u5982 KV \u6570\u636e\u5e93\u5bf9\u6570\u636e\u672c\u8eab\u51e0\u4e4e\u6ca1\u6709\u4efb\u4f55\u4e86\u89e3\uff0c\u53ea\u662f\u7b80\u5355\u5730\u63d0\u4f9b\u4e00\u4e2a\u5b57\u8282\u6570\u7ec4\u5230\u5b57\u8282\u6570\u7ec4\u6620\u5c04\u7684\u5b58\u50a8\u7cfb\u7edf\uff0c\u4f7f\u7528 KV \u6570\u636e\u5e93\u7684\u65f6\u5019\u5c31\u9700\u8981\u7f16\u5199\u5927\u91cf\u4ee3\u7801\u6765\u5148\u4ece\u6570\u636e\u5e93\u53d6\u51fa KV \u5bf9\uff0c\u7136\u540e\u518d\u8fdb\u884c\u8ba1\u7b97\u3002\u800c\u50cf RDBMS \u5219\u53ef\u4ee5\u7406\u89e3\u4e3a\u5728 KV \u6570\u636e\u5e93\u4e0a\uff0c\u63d0\u4f9b\u4e86\u590d\u6742\u7684\u8ba1\u7b97\u5f15\u64ce\uff0c\u53ef\u4ee5\u4f7f\u7528 SQL \u8bed\u53e5\u7b49\uff0c\u76f4\u63a5\u5728\u5b58\u50a8\u7cfb\u7edf\u5b8c\u6210\u9700\u8981\u7684\u8ba1\u7b97\uff0c\u518d\u8fd4\u56de\u7ed3\u679c\uff0c\u4f7f\u7528\u8005\u5219\u4e0d\u9700\u8981\u4eb2\u81ea\u5904\u7406 KV \u7684\u5e95\u5c42\u7ec6\u8282\u3002\u800c\u6587\u6863\u6570\u636e\u5e93\u4e5f\u53ef\u4ee5\u7406\u89e3\u4e3a\u5e26\u6709\u4e00\u5b9a\u8ba1\u7b97\u529f\u80fd\u7684 KV \u5f15\u64ce\uff0c\u662f RDBMS \u548c KV \u6570\u636e\u5e93\u7684\u4e00\u79cd\u6298\u4e2d\uff0c\u53ef\u4ee5\u7406\u89e3\u4e00\u4e2a Value \u4e2d\u7684\u4fe1\u606f\uff0c\u6bd4\u5982\u53ef\u4ee5\u5c06\u5176\u7406\u89e3\u6210\u4e00\u4e2a\u7ed3\u6784\u4f53\u3002\u5411\u91cf\u6570\u636e\u5e93\u5219\u662f\u987a\u5e94 AI \u65f6\u4ee3\u7684\u4e00\u79cd\u65b0\u578b\u6570\u636e\u5e93\uff0c\u5b83\u5b58\u50a8\u7684\u662f\u5927\u91cf\u7684\u6d6e\u70b9\u6570\u5411\u91cf\uff0c\u63d0\u4f9b\u4e86\u4f8b\u5982 KNN \u7b49\u7ecf\u5178\u7684\u5411\u91cf\u7b97\u6cd5\uff0c\u53ef\u4ee5\u5728\u6570\u636e\u5e93\u7aef\u5bf9\u5411\u91cf\u8fdb\u884c\u8ba1\u7b97\u3002</p> <p>\u4f7f\u7528\u529f\u80fd\u5f3a\u5927\u7684\u6570\u636e\u5e93\uff0c\u53ef\u4ee5\u7b80\u5316\u4ee3\u7801\u7684\u7f16\u5199\uff0c\u4f46\u662f\u5728\u7075\u6d3b\u6027\u4e0a\u5219\u4e0d\u5982\u529f\u80fd\u7b80\u5355\u7684\u6570\u636e\u5e93\u3002\u4f8b\u5982\uff0c\u5f53\u6570\u636e\u91cf\u5feb\u901f\u589e\u957f\u65f6\uff0cKV \u6570\u636e\u5e93\u6269\u5bb9\u5c31\u4f1a\u6bd4 RDBMS \u7b80\u5355\uff0c\u6027\u80fd\u8c03\u4f18\u4e5f\u66f4\u7b80\u5355\u3002\u540c\u65f6\uff0c\u529f\u80fd\u590d\u6742\u7684\u6570\u636e\u5e93\u53ef\u80fd\u4f1a\u5e26\u6765\u8bb8\u591a\u989d\u5916\u7684\u5f00\u9500\uff0c\u5728\u8ffd\u6c42\u6027\u80fd\u7684\u65f6\u5019\u4f18\u5316\u8d77\u6765\u4f1a\u6bd4\u4f7f\u7528\u7b80\u5355\u7248\u7684\u6570\u636e\u5e93\u52a0\u81ea\u5df1\u7f16\u5199\u7684\u7b97\u6cd5\u9ebb\u70e6\uff0c\u6240\u4ee5\u4e5f\u5e76\u4e0d\u662f\u4e00\u5b9a\u8981\u4f7f\u7528 RDBMS \u7b49\u5f3a\u5927\u7684\u6570\u636e\u5e93\u3002</p> <p>\u672c\u8282\u4e3b\u8981\u5e26\u4f60\u4e86\u89e3\u6709\u4ec0\u4e48\u6837\u7684\u5b58\u50a8\u6a21\u578b\u53ef\u4ee5\u9009\u62e9\uff0c\u4ee5\u53ca\u5bf9\u5e94\u7684\u4f7f\u7528\u573a\u666f\uff0c\u4f46\u662f\u5bf9\u4e8e\u5177\u4f53\u7684\u5b58\u50a8\u5f15\u64ce\u5b9e\u73b0\u5219\u4e0d\u4f1a\u8be6\u7ec6\u8bf4\u660e\uff0c\u66f4\u91cd\u8981\u7684\u662f\u5b66\u4f1a\u5206\u6790\u4e0d\u540c\u5f15\u64ce\u7684\u4f18\u52a3\uff0c\u4ee5\u53ca\u662f\u5426\u9002\u5408\u81ea\u5df1\u7684\u5e94\u7528\u9700\u6c42\u3002</p>"},{"location":"storage/kv/","title":"KV \u6a21\u578b","text":"<p>KV \u6a21\u578b\u662f\u6700\u7b80\u5355\u7684\u5b58\u50a8\u6a21\u578b\u4e4b\u4e00\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u53ef\u4ee5\u6301\u4e45\u5316\u7684 <code>std::map</code>\u3002\u5176\u5b9e\u6587\u4ef6\u7cfb\u7edf\u4e5f\u53ef\u4ee5\u7406\u89e3\u4e3a\u4e00\u4e2a KV\uff1aKey \u662f\u6587\u4ef6\u540d\uff0cValue \u662f\u6587\u4ef6\u5185\u5bb9\u3002\u901a\u7528\u7684 KV \u4e00\u822c\u4fdd\u5b58\u7684\u662f <code>string</code> \u5230 <code>string</code> \u7684\u6620\u5c04\uff0c\u5176\u4e2d\u7684 <code>string</code> \u4e0d\u4e00\u5b9a\u662f\u9700\u8981\u7eaf\u6587\u672c\uff0c\u4e5f\u53ef\u4ee5\u662f\u4e8c\u8fdb\u5236\u7684\u6570\u636e\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u5b57\u8282\u6570\u7ec4\u3002</p> <p>KV \u6a21\u578b\u5f3a\u5927\u4e4b\u5904\u5c31\u5728\u4e8e\u5b83\u975e\u5e38\u7b80\u5355\uff0c\u6240\u4ee5\u5b9e\u73b0\u4e00\u4e2a KV \u7cfb\u7edf\u5e76\u4e0d\u4f1a\u82b1\u8d39\u5f88\u591a\u65f6\u95f4\uff0c\u540c\u65f6\u5b83\u7684\u9002\u5e94\u6027\u975e\u5e38\u5f3a\uff0c\u5f00\u53d1\u8005\u53ef\u4ee5\u6309\u9700\u6dfb\u52a0\u81ea\u5df1\u6240\u9700\u8981\u7684\u529f\u80fd\uff0c\u5b9a\u5236\u81ea\u5df1\u7684 KV \u7cfb\u7edf\u3002\u540c\u65f6\uff0c\u4f7f\u7528 KV \u7cfb\u7edf\u53ef\u4ee5\u5f88\u65b9\u4fbf\u5730\u7ec4\u5408\u51fa\u5176\u4ed6\u8ba1\u7b97\u5b58\u50a8\u7cfb\u7edf\uff0c\u4f8b\u5982 MapReduce\u3001BigTable\u3001TiDB \u7b49\u3002\u56e0\u6b64\uff0c\u719f\u7ec3\u638c\u63e1 KV \u6a21\u578b\u662f\u7f16\u5199\u670d\u52a1\u5668\u7a0b\u5e8f\u4e2d\u5fc5\u4e0d\u53ef\u5c11\u7684\u4e00\u9879\u6280\u80fd\u3002\u5c3d\u7ba1\u73b0\u5728\u5df2\u7ecf\u6709\u5404\u79cd\u5404\u6837\u7684\u6570\u636e\u5e93\u548c\u8ba1\u7b97\u7cfb\u7edf\uff0c\u4f46\u5b83\u4eec\u6700\u5e95\u5c42\u5f80\u5f80\u90fd\u662f\u57fa\u4e8e KV \u6a21\u578b\u7684\u3002\u5f53\u4f60\u638c\u63e1\u4e86 KV \u6a21\u578b\uff0c\u4e86\u89e3\u4e86\u5e38\u7528\u7684\u4e00\u4e9b\u590d\u6742\u7684\u8ba1\u7b97\u5b58\u50a8\u7cfb\u7edf\u662f\u5982\u4f55\u5b9e\u73b0\u4e4b\u540e\uff0c\u5c31\u53ef\u4ee5\u5c1d\u8bd5\u6839\u636e\u81ea\u5df1\u7684\u9700\u8981\u7f16\u5199\u81ea\u5df1\u7684\u57fa\u4e8e KV \u7684\u65b0\u7684\u8ba1\u7b97\u5b58\u50a8\u7cfb\u7edf\u4e86\u3002</p> <p>\u6839\u636e\u5e95\u5c42\u539f\u7406\u7684\u4e0d\u540c\uff0cKV \u63d0\u4f9b\u7684\u63a5\u53e3\u548c\u6027\u80fd\u4e5f\u4f1a\u6709\u6240\u4e0d\u540c\u3002\u5c31\u50cf <code>std::map</code> \u548c <code>std::unordered_map</code> \u4e00\u6837\uff0c\u6709\u7684 KV \u662f\u57fa\u4e8e\u6709\u5e8f\u6570\u636e\u7ed3\u6784\uff0c\u4f8b\u5982 LSMTree\u3001B+Tree \u7b49\uff0c\u6765\u4fdd\u8bc1\u5176\u4e2d\u7684 Key \u662f\u6709\u5e8f\u5b58\u50a8\u7684\uff0c\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u8fdb\u884c\u6709\u5e8f\u7684\u8303\u56f4\u626b\u63cf\uff0c\u4f46\u662f\u4e3a\u4e86\u7ef4\u62a4 Key \u7684\u6709\u5e8f\u6027\uff0c\u5728\u63d2\u5165\u548c\u5bf9\u5355\u72ec\u4e00\u4e2a Key \u67e5\u8be2\u65f6\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5219\u4f1a\u6709\u6240\u4e0a\u5347\u3002\u800c\u57fa\u4e8e\u54c8\u5e0c\u8868\u7684 KV \u5b58\u50a8\uff0c\u5219\u727a\u7272\u4e86\u6709\u5e8f\u8303\u56f4\u626b\u63cf\u7684\u529f\u80fd\uff0c\u6362\u53d6\u66f4\u9ad8\u6027\u80fd\u7684\u5355\u70b9\u67e5\u8be2\u3001\u63d2\u5165\u64cd\u4f5c\u3002\u4e0d\u8fc7\uff0c\u73b0\u5728\u6210\u719f\u7684 KV \u5b58\u50a8\u5f15\u64ce\u5373\u4f7f\u5e95\u5c42\u91c7\u7528\u4e86\u54c8\u5e0c\u5b58\u50a8\uff0c\u4e5f\u540c\u6837\u4f1a\u5728\u5185\u5b58\u4e2d\u7ef4\u62a4\u4e00\u4efd\u6709\u5e8f\u7684 Key \u5217\u8868\uff0c\u6765\u63d0\u4f9b\u8303\u56f4\u67e5\u8be2\u7684\u80fd\u529b\uff0c\u8fd9\u79cd\u65b9\u5f0f\u53ef\u80fd\u4f1a\u727a\u7272\u542f\u52a8\u901f\u5ea6\uff0c\u56e0\u4e3a\u6bcf\u6b21\u542f\u52a8\u90fd\u9700\u8981\u626b\u63cf\u4e00\u6b21\u78c1\u76d8\u4e2d\u7684\u6587\u4ef6\u6765\u5efa\u7acb\u7d22\u5f15\uff0c\u4e5f\u6709\u4e00\u4e9b\u7cfb\u7edf\u4f1a\u5355\u72ec\u5b58\u653e\u7d22\u5f15\u6587\u4ef6\u3002</p> <p>\u6839\u636e\u4e0d\u540c\u7684\u4f7f\u7528\u573a\u666f\uff0c\u53ef\u4ee5\u9009\u62e9\u6700\u9002\u5408\u7684\u5b58\u50a8\u5f15\u64ce\u3002\u4e00\u822c\u800c\u8a00\uff0c\u9700\u8981\u8003\u8651\u7684\u56e0\u7d20\u6709\uff1a</p> <ul> <li>\u67e5\u8be2\u7684\u65b9\u5f0f\uff0c\u4f8b\u5982\u7a0b\u5e8f\u662f\u9488\u5bf9\u67d0\u4e00\u4e2a Key \u67e5\u8be2\u6bd4\u8f83\u591a\uff08\u5355\u70b9\u67e5\u8be2\uff09\uff0c\u8fd8\u662f\u4f1a\u8fdb\u884c\u4e00\u5b9a\u8303\u56f4\u7684\u626b\u63cf\uff08\u8303\u56f4\u67e5\u8be2\uff09\uff0c\u8fd8\u662f\u8fdb\u884c\u6279\u91cf\u7684 Key \u67e5\u8be2\uff08\u6279\u91cf\u70b9\u67e5\uff09</li> <li>\u8bfb/\u5199\u7684\u6bd4\u4f8b\uff0c\u4f8b\u5982\u7a0b\u5e8f\u662f\u4e0d\u662f 99% \u7684\u65f6\u5019\u90fd\u53ea\u662f\u8bfb\u53d6\u6570\u636e\uff0c\u800c\u4e0d\u4f1a\u8fdb\u884c\u4fee\u6539\uff0c\u6216\u8005\u662f\u5199\u5165\u540e\u57fa\u672c\u4e0d\u9700\u8981\u8bfb\u53d6</li> <li>\u8bfb/\u5199\u7684\u5ef6\u8fdf\uff0c\u4f8b\u5982\u6ce8\u518c\u7528\u6237\u7684\u65f6\u5019\u53ef\u80fd\u53ef\u4ee5\u63a5\u53d7\u82b1\u597d\u51e0\u79d2\u6765\u7b49\u5f85\u5199\u5165\uff0c\u4f46\u5e0c\u671b\u767b\u5f55\u7684\u65f6\u5019\u51e0\u5341\u6beb\u79d2\u5c31\u80fd\u8bfb\u53d6\u6570\u636e</li> <li>\u6570\u636e\u7684\u5bb9\u91cf\uff0c\u5982\u679c\u6570\u636e\u91cf\u592a\u5927\uff0c\u4f8b\u5982\u670b\u53cb\u5708\u3001\u5fae\u535a\u8fd9\u79cd\u53ef\u80fd\u4e0a\u767e\u4ebf\u7684\u6570\u91cf\uff0c\u5355\u673a\u5219\u65e0\u6cd5\u6ee1\u8db3\u9700\u6c42\uff0c\u4f46\u5982\u679c\u81ea\u5df1\u5199\u7684\u5c0f\u7f51\u7ad9\uff0c\u6570\u636e\u91cf\u53ef\u80fd\u5c0f\u5230\u53ef\u4ee5\u76f4\u63a5\u653e\u5728\u5185\u5b58\u4e2d</li> <li>\u6570\u636e\u7684\u70ed\u70b9\u5206\u5e03\uff0c\u4f8b\u5982\u5fae\u535a\uff0c\u5f88\u591a\u8bbf\u95ee\u5230\u7684\u5fae\u535a\u90fd\u662f\u6700\u8fd1\u4e00\u6bb5\u65f6\u95f4\u53d1\u7684\uff0c\u800c\u53d1\u4e86\u4e00\u4e2a\u661f\u671f\u6216\u8005\u66f4\u4e45\u7684\u5fae\u535a\u5219\u57fa\u672c\u5f88\u5c11\u88ab\u8bbf\u95ee\u5230</li> </ul>"},{"location":"storage/kv/#key-\u7684\u8bbe\u8ba1","title":"Key \u7684\u8bbe\u8ba1","text":"<p>\u4f7f\u7528 KV \u5b58\u50a8\u7684\u65f6\u5019\uff0c\u6700\u91cd\u8981\u7684\u5c31\u662f\u600e\u6837\u8bbe\u8ba1 Key\u3002\u7531\u4e8e\u4e00\u822c\u6765\u8bf4 KV \u6570\u636e\u5e93\u662f\u6574\u4e2a\u7a0b\u5e8f\u5171\u4eab\u540c\u4e00\u4e2a\u6570\u636e\u5e93\uff0c\u6240\u4ee5\u9700\u8981\u5728 Key \u4e2d\u7f16\u7801\u8f83\u591a\u7684\u4fe1\u606f\uff0c\u6bd4\u8f83\u7b80\u5355\u7684\u8bbe\u8ba1\u65b9\u6cd5\u662f\u7c7b\u578b\u3001\u5206\u9694\u7b26\u3001ID\u3002\u4f8b\u5982\uff0c\u6211\u4eec\u60f3\u4fdd\u5b58\u7528\u6237\u4fe1\u606f\u7684\u8bdd\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>users:1</code>\u3001<code>users:2</code>... \u8fd9\u79cd\u5f62\u5f0f\u6765\u7f16\u7801 Key\u3002\u5728\u9700\u8981\u8bbf\u95ee\u7684\u65f6\u5019\u624b\u52a8\u62fc\u63a5\u51fa Key\u3002</p> <p>\u5f53\u7136\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u4f7f\u7528\u4e8c\u8fdb\u5236\u4f5c\u4e3a Key\uff0c\u4f8b\u5982\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u4e5d\u4e2a\u5b57\u8282\u6765\u7f16\u7801 Key\uff0c\u5176\u4e2d\u7b2c\u4e00\u4e2a\u5b57\u8282\u53ef\u4ee5\u8bbe\u7f6e\u4e3a <code>0x1</code>\uff0c\u7528\u6765\u8868\u793a\u8fd9\u662f\u7528\u6237\uff0c\u800c\u5269\u4f59\u7684\u5b57\u8282\u5219\u53ef\u4ee5\u4f7f\u7528\u5927\u7aef\u5e8f\u6765\u7f16\u7801 64 \u4f4d\u65e0\u7b26\u53f7\u6574\u6570\u4f5c\u4e3a ID\uff0c\u8fd9\u6837\u5219\u4e0d\u9700\u8981\u4f7f\u7528\u5206\u9694\u7b26\u3002</p> <p>\u6709\u65f6\u5019\u4e5f\u53ef\u4ee5\u6a21\u4eff\u6587\u4ef6\u7cfb\u7edf\uff0c\u8fdb\u884c\u5c42\u7ea7\u5316\u7684 Key \u8bbe\u8ba1\uff0c\u4f8b\u5982 <code>users:admin:1</code>\uff0c\u8fd9\u6837\u7684\u597d\u5904\u662f\uff0c\u5047\u5982\u6211\u4eec\u9700\u8981\u6309\u7167\u4e00\u5b9a\u5c5e\u6027\uff08\u4f8b\u5982\u627e\u5230\u6240\u6709\u7ba1\u7406\u5458\uff09\u53bb\u904d\u5386 KV\uff0c\u5982\u679c Key \u53ea\u6709 ID \u4fe1\u606f\uff0c\u90a3\u4e48\u6211\u4eec\u5fc5\u987b\u626b\u63cf\u5168\u90e8\u7684 Key\uff0c\u53d6\u51fa Value \u89e3\u6790\u518d\u8fdb\u884c\u8fc7\u6ee4\u3002\u4f7f\u7528\u5c42\u7ea7\u5316\u7684\u8bbe\u8ba1\uff0c\u6211\u4eec\u53ef\u4ee5\u53ea\u626b\u63cf\u4ee5 <code>users:admin</code> \u4e3a\u524d\u7f00\u7684 Key\uff0c\u5c31\u80fd\u627e\u51fa\u6240\u6709\u7b26\u5408\u6761\u4ef6\u7684 KV\u3002</p>"},{"location":"storage/kv/#id-\u4e0e\u7d22\u5f15","title":"ID \u4e0e\u7d22\u5f15","text":"<p>\u66f4\u591a\u7684\u65f6\u5019\uff0c\u4f1a\u6df7\u5408\u4f7f\u7528\u5230\u591a\u79cd Key \u7684\u7f16\u7801\u65b9\u5f0f\u3002\u4f8b\u5982\uff0c\u6211\u4eec\u65e2\u4f7f\u7528 <code>users:1</code> \u6765\u4fdd\u5b58\u7528\u6237\u7684\u57fa\u672c\u4fe1\u606f\uff0c<code>users:admin:1</code> \u6765\u5e2e\u52a9\u6211\u4eec\u5feb\u901f\u67e5\u627e\u7279\u5b9a\u6761\u4ef6\u7684\u7528\u6237\u3002\u50cf <code>users:admin:1</code> \u8fd9\u79cd\u7528\u6765\u52a0\u901f\u67e5\u8be2\u7684 KV\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u7d22\u5f15\u3002</p> <p>\u90a3\u4e48\uff0c\u8fd9\u4f1a\u6709\u4e00\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u662f\u8981\u5206\u522b\u5728\u4e24\u4e2a Key \u4e2d\u4fdd\u5b58\u4e24\u4efd\u7528\u6237\u6570\u636e\uff0c\u8fd8\u662f <code>users:admin:1</code> \u8fd9\u4e2a Key \u4e0d\u4fdd\u5b58\u6570\u636e\uff0c\u53ea\u4fdd\u5b58 ID\uff0c\u9700\u8981\u7528\u5230\u6570\u636e\u518d\u67e5\u627e <code>users:1</code>\u3002\u8fd9\u53ef\u4ee5\u7406\u89e3\u4e3a\u805a\u7c07\u7d22\u5f15\u4e0e\u975e\u805a\u7c07\u7d22\u5f15\u3002</p> <p>\u5728\u805a\u7c07\u7d22\u5f15\u4e2d\uff0c\u6211\u4eec\u9009\u62e9\u6bcf\u4e00\u4e2a Key \u90fd\u4fdd\u5b58\u5b8c\u6574\u7684\u6570\u636e\uff0c\u8fd9\u6837\u7684\u597d\u5904\u662f\uff0c\u6211\u4eec\u53ea\u9700\u8981\u4e00\u6b21 KV \u67e5\u627e\uff0c\u5c31\u80fd\u5f97\u5230\u6240\u6709\u4fe1\u606f\uff0c\u4ee3\u4ef7\u662f\u5728\u66f4\u65b0\u6570\u636e\u7684\u65f6\u5019\u9700\u8981\u540c\u65f6\u66f4\u65b0\u591a\u4e2a Key \u4e2d\u7684\u6570\u636e\uff0c\u540c\u65f6\u8fd8\u8981\u4fdd\u8bc1\u4ed6\u4eec\u7684\u4e00\u81f4\u6027\u3002\u53e6\u5916\uff0c\u4e5f\u5f88\u6d6a\u8d39\u7a7a\u95f4\u3002\u53ef\u4ee5\u7406\u89e3\u4e3a <code>std::map&lt;string, User&gt;</code>\u3002</p> <p>\u800c\u4f7f\u7528\u975e\u805a\u7c07\u7d22\u5f15\u7684\u8bdd\uff0c\u4e00\u822c\u800c\u8a00\u53ea\u6709\u4e00\u4e2a Key \u4f1a\u4fdd\u5b58\u5b8c\u6574\u7684\u6570\u636e\uff0c\u800c\u5176\u4ed6\u7684 Key \u53ea\u4fdd\u5b58\u6307\u5411\u6570\u636e\u7684 Key\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u4e00\u4e2a\u6307\u9488\uff0c\u5728\u9700\u8981\u5b8c\u6574\u4fe1\u606f\u7684\u65f6\u5019\uff0c\u9700\u8981\u6839\u636e\u8fd9\u4e2a\u6307\u9488\u53bb\u518d\u6b21\u8bfb\u53d6 KV\uff0c\u5f97\u5230\u6570\u636e\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u53ef\u4ee5\u53eb\u505a\u56de\u8868\uff0c\u663e\u7136\uff0c\u8fd9\u79cd\u65b9\u5f0f\u591a\u4e86\u4e00\u6b21 KV \u64cd\u4f5c\u3002\u800c\u597d\u5904\u5219\u662f\u65e0\u9700\u64cd\u5fc3\u591a\u4e2a Key \u7684\u5b8c\u6574\u6027\uff0c\u4e5f\u4e0d\u9700\u8981\u6d6a\u8d39\u7a7a\u95f4\u4fdd\u5b58\u4e00\u6a21\u4e00\u6837\u7684\u6570\u636e\u3002\u53ef\u4ee5\u7406\u89e3\u4e3a <code>std::map&lt;string, User*&gt;</code>\u3002</p> <p>\u5f53\u7136\uff0c\u4ee5\u4e0a\u4e24\u79cd\u65b9\u5f0f\u4e5f\u4e0d\u662f\u975e\u9ed1\u5373\u767d\uff0c\u6211\u4eec\u751a\u81f3\u53ef\u4ee5\u91c7\u53d6\u4e00\u90e8\u5206\u7684 Key \u4f7f\u7528\u805a\u7c07\u7d22\u5f15\u7684\u65b9\u5f0f\u4fdd\u5b58\u6570\u636e\uff0c\u4e00\u90e8\u5206\u7684 Key \u5219\u4f7f\u7528\u975e\u805a\u7c07\u7d22\u5f15\u3002\u8fd9\u5c31\u9700\u8981\u5177\u4f53\u95ee\u9898\u5177\u4f53\u5206\u6790\uff0c\u770b KV \u7684\u5b58\u53d6\u9891\u7387\u7b49\u6765\u51b3\u5b9a\u4f7f\u7528\u600e\u6837\u7684\u65b9\u5f0f\u3002</p>"},{"location":"storage/kv/#kv-\u5b58\u50a8\u5f15\u64ce\u7684\u7279\u70b9","title":"KV \u5b58\u50a8\u5f15\u64ce\u7684\u7279\u70b9","text":"<p>KV \u5b58\u50a8\u6a21\u578b\u867d\u7136\u7b80\u5355\uff0c\u4f46\u662f\u5176\u5b9e\u73b0\u548c\u4f18\u5316\u6709\u6570\u4e0d\u6e05\u7684\u7ec6\u8282\u7ea0\u7f20\u5728\u4e00\u8d77\uff0c\u5230\u73b0\u5728\u4e5f\u4ecd\u7136\u662f\u7814\u7a76\u7684\u70ed\u70b9\u3002\u4e00\u822c\u800c\u8a00\uff0cKV \u4f1a\u63d0\u4f9b\u4ee5\u4e0b\u51e0\u79cd\u529f\u80fd\uff1a</p> <ul> <li>\u57fa\u672c\u7684\u589e\u5220\uff08\u70b9\u3001\u8303\u56f4\uff09\u67e5\u6539\u64cd\u4f5c<ul> <li>\u4e3a\u4e86\u9ad8\u6027\u80fd\uff0c\u4e0d\u540c KV \u4f1a\u91c7\u53d6\u4e0d\u540c\u7684\u4f7f\u7528\u573a\u666f\u3001\u8fd0\u884c\u786c\u4ef6\u7b49\u8fdb\u884c\u9488\u5bf9\u6027\u4f18\u5316</li> </ul> </li> <li>\u5d29\u6e83\u6062\u590d<ul> <li>\u5728\u6570\u636e\u64cd\u4f5c\u5230\u4e00\u534a\u7684\u65f6\u5019\uff0c\u7a0b\u5e8f\u610f\u5916\u5d29\u6e83\u4e0d\u4f1a\u9020\u6210\u6570\u636e\u635f\u574f\u7684\u95ee\u9898</li> <li>\u5728\u4e0b\u4e00\u6b21\u6570\u636e\u5e93\u521d\u59cb\u5316\u7684\u65f6\u5019\u5c1d\u8bd5\u4fee\u590d</li> <li>\u4e00\u822c\u662f\u901a\u8fc7 WAL\uff08Write-Ahead Logging\uff09\u5b9e\u73b0\u7684</li> </ul> </li> <li>\u6709\u9650\u7684\u4e8b\u52a1\u652f\u6301\u4ee5\u53ca\u5e76\u53d1\u63a7\u5236\uff0c\u4f8b\u5982<ul> <li>\u5e0c\u671b\u4e24\u4e2a Key\uff0c\u6bd4\u5982 <code>users:1</code> \u548c <code>users:admin:1</code> \u8981\u4e48\u4e00\u8d77\u66f4\u65b0\u6210\u529f\uff0c\u8981\u4e48\u4e00\u8d77\u66f4\u65b0\u5931\u8d25</li> <li>\u5728\u4fee\u6539\u7684\u8fc7\u7a0b\u4e2d\uff0c\u4e0d\u5e0c\u671b\u5176\u4ed6\u7ebf\u7a0b\u770b\u5230\u4fee\u6539\u5230\u4e00\u534a\u7684\u6570\u636e</li> <li>\u4e0d\u5e0c\u671b\u4e00\u4e2a Key \u540c\u65f6\u88ab\u591a\u4e2a\u7ebf\u7a0b\u4fee\u6539\u5bfc\u81f4\u6570\u636e\u9519\u4e71</li> </ul> </li> </ul>"},{"location":"storage/kv/#rocksdb","title":"RocksDB","text":"<p>\u76ee\u524d\u6700\u6d41\u884c\u7684\u5355\u673a KV \u5b58\u50a8\u5f15\u64ce\u662f RocksDB\uff0c\u5176\u524d\u8eab\u662f Google \u5f00\u53d1\u7684 LevelDB\u3002RocksDB \u9488\u5bf9 SSD\u3001\u591a\u6838\u7b49\u8fdb\u884c\u4e86\u5404\u79cd\u6027\u80fd\u4f18\u5316\uff0c\u57fa\u672c\u80fd\u6ee1\u8db3\u5927\u90e8\u5206\u7684\u9700\u6c42\u3002</p>"},{"location":"storage/kv/#tikv","title":"TiKV","text":"<p>TiKV \u662f\u57fa\u4e8e RocksDB \u5f00\u53d1\u7684\u5206\u5e03\u5f0f KV \u5b58\u50a8\u5f15\u64ce\uff0c\u53ef\u4ee5\u8fdb\u884c\u65e0\u9650\u6c34\u5e73\u6269\u5c55\uff0c\u4ece\u800c\u5e94\u4ed8\u5927\u91cf\u6570\u636e\u3002</p>"},{"location":"storage/object-storage/","title":"\u5bf9\u8c61\u5b58\u50a8","text":"<p>\u5728\u4e00\u4e9b\u670d\u52a1\u4e2d\uff0c\u6211\u4eec\u9700\u8981\u4fdd\u5b58\u4f8b\u5982\u7528\u6237\u4e0a\u4f20\u7684\u56fe\u7247\u3001\u97f3\u4e50\u3001\u6587\u4ef6\u7b49\uff0c\u8fd9\u79cd\u7c7b\u578b\u7684\u5b58\u50a8\u7279\u70b9\u662f\u6587\u4ef6\u5927\u5c0f\u4e0d\u786e\u5b9a\uff0c\u800c\u4e14\u8303\u56f4\u5f88\u5e7f\uff0c\u4ece\u51e0 MB \u5230\u51e0 GB \u751a\u81f3\u4e0a TB \u90fd\u6709\u3002\u8fd9\u79cd\u65f6\u5019\u5219\u9002\u5408\u4f7f\u7528\u5bf9\u8c61\u5b58\u50a8\u6765\u5b58\u653e\u8d44\u6e90\u3002</p>"},{"location":"storage/object-storage/#\u5bf9\u8c61\u5b58\u50a8\u7684\u7279\u70b9","title":"\u5bf9\u8c61\u5b58\u50a8\u7684\u7279\u70b9","text":"<p>\u5bf9\u8c61\u5b58\u50a8\u548c KV \u5b58\u50a8\u6709\u4e00\u5b9a\u7684\u76f8\u4f3c\u6027\uff0c\u90fd\u662f\u4efb\u610f\u7684 Key \u5230 Value \u7684\u6620\u5c04\u3002\u4f46\u662f\u548c KV \u5b58\u50a8\u4e0d\u540c\u7684\u662f</p> <ul> <li>\u5bf9\u8c61\u5b58\u50a8\u5f80\u5f80\u53ef\u4ee5\u9644\u52a0\u4e00\u4e9b\u5143\u4fe1\u606f\uff0c\u4f8b\u5982\u6587\u4ef6\u7684\u4fee\u6539\u65e5\u671f\u3001\u6587\u4ef6\u7c7b\u578b\u7b49</li> <li>\u5bf9\u8c61\u5b58\u50a8\u9488\u5bf9\u7684 Value \u66f4\u5927\uff0c\u4e5f\u4e3a\u6b64\u505a\u4e86\u4f18\u5316\uff0cKV \u5b58\u50a8\u4e00\u822c\u53ea\u7528\u4e8e\u5b58\u50a8 KB \u7ea7\u522b\u7684 Value</li> <li>\u5bf9\u8c61\u5b58\u50a8\u53ef\u4ee5\u652f\u6301\u4e0b\u8f7d\u6307\u5b9a\u8303\u56f4\u7684\u6587\u4ef6\u5185\u5bb9</li> <li>\u5bf9\u8c61\u5b58\u50a8\u7684\u4e00\u81f4\u6027\u66f4\u5dee\uff0c\u7528\u6237\u53ef\u80fd\u9700\u8981\u7b49\u5f85\u4e00\u6bb5\u65f6\u95f4\u624d\u80fd\u6570\u636e\u540c\u6b65</li> </ul> <p>\u800c\u5bf9\u8c61\u5b58\u50a8\u548c\u6587\u4ef6\u7cfb\u7edf\u4e5f\u6709\u4e00\u5b9a\u76f8\u4f3c\u6027\u548c\u4e0d\u540c\uff0c\u4f8b\u5982</p> <ul> <li>\u6587\u4ef6\u7cfb\u7edf\u5b9e\u9645\u4e0a\u5177\u6709\u5c42\u7ea7\u7ed3\u6784\uff0c\u5728\u6253\u5f00\u6587\u4ef6\u7684\u65f6\u5019\u9700\u8981\u6309\u7167\u76ee\u5f55\u6811\u4e00\u5c42\u5c42\u5730\u67e5\u627e\u6587\u4ef6\uff0c\u6d89\u53ca\u591a\u6b21 IO\uff0c\u800c\u5bf9\u8c61\u5b58\u50a8\u5219\u76f4\u63a5\u6839\u636e Key \u6620\u5c04\u5230\u6587\u4ef6\u672c\u8eab\uff0c\u53ef\u4ee5\u505a\u5230 O(1) \u7684 IO \u6b21\u6570</li> <li>\u6587\u4ef6\u7cfb\u7edf\u4fdd\u5b58\u7684\u5143\u4fe1\u606f\u66f4\u591a\uff0c\u4f8b\u5982\u6587\u4ef6\u6743\u9650\u7b49\u7b49\uff0c\u800c\u5bf9\u8c61\u5b58\u50a8\u5219\u53ef\u4ee5\u6709\u9009\u62e9\u7684\u53bb\u9664\u4e0d\u5fc5\u8981\u7684\u5143\u4fe1\u606f</li> <li>\u5728\u6587\u4ef6\u7cfb\u7edf\u4e0a\uff0c\u53ef\u4ee5\u9488\u5bf9\u6587\u4ef6\u7684\u67d0\u4e00\u90e8\u5206\u8fdb\u884c\u4fee\u6539\uff0c\u800c\u5bf9\u8c61\u5b58\u50a8\u53ea\u80fd\u591f\u6309\u7167\u4e00\u6574\u4e2a\u5bf9\u8c61\u6765\u8fdb\u884c\u64cd\u4f5c\uff0c\u5982\u679c\u9700\u8981\u4fee\u6539\u5219\u9700\u8981\u91cd\u65b0\u4e0a\u4f20\u4e00\u4efd\u5b8c\u6574\u7684\u5bf9\u8c61</li> </ul>"},{"location":"storage/object-storage/#s3-\u5bf9\u8c61\u5b58\u50a8\u63a5\u53e3","title":"S3 \u5bf9\u8c61\u5b58\u50a8\u63a5\u53e3","text":"<p>S3 \u662f AWS \u63d0\u4f9b\u7684\u5bf9\u8c61\u5b58\u50a8\u670d\u52a1\uff0c\u7531\u4e8e\u88ab\u5e7f\u6cdb\u4f7f\u7528\uff0cS3 API \u4e5f\u51e0\u4e4e\u6210\u4e3a\u4e86\u6240\u6709\u5bf9\u8c61\u5b58\u50a8\u7cfb\u7edf\u7684\u6807\u51c6\u63a5\u53e3\u3002</p>"},{"location":"testing/","title":"\u6982\u89c8","text":"<p>\u5728\u5b8c\u6210\u7a0b\u5e8f\u7f16\u5199\u5b8c\u6210\u540e\uff0c\u6211\u4eec\u90fd\u9700\u8981\u5bf9\u7a0b\u5e8f\u8fdb\u884c\u6d4b\u8bd5\u3002\u5e73\u65f6\u5199\u5c0f\u7a0b\u5e8f\u7684\u8bdd\uff0c\u6211\u4eec\u4e00\u822c\u76f4\u63a5\u5199\u4e2a\u7b80\u5355\u7684 <code>main</code> \u51fd\u6570\uff0c\u7136\u540e\u5904\u7406\u8f93\u5165\u8f93\u51fa\uff0c\u6216\u8005\u76f4\u63a5\u5199\u6b7b\u6d4b\u8bd5\u7528\u4f8b\uff0c\u7136\u540e\u6253\u5370\u7ed3\u679c\u3002\u4e0d\u8fc7\uff0c\u5982\u679c\u9700\u8981\u6d4b\u8bd5\u7684\u51fd\u6570\u6bd4\u8f83\u591a\u7684\u8bdd\uff0c\u4e00\u4e2a\u4e2a\u770b\u8f93\u51fa\u4e5f\u6bd4\u8f83\u9ebb\u70e6\uff0c\u800c\u4e14\u5982\u679c\u8f93\u51fa\u7684\u5185\u5bb9\u6bd4\u8f83\u591a\u5c31\u4e0d\u65b9\u4fbf\u6574\u7406\u3002\u800c\u4e14\uff0c\u4e5f\u4e0d\u65b9\u4fbf\u6211\u4eec\u4f7f\u7528\u5176\u4ed6\u7684\u81ea\u52a8\u5316\u5de5\u5177\u6765\u5904\u7406\u6d4b\u8bd5\u7ed3\u679c\u3002\u53e6\u5916\u5982\u679c\u53ea\u662f\u5f00\u53d1\u4e00\u4e2a\u5c0f\u51fd\u6570\uff0c\u6211\u4eec\u53ef\u80fd\u60f3\u8981\u53ea\u6267\u884c\u8fd9\u4e2a\u51fd\u6570\u76f8\u5173\u7684\u6d4b\u8bd5\uff0c\u52a0\u5feb\u6d4b\u8bd5\u901f\u5ea6\uff0c\u8fd9\u65f6\u5019\u9700\u8981\u6211\u4eec\u624b\u52a8\u53bb\u5904\u7406\u7a0b\u5e8f\u6ce8\u91ca\u7b49\u3002</p> <p>\u5bf9\u4e8e\u590d\u6742\u4e00\u70b9\u7684\u7a0b\u5e8f\uff0c\u6211\u4eec\u53ef\u80fd\u4f1a\u76f4\u63a5\u542f\u52a8\u7a0b\u5e8f\uff0c\u7136\u540e\u624b\u52a8\u6d4b\u8bd5\u529f\u80fd\u3002\u4f46\u5047\u5982\u7a0b\u5e8f\u7684\u4f9d\u8d56\u6bd4\u8f83\u590d\u6742\uff0c\u4f8b\u5982\u9700\u8981\u8fde\u63a5\u5230\u6570\u636e\u5e93\uff0c\u4f46\u662f\u5f00\u53d1\u7684\u529f\u80fd\u5176\u5b9e\u4e0d\u6d89\u53ca\u5230\u6570\u636e\u5e93\u7684\u8bdd\uff0c\u90a3\u4e48\u5c31\u4f1a\u663e\u5f97\u5f88\u9ebb\u70e6\u3002\u5047\u5982\u6211\u4eec\u5f00\u53d1\u7684\u662f\u4e00\u4e2a\u5e93\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u5f15\u5165\u591a\u4f59\u7684 <code>main</code> \u51fd\u6570\u3002</p> <p>\u4e3a\u6b64\uff0c\u6211\u4eec\u4e00\u822c\u4f7f\u7528\u4f8b\u5982 Google Test \u7b49\u6d4b\u8bd5\u6846\u67b6\u6765\u5bf9\u7a0b\u5e8f\u8fdb\u884c\u6d4b\u8bd5\u3002\u8fd9\u4e9b\u6d4b\u8bd5\u6846\u67b6\u4e00\u822c\u63d0\u4f9b\u4e86\u4e00\u4e9b\u5e38\u7528\u529f\u80fd\uff0c\u6bd4\u5982</p> <ul> <li>\u6bd4\u8f83\u5404\u79cd\u6570\u636e\u7c7b\u578b\u7684\u6bd4\u8f83\u51fd\u6570</li> <li>\u5305\u88c5\u4e86\u6bd4\u8f83\u51fd\u6570\u7684\u65ad\u8a00\u51fd\u6570</li> <li>\u4e00\u4e9b\u6d4b\u8bd5\u7684\u6a21\u677f\u4ee3\u7801</li> <li>\u81ea\u5b9a\u4e49\u9700\u8981\u6267\u884c\u7684\u6d4b\u8bd5\u96c6\u5408</li> <li>\u8f93\u51fa XML \u7b49\u7a0b\u5e8f\u53ef\u8bfb\u7684\u6d4b\u8bd5\u62a5\u544a</li> </ul> <p>\u5f53\u7136\uff0c\u6d4b\u8bd5\u9664\u4e86\u4fdd\u8bc1\u7a0b\u5e8f\u7684\u6b63\u786e\u6027\u4e4b\u5916\uff0c\u4e5f\u65b9\u4fbf\u4e86\u540e\u9762\u63a5\u624b\u9879\u76ee\u7684\u5f00\u53d1\u8005\u3002\u901a\u8fc7\u6d4b\u8bd5\u4ee3\u7801\uff0c\u522b\u4eba\u5c31\u53ef\u4ee5\u5f88\u6e05\u695a\u7684\u77e5\u9053\u4e00\u4e2a\u51fd\u6570/\u7c7b\u5e94\u5f53\u600e\u4e48\u53bb\u4f7f\u7528\u3002\u901a\u8fc7\u4f7f\u7528\u8c03\u8bd5\u5668\u6267\u884c\u6d4b\u8bd5\uff0c\u53ef\u4ee5\u4e0d\u9700\u8981\u914d\u7f6e\u65e0\u5173\u7684\u4f9d\u8d56\uff0c\u5f88\u5feb\u5730\u770b\u5230\u7a0b\u5e8f\u6267\u884c\u7684\u4e2d\u95f4\u7ed3\u679c\u3002</p>"},{"location":"testing/diff/","title":"\u4f7f\u7528 diff \u8fdb\u884c\u6d4b\u8bd5","text":"<p>\u4e00\u79cd\u7b80\u5355\u7c97\u66b4\u7684\u65b9\u6cd5\u5c31\u662f\u76f4\u63a5\u5bf9\u7a0b\u5e8f\u7684\u8f93\u51fa\u8fdb\u884c\u6587\u672c\u6bd4\u8f83\uff0c\u7b97\u6cd5\u7ade\u8d5b\u4e2d\u5c31\u662f\u4f7f\u7528\u8fd9\u79cd\u65b9\u6cd5\u6765\u6d4b\u8bd5\u7a0b\u5e8f\u7684\u3002</p>"},{"location":"testing/googletest/","title":"\u4f7f\u7528 Google Test \u7f16\u5199\u6d4b\u8bd5","text":""}]}